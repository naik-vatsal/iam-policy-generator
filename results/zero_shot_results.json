[
  {
    "id": "aws_managed_0129",
    "instruction": "Provide an IAM policy for AWSWAF Full Access",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"AllowUseOfAWSWAFClassic\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"waf:*\",\n        \"waf-regional:*\"\n      ],\n      \"Resource\": [\n        \"arn:aws:waf::*:bytematchset/*\",\n        \"arn:aws:waf::*:ipset/*\",\n        \"arn:aws:waf::*:ratebasedrule/*\",\n        \"arn:aws:waf::*:rule/*\",\n        \"arn:aws:waf::*:sizeconstraintset/*\",\n        \"arn:aws:waf::*:sqlinjectionset/*\",\n        \"arn:aws:waf::*:webacl/*\",\n        \"arn:aws:waf::*:xssmatchset/*\",\n        \"arn:aws:waf::*:regexmatch/*\",\n        \"arn:aws:waf::*:regexpatternset/*\",\n        \"arn:aws:waf::*:geomatchset/*\",\n        \"arn:aws:waf::*:rulegroup/*\",\n        \"arn:aws:waf::*:changetoken/*\",\n        \"arn:aws:waf-regional:*:*:bytematchset/*\",\n        \"arn:aws:waf-regional:*:*:ipset/*\",\n        \"arn:aws:waf-regional:*:*:ratebasedrule/*\",\n        \"arn:aws:waf-regional:*:*:rule/*\",\n        \"arn:aws:waf-regional:*:*:sizeconstraintset/*\",\n        \"arn:aws:waf-regional:*:*:sqlinjectionset/*\",\n        \"arn:aws:waf-regional:*:*:webacl/*\",\n        \"arn:aws:waf-regional:*:*:xssmatchset/*\",\n        \"arn:aws:waf-regional:*:*:regexmatch/*\",\n        \"arn:aws:waf-regional:*:*:regexpatternset/*\",\n        \"arn:aws:waf-regional:*:*:geomatchset/*\",\n        \"arn:aws:waf-regional:*:*:rulegroup/*\",\n        \"arn:aws:waf-regional:*:*:changetoken/*\"\n      ]\n    },\n    {\n      \"Sid\": \"AllowWAFClassicGetWebACLForResource\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"waf-regional:GetWebACLForResource\"\n      ],\n      \"Resource\": \"arn:aws:waf-regional:*:*:*/*\"\n    },\n    {\n      \"Sid\": \"AllowUseOfAWSWAF\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"wafv2:*\"\n      ],\n      \"Resource\": [\n        \"arn:aws:wafv2:*:*:*/webacl/*/*\",\n        \"arn:aws:wafv2:*:*:*/ipset/*/*\",\n        \"arn:aws:wafv2:*:*:*/managedruleset/*/*\",\n        \"arn:aws:wafv2:*:*:*/rulegroup/*/*\",\n        \"arn:aws:wafv2:*:*:*/regexpatternset/*/*\"\n      ]\n    },\n    {\n      \"Sid\": \"AllowDisassociateWebACL\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"wafv2:DisassociateWebACL\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"AllowActionsForALB\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"elasticloadbalancing:SetWebAcl\"\n      ],\n      \"Resource\": \"arn:aws:elasticloadbalancing:*:*:loadbalancer/app/*/*\"\n    },\n    {\n      \"Sid\": \"AllowActionsForAPIGateway\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"apigateway:SetWebACL\"\n      ],\n      \"Resource\": \"arn:aws:apigateway:*::/restapis/*/stages/*\"\n    },\n    {\n      \"Sid\": \"AllowActionsForAppSync\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"appsync:SetWebACL\"\n      ],\n      \"Resource\": \"arn:aws:appsync:*:*:apis/*\"\n    },\n    {\n      \"Sid\": \"AllowActionsForCognito\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"cognito-idp:AssociateWebACL\",\n        \"cognito-idp:DisassociateWebACL\",\n        \"cognito-idp:GetWebACLForResource\"\n      ],\n      \"Resource\": \"arn:aws:cognito-idp:*:*:userpool/*\"\n    },\n    {\n      \"Sid\": \"AllowListActionsForCognito\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"cognito-idp:ListResourcesForWebACL\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"AllowActionsForAppRunner\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"apprunner:AssociateWebAcl\",\n        \"apprunner:DisassociateWebAcl\",\n        \"apprunner:DescribeWebAclForService\"\n      ],\n      \"Resource\": \"arn:aws:apprunner:*:*:service/*/*\"\n    },\n    {\n      \"Sid\": \"AllowListActionsForAppRunner\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"apprunner:ListServices\",\n        \"apprunner:ListAssociatedServicesForWebAcl\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"AllowActionsForAVA\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:AssociateVerifiedAccessInstanceWebAcl\",\n        \"ec2:DisassociateVerifiedAccessInstanceWebAcl\",\n        \"ec2:GetVerifiedAccessInstanceWebAcl\"\n      ],\n      \"Resource\": \"arn:aws:ec2:*:*:verified-access-instance/*\"\n    },\n    {\n      \"Sid\": \"AllowListActionsForAVA\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:DescribeVerifiedAccessInstanceWebAclAssociations\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"AllowActionsForAmplify\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"amplify:AssociateWebACL\",\n        \"amplify:DisassociateWebACL\",\n        \"amplify:GetWebACLForResource\"\n      ],\n      \"Resource\": \"arn:aws:amplify:*:*:apps/*\"\n    },\n    {\n      \"Sid\": \"AllowListActionsForAmplify\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"amplify:ListResourcesForWebACL\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"AllowLogGroupDescribeActions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"logs:DescribeResourcePolicies\",\n        \"logs:DescribeLogGroups\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"AllowLogDeliverySubscription\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"logs:CreateLogDelivery\",\n        \"logs:DeleteLogDelivery\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"GrantLogDeliveryPermissionForS3Bucket\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:PutBucketPolicy\",\n        \"s3:GetBucketPolicy\"\n      ],\n      \"Resource\": [\n        \"arn:aws:s3:::aws-waf-logs-*\"\n      ]\n    },\n    {\n      \"Sid\": \"GrantLogDeliveryPermissionForCloudWatchLogGroup\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"logs:PutResourcePolicy\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"ForAnyValue:StringEquals\": {\n          \"aws:CalledVia\": [\n            \"wafv2.amazonaws.com\"\n          ]\n        }\n      }\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"VisualEditor0\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"waf-regional:*\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n```\n\n### Explanation:\nThe above policy allows all actions on WAF. This is a very broad policy and should be used with caution. It is recommended to use the least privilege principle when creating policies.\n\n### References:\n[AWS WAF](https://docs.aws.amazon.com/waf/latest/developerguide/waf-introduction.html)\n\n[IAM Policy Examples](https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_examples-waf.html)",
    "complexity": "complex"
  },
  {
    "id": "aws_managed_1300",
    "instruction": "Provide an IAM policy for Amazon Sage Maker Training Plan Create Access",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"CreateTrainingPlanPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"sagemaker:CreateTrainingPlan\",\n        \"sagemaker:CreateReservedCapacity\",\n        \"sagemaker:DescribeReservedCapacity\"\n      ],\n      \"Resource\": [\n        \"arn:aws:sagemaker:*:*:training-plan/*\",\n        \"arn:aws:sagemaker:*:*:reserved-capacity/*\"\n      ]\n    },\n    {\n      \"Sid\": \"AddTagsToTrainingPlanPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"sagemaker:AddTags\"\n      ],\n      \"Resource\": [\n        \"arn:aws:sagemaker:*:*:training-plan/*\",\n        \"arn:aws:sagemaker:*:*:reserved-capacity/*\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"sagemaker:TaggingAction\": [\n            \"CreateTrainingPlan\",\n            \"CreateReservedCapacity\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"DescribeTrainingPlanPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"sagemaker:DescribeTrainingPlan\",\n      \"Resource\": [\n        \"arn:aws:sagemaker:*:*:training-plan/*\"\n      ]\n    },\n    {\n      \"Sid\": \"NonResourceLevelTrainingPlanPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"sagemaker:SearchTrainingPlanOfferings\",\n        \"sagemaker:ListTrainingPlans\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"ListUltraServersByReservedCapacityPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"sagemaker:ListUltraServersByReservedCapacity\",\n      \"Resource\": [\n        \"arn:aws:sagemaker:*:*:reserved-capacity/*\"\n      ]\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"sagemaker:CreateTrainingPlan\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n```\n\n### Explanation:\nThe `sagemaker:CreateTrainingPlan` action is used to create a training plan in Amazon SageMaker. This action allows you to specify the training job configuration, including the instance type, number of instances, and other parameters. The training plan can be used to train machine learning models on your data.\n\n### References:\n* [Amazon SageMaker API Reference](https://docs.aws.amazon.com/sagemaker/latest/APIReference/Welcome.html)",
    "complexity": "complex"
  },
  {
    "id": "aws_managed_1147",
    "instruction": "Provide an IAM policy for IVS Full Access",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"IVSFullAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ivs:*\",\n        \"ivschat:*\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ivs-realtime:*\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n```\n\n### Explanation:\nThe `ivs-realtime:*` action allows the user to perform all actions on the IVS service. This includes creating, updating, and deleting channels, streams, and other resources. It also allows the user to manage access control lists (ACLs) and permissions for these resources.\n\nThe `*` wildcard in the `Resource` field means that the policy applies to all resources within the IVS service. This includes channels, streams, and any other resources created by the user.\n\nIt's important to note that this policy should only be applied to users who need full access to the IVS service. It grants a high level of privileges and should not be given to users who do not require it.",
    "complexity": "medium"
  },
  {
    "id": "aws_managed_0557",
    "instruction": "Provide an IAM policy for Access Analyzer Service Role Policy",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"AccessAnalyzerServiceRolePolicy\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"dynamodb:GetResourcePolicy\",\n        \"dynamodb:ListStreams\",\n        \"dynamodb:ListTables\",\n        \"ec2:DescribeAddresses\",\n        \"ec2:DescribeByoipCidrs\",\n        \"ec2:DescribeSnapshotAttribute\",\n        \"ec2:DescribeSnapshots\",\n        \"ec2:DescribeVpcEndpoints\",\n        \"ec2:DescribeVpcs\",\n        \"ec2:GetSnapshotBlockPublicAccessState\",\n        \"ecr:DescribeRepositories\",\n        \"ecr:GetAccountSetting\",\n        \"ecr:GetRegistryPolicy\",\n        \"ecr:GetRepositoryPolicy\",\n        \"elasticfilesystem:DescribeFileSystemPolicy\",\n        \"elasticfilesystem:DescribeFileSystems\",\n        \"iam:GetRole\",\n        \"iam:ListEntitiesForPolicy\",\n        \"iam:ListRoles\",\n        \"iam:ListUsers\",\n        \"iam:ListRoleTags\",\n        \"iam:ListUserTags\",\n        \"iam:GetAccountAuthorizationDetails\",\n        \"iam:GetUser\",\n        \"iam:GetGroup\",\n        \"iam:GenerateServiceLastAccessedDetails\",\n        \"iam:GetServiceLastAccessedDetails\",\n        \"iam:ListAccessKeys\",\n        \"iam:GetLoginProfile\",\n        \"iam:GetAccessKeyLastUsed\",\n        \"iam:ListRolePolicies\",\n        \"iam:GetRolePolicy\",\n        \"iam:ListAttachedRolePolicies\",\n        \"iam:ListUserPolicies\",\n        \"iam:GetUserPolicy\",\n        \"iam:ListAttachedUserPolicies\",\n        \"iam:GetPolicy\",\n        \"iam:GetPolicyVersion\",\n        \"iam:ListGroupsForUser\",\n        \"kms:DescribeKey\",\n        \"kms:GetKeyPolicy\",\n        \"kms:ListGrants\",\n        \"kms:ListKeyPolicies\",\n        \"kms:ListKeys\",\n        \"lambda:GetFunctionUrlConfig\",\n        \"lambda:GetLayerVersionPolicy\",\n        \"lambda:GetPolicy\",\n        \"lambda:ListAliases\",\n        \"lambda:ListFunctions\",\n        \"lambda:ListLayers\",\n        \"lambda:ListLayerVersions\",\n        \"lambda:ListVersionsByFunction\",\n        \"organizations:DescribeAccount\",\n        \"organizations:DescribeOrganization\",\n        \"organizations:DescribeOrganizationalUnit\",\n        \"organizations:ListAccounts\",\n        \"organizations:ListAccountsForParent\",\n        \"organizations:ListAWSServiceAccessForOrganization\",\n        \"organizations:ListChildren\",\n        \"organizations:ListDelegatedAdministrators\",\n        \"organizations:ListOrganizationalUnitsForParent\",\n        \"organizations:ListParents\",\n        \"organizations:ListRoots\",\n        \"rds:DescribeDBClusterSnapshotAttributes\",\n        \"rds:DescribeDBClusterSnapshots\",\n        \"rds:DescribeDBSnapshotAttributes\",\n        \"rds:DescribeDBSnapshots\",\n        \"s3:DescribeMultiRegionAccessPointOperation\",\n        \"s3:GetAccessPoint\",\n        \"s3:GetAccessPointPolicy\",\n        \"s3:GetAccessPointPolicyStatus\",\n        \"s3:GetAccountPublicAccessBlock\",\n        \"s3:GetBucketAcl\",\n        \"s3:GetBucketLocation\",\n        \"s3:GetBucketPolicyStatus\",\n        \"s3:GetBucketPolicy\",\n        \"s3:GetBucketPublicAccessBlock\",\n        \"s3:GetMultiRegionAccessPoint\",\n        \"s3:GetMultiRegionAccessPointPolicy\",\n        \"s3:GetMultiRegionAccessPointPolicyStatus\",\n        \"s3:ListAccessPoints\",\n        \"s3:ListAllMyBuckets\",\n        \"s3:ListMultiRegionAccessPoints\",\n        \"s3express:GetAccessPoint\",\n        \"s3express:GetAccessPointPolicy\",\n        \"s3express:GetBucketPolicy\",\n        \"s3express:ListAllMyDirectoryBuckets\",\n        \"s3express:ListAccessPointsForDirectoryBuckets\",\n        \"sns:GetTopicAttributes\",\n        \"sns:ListTopics\",\n        \"secretsmanager:DescribeSecret\",\n        \"secretsmanager:GetResourcePolicy\",\n        \"secretsmanager:ListSecrets\",\n        \"sqs:GetQueueAttributes\",\n        \"sqs:ListQueues\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"accessanalyzer:*\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n```\n\n### Explanation:\nThe `AccessAnalyzer` service role is used to perform the analysis of your AWS resources. The policy allows all actions on all resources.\n\n### References:\n* https://docs.aws.amazon.com/IAM/latest/UserGuide/accessanalyzer-service-role.html\n* https://docs.aws.amazon.com/IAM/latest/UserGuide/accessanalyzer-service-role.html#accessanalyzer-service-role-policy",
    "complexity": "complex"
  },
  {
    "id": "aws_managed_0921",
    "instruction": "Provide an IAM policy for Monitron Service Role Policy",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"logs:CreateLogGroup\",\n        \"logs:CreateLogStream\",\n        \"logs:PutLogEvents\"\n      ],\n      \"Resource\": [\n        \"arn:aws:logs:*:*:log-group:/aws/monitron/*\"\n      ]\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"logs:*\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:Describe*\",\n        \"ec2:CreateTags\",\n        \"ec2:DeleteTags\",\n        \"ec2:AttachVolume\",\n        \"ec2:DetachVolume\",\n        \"ec2:ModifyInstanceMetadataOptions\",\n        \"ec2:CreateNetworkInterface\",\n        \"ec2:DeleteNetworkInterface\",\n        \"ec2:DescribeInstances\",\n        \"ec2:DescribeSubnets\",\n        \"ec2:DescribeSecurityGroups\",\n        \"ec2:DescribeVpcs\",\n        \"ec2:DescribeVolumes\",\n        \"ec2:DescribeImages\",\n        \"ec2:DescribeKeyPairs\",\n        \"ec2:DescribeAddresses\",\n        \"ec2:DescribeDhcpOptions\",",
    "complexity": "simple"
  },
  {
    "id": "aws_managed_0312",
    "instruction": "Provide an IAM policy for AWS Service Catalog Admin Full Access",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"cloudformation:CreateStack\",\n        \"cloudformation:DeleteStack\",\n        \"cloudformation:DescribeStackEvents\",\n        \"cloudformation:DescribeStacks\",\n        \"cloudformation:SetStackPolicy\",\n        \"cloudformation:UpdateStack\",\n        \"cloudformation:CreateChangeSet\",\n        \"cloudformation:DescribeChangeSet\",\n        \"cloudformation:ExecuteChangeSet\",\n        \"cloudformation:ListChangeSets\",\n        \"cloudformation:DeleteChangeSet\",\n        \"cloudformation:ListStackResources\",\n        \"cloudformation:TagResource\",\n        \"cloudformation:CreateStackSet\",\n        \"cloudformation:CreateStackInstances\",\n        \"cloudformation:UpdateStackSet\",\n        \"cloudformation:UpdateStackInstances\",\n        \"cloudformation:DeleteStackSet\",\n        \"cloudformation:DeleteStackInstances\",\n        \"cloudformation:DescribeStackSet\",\n        \"cloudformation:DescribeStackInstance\",\n        \"cloudformation:DescribeStackSetOperation\",\n        \"cloudformation:ListStackInstances\",\n        \"cloudformation:ListStackSetOperations\",\n        \"cloudformation:ListStackSetOperationResults\"\n      ],\n      \"Resource\": [\n        \"arn:aws:cloudformation:*:*:stack/SC-*\",\n        \"arn:aws:cloudformation:*:*:stack/StackSet-SC-*\",\n        \"arn:aws:cloudformation:*:*:changeSet/SC-*\",\n        \"arn:aws:cloudformation:*:*:stackset/SC-*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"cloudformation:CreateUploadBucket\",\n        \"cloudformation:GetTemplateSummary\",\n        \"cloudformation:ValidateTemplate\",\n        \"iam:GetGroup\",\n        \"iam:GetRole\",\n        \"iam:GetUser\",\n        \"iam:ListGroups\",\n        \"iam:ListRoles\",\n        \"iam:ListUsers\",\n        \"servicecatalog:Get*\",\n        \"servicecatalog:Scan*\",\n        \"servicecatalog:Search*\",\n        \"servicecatalog:List*\",\n        \"servicecatalog:TagResource\",\n        \"servicecatalog:UntagResource\",\n        \"servicecatalog:SyncResource\",\n        \"ssm:DescribeDocument\",\n        \"ssm:GetAutomationExecution\",\n        \"ssm:ListDocuments\",\n        \"ssm:ListDocumentVersions\",\n        \"config:DescribeConfigurationRecorders\",\n        \"config:DescribeConfigurationRecorderStatus\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"servicecatalog:Accept*\",\n        \"servicecatalog:Associate*\",\n        \"servicecatalog:Batch*\",\n        \"servicecatalog:Copy*\",\n        \"servicecatalog:Create*\",\n        \"servicecatalog:Delete*\",\n        \"servicecatalog:Describe*\",\n        \"servicecatalog:Disable*\",\n        \"servicecatalog:Disassociate*\",\n        \"servicecatalog:Enable*\",\n        \"servicecatalog:Execute*\",\n        \"servicecatalog:Import*\",\n        \"servicecatalog:Provision*\",\n        \"servicecatalog:Put*\",\n        \"servicecatalog:Reject*\",\n        \"servicecatalog:Terminate*\",\n        \"servicecatalog:Update*\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"iam:PassRole\",\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"iam:PassedToService\": \"servicecatalog.amazonaws.com\"\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"iam:CreateServiceLinkedRole\",\n      \"Resource\": \"arn:aws:iam::*:role/aws-service-role/orgsdatasync.servicecatalog.amazonaws.com/AWSServiceRoleForServiceCatalogOrgsDataSync\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"iam:AWSServiceName\": \"orgsdatasync.servicecatalog.amazonaws.com\"\n        }\n      }\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"catalog:*\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n```\n\n### Explanation:\nThe above policy allows the user to perform all actions on AWS Service Catalog. This is a very broad policy and should only be used in cases where you need full access to AWS Service Catalog. In most cases, you will want to create more specific policies that allow the user to perform only the actions they need to perform.",
    "complexity": "complex"
  },
  {
    "id": "aws_managed_0681",
    "instruction": "Provide an IAM policy for Amazon S3Outposts Full Access",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"s3-outposts:*\",\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"datasync:ListTasks\",\n        \"datasync:ListLocations\",\n        \"datasync:DescribeTask\",\n        \"datasync:DescribeLocation*\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:DescribeVpcs\",\n        \"ec2:DescribeSubnets\",\n        \"ec2:DescribeSecurityGroups\",\n        \"ec2:DescribeNetworkInterfaces\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"outposts:ListOutposts\",\n        \"outposts:GetOutpost\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}",
    "generated": "```json\n{\n    \"Version\": \"2012-10-17\",\n    \"Statement\": [\n        {\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"s3outposts:*\"\n            ],\n            \"Resource\": \"*\"\n        }\n    ]\n}\n```\n\n### Explanation:\nThe above policy allows all actions on the Amazon S3Outposts service. This is a full access policy and should be used with caution. It is recommended to only allow specific actions that are necessary for your use case, rather than granting full access.\n\n### References:\n- [Amazon S3Outposts API Reference](https://docs.aws.amazon.com/AmazonS3Outposts/latest/APIReference/Welcome.html)",
    "complexity": "complex"
  },
  {
    "id": "aws_managed_0121",
    "instruction": "Provide an IAM policy for Amazon API Gateway Invoke Full Access",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"execute-api:Invoke\",\n        \"execute-api:ManageConnections\"\n      ],\n      \"Resource\": \"arn:aws:execute-api:*:*:*\"\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"apigateway:*\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n```\n\n### Explanation:\nThe above policy allows all actions on the API Gateway. This is not recommended in production environments, but it can be useful for testing and development purposes.\n\n### References:\n[Amazon API Gateway](https://docs.aws.amazon.com/apigateway/latest/developerguide/api-gateway-getting-started.html)",
    "complexity": "simple"
  },
  {
    "id": "aws_managed_1402",
    "instruction": "Provide an IAM policy for AWS Control Tower Cloud Trail Role Policy",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"logs:CreateLogStream\",\n      \"Resource\": \"arn:aws:logs:*:*:log-group:aws-controltower/CloudTrailLogs*:*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"logs:PutLogEvents\",\n      \"Resource\": \"arn:aws:logs:*:*:log-group:aws-controltower/CloudTrailLogs*:*\"\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"logs:CreateLogStream\",\n        \"logs:DescribeLogGroups\",\n        \"logs:DescribeLogStreams\",\n        \"logs:GetLogEvents\",\n        \"logs:PutLogEvents\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"cloudtrail:DeleteSelectors\",\n        \"cloudtrail:DescribeEventSelectors\",\n        \"cloudtrail:DescribeTrails\",\n        \"cloudtrail:GetEvents\",\n        \"cloudtrail:GetInsightsSelectors\",\n        \"cloudtrail:GetSelectors\",\n        \"cloudtrail:ListSelectors\",\n        \"cloudtrail:StartLogging\",\n        \"cloudtrail:StopLogging\",\n        \"cloudtrail:UpdateSelectors\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n```",
    "complexity": "medium"
  },
  {
    "id": "aws_managed_1127",
    "instruction": "Provide an IAM policy for Amazon Inspector2Agentless Service Role Policy",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"InstanceIdentification\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:DescribeInstances\",\n        \"ec2:DescribeVolumes\",\n        \"ec2:DescribeSnapshots\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"GetSnapshotData\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ebs:ListSnapshotBlocks\",\n        \"ebs:GetSnapshotBlock\"\n      ],\n      \"Resource\": \"arn:aws:ec2:*:*:snapshot/*\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"aws:ResourceTag/InspectorScan\": \"*\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"CreateSnapshotsAnyInstanceOrVolume\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"ec2:CreateSnapshots\",\n      \"Resource\": [\n        \"arn:aws:ec2:*:*:instance/*\",\n        \"arn:aws:ec2:*:*:volume/*\"\n      ]\n    },\n    {\n      \"Sid\": \"DenyCreateSnapshotsOnExcludedInstances\",\n      \"Effect\": \"Deny\",\n      \"Action\": \"ec2:CreateSnapshots\",\n      \"Resource\": \"arn:aws:ec2:*:*:instance/*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"ec2:ResourceTag/InspectorEc2Exclusion\": \"true\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"CreateSnapshotsOnAnySnapshotOnlyWithTag\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"ec2:CreateSnapshots\",\n      \"Resource\": \"arn:aws:ec2:*:*:snapshot/*\",\n      \"Condition\": {\n        \"Null\": {\n          \"aws:TagKeys\": \"false\"\n        },\n        \"ForAllValues:StringEquals\": {\n          \"aws:TagKeys\": \"InspectorScan\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"CreateOnlyInspectorScanTagOnlyUsingCreateSnapshots\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"ec2:CreateTags\",\n      \"Resource\": \"arn:aws:ec2:*:*:snapshot/*\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"ec2:CreateAction\": \"CreateSnapshots\"\n        },\n        \"Null\": {\n          \"aws:TagKeys\": \"false\"\n        },\n        \"ForAllValues:StringEquals\": {\n          \"aws:TagKeys\": \"InspectorScan\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"DeleteOnlySnapshotsTaggedForScanning\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"ec2:DeleteSnapshot\",\n      \"Resource\": \"arn:aws:ec2:*:*:snapshot/*\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"ec2:ResourceTag/InspectorScan\": \"*\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"DenyKmsDecryptForExcludedKeys\",\n      \"Effect\": \"Deny\",\n      \"Action\": \"kms:Decrypt\",\n      \"Resource\": \"arn:aws:kms:*:*:key/*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:ResourceTag/InspectorEc2Exclusion\": \"true\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"DecryptSnapshotBlocksVolContext\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"kms:Decrypt\",\n      \"Resource\": \"arn:aws:kms:*:*:key/*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:ResourceAccount\": \"${aws:PrincipalAccount}\"\n        },\n        \"StringLike\": {\n          \"kms:ViaService\": \"ec2.*.amazonaws.com\",\n          \"kms:EncryptionContext:aws:ebs:id\": \"vol-*\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"DecryptSnapshotBlocksSnapContext\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"kms:Decrypt\",\n      \"Resource\": \"arn:aws:kms:*:*:key/*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:ResourceAccount\": \"${aws:PrincipalAccount}\"\n        },\n        \"StringLike\": {\n          \"kms:ViaService\": \"ec2.*.amazonaws.com\",\n          \"kms:EncryptionContext:aws:ebs:id\": \"snap-*\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"DescribeKeysForEbsOperations\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"kms:DescribeKey\",\n      \"Resource\": \"arn:aws:kms:*:*:key/*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:ResourceAccount\": \"${aws:PrincipalAccount}\"\n        },\n        \"StringLike\": {\n          \"kms:ViaService\": \"ec2.*.amazonaws.com\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"ListKeyResourceTags\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"kms:ListResourceTags\",\n      \"Resource\": \"arn:aws:kms:*:*:key/*\"\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:Describe*\",\n        \"ec2:CreateTags\",\n        \"ec2:DeleteTags\",\n        \"ec2:AttachVolume\",\n        \"ec2:DetachVolume\",\n        \"ec2:ModifyInstanceMetadataOptions\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ssm:GetParameter\",\n        \"ssm:GetParametersByPath\",\n        \"ssm:GetParameters\",\n        \"ssm:GetAssociatedResources\",\n        \"ssm:GetAssociationStatus\",\n        \"ssm:PutAssociation\",\n        \"ssm:UpdateAssociationStatus\",\n        \"ssm:GetParametersByTag\",\n        \"ssm:GetParametersOfType\",\n        \"ssm:GetParametersOfTypeByPath\",\n        \"ssm:GetParametersOfTypeByTag\",",
    "complexity": "complex"
  },
  {
    "id": "aws_managed_0533",
    "instruction": "Provide an IAM policy for AWS Data Exchange Read Only",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"DataExchangeReadOnlyActions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"dataexchange:GetAsset\",\n        \"dataexchange:GetDataSet\",\n        \"dataexchange:GetEventAction\",\n        \"dataexchange:GetJob\",\n        \"dataexchange:GetRevision\",\n        \"dataexchange:GetDataGrant\",\n        \"dataexchange:GetReceivedDataGrant\",\n        \"dataexchange:ListDataGrants\",\n        \"dataexchange:ListReceivedDataGrants\",\n        \"dataexchange:ListDataSetRevisions\",\n        \"dataexchange:ListDataSets\",\n        \"dataexchange:ListEventActions\",\n        \"dataexchange:ListJobs\",\n        \"dataexchange:ListRevisionAssets\",\n        \"dataexchange:ListTagsForResource\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"AWSMarketplaceReadOnlyActions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"aws-marketplace:ViewSubscriptions\",\n        \"aws-marketplace:GetAgreementRequest\",\n        \"aws-marketplace:ListAgreementRequests\",\n        \"aws-marketplace:GetAgreementApprovalRequest\",\n        \"aws-marketplace:ListAgreementApprovalRequests\",\n        \"aws-marketplace:DescribeEntity\",\n        \"aws-marketplace:ListEntities\",\n        \"aws-marketplace:DescribeChangeSet\",\n        \"aws-marketplace:ListChangeSets\",\n        \"aws-marketplace:SearchAgreements\",\n        \"aws-marketplace:GetAgreementTerms\",\n        \"aws-marketplace:ListPrivateListings\",\n        \"aws-marketplace:ListTagsForResource\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"dataexchange:ListDataSets\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"dataexchange:DescribeDataSet\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n```\n\n### Explanation:\nThe above policy allows the user to list and describe data sets.\n\n### References:\n* https://docs.aws.amazon.com/dataexchange/latest/APIReference/API_ListDataSets.html\n* https://docs.aws.amazon.com/dataexchange/latest/APIReference/API_DescribeDataSet.html",
    "complexity": "medium"
  },
  {
    "id": "aws_managed_0379",
    "instruction": "Provide an IAM policy for Amazon Connect Read Only Access",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"AllowConnectReadOnly\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"connect:Get*\",\n        \"connect:Describe*\",\n        \"connect:List*\",\n        \"ds:DescribeDirectories\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"DenyConnectEmergencyAccess\",\n      \"Effect\": \"Deny\",\n      \"Action\": \"connect:AdminGetEmergencyAccessToken\",\n      \"Resource\": \"*\"\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"connect:*\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n```\n\n### Explanation:\nThis policy allows all actions on the Connect service. This is a very broad policy and should be used with caution. It is recommended to use this policy only in development environments or when testing new features. In production environments, it is recommended to create more specific policies that allow only the necessary actions.",
    "complexity": "medium"
  },
  {
    "id": "aws_managed_0200",
    "instruction": "Provide an IAM policy for AWS Lambda ENI Management Access",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:CreateNetworkInterface\",\n        \"ec2:DescribeNetworkInterfaces\",\n        \"ec2:DeleteNetworkInterface\",\n        \"ec2:AssignPrivateIpAddresses\",\n        \"ec2:UnassignPrivateIpAddresses\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}",
    "generated": "```json\n{\n    \"Version\": \"2012-10-17\",\n    \"Statement\": [\n        {\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"ec2:CreateNetworkInterface\",\n                \"ec2:DeleteNetworkInterface\",\n                \"ec2:Describe*\",\n                \"ec2:ModifyNetworkInterfaceAttribute\"\n            ],\n            \"Resource\": \"*\"\n        }\n    ]\n}\n```\n\n### Explanation:\nThe above policy allows the following actions on all resources:\n- CreateNetworkInterface\n- DeleteNetworkInterface\n- Describe*\n- ModifyNetworkInterfaceAttribute\n\nThis policy is intended to be used with AWS Lambda.",
    "complexity": "simple"
  },
  {
    "id": "aws_managed_1103",
    "instruction": "Provide an IAM policy for AWS Elastic Disaster Recovery Launch Actions Policy",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"LaunchActionsPolicy1\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ssm:DescribeInstanceInformation\",\n        \"ssm:DescribeParameters\"\n      ],\n      \"Resource\": [\n        \"*\"\n      ],\n      \"Condition\": {\n        \"ForAnyValue:StringEquals\": {\n          \"aws:CalledVia\": [\n            \"drs.amazonaws.com\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"LaunchActionsPolicy2\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ssm:SendCommand\",\n        \"ssm:StartAutomationExecution\"\n      ],\n      \"Resource\": [\n        \"arn:aws:ssm:*:*:document/*\",\n        \"arn:aws:ssm:*:*:automation-definition/*:*\",\n        \"arn:aws:ssm:*:*:automation-execution/*\"\n      ],\n      \"Condition\": {\n        \"ForAnyValue:StringEquals\": {\n          \"aws:CalledVia\": [\n            \"drs.amazonaws.com\"\n          ]\n        },\n        \"StringEquals\": {\n          \"aws:ResourceAccount\": \"${aws:PrincipalAccount}\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"LaunchActionsPolicy3\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ssm:SendCommand\",\n        \"ssm:StartAutomationExecution\"\n      ],\n      \"Resource\": [\n        \"arn:aws:ssm:*::document/AWS-*\",\n        \"arn:aws:ssm:*::document/AWSCodeDeployAgent-*\",\n        \"arn:aws:ssm:*::document/AWSConfigRemediation-*\",\n        \"arn:aws:ssm:*::document/AWSConformancePacks-*\",\n        \"arn:aws:ssm:*::document/AWSDisasterRecovery-*\",\n        \"arn:aws:ssm:*::document/AWSDistroOTel-*\",\n        \"arn:aws:ssm:*::document/AWSDocs-*\",\n        \"arn:aws:ssm:*::document/AWSEC2-*\",\n        \"arn:aws:ssm:*::document/AWSEC2Launch-*\",\n        \"arn:aws:ssm:*::document/AWSFIS-*\",\n        \"arn:aws:ssm:*::document/AWSFleetManager-*\",\n        \"arn:aws:ssm:*::document/AWSIncidents-*\",\n        \"arn:aws:ssm:*::document/AWSKinesisTap-*\",\n        \"arn:aws:ssm:*::document/AWSMigration-*\",\n        \"arn:aws:ssm:*::document/AWSNVMe-*\",\n        \"arn:aws:ssm:*::document/AWSNitroEnclavesWindows-*\",\n        \"arn:aws:ssm:*::document/AWSObservabilityExporter-*\",\n        \"arn:aws:ssm:*::document/AWSPVDriver-*\",\n        \"arn:aws:ssm:*::document/AWSQuickSetupType-*\",\n        \"arn:aws:ssm:*::document/AWSQuickStarts-*\",\n        \"arn:aws:ssm:*::document/AWSRefactorSpaces-*\",\n        \"arn:aws:ssm:*::document/AWSResilienceHub-*\",\n        \"arn:aws:ssm:*::document/AWSSAP-*\",\n        \"arn:aws:ssm:*::document/AWSSAPTools-*\",\n        \"arn:aws:ssm:*::document/AWSSQLServer-*\",\n        \"arn:aws:ssm:*::document/AWSSSO-*\",\n        \"arn:aws:ssm:*::document/AWSSupport-*\",\n        \"arn:aws:ssm:*::document/AWSSystemsManagerSAP-*\",\n        \"arn:aws:ssm:*::document/AmazonCloudWatch-*\",\n        \"arn:aws:ssm:*::document/AmazonCloudWatchAgent-*\",\n        \"arn:aws:ssm:*::document/AmazonECS-*\",\n        \"arn:aws:ssm:*::document/AmazonEFSUtils-*\",\n        \"arn:aws:ssm:*::document/AmazonEKS-*\",\n        \"arn:aws:ssm:*::document/AmazonInspector-*\",\n        \"arn:aws:ssm:*::document/AmazonInspector2-*\",\n        \"arn:aws:ssm:*::document/AmazonInternal-*\",\n        \"arn:aws:ssm:*::document/AwsEnaNetworkDriver-*\",\n        \"arn:aws:ssm:*::document/AwsVssComponents-*\",\n        \"arn:aws:ssm:*::automation-definition/AWS-*:*\",\n        \"arn:aws:ssm:*::automation-definition/AWSCodeDeployAgent-*:*\",\n        \"arn:aws:ssm:*::automation-definition/AWSConfigRemediation-*:*\",\n        \"arn:aws:ssm:*::automation-definition/AWSConformancePacks-*:*\",\n        \"arn:aws:ssm:*::automation-definition/AWSDisasterRecovery-*:*\",\n        \"arn:aws:ssm:*::automation-definition/AWSDistroOTel-*:*\",\n        \"arn:aws:ssm:*::automation-definition/AWSDocs-*:*\",\n        \"arn:aws:ssm:*::automation-definition/AWSEC2-*:*\",\n        \"arn:aws:ssm:*::automation-definition/AWSEC2Launch-*:*\",\n        \"arn:aws:ssm:*::automation-definition/AWSFIS-*:*\",\n        \"arn:aws:ssm:*::automation-definition/AWSFleetManager-*:*\",\n        \"arn:aws:ssm:*::automation-definition/AWSIncidents-*:*\",\n        \"arn:aws:ssm:*::automation-definition/AWSKinesisTap-*:*\",\n        \"arn:aws:ssm:*::automation-definition/AWSMigration-*:*\",\n        \"arn:aws:ssm:*::automation-definition/AWSNVMe-*:*\",\n        \"arn:aws:ssm:*::automation-definition/AWSNitroEnclavesWindows-*:*\",\n        \"arn:aws:ssm:*::automation-definition/AWSObservabilityExporter-*:*\",\n        \"arn:aws:ssm:*::automation-definition/AWSPVDriver-*:*\",\n        \"arn:aws:ssm:*::automation-definition/AWSQuickSetupType-*:*\",\n        \"arn:aws:ssm:*::automation-definition/AWSQuickStarts-*:*\",\n        \"arn:aws:ssm:*::automation-definition/AWSRefactorSpaces-*:*\",\n        \"arn:aws:ssm:*::automation-definition/AWSResilienceHub-*:*\",\n        \"arn:aws:ssm:*::automation-definition/AWSSAP-*:*\",\n        \"arn:aws:ssm:*::automation-definition/AWSSAPTools-*:*\",\n        \"arn:aws:ssm:*::automation-definition/AWSSQLServer-*:*\",\n        \"arn:aws:ssm:*::automation-definition/AWSSSO-*:*\",\n        \"arn:aws:ssm:*::automation-definition/AWSSupport-*:*\",\n        \"arn:aws:ssm:*::automation-definition/AWSSystemsManagerSAP-*:*\",\n        \"arn:aws:ssm:*::automation-definition/AmazonCloudWatch-*:*\",\n        \"arn:aws:ssm:*::automation-definition/AmazonCloudWatchAgent-*:*\",\n        \"arn:aws:ssm:*::automation-definition/AmazonECS-*:*\",\n        \"arn:aws:ssm:*::automation-definition/AmazonEFSUtils-*:*\",\n        \"arn:aws:ssm:*::automation-definition/AmazonEKS-*:*\",\n        \"arn:aws:ssm:*::automation-definition/AmazonInspector-*:*\",\n        \"arn:aws:ssm:*::automation-definition/AmazonInspector2-*:*\",\n        \"arn:aws:ssm:*::automation-definition/AmazonInternal-*:*\",\n        \"arn:aws:ssm:*::automation-definition/AwsEnaNetworkDriver-*:*\",\n        \"arn:aws:ssm:*::automation-definition/AwsVssComponents-*:*\",\n        \"arn:aws:ssm:*:*:automation-execution/*\"\n      ],\n      \"Condition\": {\n        \"ForAnyValue:StringEquals\": {\n          \"aws:CalledVia\": [\n            \"drs.amazonaws.com\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"LaunchActionsPolicy4\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ssm:SendCommand\"\n      ],\n      \"Resource\": [\n        \"arn:aws:ec2:*:*:instance/*\"\n      ],\n      \"Condition\": {\n        \"ForAnyValue:StringEquals\": {\n          \"aws:CalledVia\": [\n            \"drs.amazonaws.com\"\n          ]\n        },\n        \"Null\": {\n          \"aws:ResourceTag/AWSElasticDisasterRecoveryManaged\": \"false\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"LaunchActionsPolicy5\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ssm:SendCommand\"\n      ],\n      \"Resource\": [\n        \"arn:aws:ec2:*:*:instance/*\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:ResourceTag/AWSDRS\": \"AllowLaunchingIntoThisInstance\"\n        },\n        \"ForAnyValue:StringEquals\": {\n          \"aws:CalledVia\": [\n            \"drs.amazonaws.com\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"LaunchActionsPolicy6\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ssm:ListDocuments\",\n        \"ssm:ListCommandInvocations\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"LaunchActionsPolicy7\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ssm:ListDocumentVersions\",\n        \"ssm:GetDocument\",\n        \"ssm:DescribeDocument\"\n      ],\n      \"Resource\": \"arn:aws:ssm:*:*:document/*\"\n    },\n    {\n      \"Sid\": \"LaunchActionsPolicy8\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ssm:GetAutomationExecution\"\n      ],\n      \"Resource\": \"arn:aws:ssm:*:*:automation-execution/*\",\n      \"Condition\": {\n        \"Null\": {\n          \"aws:ResourceTag/AWSElasticDisasterRecoveryManaged\": \"false\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"LaunchActionsPolicy9\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ssm:GetParameters\"\n      ],\n      \"Resource\": \"arn:aws:ssm:*:*:parameter/ManagedByAWSElasticDisasterRecoveryService-*\",\n      \"Condition\": {\n        \"ForAnyValue:StringEquals\": {\n          \"aws:CalledVia\": \"ssm.amazonaws.com\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"LaunchActionsPolicy10\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ssm:GetParameter\",\n        \"ssm:PutParameter\"\n      ],\n      \"Resource\": \"arn:aws:ssm:*:*:parameter/ManagedByAWSElasticDisasterRecoveryService-*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:ResourceAccount\": \"${aws:PrincipalAccount}\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"LaunchActionsPolicy11\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"iam:PassRole\",\n      \"Resource\": [\n        \"arn:aws:iam::*:role/service-role/AWSElasticDisasterRecoveryRecoveryInstanceWithLaunchActionsRole\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"iam:PassedToService\": \"ec2.amazonaws.com\"\n        },\n        \"ForAnyValue:StringEquals\": {\n          \"aws:CalledVia\": \"drs.amazonaws.com\"\n        }\n      }\n    }\n  ]\n}",
    "generated": "```json\n{\n    \"Version\": \"2012-10-17\",\n    \"Statement\": [\n        {\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"ec2:CreateLaunchTemplate\",\n                \"ec2:CreateTags\",\n                \"ec2:DeleteTags\",\n                \"ec2:DescribeInstances\",\n                \"ec2:DescribeLaunchTemplates\",\n                \"ec2:ModifyInstanceMetadataOptions\",\n                \"ec2:RunInstances\"\n            ],\n            \"Resource\": \"*\"\n        },\n        {\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"ec2:CreateTags\",\n                \"ec2:DeleteTags\",\n                \"ec2:DescribeInstances\",\n                \"ec2:DescribeLaunchTemplates\",\n                \"ec2:ModifyInstanceMetadataOptions\",\n                \"ec2:RunInstances\"\n            ],\n            \"Resource\": \"*\"\n        }\n    ]\n}\n```",
    "complexity": "complex"
  },
  {
    "id": "aws_managed_0035",
    "instruction": "Provide an IAM policy for Amazon Mobile Analytics Full Access",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"mobileanalytics:*\",\n      \"Resource\": \"*\"\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"mobileanalytics:*\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n```\n\n### Explanation:\nThis policy allows the user to perform all actions on the Mobile Analytics service.\n\n### References:\n* https://docs.aws.amazon.com/IAM/latest/UserGuide/id_policies_use_policyexpressions.html#PolicyExpressions_AWSManagedPolicies",
    "complexity": "simple"
  },
  {
    "id": "aws_managed_0858",
    "instruction": "Provide an IAM policy for AWS Elastic Disaster Recovery Recovery Instance Policy",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"DRSRecoveryInstancePolicy1\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"drs:SendAgentMetricsForDrs\",\n        \"drs:SendAgentLogsForDrs\",\n        \"drs:UpdateAgentSourcePropertiesForDrs\",\n        \"drs:UpdateAgentReplicationInfoForDrs\",\n        \"drs:UpdateAgentConversionInfoForDrs\",\n        \"drs:GetAgentCommandForDrs\",\n        \"drs:GetAgentConfirmedResumeInfoForDrs\",\n        \"drs:GetAgentRuntimeConfigurationForDrs\",\n        \"drs:UpdateAgentBacklogForDrs\",\n        \"drs:GetAgentReplicationInfoForDrs\",\n        \"drs:UpdateReplicationCertificateForDrs\",\n        \"drs:NotifyReplicationServerAuthenticationForDrs\"\n      ],\n      \"Resource\": \"arn:aws:drs:*:*:recovery-instance/*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"drs:EC2InstanceARN\": \"${ec2:SourceInstanceARN}\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"DRSRecoveryInstancePolicy2\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"drs:DescribeRecoveryInstances\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"DRSRecoveryInstancePolicy3\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:DescribeInstanceTypes\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"DRSRecoveryInstancePolicy4\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"drs:GetAgentInstallationAssetsForDrs\",\n        \"drs:SendClientLogsForDrs\",\n        \"drs:CreateSourceServerForDrs\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"DRSRecoveryInstancePolicy5\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"drs:TagResource\"\n      ],\n      \"Resource\": \"arn:aws:drs:*:*:source-server/*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"drs:CreateAction\": \"CreateSourceServerForDrs\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"DRSRecoveryInstancePolicy6\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"drs:SendAgentMetricsForDrs\",\n        \"drs:SendAgentLogsForDrs\",\n        \"drs:UpdateAgentSourcePropertiesForDrs\",\n        \"drs:UpdateAgentReplicationInfoForDrs\",\n        \"drs:UpdateAgentConversionInfoForDrs\",\n        \"drs:GetAgentCommandForDrs\",\n        \"drs:GetAgentConfirmedResumeInfoForDrs\",\n        \"drs:GetAgentRuntimeConfigurationForDrs\",\n        \"drs:UpdateAgentBacklogForDrs\",\n        \"drs:GetAgentReplicationInfoForDrs\"\n      ],\n      \"Resource\": \"arn:aws:drs:*:*:source-server/*\"\n    },\n    {\n      \"Sid\": \"DRSRecoveryInstancePolicy7\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"sts:AssumeRole\",\n        \"sts:TagSession\"\n      ],\n      \"Resource\": [\n        \"arn:aws:iam::*:role/service-role/DRSCrossAccountAgentAuthorizedRole_*\"\n      ],\n      \"Condition\": {\n        \"StringLike\": {\n          \"aws:RequestTag/SourceInstanceARN\": \"${ec2:SourceInstanceARN}\"\n        },\n        \"ForAnyValue:StringEquals\": {\n          \"sts:TransitiveTagKeys\": \"SourceInstanceARN\"\n        }\n      }\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:CreateTags\",\n        \"ec2:DeleteTags\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:Describe*\",\n        \"ec2:AttachVolume\",\n        \"ec2:DetachVolume\",\n        \"ec2:ModifyInstanceMetadataOptions\",\n        \"ec2:CreateSecurityGroup\",\n        \"ec2:AuthorizeSecurityGroupIngress\",\n        \"ec2:RevokeSecurityGroupIngress\",\n        \"ec2:DeleteSecurityGroup\",\n        \"ec2:CreateTags\",\n        \"ec2:DeleteTags\",\n        \"ec2:CreateVolume\",\n        \"ec2:DeleteVolume\",\n        \"ec2:DescribeVolumes\",\n        \"ec2:AttachVolume\",\n        \"ec2:DetachVolume\",\n        \"ec2:ModifyVolume\",",
    "complexity": "complex"
  },
  {
    "id": "aws_managed_0422",
    "instruction": "Provide an IAM policy for AWS Cloud Map Read Only Access",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"servicediscovery:Get*\",\n        \"servicediscovery:List*\",\n        \"servicediscovery:DiscoverInstances\",\n        \"servicediscovery:DiscoverInstancesRevision\"\n      ],\n      \"Resource\": [\n        \"*\"\n      ]\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"cloudmap:DescribeResourceRecords\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n```\n\n### Explanation:\nThe above policy allows the user to read resource records from AWS Cloud Map. This is a common use case when you want to retrieve information about your DNS records without modifying them.\n\n### References:\n[AWS Cloud Map](https://docs.aws.amazon.com/AmazonCloudMap/latest/APIReference/Welcome.html)\n\n### Tags:\n#AWS #IAM #Policy",
    "complexity": "simple"
  },
  {
    "id": "syn_ec2_008",
    "instruction": "Read-only access to EC2 - can describe instances, images, volumes, snapshots, and key pairs but cannot modify anything",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:DescribeInstances\",\n        \"ec2:DescribeImages\",\n        \"ec2:DescribeVolumes\",\n        \"ec2:DescribeSnapshots\",\n        \"ec2:DescribeKeyPairs\",\n        \"ec2:DescribeRegions\",\n        \"ec2:DescribeAvailabilityZones\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}",
    "generated": "```json\n{\n    \"Version\": \"2012-10-17\",\n    \"Statement\": [\n        {\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"ec2:Describe*\",\n                \"ec2:Get*\"\n            ],\n            \"Resource\": \"*\"\n        }\n    ]\n}\n```\n\n### Explanation:\nThe policy allows the user to perform read-only actions on all resources in the AWS account. The `ec2:Describe*` action allows the user to retrieve information about EC2 resources such as instances, images, volumes, snapshots, and key pairs. The `ec2:Get*` action allows the user to retrieve specific information about EC2 resources such as instance metadata, security groups, and VPCs.",
    "complexity": "simple"
  },
  {
    "id": "aws_managed_0015",
    "instruction": "Provide an IAM policy for Cloud Watch Logs Read Only Access",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"CloudWatchLogsReadOnlyAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"logs:Describe*\",\n        \"logs:Get*\",\n        \"logs:List*\",\n        \"logs:StartQuery\",\n        \"logs:StopQuery\",\n        \"logs:TestMetricFilter\",\n        \"logs:FilterLogEvents\",\n        \"logs:StartLiveTail\",\n        \"logs:StopLiveTail\",\n        \"cloudwatch:GenerateQuery\",\n        \"cloudwatch:GenerateQueryResultsSummary\",\n        \"observabilityadmin:ListS3TableIntegrations\",\n        \"observabilityadmin:GetS3TableIntegration\",\n        \"observabilityadmin:ListTelemetryPipelines\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"logs:CreateLogStream\",\n        \"logs:DescribeLogGroups\",\n        \"logs:DescribeLogStreams\",\n        \"logs:GetLogEvents\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n```\n\n### Explanation:\nThe above policy allows the user to create log streams, describe log groups and streams, and get log events. This is a read-only access to CloudWatch logs.\n\n### References:\n* [AWS Documentation](https://docs.aws.amazon.com/AmazonCloudWatch/latest/APIReference/API_DescribeLogStreams.html)",
    "complexity": "medium"
  },
  {
    "id": "aws_managed_0139",
    "instruction": "Provide an IAM policy for AWS Io T Config Read Only Access",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iot:DescribeAuthorizer\",\n        \"iot:DescribeCACertificate\",\n        \"iot:DescribeCertificate\",\n        \"iot:DescribeDefaultAuthorizer\",\n        \"iot:DescribeEndpoint\",\n        \"iot:DescribeEventConfigurations\",\n        \"iot:DescribeIndex\",\n        \"iot:DescribeJob\",\n        \"iot:DescribeJobExecution\",\n        \"iot:DescribeRoleAlias\",\n        \"iot:DescribeStream\",\n        \"iot:DescribeThing\",\n        \"iot:DescribeThingGroup\",\n        \"iot:DescribeThingRegistrationTask\",\n        \"iot:DescribeThingType\",\n        \"iot:GetEffectivePolicies\",\n        \"iot:GetIndexingConfiguration\",\n        \"iot:GetJobDocument\",\n        \"iot:GetLoggingOptions\",\n        \"iot:GetOTAUpdate\",\n        \"iot:GetPolicy\",\n        \"iot:GetPolicyVersion\",\n        \"iot:GetRegistrationCode\",\n        \"iot:GetTopicRule\",\n        \"iot:GetV2LoggingOptions\",\n        \"iot:ListAttachedPolicies\",\n        \"iot:ListAuthorizers\",\n        \"iot:ListCACertificates\",\n        \"iot:ListCertificates\",\n        \"iot:ListCertificatesByCA\",\n        \"iot:ListIndices\",\n        \"iot:ListJobExecutionsForJob\",\n        \"iot:ListJobExecutionsForThing\",\n        \"iot:ListJobs\",\n        \"iot:ListOTAUpdates\",\n        \"iot:ListOutgoingCertificates\",\n        \"iot:ListPolicies\",\n        \"iot:ListPolicyPrincipals\",\n        \"iot:ListPolicyVersions\",\n        \"iot:ListPrincipalPolicies\",\n        \"iot:ListPrincipalThings\",\n        \"iot:ListRoleAliases\",\n        \"iot:ListStreams\",\n        \"iot:ListTargetsForPolicy\",\n        \"iot:ListThingGroups\",\n        \"iot:ListThingGroupsForThing\",\n        \"iot:ListThingPrincipals\",\n        \"iot:ListThingRegistrationTaskReports\",\n        \"iot:ListThingRegistrationTasks\",\n        \"iot:ListThings\",\n        \"iot:ListThingsInThingGroup\",\n        \"iot:ListThingTypes\",\n        \"iot:ListTopicRules\",\n        \"iot:ListV2LoggingLevels\",\n        \"iot:SearchIndex\",\n        \"iot:TestAuthorization\",\n        \"iot:TestInvokeAuthorizer\",\n        \"iot:DescribeAccountAuditConfiguration\",\n        \"iot:DescribeAuditTask\",\n        \"iot:ListAuditTasks\",\n        \"iot:DescribeScheduledAudit\",\n        \"iot:ListScheduledAudits\",\n        \"iot:ListAuditFindings\",\n        \"iot:DescribeSecurityProfile\",\n        \"iot:ListSecurityProfiles\",\n        \"iot:ListSecurityProfilesForTarget\",\n        \"iot:ListTargetsForSecurityProfile\",\n        \"iot:ListActiveViolations\",\n        \"iot:ListViolationEvents\",\n        \"iot:ValidateSecurityProfileBehaviors\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iotconfig:DescribeConfigurationRecorder\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iotconfig:ListConfigurationRecorders\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iotconfig:GetConfigurationRecorder\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n```",
    "complexity": "simple"
  },
  {
    "id": "aws_managed_0273",
    "instruction": "Provide an IAM policy for AWS Price List Service Full Access",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"AWSPriceListServiceFullAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"pricing:*\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"pricing:*\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n```\n\n### Explanation:\nThe `pricing:*` action allows full access to the AWS Price List Service. This includes the ability to retrieve pricing information, create and manage price lists, and perform other operations related to pricing. The `*` wildcard in the `Resource` field indicates that this policy applies to all resources within the AWS Price List Service.",
    "complexity": "simple"
  },
  {
    "id": "aws_managed_0531",
    "instruction": "Provide an IAM policy for AWS Service Role For Amazon EKS Nodegroup",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"SharedSecurityGroupRelatedPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:RevokeSecurityGroupIngress\",\n        \"ec2:AuthorizeSecurityGroupEgress\",\n        \"ec2:AuthorizeSecurityGroupIngress\",\n        \"ec2:DescribeInstances\",\n        \"ec2:RevokeSecurityGroupEgress\",\n        \"ec2:DeleteSecurityGroup\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"ec2:ResourceTag/eks\": \"*\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"EKSCreatedSecurityGroupRelatedPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:RevokeSecurityGroupIngress\",\n        \"ec2:AuthorizeSecurityGroupEgress\",\n        \"ec2:AuthorizeSecurityGroupIngress\",\n        \"ec2:DescribeInstances\",\n        \"ec2:RevokeSecurityGroupEgress\",\n        \"ec2:DeleteSecurityGroup\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"ec2:ResourceTag/eks:nodegroup-name\": \"*\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"LaunchTemplateRelatedPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:DeleteLaunchTemplate\",\n        \"ec2:CreateLaunchTemplateVersion\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"ec2:ResourceTag/eks:nodegroup-name\": \"*\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"AutoscalingRelatedPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"autoscaling:UpdateAutoScalingGroup\",\n        \"autoscaling:DeleteAutoScalingGroup\",\n        \"autoscaling:TerminateInstanceInAutoScalingGroup\",\n        \"autoscaling:CompleteLifecycleAction\",\n        \"autoscaling:PutLifecycleHook\",\n        \"autoscaling:PutNotificationConfiguration\",\n        \"autoscaling:EnableMetricsCollection\",\n        \"autoscaling:PutScheduledUpdateGroupAction\",\n        \"autoscaling:ResumeProcesses\",\n        \"autoscaling:SuspendProcesses\"\n      ],\n      \"Resource\": \"arn:aws:autoscaling:*:*:*:autoScalingGroupName/eks-*\"\n    },\n    {\n      \"Sid\": \"AllowAutoscalingToCreateSLR\",\n      \"Effect\": \"Allow\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"iam:AWSServiceName\": \"autoscaling.amazonaws.com\"\n        }\n      },\n      \"Action\": \"iam:CreateServiceLinkedRole\",\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"AllowASGCreationByEKS\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"autoscaling:CreateOrUpdateTags\",\n        \"autoscaling:CreateAutoScalingGroup\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"ForAnyValue:StringEquals\": {\n          \"aws:TagKeys\": [\n            \"eks\",\n            \"eks:cluster-name\",\n            \"eks:nodegroup-name\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"AllowPassRoleToAutoscaling\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"iam:PassRole\",\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"iam:PassedToService\": \"autoscaling.amazonaws.com\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"AllowPassRoleToEC2\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"iam:PassRole\",\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringEqualsIfExists\": {\n          \"iam:PassedToService\": [\n            \"ec2.amazonaws.com\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"PermissionsToManageResourcesForNodegroups\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:GetRole\",\n        \"ec2:CreateLaunchTemplate\",\n        \"ec2:DescribeInstances\",\n        \"iam:GetInstanceProfile\",\n        \"ec2:DescribeLaunchTemplates\",\n        \"autoscaling:DescribeAutoScalingGroups\",\n        \"ec2:CreateSecurityGroup\",\n        \"ec2:DescribeLaunchTemplateVersions\",\n        \"ec2:RunInstances\",\n        \"ec2:DescribeSecurityGroups\",\n        \"ec2:GetConsoleOutput\",\n        \"ec2:DescribeRouteTables\",\n        \"ec2:DescribeSubnets\",\n        \"ec2:DescribeCapacityReservations\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"PermissionsToCreateAndManageInstanceProfiles\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:CreateInstanceProfile\",\n        \"iam:DeleteInstanceProfile\",\n        \"iam:RemoveRoleFromInstanceProfile\",\n        \"iam:AddRoleToInstanceProfile\"\n      ],\n      \"Resource\": \"arn:aws:iam::*:instance-profile/eks-*\"\n    },\n    {\n      \"Sid\": \"PermissionsToDeleteEKSAndKubernetesTags\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:DeleteTags\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"ForAnyValue:StringLike\": {\n          \"aws:TagKeys\": [\n            \"eks\",\n            \"eks:cluster-name\",\n            \"eks:nodegroup-name\",\n            \"kubernetes.io/cluster/*\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"PermissionsForManagedNodegroupsAutoRepair\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:RebootInstances\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"ec2:ResourceTag/eks:nodegroup-name\": \"*\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"PermissionsToCreateEKSAndKubernetesTags\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:CreateTags\"\n      ],\n      \"Resource\": [\n        \"arn:*:ec2:*:*:security-group/*\",\n        \"arn:*:ec2:*:*:launch-template/*\"\n      ],\n      \"Condition\": {\n        \"ForAnyValue:StringLike\": {\n          \"aws:TagKeys\": [\n            \"eks\",\n            \"eks:cluster-name\",\n            \"eks:nodegroup-name\",\n            \"kubernetes.io/cluster/*\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"AllowTaggingEC2ResourcesOnlyDuringInstanceCreation\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:CreateTags\"\n      ],\n      \"Resource\": [\n        \"arn:*:ec2:*:*:instance/*\",\n        \"arn:*:ec2:*:*:volume/*\",\n        \"arn:*:ec2:*:*:network-interface/*\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"ec2:CreateAction\": [\n            \"RunInstances\"\n          ]\n        },\n        \"ForAnyValue:StringLike\": {\n          \"aws:TagKeys\": [\n            \"eks\",\n            \"eks:cluster-name\",\n            \"eks:nodegroup-name\",\n            \"kubernetes.io/cluster/*\"\n          ]\n        }\n      }\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ecr:GetAuthorizationToken\",\n        \"ecr:BatchCheckLayerAvailability\",\n        \"ecr:GetDownloadUrlForLayer\",\n        \"ecr:BatchGetImage\",\n        \"logs:CreateLogStream\",\n        \"logs:PutLogEvents\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"autoscaling:DescribeAutoScalingGroups\",\n        \"autoscaling:DescribeLaunchConfigurationHealth\",\n        \"autoscaling:DescribeTags\",\n        \"autoscaling:SetDesiredCapacity\",\n        \"autoscaling:TerminateInstanceInAutoScalingGroup\",\n        \"autoscaling:UpdateAutoScalingGroup\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"cloudwatch:Describe",
    "complexity": "complex"
  },
  {
    "id": "aws_managed_1327",
    "instruction": "Provide an IAM policy for Amazon Timestream Influx DB Full Access Without Marketplace Access",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"TimestreamInfluxDBStatement\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"timestream-influxdb:CreateDbParameterGroup\",\n        \"timestream-influxdb:GetDbParameterGroup\",\n        \"timestream-influxdb:ListDbParameterGroups\",\n        \"timestream-influxdb:CreateDbInstance\",\n        \"timestream-influxdb:DeleteDbInstance\",\n        \"timestream-influxdb:GetDbInstance\",\n        \"timestream-influxdb:ListDbInstances\",\n        \"timestream-influxdb:TagResource\",\n        \"timestream-influxdb:UntagResource\",\n        \"timestream-influxdb:ListTagsForResource\",\n        \"timestream-influxdb:UpdateDbInstance\",\n        \"timestream-influxdb:CreateDbCluster\",\n        \"timestream-influxdb:GetDbCluster\",\n        \"timestream-influxdb:UpdateDbCluster\",\n        \"timestream-influxdb:DeleteDbCluster\",\n        \"timestream-influxdb:ListDbClusters\",\n        \"timestream-influxdb:ListDbInstancesForCluster\",\n        \"timestream-influxdb:RebootDbInstance\",\n        \"timestream-influxdb:RebootDbCluster\"\n      ],\n      \"Resource\": [\n        \"arn:aws:timestream-influxdb:*:*:*\"\n      ]\n    },\n    {\n      \"Sid\": \"ServiceLinkedRoleStatement\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"iam:CreateServiceLinkedRole\",\n      \"Resource\": \"arn:aws:iam::*:role/aws-service-role/timestream-influxdb.amazonaws.com/AWSServiceRoleForTimestreamInfluxDB\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"iam:AWSServiceName\": \"timestream-influxdb.amazonaws.com\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"NetworkValidationStatement\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:DescribeSubnets\",\n        \"ec2:DescribeVpcs\",\n        \"ec2:DescribeSecurityGroups\",\n        \"ec2:DescribeRouteTables\",\n        \"ec2:DescribeVpcEndpoints\"\n      ],\n      \"Resource\": [\n        \"*\"\n      ]\n    },\n    {\n      \"Sid\": \"CreateEniInSubnetStatement\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:CreateNetworkInterface\"\n      ],\n      \"Resource\": [\n        \"arn:aws:ec2:*:*:network-interface/*\",\n        \"arn:aws:ec2:*:*:subnet/*\",\n        \"arn:aws:ec2:*:*:security-group/*\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:ResourceAccount\": \"${aws:PrincipalAccount}\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"BucketValidationStatement\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:ListBucket\",\n        \"s3:GetBucketPolicy\"\n      ],\n      \"Resource\": [\n        \"arn:aws:s3:::*\"\n      ]\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"timestream:*\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n```\n\n### Explanation:\nThe above policy allows the user to perform all actions on the Timestream service. This includes creating, updating, and deleting databases, tables, and streams. It also allows the user to create and manage users and roles within the Timestream service. However, it does not grant access to any other AWS services or resources outside of Timestream.\n\n### References:\n[Timestream Documentation](https://docs.aws.amazon.com/timestream/latest/developerguide/what-is-timestream.html)",
    "complexity": "complex"
  },
  {
    "id": "aws_managed_1158",
    "instruction": "Provide an IAM policy for Amazon Sage Maker Canvas Bedrock Access",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"S3CanvasAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:GetObject\",\n        \"s3:PutObject\"\n      ],\n      \"Resource\": [\n        \"arn:aws:s3:::sagemaker-*/Canvas\",\n        \"arn:aws:s3:::sagemaker-*/Canvas/*\"\n      ]\n    },\n    {\n      \"Sid\": \"S3BucketAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:ListBucket\"\n      ],\n      \"Resource\": [\n        \"arn:aws:s3:::sagemaker-*\"\n      ]\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"sagemaker:*\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n```\n\n### Explanation:\nThis policy allows all actions on the SageMaker service. This is required to allow the Canvas to create and manage resources in the SageMaker service.\n\n### References:\n* https://docs.aws.amazon.com/sagemaker/latest/dg/sagemaker-api.html\n* https://docs.aws.amazon.com/IAM/latest/UserGuide/list_amazonsagemaker.html",
    "complexity": "medium"
  },
  {
    "id": "aws_managed_0692",
    "instruction": "Provide an IAM policy for Aws Glue Data Brew Full Access Policy",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"databrew:CreateDataset\",\n        \"databrew:DescribeDataset\",\n        \"databrew:ListDatasets\",\n        \"databrew:UpdateDataset\",\n        \"databrew:DeleteDataset\",\n        \"databrew:CreateProject\",\n        \"databrew:DescribeProject\",\n        \"databrew:ListProjects\",\n        \"databrew:StartProjectSession\",\n        \"databrew:SendProjectSessionAction\",\n        \"databrew:UpdateProject\",\n        \"databrew:DeleteProject\",\n        \"databrew:CreateRecipe\",\n        \"databrew:DescribeRecipe\",\n        \"databrew:ListRecipes\",\n        \"databrew:ListRecipeVersions\",\n        \"databrew:PublishRecipe\",\n        \"databrew:UpdateRecipe\",\n        \"databrew:BatchDeleteRecipeVersion\",\n        \"databrew:DeleteRecipeVersion\",\n        \"databrew:CreateRecipeJob\",\n        \"databrew:CreateProfileJob\",\n        \"databrew:DescribeJob\",\n        \"databrew:DescribeJobRun\",\n        \"databrew:ListJobRuns\",\n        \"databrew:ListJobs\",\n        \"databrew:StartJobRun\",\n        \"databrew:StopJobRun\",\n        \"databrew:UpdateProfileJob\",\n        \"databrew:UpdateRecipeJob\",\n        \"databrew:DeleteJob\",\n        \"databrew:CreateSchedule\",\n        \"databrew:DescribeSchedule\",\n        \"databrew:ListSchedules\",\n        \"databrew:UpdateSchedule\",\n        \"databrew:DeleteSchedule\",\n        \"databrew:CreateRuleset\",\n        \"databrew:DeleteRuleset\",\n        \"databrew:DescribeRuleset\",\n        \"databrew:ListRulesets\",\n        \"databrew:UpdateRuleset\",\n        \"databrew:ListTagsForResource\",\n        \"databrew:TagResource\",\n        \"databrew:UntagResource\"\n      ],\n      \"Resource\": [\n        \"*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"appflow:DescribeFlow\",\n        \"appflow:DescribeFlowExecutionRecords\",\n        \"appflow:ListFlows\",\n        \"glue:GetConnection\",\n        \"glue:GetConnections\",\n        \"glue:GetDatabases\",\n        \"glue:GetPartitions\",\n        \"glue:GetTable\",\n        \"glue:GetTables\",\n        \"glue:GetDataCatalogEncryptionSettings\",\n        \"dataexchange:ListDataSets\",\n        \"dataexchange:ListDataSetRevisions\",\n        \"dataexchange:ListRevisionAssets\",\n        \"dataexchange:CreateJob\",\n        \"dataexchange:StartJob\",\n        \"dataexchange:GetJob\",\n        \"ec2:DescribeSecurityGroups\",\n        \"ec2:DescribeVpcs\",\n        \"ec2:DescribeSubnets\",\n        \"kms:DescribeKey\",\n        \"kms:ListKeys\",\n        \"kms:ListAliases\",\n        \"redshift:DescribeClusters\",\n        \"redshift:DescribeClusterSubnetGroups\",\n        \"redshift-data:DescribeStatement\",\n        \"redshift-data:ListDatabases\",\n        \"redshift-data:ListSchemas\",\n        \"redshift-data:ListTables\",\n        \"s3:ListAllMyBuckets\",\n        \"s3:GetBucketCORS\",\n        \"s3:GetBucketLocation\",\n        \"s3:GetEncryptionConfiguration\",\n        \"s3:GetLifecycleConfiguration\",\n        \"secretsmanager:ListSecrets\",\n        \"secretsmanager:DescribeSecret\",\n        \"sts:GetCallerIdentity\",\n        \"cloudtrail:LookupEvents\",\n        \"iam:ListRoles\",\n        \"iam:GetRole\"\n      ],\n      \"Resource\": [\n        \"*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"glue:CreateConnection\"\n      ],\n      \"Resource\": [\n        \"arn:aws:glue:*:*:catalog\",\n        \"arn:aws:glue:*:*:connection/AwsGlueDataBrew-*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"glue:GetDatabases\"\n      ],\n      \"Resource\": [\n        \"arn:aws:glue:*:*:catalog\",\n        \"arn:aws:glue:*:*:database/*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"glue:CreateTable\"\n      ],\n      \"Resource\": [\n        \"arn:aws:glue:*:*:catalog\",\n        \"arn:aws:glue:*:*:database/*\",\n        \"arn:aws:glue:*:*:table/*/awsgluedatabrew*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:ListBucket\",\n        \"s3:GetObject\"\n      ],\n      \"Resource\": [\n        \"arn:aws:s3:::databrew-public-datasets-*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"kms:GenerateDataKey\"\n      ],\n      \"Resource\": [\n        \"*\"\n      ],\n      \"Condition\": {\n        \"StringLike\": {\n          \"kms:ViaService\": \"s3.*.amazonaws.com\"\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"secretsmanager:CreateSecret\"\n      ],\n      \"Resource\": \"arn:aws:secretsmanager:*:*:secret:AwsGlueDataBrew-*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"kms:GenerateRandom\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"secretsmanager:GetSecretValue\"\n      ],\n      \"Resource\": \"arn:aws:secretsmanager:*:*:secret:databrew!default-*\",\n      \"Condition\": {\n        \"ForAnyValue:StringEquals\": {\n          \"aws:CalledVia\": [\n            \"databrew.amazonaws.com\"\n          ]\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"secretsmanager:CreateSecret\"\n      ],\n      \"Resource\": \"arn:aws:secretsmanager:*:*:secret:databrew!default-*\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"secretsmanager:Name\": \"databrew!default\"\n        },\n        \"ForAnyValue:StringEquals\": {\n          \"aws:CalledVia\": [\n            \"databrew.amazonaws.com\"\n          ]\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:PassRole\"\n      ],\n      \"Resource\": \"arn:aws:iam::*:role/*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"iam:PassedToService\": [\n            \"databrew.amazonaws.com\"\n          ]\n        }\n      }\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"glue:*\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n```\n\n### Explanation:\nThe above policy allows the user to perform all actions on AWS Glue. This includes creating, updating, and deleting data catalogs, tables, and jobs. It also allows the user to manage AWS Glue resources such as crawlers, triggers, and connections. Additionally, the policy allows the user to create and manage AWS Glue workflows and triggers.",
    "complexity": "complex"
  },
  {
    "id": "aws_managed_0328",
    "instruction": "Provide an IAM policy for AWSEC2Fleet Service Role Policy",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:DescribeImages\",\n        \"ec2:DescribeSubnets\",\n        \"ec2:RequestSpotInstances\",\n        \"ec2:DescribeInstanceStatus\",\n        \"ec2:RunInstances\"\n      ],\n      \"Resource\": [\n        \"*\"\n      ]\n    },\n    {\n      \"Sid\": \"EC2SpotManagement\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:CreateServiceLinkedRole\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"iam:AWSServiceName\": \"spot.amazonaws.com\"\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:PassRole\"\n      ],\n      \"Resource\": [\n        \"*\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"iam:PassedToService\": [\n            \"ec2.amazonaws.com\",\n            \"ec2.amazonaws.com.cn\"\n          ]\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:CreateTags\"\n      ],\n      \"Resource\": [\n        \"arn:aws:ec2:*:*:instance/*\",\n        \"arn:aws:ec2:*:*:spot-instances-request/*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:CreateTags\"\n      ],\n      \"Resource\": [\n        \"arn:aws:ec2:*:*:volume/*\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"ec2:CreateAction\": \"RunInstances\"\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:TerminateInstances\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"ec2:ResourceTag/aws:ec2:fleet-id\": \"*\"\n        }\n      }\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:CreateTags\",\n        \"ec2:DeleteTags\",\n        \"ec2:Describe*\",\n        \"ec2:RunInstances\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"autoscaling:DescribeAutoScalingGroups\",\n        \"autoscaling:DescribeLaunchConfigurations\",\n        \"autoscaling:DescribeTags\",\n        \"autoscaling:SetDesiredCapacity\",\n        \"autoscaling:TerminateInstanceInAutoScalingGroup\",\n        \"autoscaling:UpdateAutoScalingGroup\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n```",
    "complexity": "complex"
  },
  {
    "id": "aws_managed_0771",
    "instruction": "Provide an IAM policy for Amazon EMR Read Only Access Policy v2",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"ElasticMapReduceActions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"elasticmapreduce:DescribeCluster\",\n        \"elasticmapreduce:DescribeEditor\",\n        \"elasticmapreduce:DescribeJobFlows\",\n        \"elasticmapreduce:DescribeSecurityConfiguration\",\n        \"elasticmapreduce:DescribeStep\",\n        \"elasticmapreduce:DescribeReleaseLabel\",\n        \"elasticmapreduce:GetBlockPublicAccessConfiguration\",\n        \"elasticmapreduce:GetManagedScalingPolicy\",\n        \"elasticmapreduce:GetAutoTerminationPolicy\",\n        \"elasticmapreduce:ListBootstrapActions\",\n        \"elasticmapreduce:ListClusters\",\n        \"elasticmapreduce:ListEditors\",\n        \"elasticmapreduce:ListInstanceFleets\",\n        \"elasticmapreduce:ListInstanceGroups\",\n        \"elasticmapreduce:ListInstances\",\n        \"elasticmapreduce:ListSecurityConfigurations\",\n        \"elasticmapreduce:ListSteps\",\n        \"elasticmapreduce:ListSupportedInstanceTypes\",\n        \"elasticmapreduce:ViewEventsFromAllClustersInConsole\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"ViewMetricsInEMRConsole\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"cloudwatch:GetMetricStatistics\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"emr:*\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n```\n\n### Explanation:\nThe above policy allows all actions on the EMR service. This is a very broad policy and should be used with caution. It is recommended to use more specific policies that only allow the necessary actions.\n\n### References:\n* [AWS Documentation - Amazon EMR](https://docs.aws.amazon.com/emr/latest/ManagementGuide/emr-management-guide.html)\n* [AWS Documentation - AWS Identity and Access Management (IAM)](https://docs.aws.amazon.com/IAM/latest/UserGuide/index.html)",
    "complexity": "medium"
  },
  {
    "id": "syn_s3_010",
    "instruction": "Allow S3 read access only if the request uses SSL/TLS. Deny any unencrypted requests.",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:GetObject\",\n        \"s3:ListBucket\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"Bool\": {\n          \"aws:SecureTransport\": \"true\"\n        }\n      }\n    },\n    {\n      \"Effect\": \"Deny\",\n      \"Action\": \"s3:*\",\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"Bool\": {\n          \"aws:SecureTransport\": \"false\"\n        }\n      }\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"DenyUnencryptedAccess\",\n      \"Effect\": \"Deny\",\n      \"Principal\": \"*\",\n      \"Action\": \"s3:*\",\n      \"Resource\": \"arn:aws:s3:::mybucket/*\",\n      \"Condition\": {\n        \"Bool\": {\n          \"aws:SecureTransport\": \"false\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"AllowEncryptedAccess\",\n      \"Effect\": \"Allow\",\n      \"Principal\": \"*\",\n      \"Action\": \"s3:*\",\n      \"Resource\": \"arn:aws:s3:::mybucket/*\",\n      \"Condition\": {\n        \"Bool\": {\n          \"aws:SecureTransport\": \"true\"\n        }\n      }\n    }\n  ]\n}\n```",
    "complexity": "complex"
  },
  {
    "id": "aws_managed_1057",
    "instruction": "Provide an IAM policy for ROSA Kube Controller Policy",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"ReadPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:DescribeAvailabilityZones\",\n        \"ec2:DescribeInstances\",\n        \"ec2:DescribeRouteTables\",\n        \"ec2:DescribeSecurityGroups\",\n        \"ec2:DescribeSubnets\",\n        \"ec2:DescribeVpcs\",\n        \"elasticloadbalancing:DescribeLoadBalancers\",\n        \"elasticloadbalancing:DescribeLoadBalancerAttributes\",\n        \"elasticloadbalancing:DescribeListeners\",\n        \"elasticloadbalancing:DescribeTargetGroups\",\n        \"elasticloadbalancing:DescribeTargetHealth\",\n        \"elasticloadbalancing:DescribeLoadBalancerPolicies\"\n      ],\n      \"Resource\": [\n        \"*\"\n      ]\n    },\n    {\n      \"Sid\": \"KMSDescribeKey\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"kms:DescribeKey\"\n      ],\n      \"Resource\": [\n        \"*\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:ResourceTag/red-hat\": \"true\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"LoadBalanacerManagement\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"elasticloadbalancing:AddTags\",\n        \"elasticloadbalancing:ConfigureHealthCheck\",\n        \"elasticloadbalancing:CreateLoadBalancerPolicy\",\n        \"elasticloadbalancing:DeleteLoadBalancer\",\n        \"elasticloadbalancing:DeregisterInstancesFromLoadBalancer\",\n        \"elasticloadbalancing:ModifyLoadBalancerAttributes\",\n        \"elasticloadbalancing:RegisterInstancesWithLoadBalancer\",\n        \"elasticloadbalancing:SetLoadBalancerPoliciesForBackendServer\"\n      ],\n      \"Resource\": [\n        \"*\"\n      ]\n    },\n    {\n      \"Sid\": \"CreateTargetGroup\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"elasticloadbalancing:CreateTargetGroup\"\n      ],\n      \"Resource\": [\n        \"*\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:RequestTag/red-hat-managed\": \"true\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"LoadBalanacerManagementResourceTag\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"elasticloadbalancing:DeleteListener\",\n        \"elasticloadbalancing:RegisterTargets\",\n        \"elasticloadbalancing:ModifyTargetGroup\",\n        \"elasticloadbalancing:DeleteTargetGroup\",\n        \"elasticloadbalancing:ApplySecurityGroupsToLoadBalancer\",\n        \"elasticloadbalancing:CreateLoadBalancerListeners\",\n        \"elasticloadbalancing:DeleteLoadBalancerListeners\",\n        \"elasticloadbalancing:AttachLoadBalancerToSubnets\",\n        \"elasticloadbalancing:DetachLoadBalancerFromSubnets\",\n        \"elasticloadbalancing:ModifyListener\",\n        \"elasticloadbalancing:SetLoadBalancerPoliciesOfListener\"\n      ],\n      \"Resource\": [\n        \"*\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:ResourceTag/red-hat-managed\": \"true\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"CreateListeners\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"elasticloadbalancing:CreateListener\"\n      ],\n      \"Resource\": [\n        \"*\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:RequestTag/red-hat-managed\": \"true\",\n          \"aws:ResourceTag/red-hat-managed\": \"true\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"CreateSecurityGroup\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:CreateSecurityGroup\"\n      ],\n      \"Resource\": [\n        \"arn:aws:ec2:*:*:security-group/*\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:RequestTag/red-hat-managed\": \"true\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"CreateSecurityGroupVpc\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:CreateSecurityGroup\"\n      ],\n      \"Resource\": [\n        \"arn:aws:ec2:*:*:vpc/*\"\n      ]\n    },\n    {\n      \"Sid\": \"CreateLoadBalancer\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"elasticloadbalancing:CreateLoadBalancer\"\n      ],\n      \"Resource\": [\n        \"arn:aws:elasticloadbalancing:*:*:loadbalancer/*\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:RequestTag/red-hat-managed\": \"true\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"ModifySecurityGroup\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:AuthorizeSecurityGroupIngress\",\n        \"ec2:RevokeSecurityGroupIngress\",\n        \"ec2:DeleteSecurityGroup\"\n      ],\n      \"Resource\": [\n        \"arn:aws:ec2:*:*:security-group/*\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:ResourceTag/red-hat-managed\": \"true\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"CreateTagsSecurityGroups\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:CreateTags\"\n      ],\n      \"Resource\": [\n        \"arn:aws:ec2:*:*:security-group/*\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"ec2:CreateAction\": \"CreateSecurityGroup\"\n        }\n      }\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"kubernetes:*\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n```\n\n### Explanation:\nThe above policy allows the ROSA Kube Controller to perform any action on any resource. This is necessary because the ROSA Kube Controller needs to create and manage Kubernetes resources as part of its operation.\n\n### References:\n- [Kubernetes API Reference](https://kubernetes.io/docs/reference/)\n- [ROSA Kube Controller Documentation](https://github.com/redhat-openshift-apps/rosa-kube-controller)",
    "complexity": "complex"
  },
  {
    "id": "aws_managed_0666",
    "instruction": "Provide an IAM policy for Elemental Activations Download Software Access",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"elemental-activations:Get*\",\n        \"elemental-activations:Download*\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:GetObject\"\n      ],\n      \"Resource\": [\n        \"arn:aws:s3:::elemental-activations-download-software/ElementalActivationsDownloadSoftware.zip\"\n      ]\n    }\n  ]\n}\n```\n\n### Explanation:\nThis policy allows the user to download the Elemental Activations Download Software from S3.\n\n### References:\n* [AWS Elemental Activations Download Software](https://docs.aws.amazon.com/elemental/latest/userguide/activations-download-software.html)\n* [IAM Policy Examples](https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_examples-iam-policy-examples.html#Reference_Policies_Examples-S3)",
    "complexity": "simple"
  },
  {
    "id": "aws_managed_0036",
    "instruction": "Provide an IAM policy for Amazon Mobile Analytics Financial Report Access",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"mobileanalytics:GetReports\",\n        \"mobileanalytics:GetFinancialReports\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"mobileanalytics:GetFinancialReport\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n```\n\n### Explanation:\nThe `mobileanalytics:GetFinancialReport` action is used to retrieve financial reports. This action requires the following permissions:\n\n* `mobileanalytics:GetFinancialReport`\n\nFor more information, see [AWS Identity and Access Management (IAM) Policy Reference](https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_actions-resources-examples.html#Actions_mobileanalytics).",
    "complexity": "simple"
  },
  {
    "id": "aws_managed_0242",
    "instruction": "Provide an IAM policy for AWS Elastic Beanstalk Service Role Policy",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"AllowCloudformationReadOperationsOnElasticBeanstalkStacks\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"cloudformation:DescribeStackResource\",\n        \"cloudformation:DescribeStackResources\",\n        \"cloudformation:DescribeStacks\"\n      ],\n      \"Resource\": [\n        \"arn:aws:cloudformation:*:*:stack/awseb-*\",\n        \"arn:aws:cloudformation:*:*:stack/eb-*\"\n      ]\n    },\n    {\n      \"Sid\": \"AllowOperations\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"autoscaling:DescribeAutoScalingGroups\",\n        \"autoscaling:DescribeAutoScalingInstances\",\n        \"autoscaling:DescribeNotificationConfigurations\",\n        \"autoscaling:DescribeScalingActivities\",\n        \"autoscaling:PutNotificationConfiguration\",\n        \"ec2:DescribeInstanceStatus\",\n        \"ec2:AssociateAddress\",\n        \"ec2:DescribeAddresses\",\n        \"ec2:DescribeInstances\",\n        \"ec2:DescribeSecurityGroups\",\n        \"elasticloadbalancing:DescribeInstanceHealth\",\n        \"elasticloadbalancing:DescribeLoadBalancers\",\n        \"elasticloadbalancing:DescribeTargetHealth\",\n        \"elasticloadbalancing:DescribeTargetGroups\",\n        \"lambda:GetFunction\",\n        \"sqs:GetQueueAttributes\",\n        \"sqs:GetQueueUrl\",\n        \"sns:Publish\"\n      ],\n      \"Resource\": [\n        \"*\"\n      ]\n    },\n    {\n      \"Sid\": \"AllowOperationsOnHealthStreamingLogs\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"logs:CreateLogStream\",\n        \"logs:DescribeLogGroups\",\n        \"logs:DescribeLogStreams\",\n        \"logs:DeleteLogGroup\",\n        \"logs:PutLogEvents\"\n      ],\n      \"Resource\": \"arn:aws:logs:*:*:log-group:/aws/elasticbeanstalk/*\"\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:*\",\n        \"elasticloadbalancing:*\",\n        \"autoscaling:*\",\n        \"cloudwatch:*\",\n        \"s3:*\",\n        \"logs:*\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n```\n\n### Explanation:\nThe following is the list of actions that are required to be allowed in order for the service role to function properly.\n\n* ec2:* - Allows the service role to create and manage EC2 instances, security groups, and other resources.\n* elasticloadbalancing:* - Allows the service role to create and manage load balancers.\n* autoscaling:* - Allows the service role to create and manage auto scaling groups.\n* cloudwatch:* - Allows the service role to monitor and collect metrics from AWS resources.\n* s3:* - Allows the service role to upload and download files from S3 buckets.",
    "complexity": "complex"
  },
  {
    "id": "aws_managed_1122",
    "instruction": "Provide an IAM policy for AWS Resource Explorer Organizations Access",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"ReadOnlyAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"resource-explorer-2:*\",\n        \"ec2:DescribeRegions\",\n        \"ram:ListResources\",\n        \"ram:GetResourceShares\",\n        \"organizations:ListAccounts\",\n        \"organizations:ListRoots\",\n        \"organizations:ListOrganizationalUnitsForParent\",\n        \"organizations:ListAccountsForParent\",\n        \"organizations:ListDelegatedAdministrators\",\n        \"organizations:ListAWSServiceAccessForOrganization\",\n        \"organizations:DescribeOrganization\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"ResourceExplorerGetSLRAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:GetRole\"\n      ],\n      \"Resource\": \"arn:aws:iam::*:role/aws-service-role/resource-explorer-2.amazonaws.com/AWSServiceRoleForResourceExplorer\"\n    },\n    {\n      \"Sid\": \"ResourceExplorerCreateSLRAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:CreateServiceLinkedRole\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"iam:AWSServiceName\": [\n            \"resource-explorer-2.amazonaws.com\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"OrganizationsAdministratorAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"organizations:EnableAWSServiceAccess\",\n        \"organizations:DisableAWSServiceAccess\",\n        \"organizations:RegisterDelegatedAdministrator\",\n        \"organizations:DeregisterDelegatedAdministrator\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"organizations:ServicePrincipal\": [\n            \"resource-explorer-2.amazonaws.com\"\n          ]\n        }\n      }\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"organizations:*\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n```\n\n### Explanation:\nThe `organizations:*` action allows the user to perform all actions on the organizations service. This is necessary for the user to be able to create and manage organization accounts, as well as access the resource explorer.\n\nThe `*` wildcard in the `Resource` field means that the policy applies to all resources in the account. This is necessary because the resource explorer needs to be able to access all resources in the account in order to provide a comprehensive view of the infrastructure.",
    "complexity": "complex"
  },
  {
    "id": "aws_managed_1201",
    "instruction": "Provide an IAM policy for AWS Quick Setup Scheduler Permissions Boundary",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"ConfigurationAutomationRoleGetPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:GetRole\"\n      ],\n      \"Resource\": [\n        \"arn:aws:iam::*:role/AWS-QuickSetup-Scheduler-*\"\n      ]\n    },\n    {\n      \"Sid\": \"ConfigurationAutomationRolePassPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:PassRole\"\n      ],\n      \"Resource\": [\n        \"arn:aws:iam::*:role/AWS-QuickSetup-Scheduler-*\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"iam:PassedToService\": [\n            \"ssm.amazonaws.com\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"SystemsManagerCalendarReadOnlyPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ssm:GetCalendarState\"\n      ],\n      \"Resource\": [\n        \"arn:aws:ssm:*:*:document/AWSQuickSetup-ChangeCalendar-*\"\n      ]\n    },\n    {\n      \"Sid\": \"EC2ReadOnlyPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:DescribeInstances\",\n        \"ec2:DescribeInstanceStatus\",\n        \"ec2:DescribeRegions\",\n        \"ec2:DescribeTags\",\n        \"tag:GetResources\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"EC2StartStopPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:StartInstances\",\n        \"ec2:StopInstances\"\n      ],\n      \"Resource\": \"arn:aws:ec2:*:*:instance/*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:ResourceAccount\": \"${aws:PrincipalAccount}\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"AutomationStartPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ssm:StartAutomationExecution\"\n      ],\n      \"Resource\": [\n        \"arn:aws:ssm:*:*:automation-definition/AWSQuickSetup-StartStateManagerAssociations-*\"\n      ]\n    },\n    {\n      \"Sid\": \"AssociationsStartOncePermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ssm:StartAssociationsOnce\"\n      ],\n      \"Resource\": [\n        \"arn:aws:ssm:*:*:association/*\"\n      ]\n    },\n    {\n      \"Sid\": \"CreateSystemsManagerSLRPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:CreateServiceLinkedRole\"\n      ],\n      \"Resource\": [\n        \"arn:aws:iam::*:role/aws-service-role/ssm.amazonaws.com/AWSServiceRoleForAmazonSSM\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"iam:AWSServiceName\": \"ssm.amazonaws.com\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"ReadOnlyPermissionsForEnablingExplorer\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:ListRoles\",\n        \"config:DescribeConfigurationRecorders\",\n        \"compute-optimizer:GetEnrollmentStatus\",\n        \"support:DescribeTrustedAdvisorChecks\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"SSMExplorerServiceSettingsPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ssm:UpdateServiceSetting\",\n        \"ssm:GetServiceSetting\"\n      ],\n      \"Resource\": [\n        \"arn:aws:ssm:*:*:servicesetting/ssm/opsitem/ssm-patchmanager\",\n        \"arn:aws:ssm:*:*:servicesetting/ssm/opsitem/EC2\",\n        \"arn:aws:ssm:*:*:servicesetting/ssm/opsdata/ExplorerOnboarded\",\n        \"arn:aws:ssm:*:*:servicesetting/ssm/opsdata/Association\",\n        \"arn:aws:ssm:*:*:servicesetting/ssm/opsdata/ComputeOptimizer\",\n        \"arn:aws:ssm:*:*:servicesetting/ssm/opsdata/ConfigCompliance\",\n        \"arn:aws:ssm:*:*:servicesetting/ssm/opsdata/OpsData-TrustedAdvisor\",\n        \"arn:aws:ssm:*:*:servicesetting/ssm/opsdata/SupportCenterCase\"\n      ]\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:*\"\n      ],\n      \"Resource\": [\n        \"*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:*\",\n        \"autoscaling:*\",\n        \"cloudwatch:*\",\n        \"elasticloadbalancing:*\",\n        \"iam:*\",\n        \"rds:*\",\n        \"redshift:*\",\n        \"route53:*\",\n        \"sns:*\",\n        \"sqs:*\",\n        \"ssm:*\",\n        \"tag:*\",\n        \"waf:*\",\n        \"wafv2:*\",\n        \"acm:*\",\n        \"apigateway:*\",\n        \"appconfig:*\",\n        \"application-autoscaling:*\",\n        \"application-load-balancer:*\",\n        \"applicationdiscoveryservice:*\",\n        \"applicationinsights:*\",\n        \"",
    "complexity": "complex"
  },
  {
    "id": "aws_managed_0442",
    "instruction": "Provide an IAM policy for AWS Backup Service Role Policy For Restores",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"DynamoDBPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"dynamodb:Scan\",\n        \"dynamodb:Query\",\n        \"dynamodb:UpdateItem\",\n        \"dynamodb:PutItem\",\n        \"dynamodb:GetItem\",\n        \"dynamodb:DeleteItem\",\n        \"dynamodb:BatchWriteItem\",\n        \"dynamodb:DescribeTable\"\n      ],\n      \"Resource\": \"arn:aws:dynamodb:*:*:table/*\"\n    },\n    {\n      \"Sid\": \"DynamoDBBackupResourcePermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"dynamodb:RestoreTableFromBackup\"\n      ],\n      \"Resource\": \"arn:aws:dynamodb:*:*:table/*/backup/*\"\n    },\n    {\n      \"Sid\": \"EBSPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:CreateVolume\",\n        \"ec2:DeleteVolume\"\n      ],\n      \"Resource\": [\n        \"arn:aws:ec2:*::snapshot/*\",\n        \"arn:aws:ec2:*:*:volume/*\"\n      ]\n    },\n    {\n      \"Sid\": \"EC2DescribePermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:DescribeImages\",\n        \"ec2:DescribeInstances\",\n        \"ec2:DescribeSnapshots\",\n        \"ec2:DescribeVolumes\",\n        \"ec2:DescribeAccountAttributes\",\n        \"ec2:DescribeAddresses\",\n        \"ec2:DescribeAvailabilityZones\",\n        \"ec2:DescribeSecurityGroups\",\n        \"ec2:DescribeSubnets\",\n        \"ec2:DescribeVpcs\",\n        \"ec2:DescribeInternetGateways\",\n        \"ec2:DescribeSnapshotTierStatus\",\n        \"ec2:DescribeRouteTables\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"CreateTagsPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:CreateTags\"\n      ],\n      \"Resource\": \"arn:aws:ec2:*:*:route-table/*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:ResourceTag/AmazonFSx\": \"ManagedByAmazonFSx\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"StorageGatewayVolumePermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"storagegateway:DeleteVolume\",\n        \"storagegateway:DescribeCachediSCSIVolumes\",\n        \"storagegateway:DescribeStorediSCSIVolumes\",\n        \"storagegateway:AddTagsToResource\"\n      ],\n      \"Resource\": \"arn:aws:storagegateway:*:*:gateway/*/volume/*\"\n    },\n    {\n      \"Sid\": \"StorageGatewayGatewayPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"storagegateway:DescribeGatewayInformation\",\n        \"storagegateway:CreateStorediSCSIVolume\",\n        \"storagegateway:CreateCachediSCSIVolume\"\n      ],\n      \"Resource\": \"arn:aws:storagegateway:*:*:gateway/*\"\n    },\n    {\n      \"Sid\": \"StorageGatewayListPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"storagegateway:ListVolumes\"\n      ],\n      \"Resource\": \"arn:aws:storagegateway:*:*:*\"\n    },\n    {\n      \"Sid\": \"RDSPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"rds:DescribeDBInstances\",\n        \"rds:DescribeDBSnapshots\",\n        \"rds:ListTagsForResource\",\n        \"rds:RestoreDBInstanceFromDBSnapshot\",\n        \"rds:DeleteDBInstance\",\n        \"rds:AddTagsToResource\",\n        \"rds:DescribeDBClusters\",\n        \"rds:RestoreDBClusterFromSnapshot\",\n        \"rds:DeleteDBCluster\",\n        \"rds:RestoreDBInstanceToPointInTime\",\n        \"rds:DescribeDBClusterSnapshots\",\n        \"rds:RestoreDBClusterToPointInTime\",\n        \"rds:CreateTenantDatabase\",\n        \"rds:DeleteTenantDatabase\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"EFSPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"elasticfilesystem:Restore\",\n        \"elasticfilesystem:CreateFilesystem\",\n        \"elasticfilesystem:DescribeFilesystems\",\n        \"elasticfilesystem:DeleteFilesystem\",\n        \"elasticfilesystem:TagResource\"\n      ],\n      \"Resource\": \"arn:aws:elasticfilesystem:*:*:file-system/*\"\n    },\n    {\n      \"Sid\": \"KMSDescribePermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"kms:DescribeKey\",\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"DSQLResourcePermissionsForRestore\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"dsql:StartRestoreJob\",\n        \"dsql:GetRestoreJob\",\n        \"dsql:StopRestoreJob\",\n        \"dsql:TagResource\",\n        \"dsql:CreateCluster\",\n        \"dsql:PutMultiRegionProperties\",\n        \"dsql:PutWitnessRegion\",\n        \"dsql:UpdateCluster\",\n        \"dsql:AddPeerCluster\",\n        \"dsql:RemovePeerCluster\",\n        \"dsql:GetCluster\"\n      ],\n      \"Resource\": [\n        \"*\"\n      ]\n    },\n    {\n      \"Sid\": \"KMSPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"kms:Decrypt\",\n        \"kms:Encrypt\",\n        \"kms:GenerateDataKey\",\n        \"kms:ReEncryptTo\",\n        \"kms:ReEncryptFrom\",\n        \"kms:GenerateDataKeyWithoutPlaintext\",\n        \"kms:DescribeKey\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"kms:ViaService\": [\n            \"dynamodb.*.amazonaws.com\",\n            \"ec2.*.amazonaws.com\",\n            \"elasticfilesystem.*.amazonaws.com\",\n            \"rds.*.amazonaws.com\",\n            \"redshift.*.amazonaws.com\",\n            \"dsql.*.amazonaws.com\",\n            \"redshift-serverless.*.amazonaws.com\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"KMSCreateGrantPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"kms:CreateGrant\",\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"Bool\": {\n          \"kms:GrantIsForAWSResource\": \"true\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"EBSSnapshotBlockPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ebs:CompleteSnapshot\",\n        \"ebs:StartSnapshot\",\n        \"ebs:PutSnapshotBlock\"\n      ],\n      \"Resource\": \"arn:aws:ec2:*::snapshot/*\"\n    },\n    {\n      \"Sid\": \"RDSResourcePermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"rds:CreateDBInstance\"\n      ],\n      \"Resource\": \"arn:aws:rds:*:*:db:*\"\n    },\n    {\n      \"Sid\": \"EC2DeleteAndRestorePermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:DeleteSnapshot\",\n        \"ec2:DeleteTags\",\n        \"ec2:RestoreSnapshotTier\"\n      ],\n      \"Resource\": \"arn:aws:ec2:*::snapshot/*\",\n      \"Condition\": {\n        \"Null\": {\n          \"aws:ResourceTag/aws:backup:source-resource\": \"false\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"EC2CreateTagsScopedPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"ec2:CreateTags\",\n      \"Resource\": [\n        \"arn:aws:ec2:*::snapshot/*\",\n        \"arn:aws:ec2:*:*:instance/*\"\n      ],\n      \"Condition\": {\n        \"ForAllValues:StringEquals\": {\n          \"aws:TagKeys\": [\n            \"aws:backup:source-resource\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"EC2RunInstancesPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:RunInstances\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"EC2TerminateInstancesPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:TerminateInstances\"\n      ],\n      \"Resource\": \"arn:aws:ec2:*:*:instance/*\"\n    },\n    {\n      \"Sid\": \"EC2CreateTagsPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:CreateTags\"\n      ],\n      \"Resource\": [\n        \"arn:aws:ec2:*:*:instance/*\",\n        \"arn:aws:ec2:*:*:volume/*\"\n      ],\n      \"Condition\": {\n        \"StringLike\": {\n          \"ec2:CreateAction\": [\n            \"RunInstances\",\n            \"CreateVolume\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"FsxPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"fsx:CreateFileSystemFromBackup\"\n      ],\n      \"Resource\": [\n        \"arn:aws:fsx:*:*:file-system/*\",\n        \"arn:aws:fsx:*:*:backup/*\"\n      ]\n    },\n    {\n      \"Sid\": \"FsxTagPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"fsx:DescribeFileSystems\",\n        \"fsx:TagResource\"\n      ],\n      \"Resource\": \"arn:aws:fsx:*:*:file-system/*\"\n    },\n    {\n      \"Sid\": \"FsxBackupPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"fsx:DescribeBackups\",\n      \"Resource\": \"arn:aws:fsx:*:*:backup/*\"\n    },\n    {\n      \"Sid\": \"FsxDeletePermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"fsx:DeleteFileSystem\",\n        \"fsx:UntagResource\"\n      ],\n      \"Resource\": \"arn:aws:fsx:*:*:file-system/*\",\n      \"Condition\": {\n        \"Null\": {\n          \"aws:ResourceTag/aws:backup:source-resource\": \"false\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"FsxDescribePermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"fsx:DescribeVolumes\"\n      ],\n      \"Resource\": \"arn:aws:fsx:*:*:volume/*\"\n    },\n    {\n      \"Sid\": \"FsxVolumeTagPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"fsx:CreateVolumeFromBackup\",\n        \"fsx:TagResource\"\n      ],\n      \"Resource\": [\n        \"arn:aws:fsx:*:*:volume/*\"\n      ],\n      \"Condition\": {\n        \"ForAllValues:StringEquals\": {\n          \"aws:TagKeys\": [\n            \"aws:backup:source-resource\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"FsxBackupTagPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"fsx:CreateVolumeFromBackup\",\n        \"fsx:TagResource\"\n      ],\n      \"Resource\": [\n        \"arn:aws:fsx:*:*:storage-virtual-machine/*\",\n        \"arn:aws:fsx:*:*:backup/*\",\n        \"arn:aws:fsx:*:*:volume/*\"\n      ]\n    },\n    {\n      \"Sid\": \"FsxVolumePermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"fsx:DeleteVolume\",\n        \"fsx:UntagResource\"\n      ],\n      \"Resource\": \"arn:aws:fsx:*:*:volume/*\",\n      \"Condition\": {\n        \"Null\": {\n          \"aws:ResourceTag/aws:backup:source-resource\": \"false\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"DSPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"ds:DescribeDirectories\",\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"DynamoDBRestorePermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"dynamodb:RestoreTableFromAwsBackup\"\n      ],\n      \"Resource\": \"arn:aws:dynamodb:*:*:table/*\"\n    },\n    {\n      \"Sid\": \"GatewayRestorePermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"backup-gateway:Restore\"\n      ],\n      \"Resource\": \"arn:aws:backup-gateway:*:*:hypervisor/*\"\n    },\n    {\n      \"Sid\": \"CloudformationChangeSetPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"cloudformation:CreateChangeSet\",\n        \"cloudformation:DescribeChangeSet\",\n        \"cloudformation:TagResource\"\n      ],\n      \"Resource\": \"arn:aws:cloudformation:*:*:*/*/*\"\n    },\n    {\n      \"Sid\": \"RedshiftClusterSnapshotPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"redshift:RestoreFromClusterSnapshot\",\n        \"redshift:RestoreTableFromClusterSnapshot\"\n      ],\n      \"Resource\": [\n        \"arn:aws:redshift:*:*:snapshot:*/*\",\n        \"arn:aws:redshift:*:*:cluster:*\",\n        \"arn:aws:redshift-serverless:*:*:snapshot/*\"\n      ]\n    },\n    {\n      \"Sid\": \"RedshiftClusterPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"redshift:DescribeClusters\"\n      ],\n      \"Resource\": [\n        \"arn:aws:redshift:*:*:cluster:*\"\n      ]\n    },\n    {\n      \"Sid\": \"RedshiftTablePermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"redshift:DescribeTableRestoreStatus\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"RedshiftServerlessSnapshotPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"redshift-serverless:RestoreTableFromSnapshot\"\n      ],\n      \"Resource\": [\n        \"arn:aws:redshift-serverless:*:*:namespace/*\",\n        \"arn:aws:redshift-serverless:*:*:workgroup/*\",\n        \"arn:aws:redshift-serverless:*:*:snapshot/*\"\n      ]\n    },\n    {\n      \"Sid\": \"RedshiftServerlessNamespacePermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"redshift-serverless:GetNamespace\"\n      ],\n      \"Resource\": [\n        \"arn:aws:redshift-serverless:*:*:namespace/*\"\n      ]\n    },\n    {\n      \"Sid\": \"RedshiftServerlessTablePermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"redshift-serverless:GetTableRestoreStatus\"\n      ],\n      \"Resource\": [\n        \"*\"\n      ]\n    },\n    {\n      \"Sid\": \"TimestreamResourcePermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"timestream:StartAwsRestoreJob\",\n        \"timestream:GetAwsRestoreStatus\",\n        \"timestream:ListTables\",\n        \"timestream:ListTagsForResource\",\n        \"timestream:ListDatabases\",\n        \"timestream:DescribeTable\",\n        \"timestream:DescribeDatabase\"\n      ],\n      \"Resource\": [\n        \"arn:aws:timestream:*:*:database/*\"\n      ]\n    },\n    {\n      \"Sid\": \"TimestreamEndpointPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"timestream:DescribeEndpoints\"\n      ],\n      \"Resource\": [\n        \"*\"\n      ]\n    },\n    {\n      \"Sid\": \"EKSClusterRestore\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"eks:CreateCluster\",\n        \"eks:DescribeCluster\",\n        \"eks:CreateAccessEntry\",\n        \"eks:DescribeAccessEntry\",\n        \"eks:AssociateAccessPolicy\",\n        \"eks:ListAssociatedAccessPolicies\",\n        \"eks:CreateAddon\",\n        \"eks:DescribeAddon\",\n        \"eks:CreateNodegroup\",\n        \"eks:DescribeNodegroup\",\n        \"eks:CreateFargateProfile\",\n        \"eks:DescribeFargateProfile\",\n        \"eks:CreatePodIdentityAssociation\",\n        \"eks:DescribePodIdentityAssociation\",\n        \"eks:TagResource\"\n      ],\n      \"Resource\": [\n        \"arn:aws:eks:*:*:access-entry/*\",\n        \"arn:aws:eks:*:*:addon/*\",\n        \"arn:aws:eks:*:*:cluster/*\",\n        \"arn:aws:eks:*:*:fargateprofile/*\",\n        \"arn:aws:eks:*:*:nodegroup/*\",\n        \"arn:aws:eks:*:*:podidentityassociation/*\"\n      ]\n    },\n    {\n      \"Sid\": \"AssociateRestoreAccessPolicy\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"eks:AssociateAccessPolicy\",\n        \"eks:DisassociateAccessPolicy\"\n      ],\n      \"Resource\": \"arn:aws:eks:*:*:access-entry/*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"eks:policyArn\": \"arn:aws:eks::aws:cluster-access-policy/AWSBackupFullAccessPolicyForRestore\",\n          \"eks:accessScope\": \"cluster\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"CreateClusterIAMPerms\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:PassRole\"\n      ],\n      \"Resource\": \"arn:aws:iam::*:role/*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"iam:PassedToService\": [\n            \"eks.amazonaws.com\",\n            \"ec2.amazonaws.com\",\n            \"pods.eks.amazonaws.com\",\n            \"backup.amazonaws.com\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"CreateEKSNodeGroupPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:DescribeLaunchTemplateVersions\",\n        \"ec2:DescribeSubnets\",\n        \"ec2:RunInstances\",\n        \"iam:GetRole\",\n        \"iam:ListAttachedRolePolicies\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"EKSNodeGroupTagOnCreate\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:CreateTags\"\n      ],\n      \"Resource\": [\n        \"arn:aws:ec2:*:*:instance/*\",\n        \"arn:aws:ec2:*:*:volume/*\",\n        \"arn:aws:ec2:*:*:network-interface/*\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"ec2:CreateAction\": [\n            \"RunInstances\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"BackupRestoreJobManagementPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"backup:StartRestoreJob\",\n        \"backup:ListRestoreJobs\",\n        \"backup:ListRecoveryPointsByBackupVault\",\n        \"backup:DescribeRestoreJob\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"backup:Restore*\",\n        \"backup:Describe*\",\n        \"backup:List*\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n```\n\n### Explanation:\nThe following policy allows the AWS Backup service role to perform all actions related to restoring backups. This includes actions such as `Backup:Restore`, `Backup:Describe`, and `Backup:List`. The `Resource` field is set to `*`, which means that the policy applies to all resources in the account.\n\nThis policy is intended for use with the AWS Backup service role, which is used by the AWS Backup service to perform its operations. It is important to note that this policy should only be applied to the AWS Backup service role and not to any other roles or users in the account.",
    "complexity": "complex"
  },
  {
    "id": "aws_managed_0040",
    "instruction": "Provide an IAM policy for IAM Read Only Access",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:GenerateCredentialReport\",\n        \"iam:GenerateServiceLastAccessedDetails\",\n        \"iam:Get*\",\n        \"iam:List*\",\n        \"iam:SimulateCustomPolicy\",\n        \"iam:SimulatePrincipalPolicy\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:ListAccountAliases\",\n        \"iam:ListAccountSummary\",\n        \"iam:ListAttachedRolesForAccount\",\n        \"iam:ListGroupsForUser\",\n        \"iam:ListGroupMemberships\",\n        \"iam:ListGroups\",\n        \"iam:ListInstanceProfilesForRole\",\n        \"iam:ListMFADevices\",\n        \"iam:ListOpenIDConnectProviders\",\n        \"iam:ListPolicies\",\n        \"iam:ListPolicyVersions\",\n        \"iam:ListRoles\",\n        \"iam:ListRolePolicies\",\n        \"iam:ListRoleTags\",\n        \"iam:ListServerCertificates\",\n        \"iam:ListSignedUrls\",\n        \"iam:ListUsers\",\n        \"iam:ListUserPolicies\",\n        \"iam:ListUserTags\",\n        \"iam:ListVirtualMFADevices\"\n      ],\n      \"Resource\":",
    "complexity": "simple"
  },
  {
    "id": "aws_managed_0738",
    "instruction": "Provide an IAM policy for AWS Io T Wireless Read Only Access",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iotwireless:List*\",\n        \"iotwireless:Get*\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}",
    "generated": "```json\n{\n    \"Version\": \"2012-10-17\",\n    \"Statement\": [\n        {\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"iotwireless:*\"\n            ],\n            \"Resource\": \"*\"\n        }\n    ]\n}\n```\n\n### Explanation:\nThe above policy allows all actions on the AWS IoT Wireless service. This is a read only access policy and should be used with caution.\n\n### References:\nhttps://docs.aws.amazon.com/iotwireless/latest/developerguide/iotwireless-api-reference.html\n\n### Additional Information:\nThis policy can be used to provide read only access to the AWS IoT Wireless service. It should be used with caution as it allows all actions on the service.",
    "complexity": "simple"
  },
  {
    "id": "aws_managed_0724",
    "instruction": "Provide an IAM policy for AWS Marketplace License Management Service Role Policy",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"AllowLicenseManagerActions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"organizations:DescribeOrganization\",\n        \"license-manager:ListReceivedGrants\",\n        \"license-manager:ListDistributedGrants\",\n        \"license-manager:GetGrant\",\n        \"license-manager:CreateGrant\",\n        \"license-manager:CreateGrantVersion\",\n        \"license-manager:DeleteGrant\",\n        \"license-manager:AcceptGrant\"\n      ],\n      \"Resource\": [\n        \"*\"\n      ]\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"license-manager:*\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n```\n\n### Explanation:\nThe `AWSMarketplaceLicenseManagementServiceRolePolicy` is a predefined IAM role that allows the License Manager service to manage licenses. This role has full access to the License Manager API, which includes creating, updating, and deleting license records. It also allows the service to create and delete resources in your account, such as Amazon S3 buckets and DynamoDB tables.\n\nTo use this role, you must attach it to an IAM user or group. You can then grant the user or group permission to perform specific actions on the License Manager API. For example, if you want to allow a user to create license records, you would add the `CreateLicenseRecord` action to their permissions.",
    "complexity": "medium"
  },
  {
    "id": "aws_managed_1287",
    "instruction": "Provide an IAM policy for AWS Security Incident Response Case Full Access",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"SecurityIRCaseReadAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"security-ir:GetCase\",\n        \"security-ir:ListCases\",\n        \"security-ir:GetCaseAttachmentDownloadUrl\",\n        \"security-ir:ListComments\",\n        \"security-ir:ListCaseEdits\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"SecurityIRCaseTagReadAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"security-ir:ListTagsForResource\"\n      ],\n      \"Resource\": \"arn:aws:security-ir:*:*:case/*\"\n    },\n    {\n      \"Sid\": \"SecurityIRCaseWriteAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"security-ir:CreateCase\",\n        \"security-ir:UpdateCase\",\n        \"security-ir:CloseCase\",\n        \"security-ir:UpdateCaseStatus\",\n        \"security-ir:UpdateResolverType\",\n        \"security-ir:GetCaseAttachmentUploadUrl\",\n        \"security-ir:CreateCaseComment\",\n        \"security-ir:UpdateCaseComment\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"Bool\": {\n          \"aws:MultiFactorAuthPresent\": \"true\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"SecurityIRCaseTagWriteAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"security-ir:TagResource\",\n        \"security-ir:UntagResource\"\n      ],\n      \"Resource\": \"arn:aws:security-ir:*:*:case/*\",\n      \"Condition\": {\n        \"Bool\": {\n          \"aws:MultiFactorAuthPresent\": \"true\"\n        }\n      }\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:*\",\n        \"ec2:*\",\n        \"iam:*\",\n        \"cloudwatch:*\",\n        \"logs:*\",\n        \"autoscaling:*\",\n        \"elasticloadbalancing:*\",\n        \"rds:*\",\n        \"dynamodb:*\",\n        \"kinesis:*\",\n        \"sqs:*\",\n        \"sns:*\",\n        \"secretsmanager:*\",\n        \"ssm:*\",\n        \"acm:*\",\n        \"route53:*\",\n        \"apigateway:*\",\n        \"cloudformation:*\",\n        \"cloudtrail:*\",\n        \"config:*\",\n        \"guardduty:*\",\n        \"organizations:*\",\n        \"waf:*\",\n        \"wafv2:*\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n```",
    "complexity": "complex"
  },
  {
    "id": "aws_managed_0814",
    "instruction": "Provide an IAM policy for Amazon Route53Recovery Readiness Full Access",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"route53-recovery-readiness:*\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"route53recoveryreadiness:*\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n```\n\n### Explanation:\nThe `route53recoveryreadiness:*` action allows full access to the Route53RecoveryReadiness service. This includes creating, updating, and deleting recovery readiness checks, as well as retrieving information about existing checks. It is important to note that this policy should only be used in specific scenarios where full access to the service is required. In most cases, a more restrictive policy should be used to grant only the necessary permissions.",
    "complexity": "simple"
  },
  {
    "id": "aws_managed_1421",
    "instruction": "Provide an IAM policy for AWS Identity Center External Management Policy",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"IdentityStoreUserCreation\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"identitystore:CreateUser\"\n      ],\n      \"Resource\": [\n        \"arn:aws:identitystore::*:identitystore/${aws:PrincipalTag/IdentityStoreId}\",\n        \"arn:aws:identitystore:::user/*\"\n      ],\n      \"Condition\": {\n        \"ForAllValues:ArnEquals\": {\n          \"identitystore:UserExternalIdIssuers\": [\n            \"arn:aws:identitystore::*:identitystore/${aws:PrincipalTag/IdentityStoreId}/provisioningtenant/${aws:PrincipalTag/IdentityStoreExternalIdIssuer}\"\n          ]\n        },\n        \"Null\": {\n          \"identitystore:UserExternalIdIssuers\": \"false\",\n          \"identitystore:ReservedUserId\": \"false\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"IdentityStoreUserManagement\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"identitystore:UpdateUser\",\n        \"identitystore:DeleteUser\",\n        \"identitystore:DescribeUser\"\n      ],\n      \"Resource\": [\n        \"arn:aws:identitystore::*:identitystore/${aws:PrincipalTag/IdentityStoreId}\",\n        \"arn:aws:identitystore:::user/*\"\n      ],\n      \"Condition\": {\n        \"ForAllValues:ArnEquals\": {\n          \"identitystore:UserExternalIdIssuers\": [\n            \"arn:aws:identitystore::*:identitystore/${aws:PrincipalTag/IdentityStoreId}/provisioningtenant/${aws:PrincipalTag/IdentityStoreExternalIdIssuer}\"\n          ]\n        },\n        \"Null\": {\n          \"identitystore:UserExternalIdIssuers\": \"false\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"IdentityStoreCMKAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"kms:Decrypt\",\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"kms:EncryptionContext:aws:identitystore:identitystore-arn\": [\n            \"arn:aws:identitystore::${aws:PrincipalAccount}:identitystore/${aws:PrincipalTag/IdentityStoreId}\"\n          ]\n        },\n        \"StringLike\": {\n          \"kms:ViaService\": \"identitystore.*.amazonaws.com\"\n        }\n      }\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:CreateAccessKey\",\n        \"iam:DeleteAccessKey\",\n        \"iam:GetAccountSummary\",\n        \"iam:ListAccountAliases\",\n        \"iam:ListAccountSummaries\",\n        \"iam:ListAttachedRolesForInstanceProfile\",\n        \"iam:ListInstanceProfilesForRole\",\n        \"iam:ListOpenIDConnectProviders\",\n        \"iam:ListPolicies\",\n        \"iam:ListPolicyVersions\",\n        \"iam:ListRoles\",\n        \"iam:ListRolePolicies\",\n        \"iam:ListRoleTags\",\n        \"iam:ListServerCertificates\",\n        \"iam:ListUserPolicies\",\n        \"iam:ListUsers\",\n        \"iam:ListVirtualMFADevices\",\n        \"iam:PutUserPolicy\",\n        \"iam:TagResource\",\n        \"iam:UntagResource\"\n      ],\n      \"Resource\": \"*\"",
    "complexity": "medium"
  },
  {
    "id": "aws_managed_1195",
    "instruction": "Provide an IAM policy for AWS Systems Manager Enable Explorer Execution Policy",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"CreateSystemsManagerSLRPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:CreateServiceLinkedRole\"\n      ],\n      \"Resource\": [\n        \"arn:aws:iam::*:role/aws-service-role/ssm.amazonaws.com/AWSServiceRoleForAmazonSSM\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"iam:AWSServiceName\": \"ssm.amazonaws.com\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"ReadOnlyPermissionsForEnablingExplorer\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:ListRoles\",\n        \"config:DescribeConfigurationRecorders\",\n        \"compute-optimizer:GetEnrollmentStatus\",\n        \"support:DescribeTrustedAdvisorChecks\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"SSMExplorerServiceSettingsPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ssm:UpdateServiceSetting\",\n        \"ssm:GetServiceSetting\"\n      ],\n      \"Resource\": [\n        \"arn:aws:ssm:*:*:servicesetting/ssm/opsitem/ssm-patchmanager\",\n        \"arn:aws:ssm:*:*:servicesetting/ssm/opsitem/EC2\",\n        \"arn:aws:ssm:*:*:servicesetting/ssm/opsdata/ExplorerOnboarded\",\n        \"arn:aws:ssm:*:*:servicesetting/ssm/opsdata/Association\",\n        \"arn:aws:ssm:*:*:servicesetting/ssm/opsdata/ComputeOptimizer\",\n        \"arn:aws:ssm:*:*:servicesetting/ssm/opsdata/ConfigCompliance\",\n        \"arn:aws:ssm:*:*:servicesetting/ssm/opsdata/OpsData-TrustedAdvisor\",\n        \"arn:aws:ssm:*:*:servicesetting/ssm/opsdata/SupportCenterCase\"\n      ]\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ssm:EnableExplorerExecutionPolicy\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n```\n\n### Explanation:\nThe `ssm:EnableExplorerExecutionPolicy` action is used to enable the execution of explorers in AWS Systems Manager. An explorer is a script or program that runs on managed instances and performs tasks such as collecting data, running commands, or installing software. By enabling this action, you can allow explorers to run on your managed instances.\n\nIn this example, we are providing an IAM policy that allows the `ssm:EnableExplorerExecutionPolicy` action to be performed on all resources (`*`). This means that any user or role with this policy attached will be able to enable explorer execution policies on any resource in AWS Systems Manager.\n\nIt's important to note that enabling explorer execution policies should only be done when necessary, as it can potentially open up",
    "complexity": "complex"
  },
  {
    "id": "aws_managed_0684",
    "instruction": "Provide an IAM policy for Cloud Watch Lambda Insights Execution Role Policy",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"logs:CreateLogGroup\",\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"logs:CreateLogStream\",\n        \"logs:PutLogEvents\"\n      ],\n      \"Resource\": \"arn:aws:logs:*:*:log-group:/aws/lambda-insights:*\"\n    }\n  ]\n}",
    "generated": "```json\n{\n    \"Version\": \"2012-10-17\",\n    \"Statement\": [\n        {\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"logs:*\"\n            ],\n            \"Resource\": \"*\"\n        },\n        {\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"lambda:*\"\n            ],\n            \"Resource\": \"*\"\n        }\n    ]\n}\n```\n\n### Explanation:\nThe following policy allows the Lambda Insights execution role to perform all actions on the AWS Logs and AWS Lambda services. This is required so that the Lambda Insights service can collect logs from your Lambda functions and analyze them.",
    "complexity": "medium"
  },
  {
    "id": "aws_managed_1206",
    "instruction": "Provide an IAM policy for App Studio Service Role Policy",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"AppStudioResourcePermissionsForCloudWatch\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"logs:CreateLogGroup\",\n        \"logs:CreateLogStream\",\n        \"logs:PutLogEvents\"\n      ],\n      \"Resource\": [\n        \"arn:aws:logs:*:*:log-group:/aws/appstudio/*\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:ResourceAccount\": \"${aws:PrincipalAccount}\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"AppStudioResourcePermissionsForSecretsManager\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"secretsmanager:CreateSecret\",\n        \"secretsmanager:DeleteSecret\",\n        \"secretsmanager:DescribeSecret\",\n        \"secretsmanager:GetSecretValue\",\n        \"secretsmanager:PutSecretValue\",\n        \"secretsmanager:UpdateSecret\",\n        \"secretsmanager:TagResource\"\n      ],\n      \"Resource\": \"arn:aws:secretsmanager:*:*:secret:appstudio-*\",\n      \"Condition\": {\n        \"ForAllValues:StringEquals\": {\n          \"aws:TagKeys\": [\n            \"IsAppStudioSecret\"\n          ]\n        },\n        \"StringEquals\": {\n          \"aws:ResourceAccount\": \"${aws:PrincipalAccount}\",\n          \"aws:ResourceTag/IsAppStudioSecret\": \"true\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"AppStudioResourcePermissionsForManagedSecrets\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"secretsmanager:DeleteSecret\",\n        \"secretsmanager:DescribeSecret\",\n        \"secretsmanager:GetSecretValue\",\n        \"secretsmanager:PutSecretValue\",\n        \"secretsmanager:UpdateSecret\"\n      ],\n      \"Resource\": \"arn:aws:secretsmanager:*:*:secret:appstudio!*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:ResourceAccount\": \"${aws:PrincipalAccount}\",\n          \"secretsmanager:ResourceTag/aws:secretsmanager:owningService\": \"appstudio\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"AppStudioResourceWritePermissionsForManagedSecrets\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"secretsmanager:CreateSecret\"\n      ],\n      \"Resource\": \"arn:aws:secretsmanager:*:*:secret:appstudio!*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:ResourceAccount\": \"${aws:PrincipalAccount}\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"AppStudioResourcePermissionsForSSO\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"sso:GetManagedApplicationInstance\",\n        \"sso-directory:DescribeUsers\",\n        \"sso-directory:ListMembersInGroup\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:ResourceAccount\": \"${aws:PrincipalAccount}\"\n        }\n      }\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"appstudio:*\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n```\n\n### Explanation:\nThe App Studio service role is used to grant permissions to the App Studio service. The policy allows the App Studio service to perform all actions on all resources. This policy should be applied to the service role that is associated with the App Studio service.",
    "complexity": "complex"
  },
  {
    "id": "aws_managed_0767",
    "instruction": "Provide an IAM policy for AWS Grafana Account Administrator",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"AWSGrafanaOrganizationAdmin\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:ListRoles\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"GrafanaIAMGetRolePermission\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"iam:GetRole\",\n      \"Resource\": \"arn:aws:iam::*:role/*\"\n    },\n    {\n      \"Sid\": \"AWSGrafanaPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"grafana:*\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"GrafanaIAMPassRolePermission\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"iam:PassRole\",\n      \"Resource\": \"arn:aws:iam::*:role/*\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"iam:PassedToService\": \"grafana.amazonaws.com\"\n        }\n      }\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:CreateServiceLinkedRole\",\n        \"iam:DeleteServiceLinkedRole\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"grafana:ListDashboards\",\n        \"grafana:GetDashboard\",\n        \"grafana:GetOrg\",\n        \"grafana:GetUser\",\n        \"grafana:GetTeam\",\n        \"grafana:GetOrgSettings\",\n        \"grafana:GetOrgMemberships\",\n        \"grafana:GetOrgTeams\",\n        \"grafana:GetOrgUsers\",\n        \"grafana:GetOrgRoles\",\n        \"grafana:GetOrgPermissions\",\n        \"grafana:GetOrgWebhooks\",\n        \"grafana:GetOrgSchedules\",\n        \"g",
    "complexity": "complex"
  },
  {
    "id": "aws_managed_0341",
    "instruction": "Provide an IAM policy for Amazon EKS CNI Policy",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"AmazonEKSCNIPolicy\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:AssignPrivateIpAddresses\",\n        \"ec2:AttachNetworkInterface\",\n        \"ec2:CreateNetworkInterface\",\n        \"ec2:DeleteNetworkInterface\",\n        \"ec2:DescribeInstances\",\n        \"ec2:DescribeTags\",\n        \"ec2:DescribeNetworkInterfaces\",\n        \"ec2:DescribeInstanceTypes\",\n        \"ec2:DescribeSubnets\",\n        \"ec2:DetachNetworkInterface\",\n        \"ec2:ModifyNetworkInterfaceAttribute\",\n        \"ec2:UnassignPrivateIpAddresses\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"AmazonEKSCNIPolicyENITag\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:CreateTags\"\n      ],\n      \"Resource\": [\n        \"arn:aws:ec2:*:*:network-interface/*\"\n      ]\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ecr:GetAuthorizationToken\",\n        \"ecr:BatchCheckLayerAvailability\",\n        \"ecr:GetDownloadUrlForLayer\",\n        \"ecr:BatchGetImage\",\n        \"logs:CreateLogStream\",\n        \"logs:PutLogEvents\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n```\n\n### Explanation:\nThe following permissions are required by the Amazon EKS CNI addon to function properly.\n\n* `ecr:GetAuthorizationToken` - Required to authenticate with the ECR registry.\n* `ecr:BatchCheckLayerAvailability` - Required to check if a layer is available in the ECR repository.\n* `ecr:GetDownloadUrlForLayer` - Required to get the download URL for a layer.\n* `ecr:BatchGetImage` - Required to get the image manifest and layers from the ECR repository.\n* `logs",
    "complexity": "medium"
  },
  {
    "id": "aws_managed_1041",
    "instruction": "Provide an IAM policy for AWS Media Connect Service Policy",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ecs:UpdateService\",\n        \"ecs:DeleteService\",\n        \"ecs:CreateService\",\n        \"ecs:DescribeServices\",\n        \"ecs:PutAttributes\",\n        \"ecs:DeleteAttributes\",\n        \"ecs:RunTask\",\n        \"ecs:ListTasks\",\n        \"ecs:StartTask\",\n        \"ecs:StopTask\",\n        \"ecs:DescribeTasks\",\n        \"ecs:DescribeContainerInstances\",\n        \"ecs:UpdateContainerInstancesState\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"ArnLike\": {\n          \"ecs:cluster\": \"arn:aws:ecs:*:*:cluster/MediaConnectGateway\"\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ecs:CreateCluster\",\n        \"ecs:RegisterTaskDefinition\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ecs:UpdateCluster\",\n        \"ecs:UpdateClusterSettings\",\n        \"ecs:ListAttributes\",\n        \"ecs:DescribeClusters\",\n        \"ecs:DeregisterContainerInstance\",\n        \"ecs:ListContainerInstances\"\n      ],\n      \"Resource\": \"arn:aws:ecs:*:*:cluster/MediaConnectGateway\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:DeleteNetworkInterface\",\n        \"ec2:DeleteNetworkInterfacePermission\",\n        \"ec2:CreateNetworkInterfacePermission\"\n      ],\n      \"Resource\": [\n        \"arn:aws:ec2:*:*:network-interface/*\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:ResourceTag/created-for-service\": \"MediaConnect\"\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:DescribeNetworkInterfaces\",\n        \"ec2:DescribeSecurityGroups\",\n        \"ec2:DescribeSubnets\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"mediaconnect:*\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n```\n\n### Description:\nThe following is a sample IAM policy that allows all actions on the AWS Media Connect service. This policy can be used as a starting point to create more restrictive policies.\n\n### Keywords:\nAWS Media Connect, IAM policy, AWS Media Connect Service Policy\n\n### Last Updated Date:\n2023-04-25",
    "complexity": "complex"
  },
  {
    "id": "aws_managed_0169",
    "instruction": "Provide an IAM policy for AWS Application Discovery Agent Access",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"arsenal:RegisterOnPremisesAgent\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"mgh:GetHomeRegion\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:Describe*\",\n        \"ec2:CreateTags\",\n        \"ec2:DeleteTags\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ssm:GetParameters\",\n        \"ssm:GetParameterHistory\",\n        \"ssm:GetParametersByPath\",\n        \"ssm:GetParametersOfType\",\n        \"ssm:PutParameters\",\n        \"ssm:UpdateAssociationStatus\",\n        \"ssm:UpdateInstanceInformation\",\n        \"ssm:UpdateInstanceInformationForAutoScalingGroup\",\n        \"ssm:UpdateInstanceInformationForLaunchTemplate\",\n        \"ssm:UpdateInstanceInformationForLaunchTemplateVersion\",\n        \"ssm:UpdateInstanceInformationForLaunchTemplateVersionWithEC2Metadata\",\n        \"ssm:UpdateInstanceInformationForLaunchTemplateWithEC2Metadata\",\n        \"ssm:",
    "complexity": "medium"
  },
  {
    "id": "aws_managed_0033",
    "instruction": "Provide an IAM policy for AWS Marketplace Read only",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"aws-marketplace:ViewSubscriptions\",\n        \"aws-marketplace:ListAgreementCharges\",\n        \"ec2:DescribeAccountAttributes\",\n        \"ec2:DescribeAddresses\",\n        \"ec2:DescribeImages\",\n        \"ec2:DescribeInstances\",\n        \"ec2:DescribeKeyPairs\",\n        \"ec2:DescribeSecurityGroups\",\n        \"ec2:DescribeSubnets\",\n        \"ec2:DescribeVpcs\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:ListRoles\",\n        \"iam:ListInstanceProfiles\",\n        \"sns:GetTopicAttributes\",\n        \"sns:ListTopics\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"aws-marketplace:ListPrivateMarketplaceRequests\",\n        \"aws-marketplace:DescribePrivateMarketplaceRequests\",\n        \"aws-marketplace:GetAgreementPaymentRequest\",\n        \"aws-marketplace:ListAgreementPaymentRequests\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"aws-marketplace:ListPrivateListings\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"marketplacecomposite:ListProducts\",\n        \"marketplacecomposite:GetProductDetails\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n```\n\n### Explanation:\nThe above policy allows the user to list products and get product details from AWS Marketplace. This is a read-only access, which means that the user cannot create, update, or delete any resources in AWS Marketplace.\n\nThe `Effect` of the statement is set to `Allow`, which means that the user is allowed to perform the specified actions. The `Action` specifies the specific actions that are allowed, such as `marketplacecomposite:ListProducts` and `marketplacecomposite:GetProductDetails`. These actions allow the user to list all available products and retrieve detailed information about each product, respectively.\n\nThe `Resource` specifies the resource type that the action can be performed on. In this case, it is set to `*",
    "complexity": "complex"
  },
  {
    "id": "aws_managed_1242",
    "instruction": "Provide an IAM policy for AWS Partner Central Opportunity Management",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"OpportunityManagement\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"partnercentral:AcceptEngagementInvitation\",\n        \"partnercentral:AssignOpportunity\",\n        \"partnercentral:AssociateOpportunity\",\n        \"partnercentral:CreateEngagement\",\n        \"partnercentral:CreateEngagementContext\",\n        \"partnercentral:CreateEngagementInvitation\",\n        \"partnercentral:CreateOpportunity\",\n        \"partnercentral:CreateResourceSnapshot\",\n        \"partnercentral:CreateResourceSnapshotJob\",\n        \"partnercentral:DeleteResourceSnapshotJob\",\n        \"partnercentral:DisassociateOpportunity\",\n        \"partnercentral:GetAwsOpportunitySummary\",\n        \"partnercentral:GetEngagement\",\n        \"partnercentral:GetEngagementInvitation\",\n        \"partnercentral:GetOpportunity\",\n        \"partnercentral:GetResourceSnapshot\",\n        \"partnercentral:GetResourceSnapshotJob\",\n        \"partnercentral:ListEngagementByAcceptingInvitationTasks\",\n        \"partnercentral:ListEngagementFromOpportunityTasks\",\n        \"partnercentral:ListEngagementInvitations\",\n        \"partnercentral:ListEngagementMembers\",\n        \"partnercentral:ListEngagementResourceAssociations\",\n        \"partnercentral:ListEngagements\",\n        \"partnercentral:ListOpportunities\",\n        \"partnercentral:ListOpportunityFromEngagementTasks\",\n        \"partnercentral:ListResourceSnapshotJobs\",\n        \"partnercentral:ListResourceSnapshots\",\n        \"partnercentral:ListSolutions\",\n        \"partnercentral:RejectEngagementInvitation\",\n        \"partnercentral:StartEngagementByAcceptingInvitationTask\",\n        \"partnercentral:StartEngagementFromOpportunityTask\",\n        \"partnercentral:StartOpportunityFromEngagementTask\",\n        \"partnercentral:StartResourceSnapshotJob\",\n        \"partnercentral:StopResourceSnapshotJob\",\n        \"partnercentral:SubmitOpportunity\",\n        \"partnercentral:UpdateEngagementContext\",\n        \"partnercentral:UpdateOpportunity\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"partnercentral:Catalog\": [\n            \"AWS\",\n            \"Sandbox\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"ListingAWSMarketplaceEntities\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"aws-marketplace:ListEntities\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"AWSMarketplaceEntityAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"aws-marketplace:DescribeEntity\"\n      ],\n      \"Resource\": [\n        \"arn:aws:aws-marketplace:*:*:AWSMarketplace*/Solution/*\",\n        \"arn:aws:aws-marketplace:*:*:AWSMarketplace*/OfferSet/*\",\n        \"arn:aws:aws-marketplace:*:*:AWSMarketplace*/Offer/*\"\n      ]\n    },\n    {\n      \"Sid\": \"LegacyPartnerCentralAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"partnercentral-account-management:AccessLegacyPartnerCentral\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"ForAnyValue:StringEquals\": {\n          \"partnercentral-account-management:LegacyPartnerCentralRole\": \"AceManager\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"PartnerDashboardAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"partnercentral:GetPartnerDashboard\"\n      ],\n      \"Resource\": [\n        \"arn:aws:partnercentral::*:catalog/AWS/ReportingData/Opportunity_V1/Dashboard/*\",\n        \"arn:aws:partnercentral::*:catalog/AWS/ReportingData/Engagement_V1/Dashboard/*\"\n      ]\n    },\n    {\n      \"Sid\": \"CollaborationChannelAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"partnercentral:CreateCollaborationChannelRequest\",\n        \"partnercentral:ListCollaborationChannels\",\n        \"partnercentral:GetCollaborationChannel\",\n        \"partnercentral:CreateCollaborationChannelMembers\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"PartnerResourceAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"partnercentral:ListPartners\",\n        \"partnercentral:GetPartner\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"partnercentral:Catalog\": [\n            \"AWS\",\n            \"Sandbox\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"TaggingAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"partnercentral:TagResource\",\n        \"partnercentral:UntagResource\",\n        \"partnercentral:ListTagsForResource\"\n      ],\n      \"Resource\": [\n        \"arn:aws:partnercentral:*:*:catalog/*/opportunity/*\",\n        \"arn:aws:partnercentral:*:*:catalog/*/resource-snapshot-job/*\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"partnercentral:Catalog\": [\n            \"AWS\",\n            \"Sandbox\"\n          ]\n        }\n      }\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:*\"\n      ],\n      \"Resource\": [\n        \"arn:aws:s3:::partnercentral-opportunity-management-us-east-1/*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:GetObject\",\n        \"s3:PutObject\"\n      ],\n      \"Resource\": [\n        \"arn:aws:s3:::partnercentral-opportunity-management-us-east-1/data/*\"\n      ]\n    }\n  ]\n}\n```",
    "complexity": "complex"
  },
  {
    "id": "syn_multi_004",
    "instruction": "Security audit role that has read-only access across IAM, CloudTrail, Config, GuardDuty, and Security Hub for compliance reviews",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:List*\",\n        \"iam:Get*\",\n        \"iam:GenerateCredentialReport\",\n        \"iam:GetCredentialReport\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"cloudtrail:DescribeTrails\",\n        \"cloudtrail:GetTrailStatus\",\n        \"cloudtrail:LookupEvents\",\n        \"cloudtrail:GetEventSelectors\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"config:Describe*\",\n        \"config:Get*\",\n        \"config:List*\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"guardduty:GetDetector\",\n        \"guardduty:GetFindings\",\n        \"guardduty:ListDetectors\",\n        \"guardduty:ListFindings\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"securityhub:GetFindings\",\n        \"securityhub:DescribeHub\",\n        \"securityhub:GetEnabledStandards\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}",
    "generated": "```\n{\n    \"Version\": \"2012-10-17\",\n    \"Statement\": [\n        {\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"iam:*\",\n                \"cloudtrail:Get*\",\n                \"config:GetComplianceDetailsByResource\",\n                \"guardduty:ListDetectors\",\n                \"securityhub:DescribeFindings\"\n            ],\n            \"Resource\": \"*\"\n        }\n    ]\n}\n```\n\n### Explanation:\nThis policy allows the user to perform security audits on the AWS account. It grants read-only access to all services related to security, including IAM, CloudTrail, Config, GuardDuty, and Security Hub. This is useful for compliance reviews and other security-related tasks.",
    "complexity": "complex"
  },
  {
    "id": "aws_managed_0983",
    "instruction": "Provide an IAM policy for AWS Application Migration SSM Access",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ssm:GetCommandInvocation\",\n        \"ssm:DescribeInstanceInformation\"\n      ],\n      \"Resource\": [\n        \"*\"\n      ],\n      \"Condition\": {\n        \"ForAnyValue:StringEquals\": {\n          \"aws:CalledVia\": [\n            \"mgn.amazonaws.com\"\n          ]\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ssm:SendCommand\",\n        \"ssm:DescribeDocument\",\n        \"ssm:StartAutomationExecution\"\n      ],\n      \"Resource\": [\n        \"arn:aws:ssm:*:*:document/*\",\n        \"arn:aws:ssm:*:*:automation-execution/*\",\n        \"arn:aws:ssm:*:*:automation-definition/*:*\"\n      ],\n      \"Condition\": {\n        \"ForAnyValue:StringEquals\": {\n          \"aws:CalledVia\": [\n            \"mgn.amazonaws.com\"\n          ]\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ssm:SendCommand\"\n      ],\n      \"Resource\": [\n        \"arn:aws:ec2:*:*:instance/*\"\n      ],\n      \"Condition\": {\n        \"ForAnyValue:StringEquals\": {\n          \"aws:CalledVia\": [\n            \"mgn.amazonaws.com\"\n          ]\n        },\n        \"Null\": {\n          \"aws:ResourceTag/AWSApplicationMigrationServiceManaged\": \"false\"\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ssm:ListDocuments\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ssm:ListDocumentVersions\",\n        \"ssm:GetDocument\"\n      ],\n      \"Resource\": \"arn:aws:ssm:*:*:document/*\"\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ssm:GetParameter\",\n        \"ssm:GetParametersByPath\",\n        \"ssm:GetParameters\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n```\n\n### Explanation:\nThe following policy allows the user to get parameters from SSM. This is required by AWS Application Migration Service to be able to migrate your servers.\n\n### References:\n* https://docs.aws.amazon.com/systems-manager/latest/userguide/getting-started-iam-policies.html",
    "complexity": "complex"
  },
  {
    "id": "aws_managed_0056",
    "instruction": "Provide an IAM policy for Amazon S3Full Access",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:*\",\n        \"s3-object-lambda:*\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:*\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n```\n\n### Explanation:\nThe above policy grants full access to the Amazon S3 service. This includes the ability to create, read, update, and delete buckets and objects within those buckets. It also allows for the creation of new users and groups, as well as the management of existing users and groups. Additionally, this policy allows for the creation of new policies and the modification of existing policies. Finally, it allows for the creation of new roles and the modification of existing roles.",
    "complexity": "medium"
  },
  {
    "id": "aws_managed_0161",
    "instruction": "Provide an IAM policy for AWS Elastic Beanstalk Enhanced Health",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"elasticloadbalancing:DescribeInstanceHealth\",\n        \"elasticloadbalancing:DescribeLoadBalancers\",\n        \"elasticloadbalancing:DescribeTargetHealth\",\n        \"ec2:DescribeInstances\",\n        \"ec2:DescribeInstanceStatus\",\n        \"ec2:GetConsoleOutput\",\n        \"ec2:AssociateAddress\",\n        \"ec2:DescribeAddresses\",\n        \"ec2:DescribeSecurityGroups\",\n        \"sqs:GetQueueAttributes\",\n        \"sqs:GetQueueUrl\",\n        \"autoscaling:DescribeAutoScalingGroups\",\n        \"autoscaling:DescribeAutoScalingInstances\",\n        \"autoscaling:DescribeScalingActivities\",\n        \"autoscaling:DescribeNotificationConfigurations\",\n        \"sns:Publish\"\n      ],\n      \"Resource\": [\n        \"*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"logs:DescribeLogStreams\",\n        \"logs:CreateLogStream\",\n        \"logs:PutLogEvents\"\n      ],\n      \"Resource\": \"arn:aws:logs:*:*:log-group:/aws/elasticbeanstalk/*:log-stream:*\"\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"elasticbeanstalk:Describe*\",\n        \"elasticbeanstalk:List*\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:AuthorizeSecurityGroupIngress\",\n        \"ec2:CreateTags\",\n        \"ec2:DeleteTags\",\n        \"ec2:Describe*\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"autoscaling:DescribeAutoScalingGroups\",\n        \"autoscaling:DescribeLaunchConfigurations\",\n        \"autoscaling:DescribeTags\",\n        \"autoscaling:SetDesiredCapacity\",\n        \"autoscaling:TerminateInstanceInAutoScalingGroup\",\n        \"autoscaling:UpdateAutoScalingGroup\"\n      ],\n      \"Resource",
    "complexity": "complex"
  },
  {
    "id": "aws_managed_1134",
    "instruction": "Provide an IAM policy for Amazon One Enterprise Installer Access",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"InstallerAccessStatementID\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"one:CreateDeviceActivationQrCode\",\n        \"one:GetDeviceInstance\",\n        \"one:GetSite\",\n        \"one:GetSiteAddress\",\n        \"one:ListDeviceInstances\",\n        \"one:ListSites\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:CreateServiceLinkedRole\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:GetObject\",\n        \"s3:ListBucket\",\n        \"s3:PutObject\"\n      ],\n      \"Resource\": [\n        \"arn:aws:s3:::amazon-one-enterprise-installer-us-east-1/*\",\n        \"arn:aws:s3:::amazon-one-enterprise-installer-us-west-2/*\",\n        \"arn:aws:s3:::amazon-one-enterprise-installer-us-west-1/*\",\n        \"arn:aws:s3:::amazon-one-enterprise-installer-ap-northeast-1/*\",\n        \"arn:aws:s3:::amazon-one-enterprise-installer-",
    "complexity": "simple"
  },
  {
    "id": "aws_managed_0728",
    "instruction": "Provide an IAM policy for AWS Systems Manager Change Management Service Policy",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ssm:CreateAssociation\",\n        \"ssm:DeleteAssociation\",\n        \"ssm:CreateOpsItem\",\n        \"ssm:GetOpsItem\",\n        \"ssm:UpdateOpsItem\",\n        \"ssm:StartAutomationExecution\",\n        \"ssm:StopAutomationExecution\",\n        \"ssm:GetAutomationExecution\",\n        \"ssm:GetCalendarState\",\n        \"ssm:GetDocument\"\n      ],\n      \"Resource\": [\n        \"*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"cloudwatch:DescribeAlarms\"\n      ],\n      \"Resource\": [\n        \"*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"sso:ListDirectoryAssociations\"\n      ],\n      \"Resource\": [\n        \"*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"sso-directory:DescribeUsers\",\n        \"sso-directory:IsMemberInGroup\"\n      ],\n      \"Resource\": [\n        \"*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"iam:GetGroup\",\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"iam:PassRole\",\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"iam:PassedToService\": [\n            \"ssm.amazonaws.com\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"AllowKmsAccessViaIdentityCenter\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"kms:Decrypt\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"ArnLike\": {\n          \"kms:EncryptionContext:aws:sso:instance-arn\": \"arn:*:sso:::instance/*\"\n        },\n        \"StringLike\": {\n          \"kms:ViaService\": \"sso.*.amazonaws.com\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"AllowKmsAccessViaIdentityStore\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"kms:Decrypt\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"ArnLike\": {\n          \"kms:EncryptionContext:aws:identitystore:identitystore-arn\": \"arn:*:identitystore::*:identitystore/*\"\n        },\n        \"StringLike\": {\n          \"kms:ViaService\": \"identitystore.*.amazonaws.com\"\n        }\n      }\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ssm:CreateChange\",\n        \"ssm:DescribeChange\",\n        \"ssm:GetChangeExecutionStatus\",\n        \"ssm:ListChanges\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n```\n\n### Explanation:\nThe above policy allows the user to create, describe, get execution status and list changes.\n\n### References:\n* https://docs.aws.amazon.com/systems-manager/latest/userguide/change-management.html\n* https://docs.aws.amazon.com/IAM/latest/UserGuide/list_awssystemsmgr.html",
    "complexity": "complex"
  },
  {
    "id": "aws_managed_1413",
    "instruction": "Provide an IAM policy for AWS Partner Central Channel Handshake Approval Management",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"ChannelHandshakeManagement\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"partnercentral:ListChannelHandshakes\",\n        \"partnercentral:AcceptChannelHandshake\",\n        \"partnercentral:RejectChannelHandshake\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"partnercentral:Catalog\": [\n            \"AWS\",\n            \"Sandbox\"\n          ]\n        }\n      }\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"acm:ListCertificates\",\n        \"acm:DescribeCertificate\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:GetRole\",\n        \"iam:GetPolicy\",\n        \"iam:GetUser\",\n        \"iam:GetAccountSummary\",\n        \"iam:ListRoles\",\n        \"iam:ListPolicies\",\n        \"iam:ListUsers\",\n        \"iam:ListAccountAliases\",\n        \"iam:ListAttachedUserPolicies\",\n        \"iam:ListAttachedRolePolicies\",\n        \"iam:ListServerCertificates\",\n        \"iam:ListOpenIDConnectProviderConfigurations\",\n        \"iam:ListSSOAdminConfigs\",\n        \"iam:ListSSOConfigs\",\n        \"iam:ListSSORolesForAccount\",\n        \"iam:ListSSORolesForUser",
    "complexity": "simple"
  },
  {
    "id": "aws_managed_0006",
    "instruction": "Provide an IAM policy for AWS Cloud HSM Read Only Access",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"cloudhsm:Get*\",\n        \"cloudhsm:List*\",\n        \"cloudhsm:Describe*\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"kms:*\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n```\n\n### Explanation:\nThis policy allows all KMS actions on any resource. This is a very broad policy and should be used with caution. It is recommended to use the least privilege principle when creating policies, and only allow the specific actions that are required for the task at hand.\n\n### References:\n[AWS KMS](https://docs.aws.amazon.com/kms/latest/developerguide/concepts.html)",
    "complexity": "simple"
  },
  {
    "id": "aws_managed_0245",
    "instruction": "Provide an IAM policy for AWS Elastic Load Balancing Service Role Policy",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:DescribeAddresses\",\n        \"ec2:DescribeCoipPools\",\n        \"ec2:DescribeInstances\",\n        \"ec2:DescribeNetworkInterfaces\",\n        \"ec2:DescribeSubnets\",\n        \"ec2:DescribeSecurityGroups\",\n        \"ec2:DescribeVpcs\",\n        \"ec2:DescribeInternetGateways\",\n        \"ec2:DescribeAccountAttributes\",\n        \"ec2:DescribeClassicLinkInstances\",\n        \"ec2:DescribeVpcClassicLink\",\n        \"ec2:CreateSecurityGroup\",\n        \"ec2:CreateNetworkInterface\",\n        \"ec2:DeleteNetworkInterface\",\n        \"ec2:GetCoipPoolUsage\",\n        \"ec2:GetSecurityGroupsForVpc\",\n        \"ec2:ModifyNetworkInterfaceAttribute\",\n        \"ec2:AllocateAddress\",\n        \"ec2:AuthorizeSecurityGroupIngress\",\n        \"ec2:AssociateAddress\",\n        \"ec2:DisassociateAddress\",\n        \"ec2:AttachNetworkInterface\",\n        \"ec2:DetachNetworkInterface\",\n        \"ec2:AssignPrivateIpAddresses\",\n        \"ec2:AssignIpv6Addresses\",\n        \"ec2:ReleaseAddress\",\n        \"ec2:UnassignIpv6Addresses\",\n        \"ec2:DescribeVpcPeeringConnections\",\n        \"ec2:DescribeAvailabilityZones\",\n        \"ec2:AllocateIpamPoolCidr\",\n        \"logs:CreateLogDelivery\",\n        \"logs:GetLogDelivery\",\n        \"logs:UpdateLogDelivery\",\n        \"logs:DeleteLogDelivery\",\n        \"logs:ListLogDeliveries\",\n        \"outposts:GetOutpostInstanceTypes\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"elasticloadbalancing:*\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n```\n\n### Explanation:\nThe following policy allows the service role to perform all actions on all resources. This is a very broad policy and should be used with caution. It is recommended that you use a more specific policy that only grants the necessary permissions for your use case.\n\n### References:\nhttps://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies_manage-attach.html",
    "complexity": "medium"
  },
  {
    "id": "aws_managed_0432",
    "instruction": "Provide an IAM policy for Client VPN Service Role Policy",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:CreateNetworkInterface\",\n        \"ec2:CreateNetworkInterfacePermission\",\n        \"ec2:DescribeSecurityGroups\",\n        \"ec2:DescribeVpcs\",\n        \"ec2:DescribeSubnets\",\n        \"ec2:DescribeInternetGateways\",\n        \"ec2:ModifyNetworkInterfaceAttribute\",\n        \"ec2:DeleteNetworkInterface\",\n        \"ec2:DescribeAccountAttributes\",\n        \"ds:AuthorizeApplication\",\n        \"ds:DescribeDirectories\",\n        \"ds:GetDirectoryLimits\",\n        \"ds:UnauthorizeApplication\",\n        \"logs:DescribeLogStreams\",\n        \"logs:CreateLogStream\",\n        \"logs:PutLogEvents\",\n        \"logs:DescribeLogGroups\",\n        \"acm:GetCertificate\",\n        \"acm:DescribeCertificate\",\n        \"iam:GetSAMLProvider\",\n        \"lambda:GetFunctionConfiguration\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:Describe*\",\n        \"ec2:CreateVpnConnection\",\n        \"ec2:DeleteVpnConnection\",\n        \"ec2:ModifyVpnConnectionAttribute\",\n        \"ec2:AcceptVpnConnectionRequest\",\n        \"ec2:RejectVpnConnectionRequest\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:GetRole\",\n        \"iam:ListRoles\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n```",
    "complexity": "complex"
  },
  {
    "id": "aws_managed_0311",
    "instruction": "Provide an IAM policy for AWS Application Autoscaling Sage Maker Endpoint Policy",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"SageMaker\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"sagemaker:DescribeEndpoint\",\n        \"sagemaker:DescribeEndpointConfig\",\n        \"sagemaker:DescribeInferenceComponent\",\n        \"sagemaker:UpdateEndpointWeightsAndCapacities\",\n        \"sagemaker:UpdateInferenceComponentRuntimeConfig\",\n        \"cloudwatch:DescribeAlarms\",\n        \"cloudwatch:GetMetricData\"\n      ],\n      \"Resource\": [\n        \"*\"\n      ]\n    },\n    {\n      \"Sid\": \"SageMakerCloudWatchUpdate\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"cloudwatch:PutMetricAlarm\",\n        \"cloudwatch:DeleteAlarms\"\n      ],\n      \"Resource\": [\n        \"arn:aws:cloudwatch:*:*:alarm:TargetTracking*\"\n      ]\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"autoscaling:DescribeAutoScalingGroups\",\n        \"autoscaling:DescribeAutoScalingInstances\",\n        \"autoscaling:DescribeLaunchConfigurations\",\n        \"autoscaling:DescribeTags\",\n        \"autoscaling:SetDesiredCapacity\",\n        \"autoscaling:TerminateInstanceInAutoScalingGroup\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:GetObject\",\n        \"s3:ListBucket\"\n      ],\n      \"Resource\": [\n        \"arn:aws:s3:::<bucket_name>/*\",\n        \"arn:aws:s3:::<bucket_name>\"\n      ]\n    }\n  ]\n}\n```",
    "complexity": "medium"
  },
  {
    "id": "aws_managed_0461",
    "instruction": "Provide an IAM policy for AWS App Mesh Full Access",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"appmesh:*\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:CreateServiceLinkedRole\"\n      ],\n      \"Resource\": \"arn:aws:iam::*:role/aws-service-role/appmesh.amazonaws.com/AWSServiceRoleForAppMesh\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"iam:AWSServiceName\": [\n            \"appmesh.amazonaws.com\"\n          ]\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"cloudformation:CreateStack\",\n        \"cloudformation:DeleteStack\",\n        \"cloudformation:DescribeStack*\",\n        \"cloudformation:UpdateStack\"\n      ],\n      \"Resource\": \"arn:aws:cloudformation:*:*:stack/AWSAppMesh-GettingStarted-*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"acm:ListCertificates\",\n        \"acm:DescribeCertificate\",\n        \"acm-pca:DescribeCertificateAuthority\",\n        \"acm-pca:ListCertificateAuthorities\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"servicediscovery:ListNamespaces\",\n        \"servicediscovery:ListServices\",\n        \"servicediscovery:ListInstances\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"appmesh:*\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n```\n\n### Explanation:\nThe above policy allows all actions on the App Mesh service. This is useful if you want to allow full access to App Mesh without having to specify individual actions and resources.\n\n### References:\n[AWS App Mesh Policy Examples](https://docs.aws.amazon.com/app-mesh/latest/developerguide/policy-examples.html)",
    "complexity": "complex"
  },
  {
    "id": "aws_managed_1100",
    "instruction": "Provide an IAM policy for AWS Service Role For Cloud Watch Metrics Db Perf Insights Service Role Policy",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"pi:GetResourceMetrics\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:ResourceAccount\": \"${aws:PrincipalAccount}\"\n        }\n      }\n    }\n  ]\n}",
    "generated": "```json\n{\n    \"Version\": \"2012-10-17\",\n    \"Statement\": [\n        {\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"cloudwatch:PutMetricData\"\n            ],\n            \"Resource\": \"*\"\n        }\n    ]\n}\n```\n\n### Explanation:\nThe following policy allows the CloudWatch metrics to be put into the CloudWatch service.\n\n### References:\nhttps://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_Monitoring.html#USER_Monitoring.CloudWatchMetrics",
    "complexity": "simple"
  },
  {
    "id": "aws_managed_0674",
    "instruction": "Provide an IAM policy for Amazon Elastic File Systems Utils",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ssm:DescribeAssociation\",\n        \"ssm:GetDeployablePatchSnapshotForInstance\",\n        \"ssm:GetDocument\",\n        \"ssm:DescribeDocument\",\n        \"ssm:GetManifest\",\n        \"ssm:GetParameter\",\n        \"ssm:GetParameters\",\n        \"ssm:ListAssociations\",\n        \"ssm:ListInstanceAssociations\",\n        \"ssm:PutInventory\",\n        \"ssm:PutComplianceItems\",\n        \"ssm:PutConfigurePackageResult\",\n        \"ssm:UpdateAssociationStatus\",\n        \"ssm:UpdateInstanceAssociationStatus\",\n        \"ssm:UpdateInstanceInformation\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ssmmessages:CreateControlChannel\",\n        \"ssmmessages:CreateDataChannel\",\n        \"ssmmessages:OpenControlChannel\",\n        \"ssmmessages:OpenDataChannel\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2messages:AcknowledgeMessage\",\n        \"ec2messages:DeleteMessage\",\n        \"ec2messages:FailMessage\",\n        \"ec2messages:GetEndpoint\",\n        \"ec2messages:GetMessages\",\n        \"ec2messages:SendReply\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"elasticfilesystem:DescribeMountTargets\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:DescribeAvailabilityZones\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"logs:PutLogEvents\",\n        \"logs:DescribeLogStreams\",\n        \"logs:DescribeLogGroups\",\n        \"logs:CreateLogStream\",\n        \"logs:CreateLogGroup\",\n        \"logs:PutRetentionPolicy\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"efs:CreateFileSystem\",\n        \"efs:DescribeFileSystems\",\n        \"efs:DeleteFileSystem\",\n        \"efs:ModifyAccessPoint\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n```\n\n### Explanation:\nThe above policy allows the following actions on all EFS resources:\n* CreateFileSystem - Creates a new file system.\n* DescribeFileSystems - Describes one or more file systems.\n* DeleteFileSystem - Deletes a file system.\n* ModifyAccessPoint - Modifies an access point.",
    "complexity": "complex"
  },
  {
    "id": "aws_managed_0079",
    "instruction": "Provide an IAM policy for Auto Scaling Notification Access Role",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Resource\": \"*\",\n      \"Action\": [\n        \"sqs:SendMessage\",\n        \"sqs:GetQueueUrl\",\n        \"sns:Publish\"\n      ]\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"autoscaling:DescribeAutoScalingGroups\",\n        \"autoscaling:DescribeAutoScalingInstances\",\n        \"autoscaling:DescribeLaunchConfigurations\",\n        \"autoscaling:DescribeTags\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n```\n\n### Explanation:\nThe AWS Auto Scaling service uses the Auto Scaling Notification Access role to access information about your Auto Scaling groups. The Auto Scaling Notification Access role is used by the Amazon EC2 Auto Scaling service to retrieve information from your Auto Scaling groups, such as group names and instance IDs. This information is used to send notifications when events occur in your Auto Scaling groups.\n\nThe following permissions are required for the Auto Scaling Notification Access role:\n\n* autoscaling:DescribeAutoScalingGroups - Used to retrieve information about your Auto Scaling groups.\n* autoscaling",
    "complexity": "medium"
  },
  {
    "id": "aws_managed_0255",
    "instruction": "Provide an IAM policy for AWS Application Autoscaling RDS Cluster Policy",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"rds:AddTagsToResource\",\n        \"rds:CreateDBInstance\",\n        \"rds:DeleteDBInstance\",\n        \"rds:DescribeDBClusters\",\n        \"rds:DescribeDBInstances\",\n        \"rds:ModifyDBCluster\",\n        \"cloudwatch:PutMetricAlarm\",\n        \"cloudwatch:DescribeAlarms\",\n        \"cloudwatch:DeleteAlarms\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:PassRole\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"iam:PassedToService\": \"rds.amazonaws.com\"\n        }\n      }\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"autoscaling:DescribeAutoScalingGroups\",\n        \"autoscaling:DescribeAutoScalingInstances\",\n        \"autoscaling:DescribeLaunchConfigurations\",\n        \"autoscaling:DescribeTags\",\n        \"autoscaling:SetDesiredCapacity\",\n        \"autoscaling:TerminateInstanceInAutoScalingGroup\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n```\n\n### Explanation:\nThe above policy allows the following actions on all resources:\n* DescribeAutoScalingGroups\n* DescribeAutoScalingInstances\n* DescribeLaunchConfigurations\n* DescribeTags\n* SetDesiredCapacity\n* TerminateInstanceInAutoScalingGroup",
    "complexity": "medium"
  },
  {
    "id": "aws_managed_0327",
    "instruction": "Provide an IAM policy for AWS App Sync Invoke Full Access",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"appsync:GraphQL\",\n        \"appsync:GetGraphqlApi\",\n        \"appsync:ListGraphqlApis\",\n        \"appsync:ListApiKeys\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"appsync:*\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n```\n\n### Explanation:\nThe above policy allows the user to perform any action on the AWS AppSync service. This includes creating, updating, and deleting APIs, mutations, queries, subscriptions, and other resources. It also allows the user to manage authentication and authorization settings, as well as monitor and troubleshoot the service. However, it is important to note that this policy should only be used in limited circumstances, such as when testing or debugging the service, or when granting full access to a trusted user or group. In production environments, it is recommended to use more restrictive policies that allow only specific actions and resources based on the user's role and responsibilities.",
    "complexity": "simple"
  },
  {
    "id": "aws_managed_0690",
    "instruction": "Provide an IAM policy for Amazon MQ Service Role Policy",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:DescribeVpcEndpoints\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:CreateVpcEndpoint\"\n      ],\n      \"Resource\": [\n        \"arn:aws:ec2:*:*:vpc/*\",\n        \"arn:aws:ec2:*:*:subnet/*\",\n        \"arn:aws:ec2:*:*:security-group/*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:CreateVpcEndpoint\"\n      ],\n      \"Resource\": [\n        \"arn:aws:ec2:*:*:vpc-endpoint/*\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:RequestTag/AMQManaged\": \"true\"\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:CreateTags\"\n      ],\n      \"Resource\": \"arn:aws:ec2:*:*:vpc-endpoint/*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"ec2:CreateAction\": \"CreateVpcEndpoint\"\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:DeleteVpcEndpoints\"\n      ],\n      \"Resource\": \"arn:aws:ec2:*:*:vpc-endpoint/*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"ec2:ResourceTag/AMQManaged\": \"true\"\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"logs:PutLogEvents\",\n        \"logs:DescribeLogStreams\",\n        \"logs:DescribeLogGroups\",\n        \"logs:CreateLogStream\",\n        \"logs:CreateLogGroup\"\n      ],\n      \"Resource\": [\n        \"arn:aws:logs:*:*:log-group:/aws/amazonmq/*\"\n      ]\n    }\n  ]\n}",
    "generated": "```json\n{\n    \"Version\": \"2012-10-17\",\n    \"Statement\": [\n        {\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"mq:CreateQueue\",\n                \"mq:DeleteQueue\",\n                \"mq:DescribeQueues\",\n                \"mq:GetQueueAttributes\",\n                \"mq:ListQueues\",\n                \"mq:SendMessage\",\n                \"mq:SetQueueAttributes\"\n            ],\n            \"Resource\": \"*\"\n        }\n    ]\n}\n```\n\n### Explanation:\nThe following policy allows the service role to perform all actions on all resources.\n\n### References:\n[Amazon MQ Service Role Policy](https://docs.aws.amazon.com/AmazonMQ/latest/developerguide/service-role-policy.html)",
    "complexity": "complex"
  },
  {
    "id": "aws_managed_0562",
    "instruction": "Provide an IAM policy for Amazon Code Guru Profiler Full Access",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Action\": [\n        \"codeguru-profiler:*\",\n        \"iam:ListRoles\",\n        \"iam:ListUsers\",\n        \"sns:ListTopics\",\n        \"codeguru:*\"\n      ],\n      \"Effect\": \"Allow\",\n      \"Resource\": \"*\"\n    },\n    {\n      \"Action\": [\n        \"iam:CreateServiceLinkedRole\"\n      ],\n      \"Effect\": \"Allow\",\n      \"Resource\": \"arn:aws:iam::*:role/*AWSServiceRoleForCodeGuruProfiler*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"iam:AWSServiceName\": \"codeguru-profiler.amazonaws.com\"\n        }\n      }\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"codeguruprofiler:*\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n```\n\n### Explanation:\nThe `codeguruprofiler:*` action allows the user to perform all actions related to Amazon CodeGuru Profiler. This includes creating, updating, and deleting profiles, as well as retrieving information about profiles. By granting this permission, you are giving the user full access to manage profiles in your AWS account.\n\n### References:\n[Amazon CodeGuru Profiler](https://docs.aws.amazon.com/codeguru/latest/profiler/welcome.html)",
    "complexity": "complex"
  },
  {
    "id": "aws_managed_0072",
    "instruction": "Provide an IAM policy for Amazon Zocalo Read Only Access",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"zocalo:Describe*\",\n        \"ds:DescribeDirectories\",\n        \"ec2:DescribeVpcs\",\n        \"ec2:DescribeSubnets\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}",
    "generated": "```json\n{\n    \"Version\": \"2012-10-17\",\n    \"Statement\": [\n        {\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"zocalo:List*\",\n                \"zocalo:Describe*\"\n            ],\n            \"Resource\": \"*\"\n        }\n    ]\n}\n```\n\n### Explanation:\nThe above policy allows the user to list and describe all resources in the Zocalo service. This is a read only access policy.\n\n### References:\n[Zocalo API Reference](https://docs.aws.amazon.com/zocalo/latest/APIReference/Welcome.html)",
    "complexity": "medium"
  },
  {
    "id": "aws_managed_1136",
    "instruction": "Provide an IAM policy for AWS Service Role For Neptune Graph Policy",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"GraphMetrics\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"cloudwatch:PutMetricData\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"cloudwatch:namespace\": [\n            \"AWS/Neptune\",\n            \"AWS/Usage\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"GraphLogGroup\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"logs:CreateLogGroup\"\n      ],\n      \"Resource\": [\n        \"arn:aws:logs:*:*:log-group:/aws/neptune/*\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:ResourceAccount\": \"${aws:PrincipalAccount}\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"GraphLogEvents\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"logs:CreateLogStream\",\n        \"logs:PutLogEvents\",\n        \"logs:DescribeLogStreams\"\n      ],\n      \"Resource\": [\n        \"arn:aws:logs:*:*:log-group:/aws/neptune/*:log-stream:*\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:ResourceAccount\": \"${aws:PrincipalAccount}\"\n        }\n      }\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"neptune:*\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n```\n\n### Explanation:\nThe above policy allows all actions on the Neptune service. This is a common pattern when creating policies for AWS services, as it allows the service to perform any action necessary to fulfill its purpose. However, this approach can be risky if not carefully managed, as it could potentially allow unauthorized access or actions that are not intended by the service. It's important to carefully consider the specific needs of the service and only grant permissions that are absolutely necessary for it to function properly.",
    "complexity": "medium"
  },
  {
    "id": "aws_managed_0501",
    "instruction": "Provide an IAM policy for AWSVPCS2S Vpn Service Role Policy",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"0\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"acm:ExportCertificate\",\n        \"acm:DescribeCertificate\",\n        \"acm:ListCertificates\",\n        \"acm-pca:DescribeCertificateAuthority\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"VpnConnectionSecretsManagement\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"secretsmanager:DescribeSecret\",\n        \"secretsmanager:DeleteSecret\",\n        \"secretsmanager:PutSecretValue\",\n        \"secretsmanager:UpdateSecret\",\n        \"secretsmanager:GetSecretValue\"\n      ],\n      \"Resource\": \"arn:aws:secretsmanager:*:*:secret:s2svpn!*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"secretsmanager:ResourceTag/aws:secretsmanager:owningService\": \"s2svpn\",\n          \"aws:ResourceAccount\": \"${aws:PrincipalAccount}\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"VpnConnectionSecretsCreation\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"secretsmanager:CreateSecret\",\n      \"Resource\": \"arn:aws:secretsmanager:*:*:secret:s2svpn!*\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"secretsmanager:Name\": \"s2svpn!*\"\n        }\n      }\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:Describe*\",\n        \"ec2:Create*\",\n        \"ec2:Delete*\",\n        \"ec2:Modify*\",\n        \"ec2:AuthorizeSecurityGroupIngress\",\n        \"ec2:RevokeSecurityGroupIngress\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:CreateTags\",\n        \"ec2:CreateVpcPeeringConnection\",\n        \"ec2:DeleteTags\",\n        \"ec2:DeleteVpcPeeringConnection\",\n        \"ec2:Describe*\",\n        \"ec2:Modify*\",\n        \"ec2:AcceptVpcPeeringConnection\",\n        \"ec2:RejectVpcPeeringConnection\",\n        \"ec2:TerminateVpcPeeringConnection\"\n      ],\n      \"Resource\": \"*\"\n    }",
    "complexity": "medium"
  },
  {
    "id": "aws_managed_0462",
    "instruction": "Provide an IAM policy for AWS App Mesh Read Only",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"appmesh:Describe*\",\n        \"appmesh:List*\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"cloudformation:DescribeStack*\"\n      ],\n      \"Resource\": \"arn:aws:cloudformation:*:*:stack/AWSAppMesh-GettingStarted-*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"acm:ListCertificates\",\n        \"acm:DescribeCertificate\",\n        \"acm-pca:DescribeCertificateAuthority\",\n        \"acm-pca:ListCertificateAuthorities\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"servicediscovery:ListNamespaces\",\n        \"servicediscovery:ListServices\",\n        \"servicediscovery:ListInstances\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"appmesh:DescribeMesh\",\n        \"appmesh:ListMeshes\",\n        \"appmesh:ListVirtualNodes\",\n        \"appmesh:ListVirtualNodeGroups\",\n        \"appmesh:ListVirtualNodeRules\",\n        \"appmesh:ListVirtualNodeRuleTargets\",\n        \"appmesh:ListVirtualNodeRulesForVirtualNodeGroup\",\n        \"appmesh:ListVirtualNodeRulesForVirtualNode\",\n        \"appmesh:ListVirtualNodeRulesForVirtualNodeGroupAndVirtualNode\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n```\n\n### Explanation:\nThe above policy allows the user to view all resources in the AWS App Mesh service. This includes meshes, virtual nodes, virtual node groups, virtual node rules, and virtual node rule targets. The user can also list virtual node rules for specific virtual node groups or virtual nodes.",
    "complexity": "complex"
  },
  {
    "id": "aws_managed_0664",
    "instruction": "Provide an IAM policy for Elemental Activations Read Only Access",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"elemental-activations:Get*\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}",
    "generated": "```json\n{\n    \"Version\": \"2012-10-17\",\n    \"Statement\": [\n        {\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"elemental:GetActivation\"\n            ],\n            \"Resource\": \"*\"\n        }\n    ]\n}\n```\n\n### Explanation:\nThe `elemental:GetActivation` action is used to retrieve information about an activation. This includes the activation ID, name, and status. It also returns the activation's configuration, which includes the input bucket, output bucket, and other settings.\n\nThis action can be useful for monitoring activations and troubleshooting issues with them. For example, if you are having trouble accessing an activation's output data, you can use this action to check the activation's status and configuration to see if there are any errors or warnings that might be causing the issue.",
    "complexity": "simple"
  },
  {
    "id": "aws_managed_1297",
    "instruction": "Provide an IAM policy for Q Business Quicksight Plugin Policy",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"QBusinessToQuickSightPredictQAResultsInvocation\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"quicksight:PredictQAResults\"\n      ],\n      \"Resource\": [\n        \"arn:aws:quicksight:*:*:topic/*\",\n        \"arn:aws:quicksight:*:*:dashboard/*\"\n      ]\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"quicksight:*\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n```\n\n### Explanation:\nThe following policy allows the QuickSight plugin to perform all actions on all resources. This is a very broad policy, and should only be used in development or testing environments. In production environments, you should create a more restrictive policy that grants the QuickSight plugin only the permissions it needs to perform its intended function.",
    "complexity": "simple"
  },
  {
    "id": "aws_managed_0821",
    "instruction": "Provide an IAM policy for AWS Backup Audit Access",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"backup:CreateFramework\",\n        \"backup:UpdateFramework\",\n        \"backup:ListFrameworks\",\n        \"backup:DescribeFramework\",\n        \"backup:DeleteFramework\",\n        \"backup:ListBackupPlans\",\n        \"backup:ListBackupVaults\",\n        \"backup:CreateReportPlan\",\n        \"backup:UpdateReportPlan\",\n        \"backup:ListReportPlans\",\n        \"backup:DescribeReportPlan\",\n        \"backup:DeleteReportPlan\",\n        \"backup:StartReportJob\",\n        \"backup:ListReportJobs\",\n        \"backup:DescribeReportJob\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"config:DescribeConfigurationRecorders\",\n        \"config:DescribeConfigurationRecorderStatus\",\n        \"config:DescribeComplianceByConfigRule\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"config:GetComplianceDetailsByConfigRule\"\n      ],\n      \"Resource\": \"arn:aws:config:*:*:config-rule/*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:ListAllMyBuckets\",\n        \"s3:GetBucketLocation\"\n      ],\n      \"Resource\": \"arn:aws:s3:::*\"\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"AllowBackupAuditAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"backup:*\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n```\n\n### Explanation:\nThe above policy allows the user to perform all backup related actions on any resource. This is required for the audit access to work properly.\n\n### References:\n* https://docs.aws.amazon.com/AWSBackUp/latest/userguide/backup-audit-access.html",
    "complexity": "complex"
  },
  {
    "id": "aws_managed_0792",
    "instruction": "Provide an IAM policy for AWS Incident Manager Service Role Policy",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"UpdateIncidentRecordPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ssm-incidents:ListIncidentRecords\",\n        \"ssm-incidents:CreateTimelineEvent\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"RelatedOpsItemPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ssm:CreateOpsItem\",\n        \"ssm:AssociateOpsItemRelatedItem\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"IncidentEngagementPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"ssm-contacts:StartEngagement\",\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"PutMetricDataPermission\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"cloudwatch:PutMetricData\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"cloudwatch:namespace\": [\n            \"AWS/IncidentManager\",\n            \"AWS/Usage\"\n          ]\n        }\n      }\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:CreateServiceLinkedRole\",\n        \"iam:GetAccountSummary\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"incidentmanager:DescribeIncidents\",\n        \"incidentmanager:ListIncidents\",\n        \"incidentmanager:ListIncidentTypes\",\n        \"incidentmanager:ListResponders\",\n        \"incidentmanager:ListResponderGroups\",\n        \"incidentmanager:ListResponderRoles\",\n        \"incidentmanager:ListResponderTeams\",\n        \"incidentmanager:ListResponderUsers\",\n        \"incidentmanager:ListResponderWorkflows\",\n        \"incidentmanager:ListTagsForResource\",\n        \"incidentmanager:TagResource\",\n        \"incidentmanager:UntagResource\",\n        \"incidentmanager:UpdateInc",
    "complexity": "complex"
  },
  {
    "id": "aws_managed_0115",
    "instruction": "Provide an IAM policy for AWS Code Pipeline Custom Action Access",
    "expected": "{\n  \"Statement\": [\n    {\n      \"Action\": [\n        \"codepipeline:AcknowledgeJob\",\n        \"codepipeline:GetJobDetails\",\n        \"codepipeline:PollForJobs\",\n        \"codepipeline:PutJobFailureResult\",\n        \"codepipeline:PutJobSuccessResult\"\n      ],\n      \"Effect\": \"Allow\",\n      \"Resource\": \"*\"\n    }\n  ],\n  \"Version\": \"2012-10-17\"\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"codepipeline:*\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:*\",\n        \"ecr:*\",\n        \"ecs:*\",\n        \"ec2:*\",\n        \"logs:*\",\n        \"cloudwatch:*\",\n        \"iam:*\",\n        \"ssm:*\",\n        \"secretsmanager:*\",\n        \"kms:*\",\n        \"autoscaling:*\",\n        \"elasticloadbalancing:*\",\n        \"ecs:Describe*\",\n        \"ecs:List*\",\n        \"ecs:RegisterTaskDefinition\",\n        \"ecs:UpdateService\",\n        \"ecs:DeregisterTaskDefinition\",\n        \"ecs:CreateCluster\",\n        \"ecs:DeleteCluster\",\n        \"ecs:DescribeClusters\",\n        \"ecs:ListCl",
    "complexity": "simple"
  },
  {
    "id": "aws_managed_1218",
    "instruction": "Provide an IAM policy for AWS Service Role For Procurement Insights Policy",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"ProcurementInsightsPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"organizations:DescribeAccount\",\n        \"organizations:DescribeOrganization\",\n        \"organizations:ListAccounts\"\n      ],\n      \"Resource\": [\n        \"*\"\n      ]\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:Describe*\",\n        \"ec2:CreateTags\",\n        \"ec2:DeleteTags\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:*\"\n      ],\n      \"Resource\": [\n        \"arn:aws:s3:::procurementinsights-*\"\n      ]\n    }\n  ]\n}\n```",
    "complexity": "simple"
  },
  {
    "id": "aws_managed_0315",
    "instruction": "Provide an IAM policy for Amazon ES Cognito Access",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"cognito-idp:DescribeUserPool\",\n        \"cognito-idp:CreateUserPoolClient\",\n        \"cognito-idp:DeleteUserPoolClient\",\n        \"cognito-idp:UpdateUserPoolClient\",\n        \"cognito-idp:DescribeUserPoolClient\",\n        \"cognito-idp:AdminInitiateAuth\",\n        \"cognito-idp:AdminUserGlobalSignOut\",\n        \"cognito-idp:ListUserPoolClients\",\n        \"cognito-identity:DescribeIdentityPool\",\n        \"cognito-identity:UpdateIdentityPool\",\n        \"cognito-identity:SetIdentityPoolRoles\",\n        \"cognito-identity:GetIdentityPoolRoles\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"iam:PassRole\",\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"iam:PassedToService\": [\n            \"cognito-identity.amazonaws.com\",\n            \"cognito-identity-us-gov.amazonaws.com\"\n          ]\n        }\n      }\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"es:ESHttpPutRequest\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n```\n\n### Explanation:\nThis policy allows the user to perform `ESHttpPutRequest` actions on all resources. This is required by Amazon ES Cognito Access to be able to create and update indexes in your Elasticsearch domain.\n\n### References:\n* https://docs.aws.amazon.com/elasticsearch-service/latest/developerguide/es-cognito-access.html",
    "complexity": "medium"
  },
  {
    "id": "syn_ec2_007",
    "instruction": "Allow EC2 instances that are tagged with Team=backend to be started, stopped, and rebooted only by users from the backend team",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:StartInstances\",\n        \"ec2:StopInstances\",\n        \"ec2:RebootInstances\"\n      ],\n      \"Resource\": \"arn:aws:ec2:*:*:instance/*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"ec2:ResourceTag/Team\": \"backend\"\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"ec2:DescribeInstances\",\n      \"Resource\": \"*\"\n    }\n  ]\n}",
    "generated": "```\n{\n    \"Version\": \"2012-10-17\",\n    \"Statement\": [\n        {\n            \"Sid\": \"Stmt1496853374000\",\n            \"Effect\": \"Deny\",\n            \"Action\": [\n                \"ec2:StartInstances\",\n                \"ec2:StopInstances\",\n                \"ec2:RebootInstances\"\n            ],\n            \"Resource\": \"*\",\n            \"Condition\": {\n                \"StringNotEquals\": {\n                    \"aws:PrincipalArn\": \"arn:aws:iam::123456789012:user/backend\"\n                }\n            }\n        },\n        {\n            \"Sid\": \"Stmt1496853374001\",\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"ec2:StartInstances\",\n                \"ec2:StopInstances\",\n                \"ec2:RebootInstances\"\n            ],\n            \"Resource\": \"*\",",
    "complexity": "complex"
  },
  {
    "id": "aws_managed_0856",
    "instruction": "Provide an IAM policy for Amazon Dev Ops Guru Organizations Access",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"DevOpsGuruOrganizationsAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"devops-guru:DescribeOrganizationHealth\",\n        \"devops-guru:DescribeOrganizationResourceCollectionHealth\",\n        \"devops-guru:DescribeOrganizationOverview\",\n        \"devops-guru:ListOrganizationInsights\",\n        \"devops-guru:SearchOrganizationInsights\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"OrganizationsDataAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"organizations:DescribeAccount\",\n        \"organizations:DescribeOrganization\",\n        \"organizations:ListAWSServiceAccessForOrganization\",\n        \"organizations:ListAccounts\",\n        \"organizations:ListChildren\",\n        \"organizations:ListOrganizationalUnitsForParent\",\n        \"organizations:ListRoots\"\n      ],\n      \"Resource\": \"arn:aws:organizations::*:\"\n    },\n    {\n      \"Sid\": \"OrganizationsAdminDataAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"organizations:DeregisterDelegatedAdministrator\",\n        \"organizations:RegisterDelegatedAdministrator\",\n        \"organizations:ListDelegatedAdministrators\",\n        \"organizations:EnableAWSServiceAccess\",\n        \"organizations:DisableAWSServiceAccess\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"organizations:ServicePrincipal\": [\n            \"devops-guru.amazonaws.com\"\n          ]\n        }\n      }\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"AllowDevOpsGuruAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"devopsguru:*\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n```\n\n### Explanation:\nThe above policy allows the user to access all actions related to Amazon DevOps Guru. This is a very broad policy and should be used with caution. It is recommended to use this policy only in development or testing environments, where you want to test the functionality of Amazon DevOps Guru without any restrictions. In production environments, it is recommended to create a more specific policy that allows only the necessary actions required by your organization.",
    "complexity": "medium"
  },
  {
    "id": "aws_managed_0613",
    "instruction": "Provide an IAM policy for AWS Thinkbox AWS Portal Gateway Policy",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"logs:PutLogEvents\",\n        \"logs:DescribeLogStreams\",\n        \"logs:DescribeLogGroups\",\n        \"logs:CreateLogStream\"\n      ],\n      \"Resource\": [\n        \"arn:aws:logs:*:*:log-group:/thinkbox*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"logs:CreateLogGroup\"\n      ],\n      \"Resource\": [\n        \"*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:GetObject\",\n        \"s3:PutObject\",\n        \"s3:ListBucket\"\n      ],\n      \"Resource\": [\n        \"arn:aws:s3:::aws-portal-cache*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"dynamodb:Scan\",\n      \"Resource\": [\n        \"arn:aws:dynamodb:*:*:table/DeadlineFleetHealth*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:ListBucket\",\n        \"s3:GetObject\"\n      ],\n      \"Resource\": [\n        \"arn:aws:s3:::stack*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:PutObject\"\n      ],\n      \"Resource\": [\n        \"arn:aws:s3:::stack*/gateway_certs/*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"secretsmanager:GetSecretValue\"\n      ],\n      \"Resource\": [\n        \"arn:aws:secretsmanager:*:*:secret:rcs-tls-pw-stack*\"\n      ]\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:GetRole\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:ListRoles\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n```\n\n### Explanation:\nThe following policy allows the user to list and get roles. This is required by the AWS Thinkbox AWS Portal Gateway.",
    "complexity": "complex"
  },
  {
    "id": "aws_managed_0309",
    "instruction": "Provide an IAM policy for Amazon Route53Auto Naming Read Only Access",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"servicediscovery:Get*\",\n        \"servicediscovery:List*\"\n      ],\n      \"Resource\": [\n        \"*\"\n      ]\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"route53domains:DescribeDomain\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"route53domains:ListDomains\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n```\n\n### Explanation:\nThe following policy allows the user to list and describe domains.\n\n### References:\n* https://docs.aws.amazon.com/Route53/latest/APIReference/API_DescribeDomain.html\n* https://docs.aws.amazon.com/Route53/latest/APIReference/API_ListDomains.html",
    "complexity": "simple"
  },
  {
    "id": "aws_managed_1268",
    "instruction": "Provide an IAM policy for Sage Maker Studio Domain Service Role Policy",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"SSMGetParameterStatement\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ssm:GetParameter\"\n      ],\n      \"Resource\": [\n        \"arn:aws:ssm:*:*:parameter/amazon/datazone/profiles/*\"\n      ]\n    },\n    {\n      \"Sid\": \"UseKMSKeyPermissionsStatement\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"kms:Decrypt\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:ResourceTag/EnableKeyForAmazonDataZone\": \"true\"\n        },\n        \"Null\": {\n          \"aws:ResourceTag/EnableKeyForAmazonDataZone\": \"false\"\n        },\n        \"StringLike\": {\n          \"kms:ViaService\": \"ssm.*.amazonaws.com\",\n          \"kms:EncryptionContext:PARAMETER_ARN\": \"arn:aws:ssm:*:*:parameter/amazon/datazone/profiles*\"\n        }\n      }\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:*\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:CreateServiceLinkedRole\",\n        \"iam:GetRole\",\n        \"iam:ListRoles\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"sagemaker:DescribeNotebookInstance\",\n        \"sagemaker:ListNotebookInstances\",\n        \"sagemaker:StartNotebookInstance\",\n        \"sagemaker:StopNotebookInstance\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n```",
    "complexity": "medium"
  },
  {
    "id": "aws_managed_0164",
    "instruction": "Provide an IAM policy for AWS Marketplace Metering Full Access",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Action\": [\n        \"aws-marketplace:MeterUsage\"\n      ],\n      \"Effect\": \"Allow\",\n      \"Resource\": \"*\"\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"metering:GetMeteringData\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n```\n\n### Explanation:\nThe `metering:GetMeteringData` action is used to retrieve metering data from AWS Marketplace. This action allows you to view usage information for your AWS Marketplace products, such as the number of instances running and the amount of time they have been running.\n\nBy granting this permission, you can monitor the usage of your AWS Marketplace products and ensure that you are not exceeding any usage limits or incurring unexpected costs.",
    "complexity": "simple"
  },
  {
    "id": "aws_managed_0867",
    "instruction": "Provide an IAM policy for AWS Elastic Disaster Recovery Conversion Server Policy",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"DRSConversionServerPolicy1\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"drs:SendClientMetricsForDrs\",\n        \"drs:SendClientLogsForDrs\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"DRSConversionServerPolicy2\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"drs:GetChannelCommandsForDrs\",\n        \"drs:SendChannelCommandResultForDrs\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:CreateTags\",\n        \"ec2:DeleteTags\",\n        \"ec2:Describe*\",\n        \"ec2:ModifyInstanceAttribute\",\n        \"ec2:RunInstances\",\n        \"ec2:TerminateInstances\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:GetRole\",\n        \"iam:ListRoles\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n```",
    "complexity": "medium"
  },
  {
    "id": "aws_managed_0132",
    "instruction": "Provide an IAM policy for Amazon Kinesis Firehose Read Only Access",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Action\": [\n        \"firehose:Describe*\",\n        \"firehose:List*\"\n      ],\n      \"Effect\": \"Allow\",\n      \"Resource\": \"*\"\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"firehose:DescribeDeliveryStream\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"firehose:ListDeliveryStreams\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n```\n\n### Explanation:\nThe above policy allows the user to describe and list delivery streams. This is a read only access to the firehose service.",
    "complexity": "simple"
  },
  {
    "id": "aws_managed_0708",
    "instruction": "Provide an IAM policy for Amazon Sage Maker Admin Service Catalog Products Service Role Policy",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"AmazonSageMakerServiceCatalogAPIGatewayPermission\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"apigateway:GET\",\n        \"apigateway:POST\",\n        \"apigateway:PUT\",\n        \"apigateway:PATCH\",\n        \"apigateway:DELETE\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"aws:ResourceTag/sagemaker:launch-source\": \"*\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"AmazonSageMakerServiceCatalogAPIGatewayPostPermission\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"apigateway:POST\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"ForAnyValue:StringLike\": {\n          \"aws:TagKeys\": [\n            \"sagemaker:launch-source\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"AmazonSageMakerServiceCatalogAPIGatewayPatchPermission\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"apigateway:PATCH\"\n      ],\n      \"Resource\": [\n        \"arn:aws:apigateway:*::/account\"\n      ]\n    },\n    {\n      \"Sid\": \"AmazonSageMakerServiceCatalogCFnMutatePermission\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"cloudformation:CreateStack\",\n        \"cloudformation:UpdateStack\",\n        \"cloudformation:DeleteStack\"\n      ],\n      \"Resource\": \"arn:aws:cloudformation:*:*:stack/SC-*\",\n      \"Condition\": {\n        \"ArnLikeIfExists\": {\n          \"cloudformation:RoleArn\": [\n            \"arn:aws:sts::*:assumed-role/AmazonSageMakerServiceCatalog*\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"AmazonSageMakerServiceCatalogCFnTagPermission\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"cloudformation:TagResource\",\n        \"cloudformation:UntagResource\"\n      ],\n      \"Resource\": \"arn:aws:cloudformation:*:*:stack/SC-*\",\n      \"Condition\": {\n        \"Null\": {\n          \"aws:ResourceTag/sagemaker:project-name\": \"false\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"AmazonSageMakerServiceCatalogCFnReadPermission\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"cloudformation:DescribeStackEvents\",\n        \"cloudformation:DescribeStacks\"\n      ],\n      \"Resource\": \"arn:aws:cloudformation:*:*:stack/SC-*\"\n    },\n    {\n      \"Sid\": \"AmazonSageMakerServiceCatalogCFnTemplatePermission\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"cloudformation:GetTemplateSummary\",\n        \"cloudformation:ValidateTemplate\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"AmazonSageMakerServiceCatalogCodeBuildPermission\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"codebuild:CreateProject\",\n        \"codebuild:DeleteProject\",\n        \"codebuild:UpdateProject\"\n      ],\n      \"Resource\": [\n        \"arn:aws:codebuild:*:*:project/sagemaker-*\"\n      ]\n    },\n    {\n      \"Sid\": \"AmazonSageMakerServiceCatalogCodeCommitPermission\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"codecommit:CreateCommit\",\n        \"codecommit:CreateRepository\",\n        \"codecommit:DeleteRepository\",\n        \"codecommit:GetRepository\",\n        \"codecommit:TagResource\"\n      ],\n      \"Resource\": [\n        \"arn:aws:codecommit:*:*:sagemaker-*\"\n      ]\n    },\n    {\n      \"Sid\": \"AmazonSageMakerServiceCatalogCodeCommitListPermission\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"codecommit:ListRepositories\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"AmazonSageMakerServiceCatalogCodePipelinePermission\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"codepipeline:CreatePipeline\",\n        \"codepipeline:DeletePipeline\",\n        \"codepipeline:GetPipeline\",\n        \"codepipeline:GetPipelineState\",\n        \"codepipeline:StartPipelineExecution\",\n        \"codepipeline:TagResource\",\n        \"codepipeline:UpdatePipeline\"\n      ],\n      \"Resource\": [\n        \"arn:aws:codepipeline:*:*:sagemaker-*\"\n      ]\n    },\n    {\n      \"Sid\": \"AmazonSageMakerServiceCatalogCIAMUserPermission\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"cognito-idp:CreateUserPool\",\n        \"cognito-idp:TagResource\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"ForAnyValue:StringLike\": {\n          \"aws:TagKeys\": [\n            \"sagemaker:launch-source\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"AmazonSageMakerServiceCatalogCIAMPermission\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"cognito-idp:CreateGroup\",\n        \"cognito-idp:CreateUserPoolDomain\",\n        \"cognito-idp:CreateUserPoolClient\",\n        \"cognito-idp:DeleteGroup\",\n        \"cognito-idp:DeleteUserPool\",\n        \"cognito-idp:DeleteUserPoolClient\",\n        \"cognito-idp:DeleteUserPoolDomain\",\n        \"cognito-idp:DescribeUserPool\",\n        \"cognito-idp:DescribeUserPoolClient\",\n        \"cognito-idp:UpdateUserPool\",\n        \"cognito-idp:UpdateUserPoolClient\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"aws:ResourceTag/sagemaker:launch-source\": \"*\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"AmazonSageMakerServiceCatalogECRPermission\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ecr:CreateRepository\",\n        \"ecr:DeleteRepository\",\n        \"ecr:TagResource\"\n      ],\n      \"Resource\": [\n        \"arn:aws:ecr:*:*:repository/sagemaker-*\"\n      ]\n    },\n    {\n      \"Sid\": \"AmazonSageMakerServiceCatalogEventBridgePermission\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"events:DescribeRule\",\n        \"events:DeleteRule\",\n        \"events:DisableRule\",\n        \"events:EnableRule\",\n        \"events:PutRule\",\n        \"events:PutTargets\",\n        \"events:RemoveTargets\"\n      ],\n      \"Resource\": [\n        \"arn:aws:events:*:*:rule/sagemaker-*\"\n      ]\n    },\n    {\n      \"Sid\": \"AmazonSageMakerServiceCatalogFirehosePermission\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"firehose:CreateDeliveryStream\",\n        \"firehose:DeleteDeliveryStream\",\n        \"firehose:DescribeDeliveryStream\",\n        \"firehose:StartDeliveryStreamEncryption\",\n        \"firehose:StopDeliveryStreamEncryption\",\n        \"firehose:UpdateDestination\"\n      ],\n      \"Resource\": \"arn:aws:firehose:*:*:deliverystream/sagemaker-*\"\n    },\n    {\n      \"Sid\": \"AmazonSageMakerServiceCatalogGluePermission\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"glue:CreateDatabase\",\n        \"glue:DeleteDatabase\"\n      ],\n      \"Resource\": [\n        \"arn:aws:glue:*:*:catalog\",\n        \"arn:aws:glue:*:*:database/sagemaker-*\",\n        \"arn:aws:glue:*:*:table/sagemaker-*\",\n        \"arn:aws:glue:*:*:userDefinedFunction/sagemaker-*\"\n      ]\n    },\n    {\n      \"Sid\": \"AmazonSageMakerServiceCatalogGlueClassiferPermission\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"glue:CreateClassifier\",\n        \"glue:DeleteClassifier\",\n        \"glue:DeleteCrawler\",\n        \"glue:DeleteJob\",\n        \"glue:DeleteTrigger\",\n        \"glue:DeleteWorkflow\",\n        \"glue:StopCrawler\"\n      ],\n      \"Resource\": [\n        \"*\"\n      ]\n    },\n    {\n      \"Sid\": \"AmazonSageMakerServiceCatalogGlueWorkflowPermission\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"glue:CreateWorkflow\"\n      ],\n      \"Resource\": [\n        \"arn:aws:glue:*:*:workflow/sagemaker-*\"\n      ]\n    },\n    {\n      \"Sid\": \"AmazonSageMakerServiceCatalogGlueJobPermission\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"glue:CreateJob\"\n      ],\n      \"Resource\": [\n        \"arn:aws:glue:*:*:job/sagemaker-*\"\n      ]\n    },\n    {\n      \"Sid\": \"AmazonSageMakerServiceCatalogGlueCrawlerPermission\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"glue:CreateCrawler\",\n        \"glue:GetCrawler\"\n      ],\n      \"Resource\": [\n        \"arn:aws:glue:*:*:crawler/sagemaker-*\"\n      ]\n    },\n    {\n      \"Sid\": \"AmazonSageMakerServiceCatalogGlueTriggerPermission\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"glue:CreateTrigger\",\n        \"glue:GetTrigger\"\n      ],\n      \"Resource\": [\n        \"arn:aws:glue:*:*:trigger/sagemaker-*\"\n      ]\n    },\n    {\n      \"Sid\": \"AmazonSageMakerServiceCatalogPassRolePermission\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:PassRole\"\n      ],\n      \"Resource\": [\n        \"arn:aws:iam::*:role/service-role/AmazonSageMakerServiceCatalog*\"\n      ]\n    },\n    {\n      \"Sid\": \"AmazonSageMakerServiceCatalogLambdaPermission\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"lambda:AddPermission\",\n        \"lambda:CreateFunction\",\n        \"lambda:DeleteFunction\",\n        \"lambda:GetFunction\",\n        \"lambda:GetFunctionConfiguration\",\n        \"lambda:InvokeFunction\",\n        \"lambda:RemovePermission\"\n      ],\n      \"Resource\": [\n        \"arn:aws:lambda:*:*:function:sagemaker-*\"\n      ]\n    },\n    {\n      \"Sid\": \"AmazonSageMakerServiceCatalogLambdaTagPermission\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"lambda:TagResource\",\n      \"Resource\": [\n        \"arn:aws:lambda:*:*:function:sagemaker-*\"\n      ],\n      \"Condition\": {\n        \"ForAllValues:StringLike\": {\n          \"aws:TagKeys\": [\n            \"sagemaker:*\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"AmazonSageMakerServiceCatalogLogGroupPermission\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"logs:CreateLogGroup\",\n        \"logs:CreateLogStream\",\n        \"logs:DeleteLogGroup\",\n        \"logs:DeleteLogStream\",\n        \"logs:DescribeLogGroups\",\n        \"logs:DescribeLogStreams\",\n        \"logs:PutRetentionPolicy\"\n      ],\n      \"Resource\": [\n        \"arn:aws:logs:*:*:log-group:/aws/apigateway/AccessLogs/*\",\n        \"arn:aws:logs:*:*:log-group::log-stream:*\"\n      ]\n    },\n    {\n      \"Sid\": \"AmazonSageMakerServiceCatalogS3ReadPermission\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"s3:GetObject\",\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"s3:ExistingObjectTag/servicecatalog:provisioning\": \"true\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"AmazonSageMakerServiceCatalogS3ReadSagemakerResourcePermission\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"s3:GetObject\",\n      \"Resource\": [\n        \"arn:aws:s3:::sagemaker-*\"\n      ]\n    },\n    {\n      \"Sid\": \"AmazonSageMakerServiceCatalogS3MutatePermission\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:CreateBucket\",\n        \"s3:DeleteBucket\",\n        \"s3:DeleteBucketPolicy\",\n        \"s3:GetBucketPolicy\",\n        \"s3:PutBucketAcl\",\n        \"s3:PutBucketNotification\",\n        \"s3:PutBucketPolicy\",\n        \"s3:PutBucketPublicAccessBlock\",\n        \"s3:PutBucketLogging\",\n        \"s3:PutEncryptionConfiguration\",\n        \"s3:PutBucketCORS\",\n        \"s3:PutBucketTagging\",\n        \"s3:PutObjectTagging\"\n      ],\n      \"Resource\": \"arn:aws:s3:::sagemaker-*\"\n    },\n    {\n      \"Sid\": \"AmazonSageMakerServiceCatalogSageMakerPermission\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"sagemaker:CreateEndpoint\",\n        \"sagemaker:CreateEndpointConfig\",\n        \"sagemaker:CreateModel\",\n        \"sagemaker:CreateWorkteam\",\n        \"sagemaker:DeleteEndpoint\",\n        \"sagemaker:DeleteEndpointConfig\",\n        \"sagemaker:DeleteModel\",\n        \"sagemaker:DeleteWorkteam\",\n        \"sagemaker:DescribeModel\",\n        \"sagemaker:DescribeEndpointConfig\",\n        \"sagemaker:DescribeEndpoint\",\n        \"sagemaker:DescribeWorkteam\",\n        \"sagemaker:CreateCodeRepository\",\n        \"sagemaker:DescribeCodeRepository\",\n        \"sagemaker:UpdateCodeRepository\",\n        \"sagemaker:DeleteCodeRepository\"\n      ],\n      \"Resource\": [\n        \"arn:aws:sagemaker:*:*:*\"\n      ]\n    },\n    {\n      \"Sid\": \"AmazonSageMakerServiceCatalogSageMakerTagPermission\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"sagemaker:AddTags\"\n      ],\n      \"Resource\": [\n        \"arn:aws:sagemaker:*:*:endpoint/*\",\n        \"arn:aws:sagemaker:*:*:endpoint-config/*\",\n        \"arn:aws:sagemaker:*:*:model/*\",\n        \"arn:aws:sagemaker:*:*:pipeline/*\",\n        \"arn:aws:sagemaker:*:*:project/*\",\n        \"arn:aws:sagemaker:*:*:model-package/*\"\n      ],\n      \"Condition\": {\n        \"ForAllValues:StringLike\": {\n          \"aws:TagKeys\": [\n            \"sagemaker:*\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"AmazonSageMakerServiceCatalogSageMakerImagePermission\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"sagemaker:CreateImage\",\n        \"sagemaker:DeleteImage\",\n        \"sagemaker:DescribeImage\",\n        \"sagemaker:UpdateImage\",\n        \"sagemaker:ListTags\"\n      ],\n      \"Resource\": [\n        \"arn:aws:sagemaker:*:*:image/*\"\n      ]\n    },\n    {\n      \"Sid\": \"AmazonSageMakerServiceCatalogStepFunctionPermission\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"states:CreateStateMachine\",\n        \"states:DeleteStateMachine\",\n        \"states:UpdateStateMachine\"\n      ],\n      \"Resource\": [\n        \"arn:aws:states:*:*:stateMachine:sagemaker-*\"\n      ]\n    },\n    {\n      \"Sid\": \"AmazonSageMakerServiceCatalogCodeStarPermission\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"codestar-connections:PassConnection\",\n      \"Resource\": [\n        \"arn:aws:codestar-connections:*:*:connection/*\",\n        \"arn:aws:codeconnections:*:*:connection/*\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"codestar-connections:PassedToService\": \"codepipeline.amazonaws.com\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"AmazonSageMakerServiceCatalogCodeConnectionPermission\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"codeconnections:PassConnection\",\n      \"Resource\": [\n        \"arn:aws:codeconnections:*:*:connection/*\",\n        \"arn:aws:codestar-connections:*:*:connection/*\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"codeconnections:PassedToService\": \"codepipeline.amazonaws.com\"\n        }\n      }\n    }\n  ]\n}",
    "generated": "```json\n{\n    \"Version\": \"2012-10-17\",\n    \"Statement\": [\n        {\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"sagemaker:*\"\n            ],\n            \"Resource\": \"*\"\n        },\n        {\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"iam:CreateServiceLinkedRole\",\n                \"iam:GetRole\",\n                \"iam:ListRoles\"\n            ],\n            \"Resource\": \"*\"\n        }\n    ]\n}\n```\n\n### Explanation:\nThe following policy grants the service role permissions to create, update, and delete Amazon SageMaker resources. It also allows the service role to assume a service-linked role that is used by Amazon SageMaker to access other AWS services on your behalf.\n\nThe `sagemaker:*` action allows the service role to perform all actions related to Amazon SageMaker. This includes creating, updating, and deleting Amazon SageMaker resources such as notebook instances, training jobs, and models.\n\nThe `iam:CreateService",
    "complexity": "complex"
  },
  {
    "id": "aws_managed_0313",
    "instruction": "Provide an IAM policy for AWS Service Catalog End User Full Access",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"cloudformation:CreateStack\",\n        \"cloudformation:DeleteStack\",\n        \"cloudformation:DescribeStackEvents\",\n        \"cloudformation:DescribeStacks\",\n        \"cloudformation:SetStackPolicy\",\n        \"cloudformation:ValidateTemplate\",\n        \"cloudformation:UpdateStack\",\n        \"cloudformation:CreateChangeSet\",\n        \"cloudformation:DescribeChangeSet\",\n        \"cloudformation:ExecuteChangeSet\",\n        \"cloudformation:ListChangeSets\",\n        \"cloudformation:DeleteChangeSet\",\n        \"cloudformation:TagResource\",\n        \"cloudformation:CreateStackSet\",\n        \"cloudformation:CreateStackInstances\",\n        \"cloudformation:UpdateStackSet\",\n        \"cloudformation:UpdateStackInstances\",\n        \"cloudformation:DeleteStackSet\",\n        \"cloudformation:DeleteStackInstances\",\n        \"cloudformation:DescribeStackSet\",\n        \"cloudformation:DescribeStackInstance\",\n        \"cloudformation:DescribeStackSetOperation\",\n        \"cloudformation:ListStackInstances\",\n        \"cloudformation:ListStackResources\",\n        \"cloudformation:ListStackSetOperations\",\n        \"cloudformation:ListStackSetOperationResults\"\n      ],\n      \"Resource\": [\n        \"arn:aws:cloudformation:*:*:stack/SC-*\",\n        \"arn:aws:cloudformation:*:*:stack/StackSet-SC-*\",\n        \"arn:aws:cloudformation:*:*:changeSet/SC-*\",\n        \"arn:aws:cloudformation:*:*:stackset/SC-*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"cloudformation:GetTemplateSummary\",\n        \"servicecatalog:DescribeProduct\",\n        \"servicecatalog:DescribeProductView\",\n        \"servicecatalog:DescribeProvisioningParameters\",\n        \"servicecatalog:ListLaunchPaths\",\n        \"servicecatalog:ProvisionProduct\",\n        \"servicecatalog:SearchProducts\",\n        \"ssm:DescribeDocument\",\n        \"ssm:GetAutomationExecution\",\n        \"config:DescribeConfigurationRecorders\",\n        \"config:DescribeConfigurationRecorderStatus\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"servicecatalog:DescribeProvisionedProduct\",\n        \"servicecatalog:DescribeRecord\",\n        \"servicecatalog:ListRecordHistory\",\n        \"servicecatalog:ListStackInstancesForProvisionedProduct\",\n        \"servicecatalog:ScanProvisionedProducts\",\n        \"servicecatalog:TerminateProvisionedProduct\",\n        \"servicecatalog:UpdateProvisionedProduct\",\n        \"servicecatalog:SearchProvisionedProducts\",\n        \"servicecatalog:CreateProvisionedProductPlan\",\n        \"servicecatalog:DescribeProvisionedProductPlan\",\n        \"servicecatalog:ExecuteProvisionedProductPlan\",\n        \"servicecatalog:DeleteProvisionedProductPlan\",\n        \"servicecatalog:ListProvisionedProductPlans\",\n        \"servicecatalog:ListServiceActionsForProvisioningArtifact\",\n        \"servicecatalog:ExecuteProvisionedProductServiceAction\",\n        \"servicecatalog:DescribeServiceActionExecutionParameters\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"servicecatalog:userLevel\": \"self\"\n        }\n      }\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"catalog:*\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n```\n\n### Explanation:\nThe above policy allows the user to perform all actions on the AWS Service Catalog. This is useful if you want to give a user full access to the AWS Service Catalog, without having to create a custom policy.\n\n### References:\n[AWS Service Catalog](https://docs.aws.amazon.com/service-catalog/latest/adminguide/welcome.html)",
    "complexity": "complex"
  },
  {
    "id": "aws_managed_0038",
    "instruction": "Provide an IAM policy for Amazon Mobile Analytics Write Only Access",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"mobileanalytics:PutEvents\",\n      \"Resource\": \"*\"\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"mobileanalytics:PutEvents\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n```\n\n### Explanation:\nThe above policy allows the user to write events to Amazon Mobile Analytics.\n\n### References:\n* [Amazon Mobile Analytics API Reference](https://docs.aws.amazon.com/mobileanalytics/latest/APIReference/Welcome.html)\n* [AWS Policy Generator](https://policymaker.io/)",
    "complexity": "simple"
  },
  {
    "id": "syn_misc_003",
    "instruction": "give full access to route53 for managing DNS records",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"route53:ChangeResourceRecordSets\",\n        \"route53:GetHostedZone\",\n        \"route53:ListHostedZones\",\n        \"route53:ListResourceRecordSets\",\n        \"route53:GetChange\",\n        \"route53:CreateHostedZone\",\n        \"route53:DeleteHostedZone\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}",
    "generated": "```\n{\n    \"Policy\": {\n        \"Version\": \"2012-10-17\",\n        \"Statement\": [\n            {\n                \"Effect\": \"Allow\",\n                \"Principal\": {\n                    \"AWS\": \"arn:aws:iam::123456789012:root\"\n                },\n                \"Action\": \"route53:*\",\n                \"Resource\": \"*\"\n            }\n        ]\n    }\n}\n```\n\n### Explanation:\nThe policy allows the root user of account 123456789012 to perform any action on Route53. The `*` in the resource section means that the policy applies to all resources in Route53.",
    "complexity": "simple"
  },
  {
    "id": "aws_managed_0875",
    "instruction": "Provide an IAM policy for Amazon Braket Jobs Execution Policy",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:GetObject\",\n        \"s3:PutObject\",\n        \"s3:ListBucket\",\n        \"s3:CreateBucket\",\n        \"s3:PutBucketPublicAccessBlock\",\n        \"s3:PutBucketPolicy\"\n      ],\n      \"Resource\": \"arn:aws:s3:::amazon-braket-*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ecr:GetDownloadUrlForLayer\",\n        \"ecr:BatchGetImage\",\n        \"ecr:BatchCheckLayerAvailability\"\n      ],\n      \"Resource\": \"arn:aws:ecr:*:*:repository/amazon-braket*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ecr:GetAuthorizationToken\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"braket:CancelJob\",\n        \"braket:CancelQuantumTask\",\n        \"braket:CreateJob\",\n        \"braket:CreateQuantumTask\",\n        \"braket:GetDevice\",\n        \"braket:GetJob\",\n        \"braket:GetQuantumTask\",\n        \"braket:SearchDevices\",\n        \"braket:SearchJobs\",\n        \"braket:SearchQuantumTasks\",\n        \"braket:ListTagsForResource\",\n        \"braket:TagResource\",\n        \"braket:UntagResource\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:PassRole\"\n      ],\n      \"Resource\": \"arn:aws:iam::*:role/service-role/AmazonBraketJobsExecutionRole*\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"iam:PassedToService\": [\n            \"braket.amazonaws.com\"\n          ]\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:ListRoles\"\n      ],\n      \"Resource\": \"arn:aws:iam::*:role/*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"logs:GetQueryResults\"\n      ],\n      \"Resource\": [\n        \"arn:aws:logs:*:*:log-group:*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"logs:PutLogEvents\",\n        \"logs:CreateLogStream\",\n        \"logs:CreateLogGroup\",\n        \"logs:GetLogEvents\",\n        \"logs:DescribeLogStreams\",\n        \"logs:StartQuery\",\n        \"logs:StopQuery\"\n      ],\n      \"Resource\": \"arn:aws:logs:*:*:log-group:/aws/braket*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"cloudwatch:PutMetricData\",\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"cloudwatch:namespace\": \"/aws/braket\"\n        }\n      }\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"braket:*\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n```\n\n### Explanation:\nThis policy allows all actions on the Braket service. This is required to execute jobs on the service.\n\n### References:\n* https://docs.aws.amazon.com/braket/latest/APIReference/API_CreateJob.html\n* https://docs.aws.amazon.com/braket/latest/APIReference/API_ListJobs.html\n* https://docs.aws.amazon.com/braket/latest/APIReference/API_GetJob.html",
    "complexity": "complex"
  },
  {
    "id": "aws_managed_0467",
    "instruction": "Provide an IAM policy for AWS Control Tower Service Role Policy",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"cloudformation:CreateStack\",\n        \"cloudformation:CreateStackInstances\",\n        \"cloudformation:CreateStackSet\",\n        \"cloudformation:DeleteStack\",\n        \"cloudformation:DeleteStackInstances\",\n        \"cloudformation:DeleteStackSet\",\n        \"cloudformation:DescribeStackInstance\",\n        \"cloudformation:DescribeStacks\",\n        \"cloudformation:DescribeStackSet\",\n        \"cloudformation:DescribeStackSetOperation\",\n        \"cloudformation:ListStackInstances\",\n        \"cloudformation:UpdateStack\",\n        \"cloudformation:UpdateStackInstances\",\n        \"cloudformation:UpdateStackSet\"\n      ],\n      \"Resource\": [\n        \"arn:aws:cloudformation:*:*:type/resource/AWS-IAM-Role\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"cloudformation:CreateStack\",\n        \"cloudformation:CreateStackInstances\",\n        \"cloudformation:CreateStackSet\",\n        \"cloudformation:DeleteStack\",\n        \"cloudformation:DeleteStackInstances\",\n        \"cloudformation:DeleteStackSet\",\n        \"cloudformation:DescribeStackInstance\",\n        \"cloudformation:DescribeStacks\",\n        \"cloudformation:DescribeStackSet\",\n        \"cloudformation:DescribeStackSetOperation\",\n        \"cloudformation:GetTemplate\",\n        \"cloudformation:ListStackInstances\",\n        \"cloudformation:UpdateStack\",\n        \"cloudformation:UpdateStackInstances\",\n        \"cloudformation:UpdateStackSet\"\n      ],\n      \"Resource\": [\n        \"arn:aws:cloudformation:*:*:stack/AWSControlTower*/*\",\n        \"arn:aws:cloudformation:*:*:stack/StackSet-AWSControlTower*/*\",\n        \"arn:aws:cloudformation:*:*:stackset/AWSControlTower*:*\",\n        \"arn:aws:cloudformation:*:*:stackset-target/AWSControlTower*/*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"cloudtrail:CreateTrail\",\n        \"cloudtrail:DeleteTrail\",\n        \"cloudtrail:GetTrailStatus\",\n        \"cloudtrail:StartLogging\",\n        \"cloudtrail:StopLogging\",\n        \"cloudtrail:UpdateTrail\",\n        \"cloudtrail:PutEventSelectors\",\n        \"logs:CreateLogStream\",\n        \"logs:PutLogEvents\",\n        \"logs:PutRetentionPolicy\"\n      ],\n      \"Resource\": [\n        \"arn:aws:logs:*:*:log-group:aws-controltower/CloudTrailLogs*:*\",\n        \"arn:aws:cloudtrail:*:*:trail/aws-controltower*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:GetObject\"\n      ],\n      \"Resource\": [\n        \"arn:aws:s3:::aws-controltower*/*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"sts:AssumeRole\"\n      ],\n      \"Resource\": [\n        \"arn:aws:iam::*:role/AWSControlTowerExecution\",\n        \"arn:aws:iam::*:role/AWSControlTowerBlueprintAccess\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"cloudtrail:DescribeTrails\",\n        \"ec2:DescribeAvailabilityZones\",\n        \"iam:ListRoles\",\n        \"logs:CreateLogGroup\",\n        \"logs:DescribeLogGroups\",\n        \"organizations:CreateAccount\",\n        \"organizations:DescribeAccount\",\n        \"organizations:DescribeCreateAccountStatus\",\n        \"organizations:DescribeOrganization\",\n        \"organizations:DescribeOrganizationalUnit\",\n        \"organizations:DescribePolicy\",\n        \"organizations:ListAccounts\",\n        \"organizations:ListAccountsForParent\",\n        \"organizations:ListAWSServiceAccessForOrganization\",\n        \"organizations:ListChildren\",\n        \"organizations:ListOrganizationalUnitsForParent\",\n        \"organizations:ListParents\",\n        \"organizations:ListPoliciesForTarget\",\n        \"organizations:ListTargetsForPolicy\",\n        \"organizations:ListRoots\",\n        \"organizations:MoveAccount\",\n        \"servicecatalog:AssociatePrincipalWithPortfolio\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:GetRole\",\n        \"iam:GetUser\",\n        \"iam:ListAttachedRolePolicies\",\n        \"iam:GetRolePolicy\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:PassRole\"\n      ],\n      \"Resource\": [\n        \"arn:aws:iam::*:role/service-role/AWSControlTowerStackSetRole\",\n        \"arn:aws:iam::*:role/service-role/AWSControlTowerCloudTrailRole\",\n        \"arn:aws:iam::*:role/service-role/AWSControlTowerConfigAggregatorRoleForOrganizations\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"config:DeleteConfigurationAggregator\",\n        \"config:PutConfigurationAggregator\",\n        \"config:TagResource\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:ResourceTag/aws-control-tower\": \"managed-by-control-tower\"\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"organizations:EnableAWSServiceAccess\",\n        \"organizations:DisableAWSServiceAccess\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"organizations:ServicePrincipal\": [\n            \"config.amazonaws.com\",\n            \"cloudtrail.amazonaws.com\"\n          ]\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"iam:CreateServiceLinkedRole\",\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"iam:AWSServiceName\": \"cloudtrail.amazonaws.com\"\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"account:EnableRegion\",\n        \"account:ListRegions\",\n        \"account:GetRegionOptStatus\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"AllowActionsForCloudFormationHooksIntegration\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"cloudformation:SetTypeConfiguration\",\n        \"cloudformation:DeactivateType\",\n        \"cloudformation:ActivateType\"\n      ],\n      \"Resource\": \"arn:aws:cloudformation:*:*:type/hook/AWS-ControlTower*\"\n    },\n    {\n      \"Sid\": \"AllowActionsForCloudFormationStackSetOrganizationsTrustedAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"cloudformation:ActivateOrganizationsAccess\",\n        \"cloudformation:DescribeOrganizationsAccess\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:CreateServiceLinkedRole\",\n        \"iam:GetAccountSummary\",\n        \"iam:ListAccountAliases\",\n        \"iam:ListAttachedRoles\",\n        \"iam:ListAttachedRolePolicies\",\n        \"iam:ListInstanceProfiles\",\n        \"iam:ListRolePolicies\",\n        \"iam:ListRoles\",\n        \"iam:ListServerCertificates\",\n        \"iam:ListUserPolicies\",\n        \"iam:ListUsers\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"organizations:DescribeOrganization\",\n        \"organizations:ListAccounts\",\n        \"organizations:ListAwsAccounts\",\n        \"organizations:ListRoots\",\n        \"organizations:ListTrails\",\n        \"organizations:ListTagsForResource\",\n        \"organizations:TagResource\"",
    "complexity": "complex"
  },
  {
    "id": "aws_managed_0732",
    "instruction": "Provide an IAM policy for EC2Instance Profile For Image Builder ECR Container Builds",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"imagebuilder:GetComponent\",\n        \"imagebuilder:GetContainerRecipe\",\n        \"ecr:GetAuthorizationToken\",\n        \"ecr:BatchGetImage\",\n        \"ecr:InitiateLayerUpload\",\n        \"ecr:UploadLayerPart\",\n        \"ecr:CompleteLayerUpload\",\n        \"ecr:BatchCheckLayerAvailability\",\n        \"ecr:GetDownloadUrlForLayer\",\n        \"ecr:PutImage\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"kms:Decrypt\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"ForAnyValue:StringEquals\": {\n          \"kms:EncryptionContextKeys\": \"aws:imagebuilder:arn\",\n          \"aws:CalledVia\": [\n            \"imagebuilder.amazonaws.com\"\n          ]\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:GetObject\"\n      ],\n      \"Resource\": \"arn:aws:s3:::ec2imagebuilder*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"logs:CreateLogStream\",\n        \"logs:CreateLogGroup\",\n        \"logs:PutLogEvents\"\n      ],\n      \"Resource\": \"arn:aws:logs:*:*:log-group:/aws/imagebuilder/*\"\n    }\n  ]\n}",
    "generated": "```json\n{\n    \"Version\": \"2012-10-17\",\n    \"Statement\": [\n        {\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"ecr:GetAuthorizationToken\",\n                \"ecr:BatchCheckLayerAvailability\",\n                \"ecr:GetDownloadUrlForLayer\",\n                \"ecr:BatchGetImage\",\n                \"ecr:InitiateLayerUpload\",\n                \"ecr:UploadLayerPart\"\n            ],\n            \"Resource\": \"*\"\n        },\n        {\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"ecr:DescribeRepositories\",\n                \"ecr:ListImages\",\n                \"ecr:DescribeImages\",\n                \"ecr:BatchDescribeImages\",\n                \"ecr:GetRepositoryPolicy\",\n                \"ecr:GetLifecyclePolicy\",\n                \"ecr:GetRepositoryPolicyStatus\",\n                \"ecr:GetLifecyclePolicyStatus\",\n                \"ecr:SetRepositoryPolicy\",\n                \"ecr:Set",
    "complexity": "complex"
  },
  {
    "id": "aws_managed_1309",
    "instruction": "Provide an IAM policy for AWS Elemental Media Connect Read Only Access",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"mediaconnect:ListBridges\",\n        \"mediaconnect:ListEntitlements\",\n        \"mediaconnect:ListFlows\",\n        \"mediaconnect:ListGatewayInstances\",\n        \"mediaconnect:ListGateways\",\n        \"mediaconnect:ListOfferings\",\n        \"mediaconnect:ListReservations\",\n        \"mediaconnect:DescribeBridge\",\n        \"mediaconnect:DescribeFlow\",\n        \"mediaconnect:DescribeFlowSourceMetadata\",\n        \"mediaconnect:DescribeFlowSourceThumbnail\",\n        \"mediaconnect:DescribeGateway\",\n        \"mediaconnect:DescribeGatewayInstance\",\n        \"mediaconnect:DescribeOffering\",\n        \"mediaconnect:DescribeReservation\",\n        \"mediaconnect:ListTagsForResource\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:Describe*\",\n        \"ec2:Get*\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:ListRoles\",\n        \"iam:ListRolePolicies\",\n        \"iam:ListPolicyVersions\",\n        \"iam:ListAttachedRolePolicies\",\n        \"iam:ListAttachedUserPolicies\",\n        \"iam:ListAttachedGroupPolicies\",\n        \"iam:ListAttachedRolePolicies\",\n        \"iam:ListAttachedUserPolicies\",\n        \"iam:ListAttachedGroupPolicies\",\n        \"iam:ListAttachedRolePolicies\",\n        \"iam:ListAttachedUserPolicies\",\n        \"iam:ListAttachedGroupPolicies\",\n        \"iam:ListAttachedRolePolicies\",\n        \"iam:ListAttachedUserPolicies\",\n        \"",
    "complexity": "simple"
  },
  {
    "id": "aws_managed_0306",
    "instruction": "Provide an IAM policy for AWS Elemental Media Package Read Only",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": {\n    \"Effect\": \"Allow\",\n    \"Action\": [\n      \"mediapackage:List*\",\n      \"mediapackage:Describe*\"\n    ],\n    \"Resource\": \"*\"\n  }\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"mediapackage:*\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n```\n\n### Explanation:\nThis policy allows all actions on the MediaPackage service. This is a read only policy, so it does not allow any write operations.\n\n### References:\n* https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_examples_media-package.html\n* https://docs.aws.amazon.com/mediapackage/latest/ug/what-is.html",
    "complexity": "simple"
  },
  {
    "id": "aws_managed_1384",
    "instruction": "Provide an IAM policy for Amazon EC2Image References Access Policy",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"ec2:DescribeImageReferences\",\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:DescribeInstances\",\n        \"ec2:DescribeLaunchTemplates\",\n        \"ec2:DescribeLaunchTemplateVersions\",\n        \"ssm:DescribeParameters\",\n        \"ssm:GetParameters\",\n        \"imagebuilder:ListImageRecipes\",\n        \"imagebuilder:ListContainerRecipes\",\n        \"imagebuilder:GetContainerRecipe\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"ForAnyValue:StringEquals\": {\n          \"aws:CalledVia\": [\n            \"ec2-images.amazonaws.com\"\n          ]\n        }\n      }\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:DescribeImages\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n```\n\n### Explanation:\nThe above policy allows the user to describe images. This is required in order to use the AWS CLI to list available AMI's.\n\n### Reference:\nhttps://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-images.html#image-list",
    "complexity": "medium"
  },
  {
    "id": "aws_managed_1092",
    "instruction": "Provide an IAM policy for Amazon Sage Maker Partner Service Catalog Products Cloud Formation Service Role Policy",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:PassRole\"\n      ],\n      \"Resource\": [\n        \"arn:aws:iam::*:role/service-role/AmazonSageMakerServiceCatalogProductsLambdaRole\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"iam:PassedToService\": \"lambda.amazonaws.com\"\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:PassRole\"\n      ],\n      \"Resource\": [\n        \"arn:aws:iam::*:role/service-role/AmazonSageMakerServiceCatalogProductsApiGatewayRole\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"iam:PassedToService\": \"apigateway.amazonaws.com\"\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"lambda:DeleteFunction\",\n        \"lambda:UpdateFunctionCode\",\n        \"lambda:ListTags\",\n        \"lambda:InvokeFunction\"\n      ],\n      \"Resource\": [\n        \"arn:aws:lambda:*:*:function:sagemaker-*\"\n      ],\n      \"Condition\": {\n        \"Null\": {\n          \"aws:ResourceTag/sagemaker:project-name\": \"false\",\n          \"aws:ResourceTag/sagemaker:partner\": \"false\"\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"lambda:CreateFunction\",\n        \"lambda:TagResource\"\n      ],\n      \"Resource\": [\n        \"arn:aws:lambda:*:*:function:sagemaker-*\"\n      ],\n      \"Condition\": {\n        \"Null\": {\n          \"aws:ResourceTag/sagemaker:project-name\": \"false\",\n          \"aws:ResourceTag/sagemaker:partner\": \"false\"\n        },\n        \"ForAnyValue:StringEquals\": {\n          \"aws:TagKeys\": [\n            \"sagemaker:project-name\",\n            \"sagemaker:partner\"\n          ]\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"lambda:PublishLayerVersion\",\n        \"lambda:GetLayerVersion\",\n        \"lambda:DeleteLayerVersion\",\n        \"lambda:GetFunction\"\n      ],\n      \"Resource\": [\n        \"arn:aws:lambda:*:*:layer:sagemaker-*\",\n        \"arn:aws:lambda:*:*:function:sagemaker-*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"apigateway:GET\",\n        \"apigateway:DELETE\",\n        \"apigateway:PATCH\",\n        \"apigateway:POST\",\n        \"apigateway:PUT\"\n      ],\n      \"Resource\": [\n        \"arn:aws:apigateway:*::/restapis/*\",\n        \"arn:aws:apigateway:*::/restapis\"\n      ],\n      \"Condition\": {\n        \"Null\": {\n          \"aws:ResourceTag/sagemaker:project-name\": \"false\",\n          \"aws:ResourceTag/sagemaker:partner\": \"false\"\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"apigateway:POST\",\n        \"apigateway:PUT\"\n      ],\n      \"Resource\": [\n        \"arn:aws:apigateway:*::/restapis\",\n        \"arn:aws:apigateway:*::/tags/*\"\n      ],\n      \"Condition\": {\n        \"Null\": {\n          \"aws:ResourceTag/sagemaker:project-name\": \"false\",\n          \"aws:ResourceTag/sagemaker:partner\": \"false\"\n        },\n        \"ForAnyValue:StringEquals\": {\n          \"aws:TagKeys\": [\n            \"sagemaker:project-name\",\n            \"sagemaker:partner\"\n          ]\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:GetObject\"\n      ],\n      \"Resource\": [\n        \"arn:aws:s3:::sagemaker-*/lambda-auth-code/layer.zip\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:ResourceAccount\": \"${aws:PrincipalAccount}\"\n        }\n      }\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"sagemaker:*\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n```\n\n### Explanation:\nThe above policy allows the user to perform any action on the Amazon SageMaker service. This is necessary because the Partner Service Catalog Product will create a new role with this policy attached, and that role will be used by the CloudFormation stack to create resources in Amazon SageMaker. By allowing all actions on the service, we ensure that the CloudFormation stack can create the necessary resources without being blocked by any restrictions in the policy.",
    "complexity": "complex"
  },
  {
    "id": "aws_managed_0027",
    "instruction": "Provide an IAM policy for Amazon Elastic Map Reduce Full Access",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Action\": [\n        \"cloudwatch:*\",\n        \"cloudformation:CreateStack\",\n        \"cloudformation:DescribeStackEvents\",\n        \"ec2:AuthorizeSecurityGroupIngress\",\n        \"ec2:AuthorizeSecurityGroupEgress\",\n        \"ec2:CancelSpotInstanceRequests\",\n        \"ec2:CreateRoute\",\n        \"ec2:CreateSecurityGroup\",\n        \"ec2:CreateTags\",\n        \"ec2:DeleteRoute\",\n        \"ec2:DeleteTags\",\n        \"ec2:DeleteSecurityGroup\",\n        \"ec2:DescribeAvailabilityZones\",\n        \"ec2:DescribeAccountAttributes\",\n        \"ec2:DescribeInstances\",\n        \"ec2:DescribeKeyPairs\",\n        \"ec2:DescribeRouteTables\",\n        \"ec2:DescribeSecurityGroups\",\n        \"ec2:DescribeSpotInstanceRequests\",\n        \"ec2:DescribeSpotPriceHistory\",\n        \"ec2:DescribeSubnets\",\n        \"ec2:DescribeVpcAttribute\",\n        \"ec2:DescribeVpcs\",\n        \"ec2:DescribeRouteTables\",\n        \"ec2:DescribeNetworkAcls\",\n        \"ec2:CreateVpcEndpoint\",\n        \"ec2:ModifyImageAttribute\",\n        \"ec2:ModifyInstanceAttribute\",\n        \"ec2:RequestSpotInstances\",\n        \"ec2:RevokeSecurityGroupEgress\",\n        \"ec2:RunInstances\",\n        \"ec2:TerminateInstances\",\n        \"elasticmapreduce:*\",\n        \"iam:GetPolicy\",\n        \"iam:GetPolicyVersion\",\n        \"iam:ListRoles\",\n        \"iam:PassRole\",\n        \"kms:List*\",\n        \"s3:*\",\n        \"sdb:*\"\n      ],\n      \"Effect\": \"Allow\",\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"iam:CreateServiceLinkedRole\",\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"iam:AWSServiceName\": [\n            \"elasticmapreduce.amazonaws.com\",\n            \"elasticmapreduce.amazonaws.com.cn\"\n          ]\n        }\n      }\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"elasticmapreduce:*\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n```\n\n### Explanation:\nThis policy allows the user to perform all actions on Amazon EMR. This is a very broad policy and should only be used in limited circumstances.\n\n### References:\n* https://docs.aws.amazon.com/emr/latest/ManagementGuide/emr-security_iam.html",
    "complexity": "complex"
  },
  {
    "id": "aws_managed_0710",
    "instruction": "Provide an IAM policy for AWS Panorama Greengrass Group Role Policy",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"PanoramaS3Access\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:ListBucket\",\n        \"s3:GetBucket*\",\n        \"s3:GetObject\",\n        \"s3:PutObject\"\n      ],\n      \"Resource\": [\n        \"arn:aws:s3:::*aws-panorama*\"\n      ]\n    },\n    {\n      \"Sid\": \"PanoramaCLoudWatchPutDashboard\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"cloudwatch:PutDashboard\",\n      \"Resource\": [\n        \"arn:aws:cloudwatch::*:dashboard/panorama*\"\n      ]\n    },\n    {\n      \"Sid\": \"PanoramaCloudWatchPutMetricData\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"cloudwatch:PutMetricData\",\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"PanoramaGreenGrassCloudWatchAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"logs:CreateLogStream\",\n        \"logs:DescribeLogStreams\",\n        \"logs:PutLogEvents\",\n        \"logs:CreateLogGroup\"\n      ],\n      \"Resource\": \"arn:aws:logs:*:*:log-group:/aws/greengrass/*\"\n    },\n    {\n      \"Sid\": \"PanoramaAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"panorama:*\"\n      ],\n      \"Resource\": [\n        \"*\"\n      ]\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iot:*\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:Describe*\",\n        \"ec2:CreateTags\",\n        \"ec2:DeleteTags\",\n        \"ec2:AttachVolume\",\n        \"ec2:DetachVolume\",\n        \"ec2:ModifyInstanceMetadataOptions\",\n        \"ec2:CreateSecurityGroup\",\n        \"ec2:AuthorizeSecurityGroupIngress\",\n        \"ec2:RevokeSecurityGroupIngress\",\n        \"ec2:DeleteSecurityGroup\",\n        \"ec2:Describe*\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:GetObject\",\n        \"s3:PutObject\",\n        \"s3:ListBucket\",\n        \"s3",
    "complexity": "complex"
  },
  {
    "id": "aws_managed_0267",
    "instruction": "Provide an IAM policy for Amazon ECS Full Access",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"ECSIntegrationsManagementPolicy\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"application-autoscaling:DeleteScalingPolicy\",\n        \"application-autoscaling:DeregisterScalableTarget\",\n        \"application-autoscaling:DescribeScalableTargets\",\n        \"application-autoscaling:DescribeScalingActivities\",\n        \"application-autoscaling:DescribeScalingPolicies\",\n        \"application-autoscaling:PutScalingPolicy\",\n        \"application-autoscaling:RegisterScalableTarget\",\n        \"appmesh:DescribeVirtualGateway\",\n        \"appmesh:DescribeVirtualNode\",\n        \"appmesh:ListMeshes\",\n        \"appmesh:ListVirtualGateways\",\n        \"appmesh:ListVirtualNodes\",\n        \"autoscaling:CreateAutoScalingGroup\",\n        \"autoscaling:CreateLaunchConfiguration\",\n        \"autoscaling:DeleteAutoScalingGroup\",\n        \"autoscaling:DeleteLaunchConfiguration\",\n        \"autoscaling:Describe*\",\n        \"autoscaling:UpdateAutoScalingGroup\",\n        \"cloudformation:CreateStack\",\n        \"cloudformation:DeleteStack\",\n        \"cloudformation:DescribeStack*\",\n        \"cloudformation:UpdateStack\",\n        \"cloudwatch:DeleteAlarms\",\n        \"cloudwatch:DescribeAlarms\",\n        \"cloudwatch:GetMetricStatistics\",\n        \"cloudwatch:PutMetricAlarm\",\n        \"codedeploy:BatchGetApplicationRevisions\",\n        \"codedeploy:BatchGetApplications\",\n        \"codedeploy:BatchGetDeploymentGroups\",\n        \"codedeploy:BatchGetDeployments\",\n        \"codedeploy:ContinueDeployment\",\n        \"codedeploy:CreateApplication\",\n        \"codedeploy:CreateDeployment\",\n        \"codedeploy:CreateDeploymentGroup\",\n        \"codedeploy:GetApplication\",\n        \"codedeploy:GetApplicationRevision\",\n        \"codedeploy:GetDeployment\",\n        \"codedeploy:GetDeploymentConfig\",\n        \"codedeploy:GetDeploymentGroup\",\n        \"codedeploy:GetDeploymentTarget\",\n        \"codedeploy:ListApplicationRevisions\",\n        \"codedeploy:ListApplications\",\n        \"codedeploy:ListDeploymentConfigs\",\n        \"codedeploy:ListDeploymentGroups\",\n        \"codedeploy:ListDeployments\",\n        \"codedeploy:ListDeploymentTargets\",\n        \"codedeploy:RegisterApplicationRevision\",\n        \"codedeploy:StopDeployment\",\n        \"ec2:AssociateRouteTable\",\n        \"ec2:AttachInternetGateway\",\n        \"ec2:AuthorizeSecurityGroupIngress\",\n        \"ec2:CancelSpotFleetRequests\",\n        \"ec2:CreateInternetGateway\",\n        \"ec2:CreateLaunchTemplate\",\n        \"ec2:CreateRoute\",\n        \"ec2:CreateRouteTable\",\n        \"ec2:CreateSecurityGroup\",\n        \"ec2:CreateSubnet\",\n        \"ec2:CreateVpc\",\n        \"ec2:DeleteLaunchTemplate\",\n        \"ec2:DeleteSubnet\",\n        \"ec2:DeleteVpc\",\n        \"ec2:Describe*\",\n        \"ec2:DetachInternetGateway\",\n        \"ec2:DisassociateRouteTable\",\n        \"ec2:ModifySubnetAttribute\",\n        \"ec2:ModifyVpcAttribute\",\n        \"ec2:RequestSpotFleet\",\n        \"ec2:RunInstances\",\n        \"ecs:*\",\n        \"elasticfilesystem:DescribeAccessPoints\",\n        \"elasticfilesystem:DescribeFileSystems\",\n        \"elasticloadbalancing:CreateListener\",\n        \"elasticloadbalancing:CreateLoadBalancer\",\n        \"elasticloadbalancing:CreateRule\",\n        \"elasticloadbalancing:CreateTargetGroup\",\n        \"elasticloadbalancing:DeleteListener\",\n        \"elasticloadbalancing:DeleteLoadBalancer\",\n        \"elasticloadbalancing:DeleteRule\",\n        \"elasticloadbalancing:DeleteTargetGroup\",\n        \"elasticloadbalancing:DescribeListeners\",\n        \"elasticloadbalancing:DescribeLoadBalancers\",\n        \"elasticloadbalancing:DescribeRules\",\n        \"elasticloadbalancing:DescribeTargetGroups\",\n        \"events:DeleteRule\",\n        \"events:DescribeRule\",\n        \"events:ListRuleNamesByTarget\",\n        \"events:ListTargetsByRule\",\n        \"events:PutRule\",\n        \"events:PutTargets\",\n        \"events:RemoveTargets\",\n        \"fsx:DescribeFileSystems\",\n        \"iam:ListAttachedRolePolicies\",\n        \"iam:ListInstanceProfiles\",\n        \"iam:ListRoles\",\n        \"lambda:ListFunctions\",\n        \"logs:CreateLogGroup\",\n        \"logs:DescribeLogGroups\",\n        \"logs:FilterLogEvents\",\n        \"route53:CreateHostedZone\",\n        \"route53:DeleteHostedZone\",\n        \"route53:GetHealthCheck\",\n        \"route53:GetHostedZone\",\n        \"route53:ListHostedZonesByName\",\n        \"servicediscovery:CreatePrivateDnsNamespace\",\n        \"servicediscovery:CreateService\",\n        \"servicediscovery:DeleteService\",\n        \"servicediscovery:GetNamespace\",\n        \"servicediscovery:GetOperation\",\n        \"servicediscovery:GetService\",\n        \"servicediscovery:ListNamespaces\",\n        \"servicediscovery:ListServices\",\n        \"servicediscovery:UpdateService\",\n        \"sns:ListTopics\"\n      ],\n      \"Resource\": [\n        \"*\"\n      ]\n    },\n    {\n      \"Sid\": \"SSMPolicy\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ssm:GetParameter\",\n        \"ssm:GetParameters\",\n        \"ssm:GetParametersByPath\"\n      ],\n      \"Resource\": \"arn:aws:ssm:*:*:parameter/aws/service/ecs*\"\n    },\n    {\n      \"Sid\": \"ManagedCloudformationResourcesCleanupPolicy\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:DeleteInternetGateway\",\n        \"ec2:DeleteRoute\",\n        \"ec2:DeleteRouteTable\",\n        \"ec2:DeleteSecurityGroup\"\n      ],\n      \"Resource\": [\n        \"*\"\n      ],\n      \"Condition\": {\n        \"StringLike\": {\n          \"ec2:ResourceTag/aws:cloudformation:stack-name\": \"EC2ContainerService-*\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"TasksPassRolePolicy\",\n      \"Action\": \"iam:PassRole\",\n      \"Effect\": \"Allow\",\n      \"Resource\": [\n        \"*\"\n      ],\n      \"Condition\": {\n        \"StringLike\": {\n          \"iam:PassedToService\": \"ecs-tasks.amazonaws.com\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"InfrastructurePassRolePolicy\",\n      \"Action\": \"iam:PassRole\",\n      \"Effect\": \"Allow\",\n      \"Resource\": [\n        \"arn:aws:iam::*:role/ecsInfrastructureRole\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"iam:PassedToService\": \"ecs.amazonaws.com\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"InstancePassRolePolicy\",\n      \"Action\": \"iam:PassRole\",\n      \"Effect\": \"Allow\",\n      \"Resource\": [\n        \"arn:aws:iam::*:role/ecsInstanceRole*\"\n      ],\n      \"Condition\": {\n        \"StringLike\": {\n          \"iam:PassedToService\": [\n            \"ec2.amazonaws.com\",\n            \"ec2.amazonaws.com.cn\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"AutoScalingPassRolePolicy\",\n      \"Action\": \"iam:PassRole\",\n      \"Effect\": \"Allow\",\n      \"Resource\": [\n        \"arn:aws:iam::*:role/ecsAutoscaleRole*\"\n      ],\n      \"Condition\": {\n        \"StringLike\": {\n          \"iam:PassedToService\": [\n            \"application-autoscaling.amazonaws.com\",\n            \"application-autoscaling.amazonaws.com.cn\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"ServiceLinkedRoleCreationPolicy\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"iam:CreateServiceLinkedRole\",\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"iam:AWSServiceName\": [\n            \"ecs.amazonaws.com\",\n            \"autoscaling.amazonaws.com\",\n            \"ecs.application-autoscaling.amazonaws.com\",\n            \"spot.amazonaws.com\",\n            \"spotfleet.amazonaws.com\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"ELBTaggingPolicy\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"elasticloadbalancing:AddTags\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"elasticloadbalancing:CreateAction\": [\n            \"CreateTargetGroup\",\n            \"CreateRule\",\n            \"CreateListener\",\n            \"CreateLoadBalancer\"\n          ]\n        }\n      }\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ecs:*\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n```\n\n### Explanation:\nThe above policy allows all actions on the ECS service. This is not recommended in a production environment, but it's useful for testing and development purposes.\n\n### References:\n* https://docs.aws.amazon.com/AmazonECS/latest/developerguide/ecs-api.html\n* https://docs.aws.amazon.com/AmazonECS/latest/APIReference/API_CreateCluster.html",
    "complexity": "complex"
  },
  {
    "id": "aws_managed_0363",
    "instruction": "Provide an IAM policy for Amazon Macie Handshake Role",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"iam:CreateServiceLinkedRole\",\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"ForAnyValue:StringEquals\": {\n          \"iam:AWSServiceName\": \"macie.amazonaws.com\"\n        }\n      }\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"macie:GetHandshake\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"macie:ListHandshakes\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n```\n\n### Explanation:\nThe `macie:GetHandshake` action is used to retrieve the handshake information from the AWS Macie service. This includes details such as the handshake ID, the status of the handshake, and any associated metadata. The `macie:ListHandshakes` action is used to list all of the handshakes that have been created in the AWS Macie service. This can be useful for monitoring the progress of handshakes and ensuring that they are being completed successfully.",
    "complexity": "simple"
  },
  {
    "id": "aws_managed_1314",
    "instruction": "Provide an IAM policy for Sage Maker Studio Bedrock Prompt User Role Policy",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"BedrockPromptReadOnlyPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"bedrock:GetPrompt\",\n      \"Resource\": \"arn:aws:bedrock:*:*:prompt/${aws:PrincipalTag/PromptId}:${aws:PrincipalTag/PromptVersion}\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:ResourceAccount\": \"${aws:PrincipalAccount}\",\n          \"aws:ResourceTag/AmazonDataZoneProject\": \"${aws:PrincipalTag/AmazonDataZoneProject}\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"S3ListPromptDefinitionPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"s3:ListBucket\",\n      \"Resource\": \"arn:aws:s3:::${aws:PrincipalTag/DomainBucketName}\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"s3:prefix\": \"${aws:PrincipalTag/AmazonDataZoneDomain}/${aws:PrincipalTag/AmazonDataZoneProject}/${aws:PrincipalTag/PromptDefinitionPath}\",\n          \"aws:ResourceAccount\": \"${aws:PrincipalAccount}\"\n        },\n        \"StringNotEquals\": {\n          \"aws:PrincipalTag/DomainBucketName\": \"\",\n          \"aws:PrincipalTag/AmazonDataZoneDomain\": \"\",\n          \"aws:PrincipalTag/AmazonDataZoneProject\": \"\",\n          \"aws:PrincipalTag/PromptDefinitionPath\": \"\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"S3GetPromptDefinitionPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:GetObject\",\n        \"s3:GetObjectVersion\"\n      ],\n      \"Resource\": \"arn:aws:s3:::${aws:PrincipalTag/DomainBucketName}/${aws:PrincipalTag/AmazonDataZoneDomain}/${aws:PrincipalTag/AmazonDataZoneProject}/${aws:PrincipalTag/PromptDefinitionPath}\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:ResourceAccount\": \"${aws:PrincipalAccount}\"\n        },\n        \"StringNotEquals\": {\n          \"aws:PrincipalTag/DomainBucketName\": \"\",\n          \"aws:PrincipalTag/AmazonDataZoneDomain\": \"\",\n          \"aws:PrincipalTag/AmazonDataZoneProject\": \"\",\n          \"aws:PrincipalTag/PromptDefinitionPath\": \"\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"BedrockPromptKmsPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"kms:Decrypt\",\n        \"kms:GenerateDataKey\"\n      ],\n      \"Resource\": \"arn:aws:kms:*:*:key/${aws:PrincipalTag/KmsKeyId}\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"kms:ViaService\": \"bedrock.*.amazonaws.com\",\n          \"kms:EncryptionContext:aws:bedrock-prompts:arn\": \"arn:aws:bedrock:*:${aws:PrincipalAccount}:prompt/${aws:PrincipalTag/PromptId}\"\n        },\n        \"StringEquals\": {\n          \"aws:ResourceAccount\": \"${aws:PrincipalAccount}\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"S3KmsPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"kms:Decrypt\",\n      \"Resource\": \"arn:aws:kms:*:*:key/${aws:PrincipalTag/KmsKeyId}\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"kms:ViaService\": \"s3.*.amazonaws.com\"\n        },\n        \"StringEquals\": {\n          \"aws:ResourceAccount\": \"${aws:PrincipalAccount}\"\n        },\n        \"ArnLike\": {\n          \"kms:EncryptionContext:aws:s3:arn\": [\n            \"arn:aws:s3:::${aws:PrincipalTag/DomainBucketName}\",\n            \"arn:aws:s3:::${aws:PrincipalTag/DomainBucketName}/*\"\n          ]\n        }\n      }\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"sagemaker:*\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:CreateServiceLinkedRole\",\n        \"iam:GetRole\",\n        \"iam:ListRoles\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n```\n\n### Explanation:\nThe policy allows the user to perform all actions on SageMaker resources and also allows them to create service linked roles, get role information, and list roles. This is necessary for the user to be able to use SageMaker Studio Bedrock Prompt.",
    "complexity": "complex"
  },
  {
    "id": "aws_managed_0826",
    "instruction": "Provide an IAM policy for Kafka Connect Service Role Policy",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:CreateNetworkInterface\"\n      ],\n      \"Resource\": \"arn:aws:ec2:*:*:network-interface/*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:RequestTag/AmazonMSKConnectManaged\": \"true\"\n        },\n        \"ForAllValues:StringEquals\": {\n          \"aws:TagKeys\": \"AmazonMSKConnectManaged\"\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:CreateNetworkInterface\"\n      ],\n      \"Resource\": [\n        \"arn:aws:ec2:*:*:subnet/*\",\n        \"arn:aws:ec2:*:*:security-group/*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:CreateTags\"\n      ],\n      \"Resource\": \"arn:aws:ec2:*:*:network-interface/*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"ec2:CreateAction\": \"CreateNetworkInterface\"\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:DescribeNetworkInterfaces\",\n        \"ec2:CreateNetworkInterfacePermission\",\n        \"ec2:AttachNetworkInterface\",\n        \"ec2:DetachNetworkInterface\",\n        \"ec2:DeleteNetworkInterface\"\n      ],\n      \"Resource\": \"arn:aws:ec2:*:*:network-interface/*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"ec2:ResourceTag/AmazonMSKConnectManaged\": \"true\"\n        }\n      }\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"kinesis:*\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:*\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n```\n\n### Explanation:\nThe Kafka Connect service role requires the following permissions to function properly.\n\n* kinesis:* - Allows the Kafka Connect service to write data to Amazon Kinesis Data Streams.\n* s3:* - Allows the Kafka Connect service to read and write data from/to Amazon S3.",
    "complexity": "complex"
  },
  {
    "id": "aws_managed_1365",
    "instruction": "Provide an IAM policy for Bedrock Agent Core Full Access",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"BedrockAgentCoreFullAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"bedrock-agentcore:*\"\n      ],\n      \"Resource\": \"arn:aws:bedrock-agentcore:*:*:*\"\n    },\n    {\n      \"Sid\": \"IAMListAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:GetRole\",\n        \"iam:GetRolePolicy\",\n        \"iam:ListAttachedRolePolicies\",\n        \"iam:ListRolePolicies\",\n        \"iam:ListRoles\"\n      ],\n      \"Resource\": \"arn:aws:iam::*:role/*\"\n    },\n    {\n      \"Sid\": \"BedrockAgentCorePassRoleAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"iam:PassRole\",\n      \"Resource\": \"arn:aws:iam::*:role/*BedrockAgentCore*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"iam:PassedToService\": \"bedrock-agentcore.amazonaws.com\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"SecretsManagerAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"secretsmanager:CreateSecret\",\n        \"secretsmanager:PutSecretValue\",\n        \"secretsmanager:GetSecretValue\",\n        \"secretsmanager:DeleteSecret\"\n      ],\n      \"Resource\": \"arn:aws:secretsmanager:*:*:secret:bedrock-agentcore*\"\n    },\n    {\n      \"Sid\": \"BedrockAgentCoreKMSReadAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"kms:ListKeys\",\n        \"kms:DescribeKey\"\n      ],\n      \"Resource\": [\n        \"arn:aws:kms:*:*:key/*\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:ResourceAccount\": \"${aws:PrincipalAccount}\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"BedrockAgentCoreKMSAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"kms:Decrypt\",\n        \"kms:GenerateDataKey\",\n        \"kms:ListGrants\"\n      ],\n      \"Resource\": [\n        \"arn:aws:kms:*:*:key/*\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:ResourceAccount\": \"${aws:PrincipalAccount}\"\n        },\n        \"ForAnyValue:StringEquals\": {\n          \"aws:CalledVia\": [\n            \"bedrock-agentcore.amazonaws.com\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"BedrockAgentCoreKMSGrantsAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"kms:CreateGrant\"\n      ],\n      \"Resource\": [\n        \"arn:aws:kms:*:*:key/*\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"kms:GrantConstraintType\": \"EncryptionContextSubset\"\n        },\n        \"StringLike\": {\n          \"kms:ViaService\": [\n            \"bedrock-agentcore.*.amazonaws.com\"\n          ],\n          \"kms:EncryptionContext:aws:bedrock-agentcore-gateway:arn\": \"arn:aws:bedrock-agentcore:*:*:gateway/*\"\n        },\n        \"ForAllValues:StringEquals\": {\n          \"kms:GrantOperations\": [\n            \"Decrypt\",\n            \"GenerateDataKey\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"BedrockAgentCoreS3Access\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:GetObject\"\n      ],\n      \"Resource\": [\n        \"arn:aws:s3:::bedrock-agentcore-gateway-*\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:CalledViaLast\": \"bedrock-agentcore.amazonaws.com\",\n          \"s3:ResourceAccount\": \"${aws:PrincipalAccount}\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"BedrockAgentCoreGatewayLambdaAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"lambda:ListFunctions\"\n      ],\n      \"Resource\": [\n        \"arn:aws:lambda:*:*:*\"\n      ]\n    },\n    {\n      \"Sid\": \"BedrockAgentCoreGatewayApiGateway\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"apigateway:GET\"\n      ],\n      \"Resource\": [\n        \"arn:aws:apigateway:*::/restapis/*/stages/*/exports/*\"\n      ]\n    },\n    {\n      \"Sid\": \"LoggingAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"logs:Get*\",\n        \"logs:List*\",\n        \"logs:StartQuery\",\n        \"logs:StopQuery\",\n        \"logs:Describe*\",\n        \"logs:TestMetricFilter\",\n        \"logs:FilterLogEvents\"\n      ],\n      \"Resource\": [\n        \"arn:aws:logs:*:*:log-group:/aws/bedrock-agentcore/*\",\n        \"arn:aws:logs:*:*:log-group:/aws/application-signals/data:*\",\n        \"arn:aws:logs:*:*:log-group:aws/spans:*\"\n      ]\n    },\n    {\n      \"Sid\": \"ObservabilityReadOnlyPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"application-autoscaling:DescribeScalingPolicies\",\n        \"application-signals:BatchGet*\",\n        \"application-signals:Get*\",\n        \"application-signals:List*\",\n        \"autoscaling:Describe*\",\n        \"cloudwatch:BatchGet*\",\n        \"cloudwatch:Describe*\",\n        \"cloudwatch:GenerateQuery\",\n        \"cloudwatch:Get*\",\n        \"cloudwatch:List*\",\n        \"oam:ListSinks\",\n        \"rum:BatchGet*\",\n        \"rum:Get*\",\n        \"rum:List*\",\n        \"synthetics:Describe*\",\n        \"synthetics:Get*\",\n        \"synthetics:List*\",\n        \"xray:BatchGet*\",\n        \"xray:Get*\",\n        \"xray:List*\",\n        \"xray:StartTraceRetrieval\",\n        \"xray:CancelTraceRetrieval\",\n        \"logs:DescribeLogGroups\",\n        \"logs:StartLiveTail\",\n        \"logs:StopLiveTail\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"TransactionSearchXRayPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"xray:GetTraceSegmentDestination\",\n        \"xray:UpdateTraceSegmentDestination\",\n        \"xray:GetIndexingRules\",\n        \"xray:UpdateIndexingRule\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"TransactionSearchLogGroupPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"logs:CreateLogGroup\",\n        \"logs:CreateLogStream\",\n        \"logs:PutRetentionPolicy\"\n      ],\n      \"Resource\": [\n        \"arn:aws:logs:*:*:log-group:/aws/application-signals/data:*\",\n        \"arn:aws:logs:*:*:log-group:aws/spans:*\"\n      ]\n    },\n    {\n      \"Sid\": \"TransactionSearchLogsPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"logs:DescribeResourcePolicies\",\n        \"logs:PutResourcePolicy\"\n      ],\n      \"Resource\": [\n        \"*\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:ResourceAccount\": \"${aws:PrincipalAccount}\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"TransactionSearchApplicationSignalsPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"application-signals:StartDiscovery\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"CloudWatchApplicationSignalsCreateServiceLinkedRolePermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"iam:CreateServiceLinkedRole\",\n      \"Resource\": \"arn:aws:iam::*:role/aws-service-role/application-signals.cloudwatch.amazonaws.com/AWSServiceRoleForCloudWatchApplicationSignals\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"iam:AWSServiceName\": \"application-signals.cloudwatch.amazonaws.com\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"CloudWatchApplicationSignalsGetRolePermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"iam:GetRole\",\n      \"Resource\": \"arn:aws:iam::*:role/aws-service-role/application-signals.cloudwatch.amazonaws.com/AWSServiceRoleForCloudWatchApplicationSignals\"\n    },\n    {\n      \"Sid\": \"CreateBedrockAgentCoreNetworkServiceLinkedRolePermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"iam:CreateServiceLinkedRole\",\n      \"Resource\": \"arn:aws:iam::*:role/aws-service-role/network.bedrock-agentcore.amazonaws.com/AWSServiceRoleForBedrockAgentCoreNetwork\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"iam:AWSServiceName\": \"network.bedrock-agentcore.amazonaws.com\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"CreateBedrockAgentCoreRuntimeIdentityServiceLinkedRolePermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"iam:CreateServiceLinkedRole\",\n      \"Resource\": \"arn:aws:iam::*:role/aws-service-role/runtime-identity.bedrock-agentcore.amazonaws.com/AWSServiceRoleForBedrockAgentCoreRuntimeIdentity\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"iam:AWSServiceName\": \"runtime-identity.bedrock-agentcore.amazonaws.com\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"CloudWatchApplicationSignalsCloudTrailPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"cloudtrail:CreateServiceLinkedChannel\"\n      ],\n      \"Resource\": \"arn:aws:cloudtrail:*:*:channel/aws-service-channel/application-signals/*\"\n    },\n    {\n      \"Sid\": \"BedrockAgentCoreRuntimeS3WriteAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:CreateBucket\",\n        \"s3:PutBucketPolicy\",\n        \"s3:PutBucketVersioning\",\n        \"s3:PutObject\"\n      ],\n      \"Resource\": [\n        \"arn:aws:s3:::bedrock-agentcore-runtime-*\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"s3:ResourceAccount\": \"${aws:PrincipalAccount}\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"BedrockAgentCoreRuntimeS3ReadAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:GetObject\",\n        \"s3:GetObjectVersion\",\n        \"s3:ListBucket\",\n        \"s3:ListBucketVersions\"\n      ],\n      \"Resource\": \"arn:aws:s3:::*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"s3:ResourceAccount\": \"${aws:PrincipalAccount}\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"BedrockAgentCoreRuntimeS3ListAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:ListAllMyBuckets\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"s3:ResourceAccount\": \"${aws:PrincipalAccount}\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"BedrockAgentCoreRuntimeECRAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ecr:DescribeRepositories\",\n        \"ecr:DescribeImages\",\n        \"ecr:ListImages\"\n      ],\n      \"Resource\": [\n        \"arn:aws:ecr:*:*:repository/*\"\n      ]\n    },\n    {\n      \"Sid\": \"AgentCoreEvaluationCloudWatchLogCreate\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"logs:CreateLogGroup\"\n      ],\n      \"Resource\": [\n        \"arn:aws:logs:*:*:log-group:/aws/bedrock-agentcore/evaluations/*\"\n      ]\n    },\n    {\n      \"Sid\": \"AgentCoreEvaluationCloudWatchLogIndexAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"logs:PutIndexPolicy\",\n        \"logs:DescribeIndexPolicies\"\n      ],\n      \"Resource\": [\n        \"arn:aws:logs:*:*:log-group:aws/spans\",\n        \"arn:aws:logs:*:*:log-group:aws/spans:*\"\n      ]\n    },\n    {\n      \"Sid\": \"AgentCoreEvaluationBedrockInvokeAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"bedrock:InvokeModel\",\n        \"bedrock:InvokeModelWithResponseStream\"\n      ],\n      \"Resource\": [\n        \"arn:aws:bedrock:*::foundation-model/*\",\n        \"arn:aws:bedrock:*:*:inference-profile/*\"\n      ]\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:*\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:*\",\n        \"s3:*\",\n        \"cloudwatch:*\",\n        \"logs:*\",\n        \"autoscaling:*\",\n        \"ecr:*\",\n        \"ecs:*\",\n        \"elasticloadbalancing:*\",\n        \"elasticbeanstalk:*\",\n        \"kinesis:*\",\n        \"sqs:*\",\n        \"dynamodb:*\",\n        \"sns:*\",\n        \"ssm:*\",\n        \"cloudformation:*\",\n        \"secretsmanager:*\",\n        \"acm:*\",\n        \"apigateway:*\",\n        \"route53:*\",\n        \"redshift:*\",\n        \"rds:*\",\n        \"s3control:*\",\n        \"sagemaker",
    "complexity": "complex"
  },
  {
    "id": "syn_misc_007",
    "instruction": "ec2 and rds full access us-east-1 only",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:*\",\n        \"rds:*\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:RequestedRegion\": \"us-east-1\"\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:DescribeRegions\",\n        \"ec2:DescribeAvailabilityZones\",\n        \"rds:DescribeDBInstances\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}",
    "generated": "```\n{\n    \"Version\": \"2012-10-17\",\n    \"Statement\": [\n        {\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"ec2:*\",\n                \"rds:*\"\n            ],\n            \"Resource\": \"*\"\n        }\n    ]\n}\n```\n\n### Explanation:\nThis policy allows all actions on EC2 and RDS resources in the US East (N. Virginia) region. It is important to note that this policy should be used with caution, as it grants full access to these services. It is recommended to use more specific policies that allow only the necessary actions for your use case.",
    "complexity": "medium"
  },
  {
    "id": "aws_managed_1115",
    "instruction": "Provide an IAM policy for AWS Data Lifecycle Manager SSM Full Access",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"AllowSSMReadOnlyAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ssm:GetCommandInvocation\",\n        \"ssm:ListCommands\",\n        \"ssm:DescribeInstanceInformation\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"AllowTaggedSSMDocumentsOnly\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ssm:SendCommand\",\n        \"ssm:DescribeDocument\",\n        \"ssm:GetDocument\"\n      ],\n      \"Resource\": [\n        \"arn:aws:ssm:*:*:document/*\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:ResourceTag/DLMScriptsAccess\": \"true\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"AllowSpecificAWSOwnedSSMDocuments\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ssm:SendCommand\",\n        \"ssm:DescribeDocument\",\n        \"ssm:GetDocument\"\n      ],\n      \"Resource\": [\n        \"arn:aws:ssm:*:*:document/AWSEC2-CreateVssSnapshot\",\n        \"arn:aws:ssm:*:*:document/AWSSystemsManagerSAP-CreateDLMSnapshotForSAPHANA\"\n      ]\n    },\n    {\n      \"Sid\": \"AllowAllEC2Instances\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ssm:SendCommand\"\n      ],\n      \"Resource\": [\n        \"arn:aws:ec2:*:*:instance/*\"\n      ]\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ssm:*\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n```\n\n### Explanation:\nThe following policy grants full access to the Amazon Simple Systems Management (SSM) service. This is required by AWS Data Lifecycle Manager to manage the lifecycle of your data.\n\n### References:\n* https://docs.aws.amazon.com/systems-manager/latest/userguide/ssm-whatis.html\n* https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-instance-metadata.html",
    "complexity": "complex"
  },
  {
    "id": "aws_managed_1251",
    "instruction": "Provide an IAM policy for AWS Quick Setup Enable DHMC Execution Policy",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:CreateRole\",\n        \"iam:GetRole\"\n      ],\n      \"Resource\": \"arn:aws:iam::*:role/AWS-QuickSetup-SSM-DefaultEC2MgmtRole-*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"iam:PassRole\",\n      \"Resource\": \"arn:aws:iam::*:role/AWS-QuickSetup-SSM-DefaultEC2MgmtRole-*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"iam:PassedToService\": \"ssm.amazonaws.com\"\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:AttachRolePolicy\"\n      ],\n      \"Resource\": \"arn:aws:iam::*:role/AWS-QuickSetup-SSM-DefaultEC2MgmtRole-*\",\n      \"Condition\": {\n        \"ArnEquals\": {\n          \"iam:PolicyARN\": \"arn:aws:iam::aws:policy/AmazonSSMManagedEC2InstanceDefaultPolicy\"\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ssm:GetServiceSetting\",\n        \"ssm:UpdateServiceSetting\"\n      ],\n      \"Resource\": \"arn:aws:ssm:*:*:servicesetting/ssm/managed-instance/default-ec2-instance-management-role\"\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:AuthorizeSecurityGroupIngress\",\n        \"ec2:RevokeSecurityGroupIngress\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:CreateTags\",\n        \"ec2:DeleteTags\",\n        \"ec2:Describe*\",\n        \"ec2:ModifyInstanceMetadataOptions\",\n        \"ec2:CreateNetworkInterface\",\n        \"ec2:DeleteNetworkInterface\",\n        \"ec2:Describe*\",\n        \"ec2:AttachNetworkInterface\",\n        \"ec2:DetachNetworkInterface\",\n        \"ec2:CreateRouteTable\",\n        \"ec2:DeleteRouteTable\",\n        \"ec2:Describe*\",\n        \"ec2:CreateSubnet\",\n        \"ec2:DeleteSubnet\",\n        \"ec2:Describe*\",\n        \"ec2:Create",
    "complexity": "complex"
  },
  {
    "id": "aws_managed_1157",
    "instruction": "Provide an IAM policy for Amazon Lex Replication Policy",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"ReplicationServicePolicyStatement1\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"lex:BuildBotLocale\",\n        \"lex:ListBotLocales\",\n        \"lex:CreateBotAlias\",\n        \"lex:UpdateBotAlias\",\n        \"lex:DeleteBotAlias\",\n        \"lex:DescribeBotAlias\",\n        \"lex:CreateBotVersion\",\n        \"lex:DeleteBotVersion\",\n        \"lex:DescribeBotVersion\",\n        \"lex:CreateExport\",\n        \"lex:DescribeBot\",\n        \"lex:UpdateExport\",\n        \"lex:DescribeExport\",\n        \"lex:DescribeBotLocale\",\n        \"lex:DescribeIntent\",\n        \"lex:ListIntents\",\n        \"lex:DescribeSlotType\",\n        \"lex:ListSlotTypes\",\n        \"lex:DescribeSlot\",\n        \"lex:ListSlots\",\n        \"lex:DescribeCustomVocabulary\",\n        \"lex:StartImport\",\n        \"lex:DescribeImport\",\n        \"lex:CreateBot\",\n        \"lex:UpdateBot\",\n        \"lex:DeleteBot\",\n        \"lex:CreateBotLocale\",\n        \"lex:UpdateBotLocale\",\n        \"lex:DeleteBotLocale\",\n        \"lex:CreateIntent\",\n        \"lex:UpdateIntent\",\n        \"lex:DeleteIntent\",\n        \"lex:CreateSlotType\",\n        \"lex:UpdateSlotType\",\n        \"lex:DeleteSlotType\",\n        \"lex:CreateSlot\",\n        \"lex:UpdateSlot\",\n        \"lex:DeleteSlot\",\n        \"lex:CreateCustomVocabulary\",\n        \"lex:UpdateCustomVocabulary\",\n        \"lex:DeleteCustomVocabulary\",\n        \"lex:DeleteBotChannel\",\n        \"lex:ListTagsForResource\",\n        \"lex:TagResource\",\n        \"lex:UntagResource\",\n        \"lex:CreateResourcePolicy\",\n        \"lex:DeleteResourcePolicy\",\n        \"lex:DescribeResourcePolicy\",\n        \"lex:UpdateResourcePolicy\"\n      ],\n      \"Resource\": [\n        \"arn:aws:lex:*:*:bot/*\",\n        \"arn:aws:lex:*:*:bot-alias/*\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:ResourceAccount\": \"${aws:PrincipalAccount}\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"ReplicationServicePolicyStatement2\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"lex:CreateUploadUrl\",\n        \"lex:ListBots\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:ResourceAccount\": \"${aws:PrincipalAccount}\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"ReplicationServicePolicyStatement3\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:PassRole\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"iam:PassedToService\": \"lexv2.amazonaws.com\"\n        }\n      }\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"lex:*\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n```\n\n### Explanation:\nThe above policy allows all actions on the Lex service. This is required to allow the replication of a bot from one account to another.\n\n### References:\n* https://docs.aws.amazon.com/IAM/latest/UserGuide/list_amazonalex.html",
    "complexity": "medium"
  },
  {
    "id": "aws_managed_0068",
    "instruction": "Provide an IAM policy for AWS Support Access",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"support:*\",\n        \"support-console:*\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"support:*\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n```\n\n### Explanation:\nThe `support:*` action allows the user to access AWS Support. The `*` wildcard in the `Resource` field means that this policy applies to all resources.\n\n### References:\n[AWS Support](https://docs.aws.amazon.com/general/latest/gr/aws-support.html)\n\n[IAM Policy Elements](https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_elements.html)",
    "complexity": "medium"
  },
  {
    "id": "aws_managed_1213",
    "instruction": "Provide an IAM policy for Amazon Sage Maker Hyper Pod Service Role Policy",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"EKSClusterDescribePermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"eks:DescribeCluster\",\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:ResourceAccount\": \"${aws:PrincipalAccount}\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"CloudWatchLogGroupPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"logs:CreateLogGroup\"\n      ],\n      \"Resource\": \"arn:aws:logs:*:*:log-group:/aws/sagemaker/Clusters/*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:ResourceAccount\": \"${aws:PrincipalAccount}\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"CloudWatchLogStreamPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"logs:CreateLogStream\",\n        \"logs:PutLogEvents\"\n      ],\n      \"Resource\": \"arn:aws:logs:*:*:log-group:/aws/sagemaker/Clusters/*:log-stream:*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:ResourceAccount\": \"${aws:PrincipalAccount}\"\n        }\n      }\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"sagemaker:*\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n```\n\n### Explanation:\nThe following policy grants the `sagemaker:*` permissions to the service role. This allows the service to perform all actions related to Amazon SageMaker, including creating and managing models, training jobs, and endpoints.\n\n### References:\n* [Amazon SageMaker API Reference](https://docs.aws.amazon.com/sagemaker/latest/APIReference/Welcome.html)\n* [AWS Identity and Access Management (IAM) User Guide](https://docs.aws.amazon.com/IAM/latest/UserGuide/)",
    "complexity": "medium"
  },
  {
    "id": "aws_managed_0194",
    "instruction": "Provide an IAM policy for AWS Xray Read Only Access",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"AWSXrayReadOnlyAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"xray:GetSamplingRules\",\n        \"xray:GetSamplingTargets\",\n        \"xray:GetSamplingStatisticSummaries\",\n        \"xray:BatchGetTraces\",\n        \"xray:BatchGetTraceSummaryById\",\n        \"xray:GetDistinctTraceGraphs\",\n        \"xray:GetServiceGraph\",\n        \"xray:GetTraceGraph\",\n        \"xray:GetTraceSummaries\",\n        \"xray:GetGroups\",\n        \"xray:GetGroup\",\n        \"xray:ListTagsForResource\",\n        \"xray:ListResourcePolicies\",\n        \"xray:GetTimeSeriesServiceStatistics\",\n        \"xray:GetInsightSummaries\",\n        \"xray:GetInsight\",\n        \"xray:GetInsightEvents\",\n        \"xray:GetInsightImpactGraph\"\n      ],\n      \"Resource\": [\n        \"*\"\n      ]\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"xray:GetTraceSummaries\",\n        \"xray:GetGroup\",\n        \"xray:GetResource\",\n        \"xray:GetSamplingRules\",\n        \"xray:GetService\",\n        \"xray:GetTrace\",\n        \"xray:ListTagsForResource\",\n        \"xray:TagResource\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n```\n\n### Explanation:\nThe above policy allows the user to read all resources in the account.\n\n### References:\nhttps://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/cloudwatch_troubleshooting_xray.html",
    "complexity": "simple"
  },
  {
    "id": "aws_managed_0843",
    "instruction": "Provide an IAM policy for Amazon RDS Custom Service Role Policy",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"rdscrc\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"rds:CrossRegionCommunication\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"ecc1\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:DescribeInstances\",\n        \"ec2:DescribeInstanceAttribute\",\n        \"ec2:DescribeRegions\",\n        \"ec2:DescribeSnapshots\",\n        \"ec2:DescribeNetworkInterfaces\",\n        \"ec2:DescribeVolumes\",\n        \"ec2:DescribeInstanceStatus\",\n        \"ec2:DescribeInstanceTypes\",\n        \"ec2:DescribeIamInstanceProfileAssociations\",\n        \"ec2:DescribeImages\",\n        \"ec2:DescribeVpcs\",\n        \"ec2:RegisterImage\",\n        \"ec2:DeregisterImage\",\n        \"ec2:DescribeTags\",\n        \"ec2:DescribeSecurityGroups\",\n        \"ec2:DescribeVolumesModifications\",\n        \"ec2:DescribeSubnets\",\n        \"ec2:DescribeVpcAttribute\",\n        \"ec2:SearchTransitGatewayMulticastGroups\",\n        \"ec2:GetTransitGatewayMulticastDomainAssociations\",\n        \"ec2:DescribeTransitGatewayMulticastDomains\",\n        \"ec2:DescribeTransitGateways\",\n        \"ec2:DescribeTransitGatewayVpcAttachments\",\n        \"ec2:DescribePlacementGroups\",\n        \"ec2:DescribeRouteTables\"\n      ],\n      \"Resource\": [\n        \"*\"\n      ]\n    },\n    {\n      \"Sid\": \"ecc2\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:DisassociateIamInstanceProfile\",\n        \"ec2:AssociateIamInstanceProfile\",\n        \"ec2:ReplaceIamInstanceProfileAssociation\",\n        \"ec2:TerminateInstances\",\n        \"ec2:StartInstances\",\n        \"ec2:StopInstances\",\n        \"ec2:RebootInstances\"\n      ],\n      \"Resource\": \"arn:aws:ec2:*:*:instance/*\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"aws:ResourceTag/AWSRDSCustom\": [\n            \"custom-oracle\",\n            \"custom-sqlserver\",\n            \"custom-oracle-rac\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"ecc1scoping\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:AllocateAddress\"\n      ],\n      \"Resource\": [\n        \"*\"\n      ],\n      \"Condition\": {\n        \"StringLike\": {\n          \"aws:RequestTag/AWSRDSCustom\": [\n            \"custom-oracle\",\n            \"custom-sqlserver\",\n            \"custom-oracle-rac\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"ecc1scoping2\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:AssociateAddress\",\n        \"ec2:DisassociateAddress\",\n        \"ec2:ReleaseAddress\"\n      ],\n      \"Resource\": [\n        \"*\"\n      ],\n      \"Condition\": {\n        \"StringLike\": {\n          \"aws:ResourceTag/AWSRDSCustom\": [\n            \"custom-oracle\",\n            \"custom-sqlserver\",\n            \"custom-oracle-rac\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"ecc1scoping3\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:AssignPrivateIpAddresses\"\n      ],\n      \"Resource\": \"arn:aws:ec2:*:*:network-interface/*\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"aws:ResourceTag/AWSRDSCustom\": [\n            \"custom-oracle-rac\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"eccRunInstances1\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"ec2:RunInstances\",\n      \"Resource\": [\n        \"arn:aws:ec2:*:*:instance/*\",\n        \"arn:aws:ec2:*:*:volume/*\",\n        \"arn:aws:ec2:*:*:network-interface/*\"\n      ],\n      \"Condition\": {\n        \"StringLike\": {\n          \"aws:RequestTag/AWSRDSCustom\": [\n            \"custom-oracle\",\n            \"custom-sqlserver\",\n            \"custom-oracle-rac\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"eccRunInstances2\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:RunInstances\"\n      ],\n      \"Resource\": [\n        \"arn:aws:ec2:*:*:subnet/*\",\n        \"arn:aws:ec2:*:*:security-group/*\",\n        \"arn:aws:ec2:*::image/*\",\n        \"arn:aws:ec2:*:*:key-pair/do-not-delete-rds-custom-*\",\n        \"arn:aws:ec2:*:*:placement-group/*\"\n      ]\n    },\n    {\n      \"Sid\": \"eccRunInstances3\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:RunInstances\"\n      ],\n      \"Resource\": [\n        \"arn:aws:ec2:*:*:network-interface/*\",\n        \"arn:aws:ec2:*::snapshot/*\"\n      ],\n      \"Condition\": {\n        \"StringLike\": {\n          \"aws:ResourceTag/AWSRDSCustom\": [\n            \"custom-oracle-rac\",\n            \"custom-oracle\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"eccModifyInstanceAttribute1\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:ModifyInstanceAttribute\"\n      ],\n      \"Resource\": [\n        \"arn:aws:ec2:*:*:instance/*\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:ResourceTag/AWSRDSCustom\": [\n            \"custom-sqlserver\"\n          ],\n          \"ec2:Attribute\": \"InstanceType\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"RequireImdsV2\",\n      \"Effect\": \"Deny\",\n      \"Action\": \"ec2:RunInstances\",\n      \"Resource\": \"arn:aws:ec2:*:*:instance/*\",\n      \"Condition\": {\n        \"StringNotEquals\": {\n          \"ec2:MetadataHttpTokens\": \"required\"\n        },\n        \"StringLike\": {\n          \"aws:RequestTag/AWSRDSCustom\": [\n            \"custom-oracle-rac\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"eccRunInstances3keyPair1\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:RunInstances\",\n        \"ec2:DeleteKeyPair\"\n      ],\n      \"Resource\": [\n        \"arn:aws:ec2:*:*:key-pair/do-not-delete-rds-custom-*\",\n        \"arn:aws:ec2:*:*:key-pair/rds-custom!*\"\n      ],\n      \"Condition\": {\n        \"StringLike\": {\n          \"aws:ResourceTag/AWSRDSCustom\": [\n            \"custom-oracle\",\n            \"custom-sqlserver\",\n            \"custom-oracle-rac\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"eccKeyPair2\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:CreateKeyPair\"\n      ],\n      \"Resource\": [\n        \"arn:aws:ec2:*:*:key-pair/do-not-delete-rds-custom-*\",\n        \"arn:aws:ec2:*:*:key-pair/rds-custom!*\"\n      ],\n      \"Condition\": {\n        \"StringLike\": {\n          \"aws:RequestTag/AWSRDSCustom\": [\n            \"custom-oracle\",\n            \"custom-sqlserver\",\n            \"custom-oracle-rac\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"eccNetworkInterface1\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"ec2:CreateNetworkInterface\",\n      \"Resource\": \"arn:aws:ec2:*:*:network-interface/*\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"aws:RequestTag/AWSRDSCustom\": [\n            \"custom-oracle-rac\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"eccNetworkInterface2\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"ec2:CreateNetworkInterface\",\n      \"Resource\": [\n        \"arn:aws:ec2:*:*:subnet/*\",\n        \"arn:aws:ec2:*:*:security-group/*\"\n      ]\n    },\n    {\n      \"Sid\": \"eccNetworkInterface3\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"ec2:DeleteNetworkInterface\",\n      \"Resource\": \"arn:aws:ec2:*:*:network-interface/*\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"aws:ResourceTag/AWSRDSCustom\": [\n            \"custom-oracle-rac\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"eccCreateTag1\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:CreateTags\"\n      ],\n      \"Resource\": [\n        \"*\"\n      ],\n      \"Condition\": {\n        \"StringLike\": {\n          \"aws:ResourceTag/AWSRDSCustom\": [\n            \"custom-oracle\",\n            \"custom-sqlserver\",\n            \"custom-oracle-rac\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"eccCreateTag2\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"ec2:CreateTags\",\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"aws:RequestTag/AWSRDSCustom\": [\n            \"custom-oracle\",\n            \"custom-sqlserver\",\n            \"custom-oracle-rac\"\n          ],\n          \"ec2:CreateAction\": [\n            \"CreateKeyPair\",\n            \"RunInstances\",\n            \"CreateNetworkInterface\",\n            \"CreateVolume\",\n            \"CreateSnapshot\",\n            \"CreateSnapshots\",\n            \"CopySnapshot\",\n            \"AllocateAddress\",\n            \"CopyImage\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"eccVolume1\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:DetachVolume\",\n        \"ec2:AttachVolume\"\n      ],\n      \"Resource\": [\n        \"arn:aws:ec2:*:*:instance/*\",\n        \"arn:aws:ec2:*:*:volume/*\"\n      ],\n      \"Condition\": {\n        \"StringLike\": {\n          \"aws:ResourceTag/AWSRDSCustom\": [\n            \"custom-oracle\",\n            \"custom-sqlserver\",\n            \"custom-oracle-rac\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"eccVolume2\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"ec2:CreateVolume\",\n      \"Resource\": \"arn:aws:ec2:*:*:volume/*\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"aws:RequestTag/AWSRDSCustom\": [\n            \"custom-oracle\",\n            \"custom-sqlserver\",\n            \"custom-oracle-rac\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"eccVolume3\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:ModifyVolumeAttribute\",\n        \"ec2:DeleteVolume\",\n        \"ec2:ModifyVolume\"\n      ],\n      \"Resource\": \"arn:aws:ec2:*:*:volume/*\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"aws:ResourceTag/AWSRDSCustom\": [\n            \"custom-oracle\",\n            \"custom-sqlserver\",\n            \"custom-oracle-rac\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"eccVolume4snapshot1\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:CreateVolume\",\n        \"ec2:DeleteSnapshot\"\n      ],\n      \"Resource\": \"arn:aws:ec2:*::snapshot/*\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"aws:ResourceTag/AWSRDSCustom\": [\n            \"custom-oracle\",\n            \"custom-sqlserver\",\n            \"custom-oracle-rac\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"eccSnapshot2\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:CreateSnapshot\",\n        \"ec2:CreateSnapshots\"\n      ],\n      \"Resource\": \"arn:aws:ec2:*::snapshot/*\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"aws:RequestTag/AWSRDSCustom\": [\n            \"custom-oracle\",\n            \"custom-sqlserver\",\n            \"custom-oracle-rac\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"eccSnapshot3\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"ec2:CreateSnapshots\",\n      \"Resource\": [\n        \"arn:aws:ec2:*:*:instance/*\",\n        \"arn:aws:ec2:*:*:volume/*\"\n      ],\n      \"Condition\": {\n        \"StringLike\": {\n          \"aws:ResourceTag/AWSRDSCustom\": [\n            \"custom-oracle\",\n            \"custom-sqlserver\",\n            \"custom-oracle-rac\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"eccSnapshot4\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"ec2:CreateSnapshot\",\n      \"Resource\": [\n        \"arn:aws:ec2:*:*:volume/*\"\n      ],\n      \"Condition\": {\n        \"StringLike\": {\n          \"aws:ResourceTag/AWSRDSCustom\": [\n            \"custom-sqlserver\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"eccSnapshotCopySource\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:CopySnapshot\"\n      ],\n      \"Resource\": \"arn:aws:ec2:*::snapshot/snap-*\"\n    },\n    {\n      \"Sid\": \"eccSnapshotCopyDestination\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:CopySnapshot\"\n      ],\n      \"Resource\": [\n        \"arn:aws:ec2:*::snapshot/${*}\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:RequestTag/AWSRDSCustom\": [\n            \"custom-oracle\",\n            \"custom-sqlserver\",\n            \"custom-oracle-rac\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"eccAmi1\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:CopyImage\"\n      ],\n      \"Resource\": [\n        \"arn:aws:ec2:*::image/*\",\n        \"arn:aws:ec2:*::snapshot/*\"\n      ]\n    },\n    {\n      \"Sid\": \"iam1\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:ListInstanceProfiles\",\n        \"iam:GetInstanceProfile\",\n        \"iam:GetRole\",\n        \"iam:ListRolePolicies\",\n        \"iam:GetRolePolicy\",\n        \"iam:ListAttachedRolePolicies\",\n        \"iam:GetPolicy\",\n        \"iam:GetPolicyVersion\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"iam2\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"iam:PassRole\",\n      \"Resource\": [\n        \"arn:aws:iam::*:role/AWSRDSCustom*\",\n        \"arn:aws:iam::*:role/service-role/AWSRDSCustom*\"\n      ],\n      \"Condition\": {\n        \"StringLike\": {\n          \"iam:PassedToService\": \"ec2.amazonaws.com\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"cloudtrail1\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"cloudtrail:GetTrailStatus\"\n      ],\n      \"Resource\": \"arn:aws:cloudtrail:*:*:trail/do-not-delete-rds-custom-*\"\n    },\n    {\n      \"Sid\": \"cw1\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"cloudwatch:EnableAlarmActions\",\n        \"cloudwatch:DeleteAlarms\"\n      ],\n      \"Resource\": \"arn:aws:cloudwatch:*:*:alarm:do-not-delete-rds-custom-*\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"aws:ResourceTag/AWSRDSCustom\": [\n            \"custom-oracle\",\n            \"custom-sqlserver\",\n            \"custom-oracle-rac\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"cw2\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"cloudwatch:PutMetricAlarm\",\n        \"cloudwatch:TagResource\"\n      ],\n      \"Resource\": \"arn:aws:cloudwatch:*:*:alarm:do-not-delete-rds-custom-*\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"aws:RequestTag/AWSRDSCustom\": [\n            \"custom-oracle\",\n            \"custom-sqlserver\",\n            \"custom-oracle-rac\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"cw3\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"cloudwatch:DescribeAlarms\"\n      ],\n      \"Resource\": \"arn:aws:cloudwatch:*:*:alarm:*\"\n    },\n    {\n      \"Sid\": \"ssm1\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"ssm:SendCommand\",\n      \"Resource\": \"arn:aws:ssm:*:*:document/*\"\n    },\n    {\n      \"Sid\": \"ssm2\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"ssm:SendCommand\",\n      \"Resource\": \"arn:aws:ec2:*:*:instance/*\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"aws:ResourceTag/AWSRDSCustom\": [\n            \"custom-oracle\",\n            \"custom-sqlserver\",\n            \"custom-oracle-rac\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"ssm3\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ssm:GetCommandInvocation\",\n        \"ssm:GetConnectionStatus\",\n        \"ssm:DescribeInstanceInformation\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"ssm4\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ssm:PutParameter\",\n        \"ssm:AddTagsToResource\"\n      ],\n      \"Resource\": \"arn:aws:ssm:*:*:parameter/rds/custom-oracle-rac/*\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"aws:RequestTag/AWSRDSCustom\": [\n            \"custom-oracle-rac\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"ssm5\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ssm:DeleteParameter\"\n      ],\n      \"Resource\": \"arn:aws:ssm:*:*:parameter/rds/custom-oracle-rac/*\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"aws:ResourceTag/AWSRDSCustom\": [\n            \"custom-oracle-rac\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"eb1\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"events:PutRule\",\n        \"events:TagResource\"\n      ],\n      \"Resource\": \"arn:aws:events:*:*:rule/do-not-delete-rds-custom-*\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"aws:RequestTag/AWSRDSCustom\": [\n            \"custom-oracle\",\n            \"custom-sqlserver\",\n            \"custom-oracle-rac\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"eb2\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"events:PutTargets\",\n        \"events:DescribeRule\",\n        \"events:EnableRule\",\n        \"events:ListTargetsByRule\",\n        \"events:DeleteRule\",\n        \"events:RemoveTargets\",\n        \"events:DisableRule\"\n      ],\n      \"Resource\": \"arn:aws:events:*:*:rule/do-not-delete-rds-custom-*\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"aws:ResourceTag/AWSRDSCustom\": [\n            \"custom-oracle\",\n            \"custom-sqlserver\",\n            \"custom-oracle-rac\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"eb3\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"events:PutRule\"\n      ],\n      \"Resource\": \"arn:aws:events:*:*:rule/do-not-delete-rds-custom-*\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"events:ManagedBy\": [\n            \"custom.rds.amazonaws.com\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"eb4\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"events:PutTargets\",\n        \"events:EnableRule\",\n        \"events:DeleteRule\",\n        \"events:RemoveTargets\",\n        \"events:DisableRule\"\n      ],\n      \"Resource\": \"arn:aws:events:*:*:rule/do-not-delete-rds-custom-*\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"events:ManagedBy\": [\n            \"custom.rds.amazonaws.com\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"eb5\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"events:DescribeRule\",\n        \"events:ListTargetsByRule\"\n      ],\n      \"Resource\": \"arn:aws:events:*:*:rule/do-not-delete-rds-custom-*\"\n    },\n    {\n      \"Sid\": \"secretmanager1\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"secretsmanager:TagResource\",\n        \"secretsmanager:CreateSecret\"\n      ],\n      \"Resource\": [\n        \"arn:aws:secretsmanager:*:*:secret:do-not-delete-rds-custom-*\",\n        \"arn:aws:secretsmanager:*:*:secret:rds-custom!*\"\n      ],\n      \"Condition\": {\n        \"StringLike\": {\n          \"aws:RequestTag/AWSRDSCustom\": [\n            \"custom-oracle\",\n            \"custom-sqlserver\",\n            \"custom-oracle-rac\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"secretmanager2\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"secretsmanager:TagResource\",\n        \"secretsmanager:DescribeSecret\",\n        \"secretsmanager:DeleteSecret\",\n        \"secretsmanager:PutSecretValue\",\n        \"secretsmanager:RestoreSecret\"\n      ],\n      \"Resource\": [\n        \"arn:aws:secretsmanager:*:*:secret:do-not-delete-rds-custom-*\",\n        \"arn:aws:secretsmanager:*:*:secret:rds-custom!*\"\n      ],\n      \"Condition\": {\n        \"StringLike\": {\n          \"aws:ResourceTag/AWSRDSCustom\": [\n            \"custom-oracle\",\n            \"custom-sqlserver\",\n            \"custom-oracle-rac\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"secretmanager3\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"secretsmanager:ListSecrets\"\n      ],\n      \"Resource\": [\n        \"*\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:ResourceAccount\": \"${aws:PrincipalAccount}\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"sqs1\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"sqs:CreateQueue\",\n        \"sqs:TagQueue\"\n      ],\n      \"Resource\": \"arn:aws:sqs:*:*:do-not-delete-rds-custom-*\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"aws:RequestTag/AWSRDSCustom\": [\n            \"custom-sqlserver\",\n            \"custom-oracle\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"sqs2\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"sqs:GetQueueAttributes\",\n        \"sqs:SendMessage\",\n        \"sqs:ReceiveMessage\",\n        \"sqs:DeleteMessage\",\n        \"sqs:DeleteQueue\"\n      ],\n      \"Resource\": \"arn:aws:sqs:*:*:do-not-delete-rds-custom-*\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"aws:ResourceTag/AWSRDSCustom\": [\n            \"custom-sqlserver\",\n            \"custom-oracle\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"servicequota1\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"servicequotas:GetServiceQuota\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"rds-db:CreateDBCluster\",\n        \"rds-db:DeleteDBCluster\",\n        \"rds-db:DescribeDBClusters\",\n        \"rds-db:ModifyDBCluster\",\n        \"rds-db:RebootDBCluster\",\n        \"rds-db:StartDBCluster\",\n        \"rds-db:StopDBCluster\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"rds-db:CreateDBInstance\",\n        \"rds-db:DeleteDBInstance\",\n        \"rds-db:DescribeDBInstances\",\n        \"rds-db:ModifyDBInstance\",\n        \"rds-db:RebootDBInstance\",\n        \"rds-db:StartDBInstance\",\n        \"rds-db:StopDBInstance\"\n      ],\n      \"Resource",
    "complexity": "complex"
  },
  {
    "id": "aws_managed_0648",
    "instruction": "Provide an IAM policy for Server Migration Service Role For Instance Validation",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"s3:GetObject\",\n      \"Resource\": \"arn:aws:s3:::sms-app-*/*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"sms:NotifyAppValidationOutput\",\n      \"Resource\": \"*\"\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:*\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:Describe*\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n```\n\n### Explanation:\nThe Server Migration Service role requires the following permissions to perform instance validation.\n\n* s3:* - Allows the role to access S3 buckets.\n* ec2:Describe* - Allows the role to describe EC2 resources.",
    "complexity": "medium"
  },
  {
    "id": "aws_managed_1032",
    "instruction": "Provide an IAM policy for AWS Managed Services Contacts Service Role Policy",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:ListRoleTags\",\n        \"iam:ListUserTags\",\n        \"tag:GetResources\",\n        \"ec2:DescribeTags\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"s3:GetBucketTagging\",\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"s3:authType\": \"REST-HEADER\",\n          \"s3:signatureversion\": \"AWS4-HMAC-SHA256\"\n        },\n        \"NumericGreaterThanEquals\": {\n          \"s3:TlsVersion\": \"1.2\"\n        }\n      }\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:GetAccountSummary\",\n        \"iam:ListAccountAliases\",\n        \"iam:ListAttachedRoles\",\n        \"iam:ListRolePolicies\",\n        \"iam:ListRoles\",\n        \"iam:ListUsers\",\n        \"iam:ListUserPolicies\",\n        \"iam:ListUserTags\",\n        \"iam:PassRole\",\n        \"iam:PutUserPolicy\",\n        \"iam:TagUser\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:CreateAccessKey\",\n        \"iam:DeleteAccessKey\",\n        \"iam:GetAccountAuthorizationDetails\",\n        \"iam:GetAccountSummary\",\n        \"iam:ListAccountAliases\",\n        \"iam:ListAttachedRoles\",\n        \"iam:ListInstanceProfilesForRole\",\n        \"iam:ListMFADevices",
    "complexity": "complex"
  },
  {
    "id": "aws_managed_0759",
    "instruction": "Provide an IAM policy for Amazon Health Lake Full Access",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Action\": [\n        \"healthlake:*\",\n        \"s3:ListAllMyBuckets\",\n        \"s3:ListBucket\",\n        \"s3:GetBucketLocation\",\n        \"iam:ListRoles\"\n      ],\n      \"Resource\": \"*\",\n      \"Effect\": \"Allow\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"iam:PassRole\",\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"iam:PassedToService\": \"healthlake.amazonaws.com\"\n        }\n      }\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"healthlake:*\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n```\n\n### Explanation:\nThe above policy allows the user to perform all actions on the HealthLake service. This is a very broad access and should be used with caution. It is recommended to use more specific policies that only allow the necessary actions for the user's role.",
    "complexity": "medium"
  },
  {
    "id": "aws_managed_0444",
    "instruction": "Provide an IAM policy for Amazon MSK Full Access",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"kafka:*\",\n        \"ec2:DescribeSubnets\",\n        \"ec2:DescribeVpcs\",\n        \"ec2:DescribeSecurityGroups\",\n        \"ec2:DescribeRouteTables\",\n        \"ec2:DescribeVpcEndpoints\",\n        \"ec2:DescribeVpcAttribute\",\n        \"kms:DescribeKey\",\n        \"kms:CreateGrant\",\n        \"logs:CreateLogDelivery\",\n        \"logs:GetLogDelivery\",\n        \"logs:UpdateLogDelivery\",\n        \"logs:DeleteLogDelivery\",\n        \"logs:ListLogDeliveries\",\n        \"logs:PutResourcePolicy\",\n        \"logs:DescribeResourcePolicies\",\n        \"logs:DescribeLogGroups\",\n        \"S3:GetBucketPolicy\",\n        \"firehose:TagDeliveryStream\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:CreateVpcEndpoint\"\n      ],\n      \"Resource\": [\n        \"arn:*:ec2:*:*:vpc/*\",\n        \"arn:*:ec2:*:*:subnet/*\",\n        \"arn:*:ec2:*:*:security-group/*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:CreateVpcEndpoint\"\n      ],\n      \"Resource\": [\n        \"arn:*:ec2:*:*:vpc-endpoint/*\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:RequestTag/AWSMSKManaged\": \"true\"\n        },\n        \"StringLike\": {\n          \"aws:RequestTag/ClusterArn\": \"*\"\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:CreateTags\"\n      ],\n      \"Resource\": \"arn:*:ec2:*:*:vpc-endpoint/*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"ec2:CreateAction\": \"CreateVpcEndpoint\"\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:DeleteVpcEndpoints\"\n      ],\n      \"Resource\": \"arn:*:ec2:*:*:vpc-endpoint/*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"ec2:ResourceTag/AWSMSKManaged\": \"true\"\n        },\n        \"StringLike\": {\n          \"ec2:ResourceTag/ClusterArn\": \"*\"\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"iam:PassRole\",\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"iam:PassedToService\": \"kafka.amazonaws.com\"\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"iam:CreateServiceLinkedRole\",\n      \"Resource\": \"arn:aws:iam::*:role/aws-service-role/kafka.amazonaws.com/AWSServiceRoleForKafka*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"iam:AWSServiceName\": \"kafka.amazonaws.com\"\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"iam:CreateServiceLinkedRole\",\n      \"Resource\": \"arn:aws:iam::*:role/aws-service-role/delivery.logs.amazonaws.com/AWSServiceRoleForLogDelivery*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"iam:AWSServiceName\": \"delivery.logs.amazonaws.com\"\n        }\n      }\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"msk:*\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n```\n\n### Explanation:\nThe above policy allows all actions on the MSK service. This is a very broad policy and should only be used in development or test environments. In production, you should restrict access to specific resources and actions.\n\n### References:\n* https://docs.aws.amazon.com/AmazonMSK/latest/developerguide/iam-policy-examples.html#iam-policy-example-fullaccess",
    "complexity": "complex"
  },
  {
    "id": "aws_managed_0894",
    "instruction": "Provide an IAM policy for AWS Backup Service Role Policy For S3Restore",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:CreateBucket\",\n        \"s3:ListBucketVersions\",\n        \"s3:ListBucket\",\n        \"s3:GetBucketVersioning\",\n        \"s3:GetBucketLocation\",\n        \"s3:PutBucketVersioning\",\n        \"s3:PutBucketOwnershipControls\",\n        \"s3:GetBucketOwnershipControls\"\n      ],\n      \"Resource\": [\n        \"arn:aws:s3:::*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:GetObject\",\n        \"s3:GetObjectVersion\",\n        \"s3:DeleteObject\",\n        \"s3:PutObjectVersionAcl\",\n        \"s3:GetObjectVersionAcl\",\n        \"s3:GetObjectTagging\",\n        \"s3:PutObjectTagging\",\n        \"s3:GetObjectAcl\",\n        \"s3:PutObjectAcl\",\n        \"s3:ListMultipartUploadParts\",\n        \"s3:PutObject\"\n      ],\n      \"Resource\": [\n        \"arn:aws:s3:::*/*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"kms:DescribeKey\",\n        \"kms:GenerateDataKey\",\n        \"kms:Decrypt\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"kms:ViaService\": \"s3.*.amazonaws.com\"\n        }\n      }\n    }\n  ]\n}",
    "generated": "```json\n{\n    \"Version\": \"2012-10-17\",\n    \"Statement\": [\n        {\n            \"Sid\": \"AllowBackupServiceRolePolicyForS3Restore\",\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"s3:GetObject\",\n                \"s3:PutObject\"\n            ],\n            \"Resource\": [\n                \"arn:aws:s3:::backup-vault-<VaultName>/*\",\n                \"arn:aws:s3:::backup-vault-<VaultName>\"\n            ]\n        }\n    ]\n}\n```\n\n### Explanation:\nThe following policy allows the backup service role to perform the actions required to restore from S3.\n\n* `s3:GetObject` - Allows the backup service role to retrieve objects from S3.\n* `s3:PutObject` - Allows the backup service role to upload objects to S3.",
    "complexity": "medium"
  },
  {
    "id": "aws_managed_1106",
    "instruction": "Provide an IAM policy for Amazon Data Zone Redshift Glue Provisioning Policy",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"AmazonDataZonePermissionsToCreateEnvironmentRole\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:CreateRole\",\n        \"iam:DetachRolePolicy\",\n        \"iam:DeleteRolePolicy\",\n        \"iam:AttachRolePolicy\",\n        \"iam:PutRolePolicy\"\n      ],\n      \"Resource\": \"arn:aws:iam::*:role/datazone*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"iam:PermissionsBoundary\": \"arn:aws:iam::aws:policy/AmazonDataZoneEnvironmentRolePermissionsBoundary\",\n          \"aws:CalledViaFirst\": [\n            \"cloudformation.amazonaws.com\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"IamPassRolePermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:PassRole\"\n      ],\n      \"Resource\": [\n        \"arn:aws:iam::*:role/datazone*\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"iam:PassedToService\": [\n            \"glue.amazonaws.com\",\n            \"lakeformation.amazonaws.com\"\n          ],\n          \"aws:CalledViaFirst\": [\n            \"cloudformation.amazonaws.com\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"AmazonDataZonePermissionsToManageCreatedEnvironmentRole\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:DeleteRole\",\n        \"iam:GetRole\"\n      ],\n      \"Resource\": \"arn:aws:iam::*:role/datazone*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:CalledViaFirst\": [\n            \"cloudformation.amazonaws.com\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"AmazonDataZoneCFStackCreationForEnvironments\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"cloudformation:CreateStack\",\n        \"cloudformation:TagResource\"\n      ],\n      \"Resource\": [\n        \"arn:aws:cloudformation:*:*:stack/DataZone*\"\n      ],\n      \"Condition\": {\n        \"ForAnyValue:StringLike\": {\n          \"aws:TagKeys\": \"AmazonDataZoneEnvironment\"\n        },\n        \"Null\": {\n          \"aws:ResourceTag/AmazonDataZoneEnvironment\": \"false\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"AmazonDataZoneCFStackManagementForEnvironments\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"cloudformation:DeleteStack\",\n        \"cloudformation:DescribeStacks\",\n        \"cloudformation:DescribeStackEvents\"\n      ],\n      \"Resource\": [\n        \"arn:aws:cloudformation:*:*:stack/DataZone*\"\n      ]\n    },\n    {\n      \"Sid\": \"AmazonDataZoneEnvironmentParameterValidation\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"lakeformation:GetDataLakeSettings\",\n        \"lakeformation:PutDataLakeSettings\",\n        \"lakeformation:RevokePermissions\",\n        \"lakeformation:ListPermissions\",\n        \"glue:CreateDatabase\",\n        \"glue:GetDatabase\",\n        \"athena:GetWorkGroup\",\n        \"logs:DescribeLogGroups\",\n        \"redshift-serverless:GetNamespace\",\n        \"redshift-serverless:GetWorkgroup\",\n        \"redshift:DescribeClusters\",\n        \"secretsmanager:ListSecrets\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"AmazonDataZoneEnvironmentLakeFormationPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"lakeformation:RegisterResource\",\n        \"lakeformation:DeregisterResource\",\n        \"lakeformation:GrantPermissions\",\n        \"lakeformation:ListResources\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:CalledViaFirst\": [\n            \"cloudformation.amazonaws.com\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"AmazonDataZoneEnvironmentGlueDeletePermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"glue:DeleteDatabase\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:CalledViaFirst\": [\n            \"cloudformation.amazonaws.com\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"AmazonDataZoneEnvironmentAthenaDeletePermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"athena:DeleteWorkGroup\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:CalledViaFirst\": [\n            \"cloudformation.amazonaws.com\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"AmazonDataZoneEnvironmentAthenaResourceCreation\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"athena:CreateWorkGroup\",\n        \"athena:TagResource\",\n        \"iam:TagRole\",\n        \"iam:TagPolicy\",\n        \"logs:TagLogGroup\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"ForAnyValue:StringLike\": {\n          \"aws:TagKeys\": \"AmazonDataZoneEnvironment\"\n        },\n        \"Null\": {\n          \"aws:ResourceTag/AmazonDataZoneEnvironment\": \"false\"\n        },\n        \"StringEquals\": {\n          \"aws:CalledViaFirst\": [\n            \"cloudformation.amazonaws.com\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"AmazonDataZoneEnvironmentLogGroupCreation\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"logs:CreateLogGroup\",\n        \"logs:DeleteLogGroup\"\n      ],\n      \"Resource\": \"arn:aws:logs:*:*:log-group:datazone-*\",\n      \"Condition\": {\n        \"ForAnyValue:StringLike\": {\n          \"aws:TagKeys\": \"AmazonDataZoneEnvironment\"\n        },\n        \"Null\": {\n          \"aws:ResourceTag/AmazonDataZoneEnvironment\": \"false\"\n        },\n        \"StringEquals\": {\n          \"aws:CalledViaFirst\": [\n            \"cloudformation.amazonaws.com\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"AmazonDataZoneEnvironmentLogGroupManagement\",\n      \"Action\": [\n        \"logs:PutRetentionPolicy\"\n      ],\n      \"Resource\": \"arn:aws:logs:*:*:log-group:datazone-*\",\n      \"Effect\": \"Allow\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:CalledViaFirst\": [\n            \"cloudformation.amazonaws.com\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"AmazonDataZoneEnvironmentIAMPolicyManagement\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:DeletePolicy\",\n        \"iam:CreatePolicy\",\n        \"iam:GetPolicy\",\n        \"iam:ListPolicyVersions\",\n        \"iam:DeletePolicyVersion\"\n      ],\n      \"Resource\": [\n        \"arn:aws:iam::*:policy/datazone*\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:CalledViaFirst\": [\n            \"cloudformation.amazonaws.com\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"AmazonDataZoneEnvironmentS3ValidationPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:ListAllMyBuckets\",\n        \"s3:ListBucket\"\n      ],\n      \"Resource\": \"arn:aws:s3:::*\"\n    },\n    {\n      \"Sid\": \"AmazonDataZoneEnvironmentKMSDecryptPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"kms:GenerateDataKey\",\n        \"kms:Decrypt\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"Null\": {\n          \"aws:ResourceTag/AmazonDataZoneEnvironment\": \"false\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"PermissionsToTagAmazonDataZoneEnvironmentGlueResources\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"glue:TagResource\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"ForAnyValue:StringLike\": {\n          \"aws:TagKeys\": \"AmazonDataZoneEnvironment\"\n        },\n        \"Null\": {\n          \"aws:RequestTag/AmazonDataZoneEnvironment\": \"false\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"PermissionsToGetAmazonDataZoneEnvironmentBlueprintTemplates\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"s3:GetObject\",\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringNotEquals\": {\n          \"aws:ResourceAccount\": \"${aws:PrincipalAccount}\"\n        },\n        \"StringEquals\": {\n          \"aws:CalledViaFirst\": [\n            \"cloudformation.amazonaws.com\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"RedshiftDataPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"redshift-data:ListSchemas\",\n        \"redshift-data:ExecuteStatement\"\n      ],\n      \"Resource\": [\n        \"arn:aws:redshift-serverless:*:*:workgroup/*\",\n        \"arn:aws:redshift:*:*:cluster:*\"\n      ]\n    },\n    {\n      \"Sid\": \"DescribeStatementPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"redshift-data:DescribeStatement\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"GetSecretValuePermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"secretsmanager:GetSecretValue\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"secretsmanager:ResourceTag/AmazonDataZoneDomain\": \"dzd*\"\n        }\n      }\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"glue:*\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n```\n\n### Explanation:\nThe above policy allows all actions on the Glue service. This is required to allow the provisioning of a Redshift cluster in AWS Data Zone.\n\n### References:\n* https://docs.aws.amazon.com/redshift/latest/dg/data-zone-provisioning-policy.html\n* https://docs.aws.amazon.com/IAM/latest/UserGuide/list_awssupport.html",
    "complexity": "complex"
  },
  {
    "id": "aws_managed_0155",
    "instruction": "Provide an IAM policy for Cloud Watch Events Full Access",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"EventBridgeActions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"events:*\",\n        \"schemas:*\",\n        \"scheduler:*\",\n        \"pipes:*\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"IAMCreateServiceLinkedRoleForApiDestinations\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"iam:CreateServiceLinkedRole\",\n      \"Resource\": \"arn:aws:iam::*:role/aws-service-role/apidestinations.events.amazonaws.com/AWSServiceRoleForAmazonEventBridgeApiDestinations\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"iam:AWSServiceName\": \"apidestinations.events.amazonaws.com\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"IAMCreateServiceLinkedRoleForAmazonEventBridgeSchemas\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"iam:CreateServiceLinkedRole\",\n      \"Resource\": \"arn:aws:iam::*:role/aws-service-role/schemas.amazonaws.com/AWSServiceRoleForSchemas\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"iam:AWSServiceName\": \"schemas.amazonaws.com\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"SecretsManagerAccessForApiDestinations\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"secretsmanager:CreateSecret\",\n        \"secretsmanager:UpdateSecret\",\n        \"secretsmanager:DeleteSecret\",\n        \"secretsmanager:GetSecretValue\",\n        \"secretsmanager:PutSecretValue\"\n      ],\n      \"Resource\": \"arn:aws:secretsmanager:*:*:secret:events!*\"\n    },\n    {\n      \"Sid\": \"IAMPassRoleForCloudWatchEvents\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"iam:PassRole\",\n      \"Resource\": \"arn:aws:iam::*:role/AWS_Events_Invoke_Targets\"\n    },\n    {\n      \"Sid\": \"IAMPassRoleAccessForScheduler\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"iam:PassRole\",\n      \"Resource\": \"arn:aws:iam::*:role/*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"iam:PassedToService\": \"scheduler.amazonaws.com\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"IAMPassRoleAccessForPipes\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"iam:PassRole\",\n      \"Resource\": \"arn:aws:iam::*:role/*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"iam:PassedToService\": \"pipes.amazonaws.com\"\n        }\n      }\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"events:*\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n```\n\n### Explanation:\nThe `events:*` action allows full access to the CloudWatchEvents service. This is a very powerful permission, and should be used with caution. It allows the user to create, update, delete, and manage events in the CloudWatchEvents service. This includes creating event rules, targets, and alarms. It also allows the user to view and modify existing events.\n\nIt's important to note that this permission does not allow the user to perform any actions on other AWS services. It only grants access to the CloudWatchEvents service. However, it still provides a lot of power and should be carefully considered before granting it to a user.",
    "complexity": "complex"
  },
  {
    "id": "syn_s3_003",
    "instruction": "I need a policy for our analytics team. They should be able to read from the bucket analytics-prod but only objects under the prefix reports/2024/. They also need to list the bucket contents.",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"s3:ListBucket\",\n      \"Resource\": \"arn:aws:s3:::analytics-prod\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"s3:prefix\": \"reports/2024/*\"\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"s3:GetObject\",\n      \"Resource\": \"arn:aws:s3:::analytics-prod/reports/2024/*\"\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"AllowAnalyticsTeamToReadReports\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:GetObject\",\n        \"s3:ListBucket\"\n      ],\n      \"Resource\": [\n        \"arn:aws:s3:::analytics-prod/*reports/2024/*\"\n      ]\n    }\n  ]\n}\n```",
    "complexity": "medium"
  },
  {
    "id": "aws_managed_0426",
    "instruction": "Provide an IAM policy for Well Architected Console Full Access",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"wellarchitected:*\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"wafv2:*\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:Describe*\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:GetAccountSummary\",\n        \"iam:ListAccountAliases\",\n        \"iam:ListAttachedUserPolicies\",\n        \"iam:ListAttachedRolePolicies\",\n        \"iam:ListInstanceProfilesForRole\",\n        \"iam:ListPolicyVersions\",\n        \"iam:ListRoles\",\n        \"iam:ListRolePolicies\",\n        \"iam:ListServerCertificates\",\n        \"iam:ListTagsForResource\",\n        \"iam:ListUsers\",\n        \"iam:ListUserPolicies\",\n        \"iam:PutUserPolicy\",\n        \"",
    "complexity": "simple"
  },
  {
    "id": "aws_managed_0541",
    "instruction": "Provide an IAM policy for AWS Backup Full Access",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"AwsBackupAllAccessPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"backup:*\",\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"AwsBackupStorageAllAccessPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"backup-storage:*\",\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"RdsPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"rds:DescribeDBSnapshots\",\n        \"rds:ListTagsForResource\",\n        \"rds:DescribeDBInstances\",\n        \"rds:describeDBEngineVersions\",\n        \"rds:describeOptionGroups\",\n        \"rds:describeOrderableDBInstanceOptions\",\n        \"rds:describeDBSubnetGroups\",\n        \"rds:describeDBClusterSnapshots\",\n        \"rds:describeDBClusters\",\n        \"rds:describeDBParameterGroups\",\n        \"rds:DescribeDBClusterParameterGroups\",\n        \"rds:DescribeDBInstanceAutomatedBackups\",\n        \"rds:DescribeDBClusterAutomatedBackups\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"RdsDeletePermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"rds:DeleteDBSnapshot\",\n        \"rds:DeleteDBClusterSnapshot\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"ForAnyValue:StringEquals\": {\n          \"aws:CalledVia\": [\n            \"backup.amazonaws.com\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"DynamoDbPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"dynamodb:ListBackups\",\n        \"dynamodb:ListTables\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"DynamoDbDeleteBackupPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"dynamodb:DeleteBackup\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"ForAnyValue:StringEquals\": {\n          \"aws:CalledVia\": [\n            \"backup.amazonaws.com\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"EfsFileSystemPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"elasticfilesystem:DescribeFilesystems\"\n      ],\n      \"Resource\": \"arn:aws:elasticfilesystem:*:*:file-system/*\"\n    },\n    {\n      \"Sid\": \"Ec2Permissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:DescribeSnapshots\",\n        \"ec2:DescribeVolumes\",\n        \"ec2:describeAvailabilityZones\",\n        \"ec2:DescribeVpcs\",\n        \"ec2:DescribeAccountAttributes\",\n        \"ec2:DescribeSecurityGroups\",\n        \"ec2:DescribeImages\",\n        \"ec2:DescribeSubnets\",\n        \"ec2:DescribePlacementGroups\",\n        \"ec2:DescribeInstances\",\n        \"ec2:DescribeInstanceTypes\",\n        \"ec2:DescribeVpcEndpoints\",\n        \"ec2:DescribeAddresses\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"Ec2DeletePermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:DeleteSnapshot\",\n        \"ec2:DeregisterImage\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"ForAnyValue:StringEquals\": {\n          \"aws:CalledVia\": [\n            \"backup.amazonaws.com\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"ResourceGroupTaggingPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"tag:GetTagKeys\",\n        \"tag:GetTagValues\",\n        \"tag:GetResources\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"StorageGatewayVolumePermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"storagegateway:DescribeCachediSCSIVolumes\",\n        \"storagegateway:DescribeStorediSCSIVolumes\"\n      ],\n      \"Resource\": \"arn:aws:storagegateway:*:*:gateway/*/volume/*\"\n    },\n    {\n      \"Sid\": \"StorageGatewayPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"storagegateway:ListGateways\"\n      ],\n      \"Resource\": \"arn:aws:storagegateway:*:*:*\"\n    },\n    {\n      \"Sid\": \"StorageGatewayGatewayPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"storagegateway:DescribeGatewayInformation\",\n        \"storagegateway:ListLocalDisks\"\n      ],\n      \"Resource\": \"arn:aws:storagegateway:*:*:gateway/*\"\n    },\n    {\n      \"Sid\": \"StorageGatewayGatewayStarPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"storagegateway:ListVolumes\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"IamRolePermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:ListRoles\",\n        \"iam:GetRole\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"IamPassRolePermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"iam:PassRole\",\n      \"Resource\": [\n        \"arn:aws:iam::*:role/*AwsBackup*\",\n        \"arn:aws:iam::*:role/*AWSBackup*\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"iam:PassedToService\": [\n            \"backup.amazonaws.com\",\n            \"restore-testing.backup.amazonaws.com\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"AwsOrganizationsPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"organizations:DescribeOrganization\",\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"KmsPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"kms:ListKeys\",\n        \"kms:DescribeKey\",\n        \"kms:GenerateDataKey\",\n        \"kms:ListAliases\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"KmsCreateGrantPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"kms:CreateGrant\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"ForAnyValue:StringEquals\": {\n          \"kms:EncryptionContextKeys\": \"aws:backup:backup-vault\"\n        },\n        \"Bool\": {\n          \"kms:GrantIsForAWSResource\": true\n        },\n        \"StringLike\": {\n          \"kms:ViaService\": \"backup.*.amazonaws.com\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"SystemManagerCommandPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ssm:CancelCommand\",\n        \"ssm:GetCommandInvocation\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"SystemManagerSendCommandPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"ssm:SendCommand\",\n      \"Resource\": [\n        \"arn:aws:ssm:*:*:document/AWSEC2-CreateVssSnapshot\",\n        \"arn:aws:ec2:*:*:instance/*\"\n      ]\n    },\n    {\n      \"Sid\": \"FsxPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"fsx:DescribeFileSystems\",\n        \"fsx:DescribeBackups\",\n        \"fsx:DescribeVolumes\",\n        \"fsx:DescribeStorageVirtualMachines\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"FsxDeletePermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"fsx:DeleteBackup\",\n      \"Resource\": \"arn:aws:fsx:*:*:backup/*\",\n      \"Condition\": {\n        \"ForAnyValue:StringEquals\": {\n          \"aws:CalledVia\": [\n            \"backup.amazonaws.com\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"DirectoryServicePermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"ds:DescribeDirectories\",\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"IamCreateServiceLinkedRolePermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"iam:CreateServiceLinkedRole\",\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"iam:AWSServiceName\": [\n            \"backup.amazonaws.com\",\n            \"restore-testing.backup.amazonaws.com\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"BackupGatewayPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"backup-gateway:AssociateGatewayToServer\",\n        \"backup-gateway:CreateGateway\",\n        \"backup-gateway:DeleteGateway\",\n        \"backup-gateway:DeleteHypervisor\",\n        \"backup-gateway:DisassociateGatewayFromServer\",\n        \"backup-gateway:ImportHypervisorConfiguration\",\n        \"backup-gateway:ListGateways\",\n        \"backup-gateway:ListHypervisors\",\n        \"backup-gateway:ListTagsForResource\",\n        \"backup-gateway:ListVirtualMachines\",\n        \"backup-gateway:PutMaintenanceStartTime\",\n        \"backup-gateway:TagResource\",\n        \"backup-gateway:TestHypervisorConfiguration\",\n        \"backup-gateway:UntagResource\",\n        \"backup-gateway:UpdateGatewayInformation\",\n        \"backup-gateway:UpdateHypervisor\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"BackupGatewayHypervisorPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"backup-gateway:GetHypervisor\",\n        \"backup-gateway:GetHypervisorPropertyMappings\",\n        \"backup-gateway:PutHypervisorPropertyMappings\",\n        \"backup-gateway:StartVirtualMachinesMetadataSync\"\n      ],\n      \"Resource\": \"arn:aws:backup-gateway:*:*:hypervisor/*\"\n    },\n    {\n      \"Sid\": \"BackupGatewayVirtualMachinePermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"backup-gateway:GetVirtualMachine\"\n      ],\n      \"Resource\": \"arn:aws:backup-gateway:*:*:vm/*\"\n    },\n    {\n      \"Sid\": \"BackupGatewayGatewayPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"backup-gateway:GetBandwidthRateLimitSchedule\",\n        \"backup-gateway:GetGateway\",\n        \"backup-gateway:PutBandwidthRateLimitSchedule\"\n      ],\n      \"Resource\": \"arn:aws:backup-gateway:*:*:gateway/*\"\n    },\n    {\n      \"Sid\": \"CloudWatchPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"cloudwatch:GetMetricData\",\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"TimestreamDatabasePermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"timestream:ListTables\",\n        \"timestream:ListDatabases\"\n      ],\n      \"Resource\": [\n        \"arn:aws:timestream:*:*:database/*\"\n      ]\n    },\n    {\n      \"Sid\": \"TimestreamPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"timestream:DescribeEndpoints\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"S3BucketPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:ListAllMyBuckets\"\n      ],\n      \"Resource\": \"arn:aws:s3:::*\"\n    },\n    {\n      \"Sid\": \"RedshiftResourcesPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"redshift:DescribeClusters\",\n        \"redshift:DescribeClusterSubnetGroups\",\n        \"redshift:DescribeClusterSnapshots\",\n        \"redshift:DescribeSnapshotSchedules\"\n      ],\n      \"Resource\": [\n        \"arn:aws:redshift:*:*:cluster:*\",\n        \"arn:aws:redshift:*:*:subnetgroup:*\",\n        \"arn:aws:redshift:*:*:snapshot:*/*\",\n        \"arn:aws:redshift:*:*:snapshotschedule:*\"\n      ]\n    },\n    {\n      \"Sid\": \"RedshiftPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"redshift:DescribeNodeConfigurationOptions\",\n        \"redshift:DescribeOrderableClusterOptions\",\n        \"redshift:DescribeClusterParameterGroups\",\n        \"redshift:DescribeClusterTracks\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"RedshiftServerlessListPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"redshift-serverless:ListNamespaces\",\n        \"redshift-serverless:ListSnapshots\",\n        \"redshift-serverless:ListWorkgroups\"\n      ],\n      \"Resource\": [\n        \"*\"\n      ]\n    },\n    {\n      \"Sid\": \"RedshiftServerlessGetPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"redshift-serverless:GetNamespace\",\n        \"redshift-serverless:GetSnapshot\",\n        \"redshift-serverless:GetWorkgroup\"\n      ],\n      \"Resource\": [\n        \"arn:aws:redshift-serverless:*:*:namespace/*\",\n        \"arn:aws:redshift-serverless:*:*:workgroup/*\",\n        \"arn:aws:redshift-serverless:*:*:snapshot/*\"\n      ]\n    },\n    {\n      \"Sid\": \"RedshiftServerlessDeletetPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"redshift-serverless:DeleteSnapshot\"\n      ],\n      \"Resource\": [\n        \"arn:aws:redshift-serverless:*:*:snapshot/*\"\n      ],\n      \"Condition\": {\n        \"Null\": {\n          \"aws:ResourceTag/aws:backup:source-resource\": \"false\"\n        },\n        \"ForAnyValue:StringEquals\": {\n          \"aws:CalledVia\": [\n            \"backup.amazonaws.com\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"CloudFormationStackPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"cloudformation:ListStacks\"\n      ],\n      \"Resource\": [\n        \"arn:aws:cloudformation:*:*:stack/*\"\n      ]\n    },\n    {\n      \"Sid\": \"SystemsManagerForSapPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ssm-sap:GetOperation\",\n        \"ssm-sap:ListDatabases\",\n        \"ssm-sap:GetDatabase\",\n        \"ssm-sap:ListTagsForResource\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"ResourceAccessManagerPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ram:GetResourceShareAssociations\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"DSQLDescribePermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"dsql:GetCluster\",\n        \"dsql:ListClusters\",\n        \"dsql:ListTagsForResource\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"EKSClusterPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"eks:ListClusters\",\n        \"eks:ListTagsForResource\",\n        \"eks:DescribeCluster\"\n      ],\n      \"Resource\": \"arn:aws:eks:*:*:cluster/*\"\n    },\n    {\n      \"Sid\": \"IamPassRolePermissionsForGuardDuty\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"iam:PassRole\",\n      \"Resource\": [\n        \"arn:aws:iam::*:role/*AwsBackupGuardDuty*\",\n        \"arn:aws:iam::*:role/*AWSBackupGuardDuty*\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"iam:PassedToService\": \"malware-protection.guardduty.amazonaws.com\"\n        }\n      }\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"backup:*\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n```\n\n### Explanation:\nThe above policy grants full access to the AWS Backup service. This includes the ability to create, manage, and delete backups, as well as configure backup plans and schedules. It also allows for the creation of recovery points and the restoration of data from backups.\n\nIt is important to note that this policy should only be applied to users or roles who are specifically authorized to perform these actions. Granting full access to all users can pose a security risk if not properly managed.",
    "complexity": "complex"
  },
  {
    "id": "aws_managed_0458",
    "instruction": "Provide an IAM policy for AWSIQ Full Access",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Action\": [\n        \"iq:*\",\n        \"iq-permission:*\"\n      ],\n      \"Effect\": \"Allow\",\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"iam:CreateServiceLinkedRole\",\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"iam:AWSServiceName\": [\n            \"permission.iq.amazonaws.com\",\n            \"contract.iq.amazonaws.com\"\n          ]\n        }\n      }\n    }\n  ]\n}",
    "generated": "```json\n{\n    \"Version\": \"2012-10-17\",\n    \"Statement\": [\n        {\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"iam:*\"\n            ],\n            \"Resource\": \"*\"\n        },\n        {\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"s3:*\",\n                \"ec2:*\",\n                \"autoscaling:*\",\n                \"cloudwatch:*\",\n                \"logs:*\",\n                \"sqs:*\",\n                \"dynamodb:*\",\n                \"rds:*\",\n                \"redshift:*\",\n                \"elasticache:*\",\n                \"kinesis:*\",\n                \"sns:*\",\n                \"lambda:*\",\n                \"apigateway:*\",\n                \"cloudformation:*\",\n                \"cloudtrail:*\",\n                \"organizations:*\",\n                \"sts:*\",\n                \"acm:*\",\n                \"route53:*\",\n                \"waf:*\",",
    "complexity": "medium"
  },
  {
    "id": "aws_managed_0272",
    "instruction": "Provide an IAM policy for Amazon Inspector Service Role Policy",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"directconnect:DescribeConnections\",\n        \"directconnect:DescribeDirectConnectGateways\",\n        \"directconnect:DescribeDirectConnectGatewayAssociations\",\n        \"directconnect:DescribeDirectConnectGatewayAttachments\",\n        \"directconnect:DescribeVirtualGateways\",\n        \"directconnect:DescribeVirtualInterfaces\",\n        \"directconnect:DescribeTags\",\n        \"ec2:DescribeAvailabilityZones\",\n        \"ec2:DescribeCustomerGateways\",\n        \"ec2:DescribeInstances\",\n        \"ec2:DescribeTags\",\n        \"ec2:DescribeInternetGateways\",\n        \"ec2:DescribeNatGateways\",\n        \"ec2:DescribeNetworkAcls\",\n        \"ec2:DescribeNetworkInterfaces\",\n        \"ec2:DescribePrefixLists\",\n        \"ec2:DescribeRegions\",\n        \"ec2:DescribeRouteTables\",\n        \"ec2:DescribeSecurityGroups\",\n        \"ec2:DescribeSubnets\",\n        \"ec2:DescribeVpcEndpoints\",\n        \"ec2:DescribeVpcPeeringConnections\",\n        \"ec2:DescribeVpcs\",\n        \"ec2:DescribeVpnConnections\",\n        \"ec2:DescribeVpnGateways\",\n        \"ec2:DescribeManagedPrefixLists\",\n        \"ec2:GetManagedPrefixListEntries\",\n        \"ec2:DescribeVpcEndpointServiceConfigurations\",\n        \"ec2:DescribeTransitGateways\",\n        \"ec2:DescribeTransitGatewayAttachments\",\n        \"ec2:DescribeTransitGatewayVpcAttachments\",\n        \"ec2:DescribeTransitGatewayRouteTables\",\n        \"ec2:SearchTransitGatewayRoutes\",\n        \"ec2:DescribeTransitGatewayPeeringAttachments\",\n        \"ec2:GetTransitGatewayRouteTablePropagations\",\n        \"elasticloadbalancing:DescribeListeners\",\n        \"elasticloadbalancing:DescribeLoadBalancers\",\n        \"elasticloadbalancing:DescribeLoadBalancerAttributes\",\n        \"elasticloadbalancing:DescribeRules\",\n        \"elasticloadbalancing:DescribeTags\",\n        \"elasticloadbalancing:DescribeTargetGroups\",\n        \"elasticloadbalancing:DescribeTargetHealth\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"inspector:*\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n```\n\n### Explanation:\nThe following policy allows the Amazon Inspector service role to perform all actions on all resources.\n\n### References:\n* https://docs.aws.amazon.com/inspector/latest/userguide/service-role-policy.html\n* https://docs.aws.amazon.com/inspector/latest/APIReference/API_AssessTarget.html\n* https://docs.aws.amazon.com/inspector/latest/APIReference/API_CreateAssessmentRun.html\n* https://docs.aws.amazon.com/inspector/latest/APIReference/API_DescribeAssessmentRuns.html\n* https://docs.aws.amazon.com/inspector/latest/APIReference/API_GetFindings.html\n* https://docs.",
    "complexity": "medium"
  },
  {
    "id": "aws_managed_1014",
    "instruction": "Provide an IAM policy for Amazon Detective Member Access",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"detective:AcceptInvitation\",\n        \"detective:BatchGetMembershipDatasources\",\n        \"detective:DisassociateMembership\",\n        \"detective:GetFreeTrialEligibility\",\n        \"detective:GetPricingInformation\",\n        \"detective:GetUsageInformation\",\n        \"detective:ListInvitations\",\n        \"detective:RejectInvitation\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"detective:*\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n```\n\n### Explanation:\nThis policy allows the user to perform all actions on the Detective service.\n\n### References:\n* https://docs.aws.amazon.com/IAM/latest/UserGuide/list_amazondetective.html\n\n### Last Modified Date:\n2023-04-18",
    "complexity": "simple"
  },
  {
    "id": "aws_managed_0529",
    "instruction": "Provide an IAM policy for AWS Savings Plans Full Access",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"savingsplans:*\",\n      \"Resource\": \"*\"\n    }\n  ]\n}",
    "generated": "```json\n{\n    \"Version\": \"2012-10-17\",\n    \"Statement\": [\n        {\n            \"Sid\": \"AllowSavingsPlansFullAccess\",\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"savingsplans:*\"\n            ],\n            \"Resource\": \"*\"\n        }\n    ]\n}\n```\n\n### Explanation:\nThe above policy allows all actions on Savings Plans. This is the recommended approach to granting access to Savings Plans, as it provides the most granular control over which resources can be accessed and modified.\n\n### References:\n[AWS Savings Plans](https://aws.amazon.com/savings-plans/)\n\n[AWS Savings Plans API Reference](https://docs.aws.amazon.com/savingsplans/latest/APIReference/Welcome.html)",
    "complexity": "simple"
  },
  {
    "id": "aws_managed_1419",
    "instruction": "Provide an IAM policy for AWS Mcp Service Actions Full Access",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"AllowAllMCPServiceActions\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"*\",\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"Bool\": {\n          \"aws:IsMcpServiceAction\": \"true\"\n        }\n      }\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"mcp:*\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n```\n\n### Explanation:\nThe above policy allows all actions on the MCP service. This is a very broad policy and should only be used in development or testing environments. In production, you should limit access to specific resources and actions as needed.\n\n### References:\n[AWS Mcp Service Actions](https://docs.aws.amazon.com/service-authorization/latest/reference/list_mcp.html)",
    "complexity": "simple"
  },
  {
    "id": "aws_managed_0954",
    "instruction": "Provide an IAM policy for AWS Support Plans Full Access",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"supportplans:GetSupportPlan\",\n        \"supportplans:GetSupportPlanUpdateStatus\",\n        \"supportplans:ListSupportPlanModifiers\",\n        \"supportplans:StartSupportPlanUpdate\",\n        \"supportplans:CreateSupportPlanSchedule\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"support:*\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n```\n\n### Explanation:\nThe above policy allows the user to perform all actions related to AWS Support Plans. This includes creating, modifying, and deleting support plans, as well as managing associated resources such as contacts and billing information. It is important to note that this policy should only be applied to users who are specifically responsible for managing AWS Support Plans, as granting this level of access to all users can lead to security risks and unnecessary costs.",
    "complexity": "simple"
  },
  {
    "id": "aws_managed_0745",
    "instruction": "Provide an IAM policy for Amazon Prometheus Console Full Access",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"tag:GetTagValues\",\n        \"tag:GetTagKeys\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"aps:CreateWorkspace\",\n        \"aps:DescribeWorkspace\",\n        \"aps:UpdateWorkspaceAlias\",\n        \"aps:DeleteWorkspace\",\n        \"aps:ListWorkspaces\",\n        \"aps:DescribeAlertManagerDefinition\",\n        \"aps:DescribeRuleGroupsNamespace\",\n        \"aps:CreateAlertManagerDefinition\",\n        \"aps:CreateRuleGroupsNamespace\",\n        \"aps:DeleteAlertManagerDefinition\",\n        \"aps:DeleteRuleGroupsNamespace\",\n        \"aps:ListRuleGroupsNamespaces\",\n        \"aps:PutAlertManagerDefinition\",\n        \"aps:PutRuleGroupsNamespace\",\n        \"aps:TagResource\",\n        \"aps:UntagResource\",\n        \"aps:CreateLoggingConfiguration\",\n        \"aps:UpdateLoggingConfiguration\",\n        \"aps:DeleteLoggingConfiguration\",\n        \"aps:DescribeLoggingConfiguration\",\n        \"aps:UpdateWorkspaceConfiguration\",\n        \"aps:DescribeWorkspaceConfiguration\",\n        \"aps:CreateQueryLoggingConfiguration\",\n        \"aps:UpdateQueryLoggingConfiguration\",\n        \"aps:DeleteQueryLoggingConfiguration\",\n        \"aps:DescribeQueryLoggingConfiguration\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"prometheusconsole:*\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n```\n\n### Explanation:\nThe `prometheusconsole:*` action allows full access to the Amazon Prometheus Console. This includes creating, updating, and deleting resources, as well as managing permissions and tags. It is important to note that this policy should only be used in specific cases where full access is required, such as when setting up a new environment or troubleshooting issues. In general, it is recommended to use more restrictive policies that grant only the necessary permissions to perform specific tasks.",
    "complexity": "medium"
  },
  {
    "id": "aws_managed_0043",
    "instruction": "Provide an IAM policy for Amazon Work Mail Read Only Access",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ses:Describe*\",\n        \"ses:Get*\",\n        \"workmail:Describe*\",\n        \"workmail:Get*\",\n        \"workmail:List*\",\n        \"workmail:Search*\",\n        \"lambda:ListFunctions\",\n        \"iam:ListRoles\",\n        \"logs:DescribeLogGroups\",\n        \"cloudwatch:GetMetricData\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"workmail:GetAccountSettings\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"workmail:ListUsers\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n```\n\n### Explanation:\nThe following policy allows the user to view account settings and list users.\n\n### References:\n* https://docs.aws.amazon.com/workmail/latest/adminguide/iam-policies-for-workmail.html",
    "complexity": "complex"
  },
  {
    "id": "aws_managed_0714",
    "instruction": "Provide an IAM policy for AWS Panorama Service Role Policy",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"PanoramaIoTThingAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iot:CreateThing\",\n        \"iot:DeleteThing\",\n        \"iot:DeleteThingShadow\",\n        \"iot:DescribeThing\",\n        \"iot:GetThingShadow\",\n        \"iot:UpdateThing\",\n        \"iot:UpdateThingShadow\"\n      ],\n      \"Resource\": [\n        \"arn:aws:iot:*:*:thing/panorama*\"\n      ]\n    },\n    {\n      \"Sid\": \"PanoramaIoTCertificateAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iot:AttachThingPrincipal\",\n        \"iot:DetachThingPrincipal\",\n        \"iot:UpdateCertificate\",\n        \"iot:DeleteCertificate\",\n        \"iot:AttachPrincipalPolicy\",\n        \"iot:DetachPrincipalPolicy\"\n      ],\n      \"Resource\": [\n        \"arn:aws:iot:*:*:thing/panorama*\",\n        \"arn:aws:iot:*:*:cert/*\"\n      ]\n    },\n    {\n      \"Sid\": \"PanoramaIoTCreateCertificateAndPolicyAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iot:CreateKeysAndCertificate\",\n        \"iot:CreatePolicy\"\n      ],\n      \"Resource\": [\n        \"*\"\n      ]\n    },\n    {\n      \"Sid\": \"PanoramaIoTCreatePolicyVersionAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iot:CreatePolicyVersion\"\n      ],\n      \"Resource\": [\n        \"arn:aws:iot:*:*:policy/panorama*\"\n      ]\n    },\n    {\n      \"Sid\": \"PanoramaIoTJobAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iot:DescribeJobExecution\",\n        \"iot:CreateJob\",\n        \"iot:DeleteJob\"\n      ],\n      \"Resource\": [\n        \"arn:aws:iot:*:*:job/panorama*\",\n        \"arn:aws:iot:*:*:thing/panorama*\"\n      ]\n    },\n    {\n      \"Sid\": \"PanoramaIoTEndpointAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iot:DescribeEndpoint\"\n      ],\n      \"Resource\": [\n        \"*\"\n      ]\n    },\n    {\n      \"Sid\": \"PanoramaAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"panorama:Describe*\",\n        \"panorama:List*\",\n        \"panorama:Get*\"\n      ],\n      \"Resource\": [\n        \"*\"\n      ]\n    },\n    {\n      \"Sid\": \"PanoramaS3Access\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:GetObject\",\n        \"s3:PutObject\",\n        \"s3:DeleteObject\",\n        \"s3:DeleteBucket\",\n        \"s3:ListBucket\",\n        \"s3:GetBucket*\",\n        \"s3:CreateBucket\"\n      ],\n      \"Resource\": [\n        \"arn:aws:s3:::*aws-panorama*\"\n      ]\n    },\n    {\n      \"Sid\": \"PanoramaIAMPassSageMakerRoleAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:PassRole\"\n      ],\n      \"Resource\": [\n        \"arn:aws:iam::*:role/AWSPanoramaSageMakerRole\",\n        \"arn:aws:iam::*:role/service-role/AWSPanoramaSageMakerRole\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"iam:PassedToService\": [\n            \"sagemaker.amazonaws.com\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"PanoramaIAMPassGreengrassRoleAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:PassRole\"\n      ],\n      \"Resource\": [\n        \"arn:aws:iam::*:role/AWSPanoramaGreengrassGroupRole\",\n        \"arn:aws:iam::*:role/service-role/AWSPanoramaGreengrassGroupRole\",\n        \"arn:aws:iam::*:role/AWSPanoramaGreengrassRole\",\n        \"arn:aws:iam::*:role/service-role/AWSPanoramaGreengrassRole\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"iam:PassedToService\": [\n            \"greengrass.amazonaws.com\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"PanoramaIAMPassIoTRoleAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:PassRole\"\n      ],\n      \"Resource\": [\n        \"arn:aws:iam::*:role/AWSPanoramaApplianceRole\",\n        \"arn:aws:iam::*:role/service-role/AWSPanoramaApplianceRole\"\n      ],\n      \"Condition\": {\n        \"StringEqualsIfExists\": {\n          \"iam:PassedToService\": \"iot.amazonaws.com\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"PanoramaGreenGrassAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"greengrass:AssociateRoleToGroup\",\n        \"greengrass:AssociateServiceRoleToAccount\",\n        \"greengrass:CreateResourceDefinition\",\n        \"greengrass:CreateResourceDefinitionVersion\",\n        \"greengrass:CreateCoreDefinition\",\n        \"greengrass:CreateCoreDefinitionVersion\",\n        \"greengrass:CreateDeployment\",\n        \"greengrass:CreateFunctionDefinition\",\n        \"greengrass:CreateFunctionDefinitionVersion\",\n        \"greengrass:CreateGroup\",\n        \"greengrass:CreateGroupCertificateAuthority\",\n        \"greengrass:CreateGroupVersion\",\n        \"greengrass:CreateLoggerDefinition\",\n        \"greengrass:CreateLoggerDefinitionVersion\",\n        \"greengrass:CreateSubscriptionDefinition\",\n        \"greengrass:CreateSubscriptionDefinitionVersion\",\n        \"greengrass:DeleteCoreDefinition\",\n        \"greengrass:DeleteFunctionDefinition\",\n        \"greengrass:DeleteResourceDefinition\",\n        \"greengrass:DeleteGroup\",\n        \"greengrass:DeleteLoggerDefinition\",\n        \"greengrass:DeleteSubscriptionDefinition\",\n        \"greengrass:DisassociateRoleFromGroup\",\n        \"greengrass:DisassociateServiceRoleFromAccount\",\n        \"greengrass:GetAssociatedRole\",\n        \"greengrass:GetConnectivityInfo\",\n        \"greengrass:GetCoreDefinition\",\n        \"greengrass:GetCoreDefinitionVersion\",\n        \"greengrass:GetDeploymentStatus\",\n        \"greengrass:GetDeviceDefinition\",\n        \"greengrass:GetDeviceDefinitionVersion\",\n        \"greengrass:GetFunctionDefinition\",\n        \"greengrass:GetFunctionDefinitionVersion\",\n        \"greengrass:GetGroup\",\n        \"greengrass:GetGroupCertificateAuthority\",\n        \"greengrass:GetGroupCertificateConfiguration\",\n        \"greengrass:GetGroupVersion\",\n        \"greengrass:GetLoggerDefinition\",\n        \"greengrass:GetLoggerDefinitionVersion\",\n        \"greengrass:GetResourceDefinition\",\n        \"greengrass:GetServiceRoleForAccount\",\n        \"greengrass:GetSubscriptionDefinition\",\n        \"greengrass:GetSubscriptionDefinitionVersion\",\n        \"greengrass:ListCoreDefinitionVersions\",\n        \"greengrass:ListCoreDefinitions\",\n        \"greengrass:ListDeployments\",\n        \"greengrass:ListDeviceDefinitionVersions\",\n        \"greengrass:ListDeviceDefinitions\",\n        \"greengrass:ListFunctionDefinitionVersions\",\n        \"greengrass:ListFunctionDefinitions\",\n        \"greengrass:ListGroupCertificateAuthorities\",\n        \"greengrass:ListGroupVersions\",\n        \"greengrass:ListGroups\",\n        \"greengrass:ListLoggerDefinitionVersions\",\n        \"greengrass:ListLoggerDefinitions\",\n        \"greengrass:ListSubscriptionDefinitionVersions\",\n        \"greengrass:ListSubscriptionDefinitions\",\n        \"greengrass:ResetDeployments\",\n        \"greengrass:UpdateConnectivityInfo\",\n        \"greengrass:UpdateCoreDefinition\",\n        \"greengrass:UpdateDeviceDefinition\",\n        \"greengrass:UpdateFunctionDefinition\",\n        \"greengrass:UpdateGroup\",\n        \"greengrass:UpdateGroupCertificateConfiguration\",\n        \"greengrass:UpdateLoggerDefinition\",\n        \"greengrass:UpdateSubscriptionDefinition\",\n        \"greengrass:UpdateResourceDefinition\"\n      ],\n      \"Resource\": [\n        \"*\"\n      ]\n    },\n    {\n      \"Sid\": \"PanoramaLambdaUsersFunctionAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"lambda:GetFunction\",\n        \"lambda:GetFunctionConfiguration\",\n        \"lambda:ListFunctions\",\n        \"lambda:ListVersionsByFunction\"\n      ],\n      \"Resource\": [\n        \"arn:aws:lambda:*:*:function:*\"\n      ]\n    },\n    {\n      \"Sid\": \"PanoramaSageMakerWriteAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"sagemaker:CreateTrainingJob\",\n        \"sagemaker:StopTrainingJob\",\n        \"sagemaker:CreateCompilationJob\",\n        \"sagemaker:DescribeCompilationJob\",\n        \"sagemaker:StopCompilationJob\"\n      ],\n      \"Resource\": [\n        \"arn:aws:sagemaker:*:*:training-job/panorama*\",\n        \"arn:aws:sagemaker:*:*:compilation-job/panorama*\"\n      ]\n    },\n    {\n      \"Sid\": \"PanoramaSageMakerListAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"sagemaker:ListCompilationJobs\"\n      ],\n      \"Resource\": [\n        \"*\"\n      ]\n    },\n    {\n      \"Sid\": \"PanoramaSageMakerReadAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"sagemaker:DescribeTrainingJob\"\n      ],\n      \"Resource\": [\n        \"arn:aws:sagemaker:*:*:training-job/*\"\n      ]\n    },\n    {\n      \"Sid\": \"PanoramaCWLogsAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iot:AttachPolicy\",\n        \"iot:CreateRoleAlias\"\n      ],\n      \"Resource\": [\n        \"arn:aws:iot:*:*:policy/panorama*\",\n        \"arn:aws:iot:*:*:rolealias/panorama*\"\n      ]\n    }\n  ]\n}",
    "generated": "```json\n{\n    \"Version\": \"2012-10-17\",\n    \"Statement\": [\n        {\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"ec2:*\"\n            ],\n            \"Resource\": \"*\"\n        },\n        {\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"s3:*\"\n            ],\n            \"Resource\": \"*\"\n        },\n        {\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"logs:*\"\n            ],\n            \"Resource\": \"*\"\n        },\n        {\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"iam:*\"\n            ],\n            \"Resource\": \"*\"\n        },\n        {\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"autoscaling:*\"\n            ],\n            \"Resource\": \"*\"\n        },\n        {\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"cloudwatch:*\"\n            ],\n            \"Resource\": \"*\"\n        },",
    "complexity": "complex"
  },
  {
    "id": "aws_managed_1410",
    "instruction": "Provide an IAM policy for Amazon MWAA Serverless Service Role Policy",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:AttachNetworkInterface\",\n        \"ec2:CreateNetworkInterface\",\n        \"ec2:CreateNetworkInterfacePermission\",\n        \"ec2:DeleteNetworkInterface\",\n        \"ec2:DeleteNetworkInterfacePermission\",\n        \"ec2:DescribeDhcpOptions\",\n        \"ec2:DescribeNetworkInterfaces\",\n        \"ec2:DescribeSecurityGroups\",\n        \"ec2:DescribeSubnets\",\n        \"ec2:DescribeVpcs\",\n        \"ec2:DetachNetworkInterface\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"logs:*\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:*\",\n        \"s3-object-lambda:*\"\n      ],\n      \"Resource\": [\n        \"arn:aws:s3:::mwaa-bucket-*\",\n        \"arn:aws:s3:::mwaa-bucket-*/*\"\n      ]\n    }\n  ]\n}\n```",
    "complexity": "simple"
  },
  {
    "id": "syn_lambda_002",
    "instruction": "Allow invoking a specific Lambda function named process-orders in us-east-1 for account 123456789012",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"lambda:InvokeFunction\",\n      \"Resource\": \"arn:aws:lambda:us-east-1:123456789012:function:process-orders\"\n    }\n  ]\n}",
    "generated": "{\n    \"Version\": \"2012-10-17\",\n    \"Statement\": [\n        {\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"lambda:InvokeFunction\"\n            ],\n            \"Resource\": [\n                \"arn:aws:lambda:us-east-1:123456789012:function:process-orders\"\n            ]\n        }\n    ]\n}",
    "complexity": "simple"
  },
  {
    "id": "aws_managed_1042",
    "instruction": "Provide an IAM policy for AWS Proton Service Git Sync Service Role Policy",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"ProtonServiceSync\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"proton:GetService\",\n        \"proton:UpdateService\",\n        \"proton:UpdateServicePipeline\",\n        \"proton:GetServiceInstance\",\n        \"proton:CreateServiceInstance\",\n        \"proton:UpdateServiceInstance\",\n        \"proton:ListServiceInstances\",\n        \"proton:GetComponent\",\n        \"proton:CreateComponent\",\n        \"proton:ListComponents\",\n        \"proton:UpdateComponent\",\n        \"proton:GetEnvironment\",\n        \"proton:CreateEnvironment\",\n        \"proton:ListEnvironments\",\n        \"proton:UpdateEnvironment\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:GetObject\",\n        \"s3:ListBucket\"\n      ],\n      \"Resource\": [\n        \"arn:aws:s3:::proton-git-sync-service-bucket/*\",\n        \"arn:aws:s3:::proton-git-sync-service-bucket\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:PutObject\",\n        \"s3:DeleteObject\"\n      ],\n      \"Resource\": [\n        \"arn:aws:s3:::proton-git-sync-service-bucket/*\",\n        \"arn:aws:s3:::proton-git-sync-service-bucket\"\n      ]\n    }\n  ]\n}\n```",
    "complexity": "simple"
  },
  {
    "id": "aws_managed_1007",
    "instruction": "Provide an IAM policy for AWS Outposts Authorize Server Policy",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"outposts:StartConnection\",\n        \"outposts:GetConnection\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:AuthorizeSecurityGroupIngress\",\n        \"ec2:RevokeSecurityGroupIngress\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:CreateNetworkInterface\",\n        \"ec2:DeleteNetworkInterface\",\n        \"ec2:Describe*\",\n        \"ec2:ModifyNetworkInterfaceAttribute\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:CreateTags\",\n        \"ec2:DeleteTags\",\n        \"ec2:Describe*\",\n        \"ec2:Get*\",\n        \"ec2:List*\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:CreateRouteTable\",",
    "complexity": "simple"
  },
  {
    "id": "aws_managed_1099",
    "instruction": "Provide an IAM policy for Amazon Launch Wizard Full Access V2",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"AppInsightsActions0\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"applicationinsights:*\",\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"ResourceGroupActions0\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"resource-groups:List*\",\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"Route53Actions0\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"route53:ChangeResourceRecordSets\",\n        \"route53:GetChange\",\n        \"route53:ListResourceRecordSets\",\n        \"route53:ListHostedZones\",\n        \"route53:ListHostedZonesByName\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"S3Actions0\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:ListAllMyBuckets\",\n        \"s3:ListBucket\",\n        \"s3:GetBucketLocation\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"KmsActions0\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"kms:ListKeys\",\n        \"kms:ListAliases\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"CloudWatchActions0\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"cloudwatch:List*\",\n        \"cloudwatch:Get*\",\n        \"cloudwatch:Describe*\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"Ec2Actions0\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:CreateInternetGateway\",\n        \"ec2:CreateNatGateway\",\n        \"ec2:CreateVpc\",\n        \"ec2:CreateKeyPair\",\n        \"ec2:CreateRoute\",\n        \"ec2:CreateRouteTable\",\n        \"ec2:CreateSubnet\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"Ec2Actions1\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:AllocateAddress\",\n        \"ec2:AllocateHosts\",\n        \"ec2:AssignPrivateIpAddresses\",\n        \"ec2:AssociateAddress\",\n        \"ec2:CreateDhcpOptions\",\n        \"ec2:CreateEgressOnlyInternetGateway\",\n        \"ec2:CreateNetworkInterface\",\n        \"ec2:CreateVolume\",\n        \"ec2:CreateVpcEndpoint\",\n        \"ec2:CreateTags\",\n        \"ec2:DeleteTags\",\n        \"ec2:RunInstances\",\n        \"ec2:StartInstances\",\n        \"ec2:ModifyInstanceAttribute\",\n        \"ec2:ModifySubnetAttribute\",\n        \"ec2:ModifyVolumeAttribute\",\n        \"ec2:ModifyVpcAttribute\",\n        \"ec2:AssociateDhcpOptions\",\n        \"ec2:AssociateSubnetCidrBlock\",\n        \"ec2:AttachInternetGateway\",\n        \"ec2:AttachNetworkInterface\",\n        \"ec2:AttachVolume\",\n        \"ec2:DeleteDhcpOptions\",\n        \"ec2:DeleteInternetGateway\",\n        \"ec2:DeleteKeyPair\",\n        \"ec2:DeleteNatGateway\",\n        \"ec2:DeleteSecurityGroup\",\n        \"ec2:DeleteVolume\",\n        \"ec2:DeleteVpc\",\n        \"ec2:DetachInternetGateway\",\n        \"ec2:DetachVolume\",\n        \"ec2:DeleteSnapshot\",\n        \"ec2:AssociateRouteTable\",\n        \"ec2:AssociateVpcCidrBlock\",\n        \"ec2:DeleteNetworkAcl\",\n        \"ec2:DeleteNetworkInterface\",\n        \"ec2:DeleteNetworkInterfacePermission\",\n        \"ec2:DeleteRoute\",\n        \"ec2:DeleteRouteTable\",\n        \"ec2:DeleteSubnet\",\n        \"ec2:DetachNetworkInterface\",\n        \"ec2:DisassociateAddress\",\n        \"ec2:DisassociateVpcCidrBlock\",\n        \"ec2:GetLaunchTemplateData\",\n        \"ec2:ModifyNetworkInterfaceAttribute\",\n        \"ec2:ModifyVolume\",\n        \"ec2:AuthorizeSecurityGroupEgress\",\n        \"ec2:GetConsoleOutput\",\n        \"ec2:GetPasswordData\",\n        \"ec2:ReleaseAddress\",\n        \"ec2:ReplaceRoute\",\n        \"ec2:ReplaceRouteTableAssociation\",\n        \"ec2:RevokeSecurityGroupEgress\",\n        \"ec2:RevokeSecurityGroupIngress\",\n        \"ec2:DisassociateIamInstanceProfile\",\n        \"ec2:DisassociateRouteTable\",\n        \"ec2:DisassociateSubnetCidrBlock\",\n        \"ec2:ModifyInstancePlacement\",\n        \"ec2:DeletePlacementGroup\",\n        \"ec2:CreatePlacementGroup\",\n        \"elasticfilesystem:DeleteFileSystem\",\n        \"elasticfilesystem:DeleteMountTarget\",\n        \"ds:AddIpRoutes\",\n        \"ds:CreateComputer\",\n        \"ds:CreateMicrosoftAD\",\n        \"ds:DeleteDirectory\",\n        \"servicecatalog:AssociateProductWithPortfolio\",\n        \"cloudformation:GetTemplateSummary\",\n        \"sts:GetCallerIdentity\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"ForAnyValue:StringEquals\": {\n          \"aws:CalledVia\": \"launchwizard.amazonaws.com\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"CloudFormationActions0\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"cloudformation:DescribeStack*\",\n        \"cloudformation:Get*\",\n        \"cloudformation:ListStacks\",\n        \"cloudformation:SignalResource\",\n        \"cloudformation:DeleteStack\"\n      ],\n      \"Resource\": [\n        \"arn:aws:cloudformation:*:*:stack/LaunchWizard*/*\",\n        \"arn:aws:cloudformation:*:*:stack/ApplicationInsights*/*\"\n      ]\n    },\n    {\n      \"Sid\": \"Ec2Actions2\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:StopInstances\",\n        \"ec2:TerminateInstances\"\n      ],\n      \"Resource\": \"arn:aws:ec2:*:*:instance/*\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"ec2:ResourceTag/aws:cloudformation:stack-id\": \"arn:aws:cloudformation:*:*:stack/LaunchWizard-*/*\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"IamActions0\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:CreateInstanceProfile\",\n        \"iam:DeleteInstanceProfile\",\n        \"iam:RemoveRoleFromInstanceProfile\",\n        \"iam:AddRoleToInstanceProfile\"\n      ],\n      \"Resource\": [\n        \"arn:aws:iam::*:role/service-role/AmazonEC2RoleForLaunchWizard*\",\n        \"arn:aws:iam::*:instance-profile/LaunchWizard*\"\n      ]\n    },\n    {\n      \"Sid\": \"IamActions1\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:PassRole\"\n      ],\n      \"Resource\": [\n        \"arn:aws:iam::*:role/service-role/AmazonEC2RoleForLaunchWizard\",\n        \"arn:aws:iam::*:role/service-role/AmazonLambdaRoleForLaunchWizard\",\n        \"arn:aws:iam::*:instance-profile/LaunchWizard*\"\n      ],\n      \"Condition\": {\n        \"StringEqualsIfExists\": {\n          \"iam:PassedToService\": [\n            \"lambda.amazonaws.com\",\n            \"ec2.amazonaws.com\",\n            \"ec2.amazonaws.com.cn\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"AutoScalingActions0\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"autoscaling:AttachInstances\",\n        \"autoscaling:CreateAutoScalingGroup\",\n        \"autoscaling:CreateLaunchConfiguration\",\n        \"autoscaling:DeleteAutoScalingGroup\",\n        \"autoscaling:DeleteLaunchConfiguration\",\n        \"autoscaling:UpdateAutoScalingGroup\",\n        \"autoscaling:CreateOrUpdateTags\",\n        \"resource-groups:CreateGroup\",\n        \"resource-groups:DeleteGroup\",\n        \"sns:ListSubscriptionsByTopic\",\n        \"sns:Publish\",\n        \"ssm:DeleteDocument\",\n        \"ssm:DeleteParameter*\",\n        \"ssm:DescribeDocument*\",\n        \"ssm:GetDocument\",\n        \"ssm:PutParameter\"\n      ],\n      \"Resource\": [\n        \"arn:aws:resource-groups:*:*:group/LaunchWizard*\",\n        \"arn:aws:sns:*:*:*\",\n        \"arn:aws:autoscaling:*:*:autoScalingGroup:*:autoScalingGroupName/LaunchWizard*\",\n        \"arn:aws:autoscaling:*:*:launchConfiguration:*:launchConfigurationName/LaunchWizard*\",\n        \"arn:aws:ssm:*:*:parameter/LaunchWizard*\",\n        \"arn:aws:ssm:*:*:document/LaunchWizard*\"\n      ]\n    },\n    {\n      \"Sid\": \"SsmActions0\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ssm:GetDocument\",\n        \"ssm:SendCommand\"\n      ],\n      \"Resource\": [\n        \"arn:aws:ssm:*::document/AWS-RunShellScript\"\n      ]\n    },\n    {\n      \"Sid\": \"SsmActions1\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ssm:SendCommand\"\n      ],\n      \"Resource\": [\n        \"arn:aws:ec2:*:*:instance/*\"\n      ],\n      \"Condition\": {\n        \"StringLike\": {\n          \"aws:ResourceTag/aws:cloudformation:stack-id\": \"arn:aws:cloudformation:*:*:stack/LaunchWizard-*/*\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"SsmActions2\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ssm:AddTagsToResource\",\n        \"ssm:DescribeDocument\",\n        \"ssm:GetDocument\",\n        \"ssm:ListTagsForResource\",\n        \"ssm:RemoveTagsFromResource\"\n      ],\n      \"Resource\": [\n        \"arn:aws:ssm:*:*:parameter/LaunchWizard*\",\n        \"arn:aws:ssm:*:*:document/LaunchWizard*\"\n      ]\n    },\n    {\n      \"Sid\": \"SsmActions3\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"autoscaling:Describe*\",\n        \"cloudformation:DescribeAccountLimits\",\n        \"cloudformation:DescribeStackDriftDetectionStatus\",\n        \"cloudformation:List*\",\n        \"cloudformation:ValidateTemplate\",\n        \"ds:Describe*\",\n        \"ds:ListAuthorizedApplications\",\n        \"ec2:Describe*\",\n        \"ec2:Get*\",\n        \"iam:GetRole\",\n        \"iam:GetRolePolicy\",\n        \"iam:GetUser\",\n        \"iam:GetPolicyVersion\",\n        \"iam:GetPolicy\",\n        \"iam:List*\",\n        \"resource-groups:Get*\",\n        \"resource-groups:List*\",\n        \"servicequotas:GetServiceQuota\",\n        \"servicequotas:ListServiceQuotas\",\n        \"sns:ListSubscriptions\",\n        \"sns:ListTopics\",\n        \"ssm:CreateDocument\",\n        \"ssm:DescribeAutomation*\",\n        \"ssm:DescribeInstanceInformation\",\n        \"ssm:DescribeParameters\",\n        \"ssm:GetAutomationExecution\",\n        \"ssm:GetCommandInvocation\",\n        \"ssm:GetParameter*\",\n        \"ssm:GetConnectionStatus\",\n        \"ssm:ListCommand*\",\n        \"ssm:ListDocument*\",\n        \"ssm:ListInstanceAssociations\",\n        \"ssm:SendAutomationSignal\",\n        \"tag:Get*\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"SsmActions4\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ssm:StartAutomationExecution\",\n        \"ssm:StopAutomationExecution\"\n      ],\n      \"Resource\": \"arn:aws:ssm:*:*:automation-definition/LaunchWizard-*:*\",\n      \"Condition\": {\n        \"ForAnyValue:StringEquals\": {\n          \"aws:CalledVia\": \"launchwizard.amazonaws.com\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"CloudFormationActions1\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"cloudformation:List*\",\n        \"cloudformation:Describe*\"\n      ],\n      \"Resource\": \"arn:aws:cloudformation:*:*:stack/LaunchWizard*/\"\n    },\n    {\n      \"Sid\": \"IamActions2\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:CreateServiceLinkedRole\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"iam:AWSServiceName\": [\n            \"autoscaling.amazonaws.com\",\n            \"application-insights.amazonaws.com\",\n            \"events.amazonaws.com\",\n            \"autoscaling.amazonaws.com.cn\",\n            \"events.amazonaws.com.cn\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"LaunchWizardActions0\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"launchwizard:*\",\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"SqsActions0\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"sqs:TagQueue\",\n        \"sqs:GetQueueUrl\",\n        \"sqs:AddPermission\",\n        \"sqs:ListQueues\",\n        \"sqs:DeleteQueue\",\n        \"sqs:GetQueueAttributes\",\n        \"sqs:ListQueueTags\",\n        \"sqs:CreateQueue\",\n        \"sqs:SetQueueAttributes\"\n      ],\n      \"Resource\": \"arn:aws:sqs:*:*:LaunchWizard*\"\n    },\n    {\n      \"Sid\": \"CloudWatchActions1\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"cloudwatch:PutMetricAlarm\",\n        \"iam:GetInstanceProfile\",\n        \"cloudwatch:DeleteAlarms\",\n        \"cloudwatch:DescribeAlarms\"\n      ],\n      \"Resource\": [\n        \"arn:aws:cloudwatch:*:*:alarm:LaunchWizard*\",\n        \"arn:aws:iam::*:instance-profile/LaunchWizard*\"\n      ]\n    },\n    {\n      \"Sid\": \"EfsActions0\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"cloudformation:CreateStack\",\n        \"route53:ListHostedZones\",\n        \"ec2:CreateSecurityGroup\",\n        \"ec2:AuthorizeSecurityGroupIngress\",\n        \"elasticfilesystem:DescribeFileSystems\",\n        \"elasticfilesystem:CreateFileSystem\",\n        \"elasticfilesystem:CreateMountTarget\",\n        \"elasticfilesystem:DescribeMountTargets\",\n        \"elasticfilesystem:DescribeMountTargetSecurityGroups\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"S3Actions1\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:GetObject\",\n        \"s3:PutObject\"\n      ],\n      \"Resource\": [\n        \"arn:aws:s3:::launchwizard*\",\n        \"arn:aws:s3:::launchwizard*/*\",\n        \"arn:aws:s3:::aws-sap-data-provider/config.properties\"\n      ]\n    },\n    {\n      \"Sid\": \"CloudFormationActions2\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"cloudformation:TagResource\",\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"ForAllValues:StringLike\": {\n          \"aws:TagKeys\": \"LaunchWizard*\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"LambdaActions0\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:CreateBucket\",\n        \"s3:PutBucketVersioning\",\n        \"s3:DeleteBucket\",\n        \"lambda:CreateFunction\",\n        \"lambda:DeleteFunction\",\n        \"lambda:GetFunction\",\n        \"lambda:GetFunctionConfiguration\",\n        \"lambda:InvokeFunction\"\n      ],\n      \"Resource\": [\n        \"arn:aws:lambda:*:*:function:LaunchWizard*\",\n        \"arn:aws:s3:::launchwizard*\"\n      ]\n    },\n    {\n      \"Sid\": \"DynamodbActions0\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"dynamodb:CreateTable\",\n        \"dynamodb:DescribeTable\",\n        \"dynamodb:DeleteTable\"\n      ],\n      \"Resource\": \"arn:aws:dynamodb:*:*:table/LaunchWizard*\"\n    },\n    {\n      \"Sid\": \"SecretsManagerActions0\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"secretsmanager:CreateSecret\",\n        \"secretsmanager:DeleteSecret\",\n        \"secretsmanager:TagResource\",\n        \"secretsmanager:UntagResource\",\n        \"secretsmanager:PutResourcePolicy\",\n        \"secretsmanager:DeleteResourcePolicy\",\n        \"secretsmanager:ListSecretVersionIds\",\n        \"secretsmanager:GetSecretValue\"\n      ],\n      \"Resource\": \"arn:aws:secretsmanager:*:*:secret:LaunchWizard*\"\n    },\n    {\n      \"Sid\": \"SecretsManagerActions1\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"secretsmanager:GetRandomPassword\",\n        \"secretsmanager:ListSecrets\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"SsmActions5\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ssm:CreateOpsMetadata\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"SsmActions6\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"ssm:DeleteOpsMetadata\",\n      \"Resource\": \"arn:aws:ssm:*:*:opsmetadata/aws/ssm/LaunchWizard*\"\n    },\n    {\n      \"Sid\": \"SnsActions0\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"sns:CreateTopic\",\n        \"sns:DeleteTopic\",\n        \"sns:Subscribe\",\n        \"sns:Unsubscribe\"\n      ],\n      \"Resource\": \"arn:aws:sns:*:*:LaunchWizard*\"\n    },\n    {\n      \"Sid\": \"FsxActions0\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"fsx:UntagResource\",\n        \"fsx:TagResource\",\n        \"fsx:DeleteFileSystem\",\n        \"fsx:ListTagsForResource\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"aws:ResourceTag/Name\": \"LaunchWizard*\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"FsxActions1\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"fsx:CreateFileSystem\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"aws:RequestTag/Name\": [\n            \"LaunchWizard*\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"FsxActions2\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"fsx:DescribeFileSystems\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"ServiceCatalogActions0\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"servicecatalog:CreatePortfolio\",\n        \"servicecatalog:DescribePortfolio\",\n        \"servicecatalog:CreateConstraint\",\n        \"servicecatalog:CreateProduct\",\n        \"servicecatalog:AssociatePrincipalWithPortfolio\",\n        \"servicecatalog:CreateProvisioningArtifact\",\n        \"servicecatalog:TagResource\",\n        \"servicecatalog:UntagResource\"\n      ],\n      \"Resource\": [\n        \"arn:aws:servicecatalog:*:*:*/*\",\n        \"arn:aws:catalog:*:*:*/*\"\n      ],\n      \"Condition\": {\n        \"ForAnyValue:StringEquals\": {\n          \"aws:CalledVia\": \"launchwizard.amazonaws.com\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"SsmActions7\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ssm:CreateAssociation\",\n        \"ssm:DeleteAssociation\"\n      ],\n      \"Resource\": [\n        \"arn:aws:ssm:*:*:document/AWS-ConfigureAWSPackage\",\n        \"arn:aws:ssm:*:*:association/*\"\n      ],\n      \"Condition\": {\n        \"ForAnyValue:StringEquals\": {\n          \"aws:CalledVia\": \"launchwizard.amazonaws.com\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"EfsActions1\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"elasticfilesystem:UntagResource\",\n        \"elasticfilesystem:TagResource\"\n      ],\n      \"Resource\": \"arn:aws:elasticfilesystem:*:*:file-system/*\",\n      \"Condition\": {\n        \"ForAnyValue:StringEquals\": {\n          \"aws:CalledVia\": \"launchwizard.amazonaws.com\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"LogsActions0\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"logs:CreateLogStream\",\n        \"logs:DeleteLogGroup\",\n        \"logs:DescribeLogStreams\",\n        \"logs:UntagResource\",\n        \"logs:TagResource\",\n        \"logs:CreateLogGroup\",\n        \"logs:DeleteLogStream\",\n        \"logs:PutLogEvents\",\n        \"logs:GetLogEvents\",\n        \"logs:GetLogDelivery\",\n        \"logs:GetLogGroupFields\",\n        \"logs:GetLogRecord\",\n        \"logs:ListLogDeliveries\"\n      ],\n      \"Resource\": [\n        \"arn:aws:logs:*:*:log-group:LaunchWizard*\",\n        \"arn:aws:logs:*:*:log-group:LaunchWizard*:log-stream:*\"\n      ],\n      \"Condition\": {\n        \"ForAnyValue:StringEquals\": {\n          \"aws:CalledVia\": \"launchwizard.amazonaws.com\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"LogsActions1\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"logs:DescribeLogGroups\",\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"ForAnyValue:StringEquals\": {\n          \"aws:CalledVia\": \"launchwizard.amazonaws.com\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"FsxActions3\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"fsx:CreateStorageVirtualMachine\",\n        \"fsx:CreateVolume\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"aws:ResourceTag/aws:cloudformation:stack-id\": \"arn:aws:cloudformation:*:*:stack/LaunchWizard-*/*\"\n        },\n        \"ForAnyValue:StringEquals\": {\n          \"aws:CalledVia\": [\n            \"launchwizard.amazonaws.com\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"FsxActions4\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"fsx:DescribeStorageVirtualMachines\",\n        \"fsx:DescribeVolumes\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"ForAnyValue:StringEquals\": {\n          \"aws:CalledVia\": [\n            \"launchwizard.amazonaws.com\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"FsxActions5\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"fsx:DeleteStorageVirtualMachine\",\n        \"fsx:DeleteVolume\"\n      ],\n      \"Resource\": [\n        \"arn:aws:fsx:*:*:storage-virtual-machine/*/*\",\n        \"arn:aws:fsx:*:*:backup/*\",\n        \"arn:aws:fsx:*:*:volume/*/*\"\n      ],\n      \"Condition\": {\n        \"StringLike\": {\n          \"aws:ResourceTag/aws:cloudformation:stack-id\": \"arn:aws:cloudformation:*:*:stack/LaunchWizard-*/*\"\n        },\n        \"ForAnyValue:StringEquals\": {\n          \"aws:CalledVia\": [\n            \"launchwizard.amazonaws.com\"\n          ]\n        }\n      }\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"launch-wizard:*\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n```\n\n### Explanation:\nThe `launch-wizard:*` action allows the user to perform all actions related to Amazon Launch Wizard. This includes creating, updating, and deleting launch wizards, as well as managing their associated resources. By granting this permission, the user will have full access to the Amazon Launch Wizard service, allowing them to create and manage launch wizards as needed.",
    "complexity": "complex"
  },
  {
    "id": "aws_managed_1358",
    "instruction": "Provide an IAM policy for AWS Zone Group Access Management Service Role Policy",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"AwsOrganizationsAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"organizations:DescribeOrganization\",\n        \"organizations:DescribeOrganizationalUnit\",\n        \"organizations:DescribeAccount\",\n        \"organizations:ListAccounts\",\n        \"organizations:ListAccountsForParent\",\n        \"organizations:ListParents\",\n        \"organizations:ListAWSServiceAccessForOrganization\",\n        \"organizations:ListChildren\",\n        \"organizations:ListDelegatedAdministrators\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:CreateTags\",\n        \"ec2:DeleteTags\",\n        \"ec2:Describe*\",\n        \"ec2:AttachVolume\",\n        \"ec2:DetachVolume\",\n        \"ec2:ModifyInstanceMetadataOptions\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"autoscaling:DescribeAutoScalingGroups\",\n        \"autoscaling:DescribeLaunchConfigurationHealth\",\n        \"autoscaling:DescribeLaunchConfigurations\",\n        \"autoscaling:DescribeTags\",\n        \"autoscaling:SetDesiredCapacity\",\n        \"autoscaling:TerminateInstanceInAutoScalingGroup\",\n        \"autoscaling:UpdateAutoScalingGroup\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n```",
    "complexity": "simple"
  },
  {
    "id": "aws_managed_0600",
    "instruction": "Provide an IAM policy for AWSWAF Console Read Only Access",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"AllowReadOnlyOfAWSWAFClassic\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"waf:Get*\",\n        \"waf:List*\",\n        \"waf-regional:Get*\",\n        \"waf-regional:List*\"\n      ],\n      \"Resource\": [\n        \"arn:aws:waf::*:bytematchset/*\",\n        \"arn:aws:waf::*:ipset/*\",\n        \"arn:aws:waf::*:ratebasedrule/*\",\n        \"arn:aws:waf::*:rule/*\",\n        \"arn:aws:waf::*:sizeconstraintset/*\",\n        \"arn:aws:waf::*:sqlinjectionset/*\",\n        \"arn:aws:waf::*:webacl/*\",\n        \"arn:aws:waf::*:xssmatchset/*\",\n        \"arn:aws:waf::*:regexmatch/*\",\n        \"arn:aws:waf::*:regexpatternset/*\",\n        \"arn:aws:waf::*:geomatchset/*\",\n        \"arn:aws:waf::*:rulegroup/*\",\n        \"arn:aws:waf:*:*:changetoken/*\",\n        \"arn:aws:waf-regional:*:*:bytematchset/*\",\n        \"arn:aws:waf-regional:*:*:ipset/*\",\n        \"arn:aws:waf-regional:*:*:ratebasedrule/*\",\n        \"arn:aws:waf-regional:*:*:rule/*\",\n        \"arn:aws:waf-regional:*:*:sizeconstraintset/*\",\n        \"arn:aws:waf-regional:*:*:sqlinjectionset/*\",\n        \"arn:aws:waf-regional:*:*:webacl/*\",\n        \"arn:aws:waf-regional:*:*:xssmatchset/*\",\n        \"arn:aws:waf-regional:*:*:regexmatch/*\",\n        \"arn:aws:waf-regional:*:*:regexpatternset/*\",\n        \"arn:aws:waf-regional:*:*:geomatchset/*\",\n        \"arn:aws:waf-regional:*:*:rulegroup/*\",\n        \"arn:aws:waf-regional:*:*:changetoken/*\"\n      ]\n    },\n    {\n      \"Sid\": \"AllowWAFClassicGetWebACLForResource\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"waf-regional:GetWebACLForResource\"\n      ],\n      \"Resource\": \"arn:aws:waf-regional:*:*:*/*\"\n    },\n    {\n      \"Sid\": \"AllowReadOnlyOfAWSWAF\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"wafv2:Get*\",\n        \"wafv2:List*\",\n        \"wafv2:Describe*\",\n        \"wafv2:CheckCapacity\"\n      ],\n      \"Resource\": [\n        \"arn:aws:wafv2:*:*:*/webacl/*/*\",\n        \"arn:aws:wafv2:*:*:*/ipset/*/*\",\n        \"arn:aws:wafv2:*:*:*/managedruleset/*/*\",\n        \"arn:aws:wafv2:*:*:*/rulegroup/*/*\",\n        \"arn:aws:wafv2:*:*:*/regexpatternset/*/*\"\n      ]\n    },\n    {\n      \"Sid\": \"AllowEC2DescribeRegions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:DescribeRegions\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"AllowListActionsForCloudWatch\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"cloudwatch:GetMetricData\",\n        \"cloudwatch:GetMetricStatistics\",\n        \"cloudwatch:ListMetrics\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"AllowGetActionForCloudFront\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"cloudfront:GetDistributionConfig\",\n        \"cloudfront:GetDistribution\"\n      ],\n      \"Resource\": \"arn:aws:cloudfront::*:distribution/*\"\n    },\n    {\n      \"Sid\": \"AllowListActionsForCloudFront\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"cloudfront:ListDistributions\",\n        \"cloudfront:ListDistributionsByWebACLId\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"AllowGetActionForCloudFrontTenant\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"cloudfront:GetDistributionTenant\"\n      ],\n      \"Resource\": \"arn:aws:cloudfront::*:distribution-tenant/*\"\n    },\n    {\n      \"Sid\": \"AllowListActionsForCloudFrontTenant\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"cloudfront:ListDistributionTenants\",\n        \"cloudfront:ListDistributionTenantsByCustomization\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"AllowListActionsForALB\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"elasticloadbalancing:DescribeLoadBalancers\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"AllowListActionsForAPIGateway\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"apigateway:GET\"\n      ],\n      \"Resource\": \"arn:aws:apigateway:*::/*\"\n    },\n    {\n      \"Sid\": \"AllowListActionsForAppSync\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"appsync:ListGraphqlApis\",\n        \"appsync:ListApis\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"AllowGetActionForCognito\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"cognito-idp:GetWebACLForResource\"\n      ],\n      \"Resource\": \"arn:aws:cognito-idp:*:*:userpool/*\"\n    },\n    {\n      \"Sid\": \"AllowListActionsForCognito\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"cognito-idp:ListUserPools\",\n        \"cognito-idp:ListResourcesForWebACL\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"AllowGetActionForAppRunner\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"apprunner:DescribeWebAclForService\"\n      ],\n      \"Resource\": \"arn:aws:apprunner:*:*:service/*/*\"\n    },\n    {\n      \"Sid\": \"AllowListActionsForAppRunner\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"apprunner:ListServices\",\n        \"apprunner:ListAssociatedServicesForWebAcl\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"AllowGetActionForAVA\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:GetVerifiedAccessInstanceWebAcl\"\n      ],\n      \"Resource\": \"arn:aws:ec2:*:*:verified-access-instance/*\"\n    },\n    {\n      \"Sid\": \"AllowListActionsForAVA\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:DescribeVerifiedAccessInstances\",\n        \"ec2:DescribeVerifiedAccessInstanceWebAclAssociations\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"AllowGetActionForAmplify\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"amplify:GetWebACLForResource\"\n      ],\n      \"Resource\": \"arn:aws:amplify:*:*:apps/*\"\n    },\n    {\n      \"Sid\": \"AllowListActionsForAmplify\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"amplify:ListApps\",\n        \"amplify:ListResourcesForWebACL\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"AllowS3ListAllMyBuckets\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:ListAllMyBuckets\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"AllowLogGroupDescribeActions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"logs:DescribeResourcePolicies\",\n        \"logs:DescribeLogGroups\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"AllowListActionForFirehoseStream\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"firehose:ListDeliveryStreams\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"AllowActionsForPricing\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"pricing:ListPriceLists\",\n        \"pricing:GetPriceListFileUrl\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"AllowMarketplaceViewSubscriptions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"aws-marketplace:ViewSubscriptions\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"AllowLogQueryActions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"logs:StartQuery\",\n        \"logs:DescribeQueryDefinitions\",\n        \"logs:GetQueryResults\"\n      ],\n      \"Resource\": \"arn:aws:logs:*:*:log-group:aws-waf-logs-*\"\n    },\n    {\n      \"Sid\": \"AllowListActionsForPricingPlanManager\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"pricingplanmanager:GetSubscription\"\n      ],\n      \"Resource\": \"arn:aws:pricingplanmanager::*:subscription:*\"\n    },\n    {\n      \"Sid\": \"AllowListActionsForRoute53\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"route53:ListHostedZones\",\n        \"route53:GetHostedZone\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"AllowListSubscriptionsForPricingPlanManager\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"pricingplanmanager:ListSubscriptions\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"wafv2:*\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n```\n\n### Explanation:\nThe above policy allows all actions on the WAF service. This is a very broad policy and should be used with caution. It is recommended to use more specific policies that only allow the necessary actions.\n\n### References:\n[AWS WAF V2 Policy Reference](https://docs.aws.amazon.com/waf/latest/APIReference/API_Policy.html)",
    "complexity": "complex"
  },
  {
    "id": "aws_managed_0358",
    "instruction": "Provide an IAM policy for AWS Elemental Media Convert Read Only",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"mediaconvert:Get*\",\n        \"mediaconvert:List*\",\n        \"mediaconvert:DescribeEndpoints\",\n        \"s3:ListAllMyBuckets\",\n        \"s3:ListBucket\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}",
    "generated": "```json\n{\n    \"Version\": \"2012-10-17\",\n    \"Statement\": [\n        {\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"ec2:Describe*\",\n                \"ec2:Get*\"\n            ],\n            \"Resource\": \"*\"\n        },\n        {\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"iam:ListRoles\",\n                \"iam:GetRole\",\n                \"iam:GetRolePolicy\",\n                \"iam:GetUser\",\n                \"iam:GetAccountSummary\",\n                \"iam:GetAccountAuthorizationDetails\",\n                \"iam:GetAccountAccessKeyInfo\",\n                \"iam:GetAccountPasswordPolicy\",\n                \"iam:GetAccountMFAStatus\",\n                \"iam:GetAccountLoginProfile\",\n                \"iam:GetAccountSAMLProvider\",\n                \"iam:GetAccountSigningCertificate\",\n                \"iam:GetAccountVpceConfiguration\",\n                \"iam:GetAccountVpcConfiguration\",\n                \"iam:Get",
    "complexity": "medium"
  },
  {
    "id": "aws_managed_0595",
    "instruction": "Provide an IAM policy for Compute Optimizer Read Only Access",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"computeOptimizerReadOnlyAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"compute-optimizer:DescribeRecommendationExportJobs\",\n        \"compute-optimizer:GetEnrollmentStatus\",\n        \"compute-optimizer:GetEnrollmentStatusesForOrganization\",\n        \"compute-optimizer:GetRecommendationSummaries\",\n        \"compute-optimizer:GetEC2InstanceRecommendations\",\n        \"compute-optimizer:GetEC2RecommendationProjectedMetrics\",\n        \"compute-optimizer:GetAutoScalingGroupRecommendations\",\n        \"compute-optimizer:GetEBSVolumeRecommendations\",\n        \"compute-optimizer:GetLambdaFunctionRecommendations\",\n        \"compute-optimizer:GetRecommendationPreferences\",\n        \"compute-optimizer:GetEffectiveRecommendationPreferences\",\n        \"compute-optimizer:GetECSServiceRecommendations\",\n        \"compute-optimizer:GetECSServiceRecommendationProjectedMetrics\",\n        \"compute-optimizer:GetRDSDatabaseRecommendations\",\n        \"compute-optimizer:GetRDSDatabaseRecommendationProjectedMetrics\",\n        \"compute-optimizer:GetLicenseRecommendations\",\n        \"compute-optimizer:GetIdleRecommendations\",\n        \"ec2:DescribeInstances\",\n        \"ec2:DescribeVolumes\",\n        \"ecs:ListServices\",\n        \"ecs:ListClusters\",\n        \"autoscaling:DescribeAutoScalingGroups\",\n        \"autoscaling:DescribeAutoScalingInstances\",\n        \"lambda:ListFunctions\",\n        \"lambda:ListProvisionedConcurrencyConfigs\",\n        \"cloudwatch:GetMetricData\",\n        \"organizations:ListAccounts\",\n        \"organizations:DescribeOrganization\",\n        \"organizations:DescribeAccount\",\n        \"rds:DescribeDBInstances\",\n        \"rds:DescribeDBClusters\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"comprehend:*\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:Describe*\",\n        \"ec2:Get*\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n```\n\n### Explanation:\nThe following policy allows the user to read all EC2 resources and all Comprehend resources.\n\n### References:\n[AWS Documentation](https://docs.aws.amazon.com/IAM/latest/UserGuide/list_awssummary.html)",
    "complexity": "complex"
  },
  {
    "id": "aws_managed_0945",
    "instruction": "Provide an IAM policy for Amazon EKS Local Outpost Service Role Policy",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:DescribeVpcs\",\n        \"ec2:DescribeSubnets\",\n        \"ec2:DescribeRouteTables\",\n        \"ec2:DescribeAddresses\",\n        \"ec2:DescribeImages\",\n        \"ec2:DescribeInstances\",\n        \"ec2:DescribeNetworkInterfaces\",\n        \"ec2:DescribeNetworkInterfaceAttribute\",\n        \"ec2:DescribeSecurityGroups\",\n        \"ec2:DescribeVpcAttribute\",\n        \"ec2:DescribePlacementGroups\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:CreateNetworkInterface\"\n      ],\n      \"Resource\": \"arn:aws:ec2:*:*:network-interface/*\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"aws:RequestTag/eks-local:controlplane-name\": \"*\"\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:CreateNetworkInterface\"\n      ],\n      \"Resource\": [\n        \"arn:aws:ec2:*:*:security-group/*\",\n        \"arn:aws:ec2:*:*:subnet/*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:ModifyNetworkInterfaceAttribute\"\n      ],\n      \"Resource\": [\n        \"arn:aws:ec2:*:*:instance/*\",\n        \"arn:aws:ec2:*:*:security-group/*\",\n        \"arn:aws:ec2:*:*:network-interface/*\"\n      ],\n      \"Condition\": {\n        \"StringLike\": {\n          \"aws:ResourceTag/eks-local:controlplane-name\": \"*\"\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:CreateSecurityGroup\"\n      ],\n      \"Resource\": \"arn:aws:ec2:*:*:security-group/*\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"aws:RequestTag/eks-local:controlplane-name\": \"*\"\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:CreateSecurityGroup\"\n      ],\n      \"Resource\": \"arn:aws:ec2:*:*:vpc/*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"ec2:RunInstances\",\n      \"Resource\": \"arn:aws:ec2:*:*:instance/*\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"aws:RequestTag/eks-local:controlplane-name\": \"*\"\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"ec2:RunInstances\",\n      \"Resource\": [\n        \"arn:aws:ec2:*:*:volume/*\",\n        \"arn:aws:ec2:*:*:image/*\",\n        \"arn:aws:ec2:*:*:launch-template/*\",\n        \"arn:aws:ec2:*:*:network-interface/*\",\n        \"arn:aws:ec2:*:*:security-group/*\",\n        \"arn:aws:ec2:*:*:subnet/*\",\n        \"arn:aws:ec2:*:*:placement-group/*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:AuthorizeSecurityGroupIngress\",\n        \"ec2:RevokeSecurityGroupIngress\",\n        \"ec2:DeleteNetworkInterface\",\n        \"ec2:DeleteSecurityGroup\",\n        \"ec2:TerminateInstances\",\n        \"ec2:GetConsoleOutput\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"aws:ResourceTag/eks-local:controlplane-name\": \"*\"\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"ec2:CreateTags\",\n      \"Resource\": [\n        \"arn:aws:ec2:*:*:security-group/*\",\n        \"arn:aws:ec2:*:*:network-interface/*\",\n        \"arn:aws:ec2:*:*:instance/*\"\n      ],\n      \"Condition\": {\n        \"ForAnyValue:StringLike\": {\n          \"aws:TagKeys\": [\n            \"kubernetes.io/cluster/*\",\n            \"eks*\"\n          ]\n        },\n        \"StringEquals\": {\n          \"ec2:CreateAction\": [\n            \"CreateNetworkInterface\",\n            \"CreateSecurityGroup\",\n            \"RunInstances\"\n          ]\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"secretsmanager:TagResource\"\n      ],\n      \"Resource\": \"arn:aws:secretsmanager:*:*:secret:eks-local.cluster.x-k8s.io/*\",\n      \"Condition\": {\n        \"ForAnyValue:StringLike\": {\n          \"aws:TagKeys\": [\n            \"kubernetes.io/cluster/*\",\n            \"eks*\"\n          ]\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"secretsmanager:CreateSecret\"\n      ],\n      \"Resource\": \"arn:aws:secretsmanager:*:*:secret:eks-local.cluster.x-k8s.io/*\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"aws:RequestTag/eks-local:controlplane-name\": \"*\"\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"secretsmanager:DeleteSecret\",\n      \"Resource\": \"arn:aws:secretsmanager:*:*:secret:eks-local.cluster.x-k8s.io/*\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"aws:ResourceTag/eks-local:controlplane-name\": \"*\"\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"secretsmanager:DescribeSecret\",\n      \"Resource\": \"arn:aws:secretsmanager:*:*:secret:eks-local.cluster.x-k8s.io/*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:PassRole\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"iam:PassedToService\": \"ec2.amazonaws.com\"\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:GetInstanceProfile\",\n        \"iam:DeleteInstanceProfile\",\n        \"iam:RemoveRoleFromInstanceProfile\"\n      ],\n      \"Resource\": \"arn:aws:iam::*:instance-profile/eks-local-*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ssm:StartSession\"\n      ],\n      \"Resource\": \"arn:aws:ec2:*:*:instance/*\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"ssm:resourceTag/eks-local:controlplane-name\": \"*\"\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ssm:StartSession\"\n      ],\n      \"Resource\": \"arn:aws:ssm:*::document/AmazonEKS-ControlPlaneInstanceProxy\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ssmmessages:OpenDataChannel\"\n      ],\n      \"Resource\": \"arn:aws:ssm:*:*:session/*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ssm:ResumeSession\",\n        \"ssm:TerminateSession\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"outposts:GetOutpost\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:*\",\n        \"iam:*\",\n        \"eks:*\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n```\n\n### Explanation:\nThe IAM policy for the Amazon EKS Local Outpost Service role allows the service to perform various actions on EC2, IAM, and EKS resources. The `ec2:*`, `iam:*`, and `eks:*` actions allow the service to manage EC2 instances, IAM roles, and EKS clusters, respectively. The `*` wildcard in the `Resource` field indicates that the service can operate on all resources within these services. This policy grants the necessary permissions for the Amazon EKS Local Outpost Service to function properly.",
    "complexity": "complex"
  },
  {
    "id": "aws_managed_0317",
    "instruction": "Provide an IAM policy for DAX Service Role Policy",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:AuthorizeSecurityGroupIngress\",\n        \"ec2:CreateNetworkInterface\",\n        \"ec2:CreateSecurityGroup\",\n        \"ec2:DeleteNetworkInterface\",\n        \"ec2:DeleteSecurityGroup\",\n        \"ec2:DescribeAvailabilityZones\",\n        \"ec2:DescribeNetworkInterfaces\",\n        \"ec2:DescribeSecurityGroups\",\n        \"ec2:DescribeSubnets\",\n        \"ec2:DescribeVpcs\",\n        \"ec2:ModifyNetworkInterfaceAttribute\",\n        \"ec2:RevokeSecurityGroupIngress\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"dax:*\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n```\n\n### Explanation:\nThe above policy allows the DAX service to perform any action on any resource. This is necessary because the DAX service needs to be able to create and manage resources in order to provide its functionality.\n\n### References:\n[AWS Documentation](https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_create_for-service.html)",
    "complexity": "simple"
  },
  {
    "id": "aws_managed_1424",
    "instruction": "Provide an IAM policy for AWS Lambda Managed EC2Resource Operator",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:RunInstances\",\n        \"ec2:CreateTags\",\n        \"ec2:AttachNetworkInterface\"\n      ],\n      \"Resource\": [\n        \"arn:aws:ec2:*:*:instance/*\",\n        \"arn:aws:ec2:*:*:network-interface/*\",\n        \"arn:aws:ec2:*:*:volume/*\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"ec2:ManagedResourceOperator\": \"scaler.lambda.amazonaws.com\"\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:DescribeAvailabilityZones\",\n        \"ec2:DescribeCapacityReservations\",\n        \"ec2:DescribeInstances\",\n        \"ec2:DescribeInstanceStatus\",\n        \"ec2:DescribeInstanceTypeOfferings\",\n        \"ec2:DescribeInstanceTypes\",\n        \"ec2:DescribeSecurityGroups\",\n        \"ec2:DescribeSubnets\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:RunInstances\",\n        \"ec2:CreateNetworkInterface\"\n      ],\n      \"Resource\": [\n        \"arn:aws:ec2:*:*:subnet/*\",\n        \"arn:aws:ec2:*:*:security-group/*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:RunInstances\"\n      ],\n      \"Resource\": [\n        \"arn:aws:ec2:*:*:image/*\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"ec2:Owner\": \"amazon\"\n        }\n      }\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:CreateTags\",\n        \"ec2:DeleteTags\",\n        \"ec2:Describe*\",\n        \"ec2:ModifyInstanceMetadataOptions\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"autoscaling:DescribeAutoScalingGroups\",\n        \"autoscaling:DescribeLaunchConfigurations\",\n        \"autoscaling:DescribeLaunchTemplateVersions\",\n        \"autoscaling:DescribeTags\",\n        \"autoscaling:SetDesiredCapacity\",\n        \"autoscaling:TerminateInstanceInAutoScalingGroup\",\n        \"autoscaling:UpdateAutoScalingGroup\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n```",
    "complexity": "complex"
  },
  {
    "id": "aws_managed_0274",
    "instruction": "Provide an IAM policy for AWS Code Deploy Role For Lambda",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Action\": [\n        \"cloudwatch:DescribeAlarms\",\n        \"lambda:UpdateAlias\",\n        \"lambda:GetAlias\",\n        \"lambda:GetProvisionedConcurrencyConfig\",\n        \"sns:Publish\"\n      ],\n      \"Resource\": \"*\",\n      \"Effect\": \"Allow\"\n    },\n    {\n      \"Action\": [\n        \"s3:GetObject\",\n        \"s3:GetObjectVersion\"\n      ],\n      \"Resource\": \"arn:aws:s3:::*/CodeDeploy/*\",\n      \"Effect\": \"Allow\"\n    },\n    {\n      \"Action\": [\n        \"s3:GetObject\",\n        \"s3:GetObjectVersion\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"s3:ExistingObjectTag/UseWithCodeDeploy\": \"true\"\n        }\n      },\n      \"Effect\": \"Allow\"\n    },\n    {\n      \"Action\": [\n        \"lambda:InvokeFunction\"\n      ],\n      \"Resource\": \"arn:aws:lambda:*:*:function:CodeDeployHook_*\",\n      \"Effect\": \"Allow\"\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"codedeploy:CreateApplication\",\n        \"codedeploy:CreateDeploymentGroup\",\n        \"codedeploy:GetApplication\",\n        \"codedeploy:GetApplicationRevision\",\n        \"codedeploy:GetDeployment\",\n        \"codedeploy:GetDeploymentConfig\",\n        \"codedeploy:RegisterApplicationRevision\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:GetObject\",\n        \"s3:PutObject\"\n      ],\n      \"Resource\": [\n        \"arn:aws:s3:::<bucket_name>/*\",\n        \"arn:aws:s3:::<bucket_name>\"\n      ]\n    }\n  ]\n}\n```",
    "complexity": "complex"
  },
  {
    "id": "aws_managed_0380",
    "instruction": "Provide an IAM policy for AWS Certificate Manager Private CA Auditor",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"acm-pca:CreateCertificateAuthorityAuditReport\",\n        \"acm-pca:DescribeCertificateAuthority\",\n        \"acm-pca:DescribeCertificateAuthorityAuditReport\",\n        \"acm-pca:GetCertificateAuthorityCsr\",\n        \"acm-pca:GetCertificateAuthorityCertificate\",\n        \"acm-pca:GetCertificate\",\n        \"acm-pca:GetPolicy\",\n        \"acm-pca:ListPermissions\",\n        \"acm-pca:ListTags\"\n      ],\n      \"Resource\": \"arn:aws:acm-pca:*:*:certificate-authority/*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"acm-pca:ListCertificateAuthorities\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"acm-pca:DescribeCertificateAuthority\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n```\n\n### Explanation:\nThe `acm-pca:DescribeCertificateAuthority` action is used to retrieve information about a certificate authority. This includes the name of the certificate authority, its ARN, and other metadata. The `*` wildcard in the `Resource` field allows this policy to be applied to any certificate authority in your account.\n\n### References:\n- [AWS Certificate Manager Private CA](https://docs.aws.amazon.com/acm-pca/latest/userguide/what-is.html)\n- [AWS Certificate Manager Private CA API Reference](https://docs.aws.amazon.com/acm-pca/latest/APIReference/Welcome.html)",
    "complexity": "medium"
  },
  {
    "id": "aws_managed_1209",
    "instruction": "Provide an IAM policy for Amazon Bedrock Studio Permissions Boundary",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"AccessS3Buckets\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:ListBucket\",\n        \"s3:ListBucketVersions\",\n        \"s3:GetObject\",\n        \"s3:PutObject\",\n        \"s3:DeleteObject\",\n        \"s3:GetObjectVersion\",\n        \"s3:DeleteObjectVersion\"\n      ],\n      \"Resource\": \"arn:aws:s3:::br-studio-${aws:PrincipalAccount}-*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:ResourceAccount\": \"${aws:PrincipalAccount}\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"AccessOpenSearchCollections\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"aoss:APIAccessAll\",\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:ResourceAccount\": \"${aws:PrincipalAccount}\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"InvokeBedrockModels\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"bedrock:InvokeModel\",\n        \"bedrock:InvokeModelWithResponseStream\"\n      ],\n      \"Resource\": \"arn:aws:bedrock:*::foundation-model/*\"\n    },\n    {\n      \"Sid\": \"AccessBedrockResources\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"bedrock:InvokeAgent\",\n        \"bedrock:Retrieve\",\n        \"bedrock:StartIngestionJob\",\n        \"bedrock:GetIngestionJob\",\n        \"bedrock:ListIngestionJobs\",\n        \"bedrock:ApplyGuardrail\",\n        \"bedrock:ListPrompts\",\n        \"bedrock:GetPrompt\",\n        \"bedrock:CreatePrompt\",\n        \"bedrock:DeletePrompt\",\n        \"bedrock:CreatePromptVersion\",\n        \"bedrock:InvokeFlow\",\n        \"bedrock:ListTagsForResource\",\n        \"bedrock:TagResource\",\n        \"bedrock:UntagResource\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:ResourceAccount\": \"${aws:PrincipalAccount}\",\n          \"aws:ResourceTag/AmazonBedrockManaged\": \"true\"\n        },\n        \"Null\": {\n          \"aws:ResourceTag/AmazonDataZoneProject\": \"false\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"RetrieveAndGenerate\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"bedrock:RetrieveAndGenerate\",\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"WriteLogs\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"logs:CreateLogGroup\",\n        \"logs:CreateLogStream\",\n        \"logs:PutLogEvents\"\n      ],\n      \"Resource\": \"arn:aws:logs:*:*:log-group:/aws/lambda/br-studio-*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:ResourceAccount\": \"${aws:PrincipalAccount}\",\n          \"aws:ResourceTag/AmazonBedrockManaged\": \"true\"\n        },\n        \"Null\": {\n          \"aws:ResourceTag/AmazonDataZoneProject\": \"false\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"InvokeLambdaFunctions\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"lambda:InvokeFunction\",\n      \"Resource\": \"arn:aws:lambda:*:*:function:br-studio-*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:ResourceAccount\": \"${aws:PrincipalAccount}\",\n          \"aws:ResourceTag/AmazonBedrockManaged\": \"true\"\n        },\n        \"Null\": {\n          \"aws:ResourceTag/AmazonDataZoneProject\": \"false\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"AccessSecretsManagerSecrets\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"secretsmanager:DescribeSecret\",\n        \"secretsmanager:GetSecretValue\",\n        \"secretsmanager:PutSecretValue\"\n      ],\n      \"Resource\": \"arn:aws:secretsmanager:*:*:secret:br-studio/*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:ResourceAccount\": \"${aws:PrincipalAccount}\",\n          \"aws:ResourceTag/AmazonBedrockManaged\": \"true\"\n        },\n        \"Null\": {\n          \"aws:ResourceTag/AmazonDataZoneProject\": \"false\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"UseKmsKeyWithBedrock\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"kms:Decrypt\",\n        \"kms:GenerateDataKey\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:ResourceAccount\": \"${aws:PrincipalAccount}\",\n          \"aws:ResourceTag/EnableBedrock\": \"true\"\n        },\n        \"Null\": {\n          \"kms:EncryptionContext:aws:bedrock:arn\": \"false\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"UseKmsKeyWithAwsServices\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"kms:Decrypt\",\n        \"kms:GenerateDataKey\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:ResourceAccount\": \"${aws:PrincipalAccount}\",\n          \"aws:ResourceTag/EnableBedrock\": \"true\"\n        },\n        \"StringLike\": {\n          \"kms:ViaService\": [\n            \"s3.*.amazonaws.com\",\n            \"secretsmanager.*.amazonaws.com\"\n          ]\n        }\n      }\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"AllowBedrockStudio\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"bedrock:*\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n```\n\n### Explanation:\nThe above policy allows all actions on the Bedrock Studio service. This is a very permissive policy and should only be used in development environments or when testing. In production, you should restrict access to specific resources or actions as needed.\n\n### References:\n* [Amazon Bedrock Studio Permissions Boundary](https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_permissions-boundaries.html#reference_policies_permissions-boundaries-bedrock)",
    "complexity": "complex"
  },
  {
    "id": "aws_managed_1255",
    "instruction": "Provide an IAM policy for AWS Quick Setup Enable AREX Execution Policy",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"AllowReadActions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"resource-explorer-2:GetDefaultView\",\n        \"resource-explorer-2:GetIndex\",\n        \"resource-explorer-2:ListIndexes\",\n        \"resource-explorer-2:ListViews\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"AllowUpdateExistingIndexAndAssociateDefaultView\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"resource-explorer-2:UpdateIndexType\",\n        \"resource-explorer-2:AssociateDefaultView\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"AllowCreateViewAndIndex\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"resource-explorer-2:CreateView\",\n        \"resource-explorer-2:CreateIndex\",\n        \"resource-explorer-2:TagResource\"\n      ],\n      \"Resource\": [\n        \"arn:aws:resource-explorer-2:*:*:view/all-resources/*\",\n        \"arn:aws:resource-explorer-2:*:*:index/*\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:RequestTag/Type\": \"QuickSetup\",\n          \"aws:ResourceTag/Type\": \"QuickSetup\"\n        },\n        \"ForAllValues:StringEquals\": {\n          \"aws:TagKeys\": \"Type\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"AllowCreateServiceLinkedRole\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:CreateServiceLinkedRole\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"iam:AWSServiceName\": [\n            \"resource-explorer-2.amazonaws.com\"\n          ]\n        }\n      },\n      \"Resource\": \"arn:aws:iam::*:role/aws-service-role/resource-explorer-2.amazonaws.com/AWSServiceRoleForResourceExplorer\"\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:CreateServiceLinkedRole\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:GetAccountSummary\",\n        \"iam:ListAccountAliases\",\n        \"iam:ListAttachedRoles\",\n        \"iam:ListAttachedRolePolicies\",\n        \"iam:ListInstanceProfiles\",\n        \"iam:ListRolePolicies\",\n        \"iam:ListRoles\",\n        \"iam:ListServerCertificates\",\n        \"iam:ListUserPolicies\",\n        \"iam:ListUsers\",\n        \"iam:PassRole\",\n        \"iam:PutRolePolicy\",\n        \"iam:RemoveRoleFromInstanceProfile\",\n        \"iam:SetDefaultPolicyDocument\",\n        \"iam:TagRole\",\n        \"iam:UntagRole\",\n        \"iam:UpdateAssumeRolePolicy\",\n        \"iam:",
    "complexity": "complex"
  },
  {
    "id": "aws_managed_0668",
    "instruction": "Provide an IAM policy for Amazon Redshift Data Full Access",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"DataAPIPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"redshift-data:BatchExecuteStatement\",\n        \"redshift-data:ExecuteStatement\",\n        \"redshift-data:CancelStatement\",\n        \"redshift-data:ListStatements\",\n        \"redshift-data:GetStatementResult\",\n        \"redshift-data:DescribeStatement\",\n        \"redshift-data:ListDatabases\",\n        \"redshift-data:ListSchemas\",\n        \"redshift-data:ListTables\",\n        \"redshift-data:DescribeTable\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"SecretsManagerPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"secretsmanager:GetSecretValue\"\n      ],\n      \"Resource\": \"arn:aws:secretsmanager:*:*:secret:*\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"secretsmanager:ResourceTag/RedshiftDataFullAccess\": \"*\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"GetCredentialsForAPIUser\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"redshift:GetClusterCredentials\",\n      \"Resource\": [\n        \"arn:aws:redshift:*:*:dbname:*/*\",\n        \"arn:aws:redshift:*:*:dbuser:*/redshift_data_api_user\"\n      ]\n    },\n    {\n      \"Sid\": \"GetCredentialsWithFederatedIAMCredentials\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"redshift:GetClusterCredentialsWithIAM\",\n      \"Resource\": \"arn:aws:redshift:*:*:dbname:*/*\"\n    },\n    {\n      \"Sid\": \"GetCredentialsForServerless\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"redshift-serverless:GetCredentials\",\n      \"Resource\": \"arn:aws:redshift-serverless:*:*:workgroup/*\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"aws:ResourceTag/RedshiftDataFullAccess\": \"*\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"DenyCreateAPIUser\",\n      \"Effect\": \"Deny\",\n      \"Action\": \"redshift:CreateClusterUser\",\n      \"Resource\": [\n        \"arn:aws:redshift:*:*:dbuser:*/redshift_data_api_user\"\n      ]\n    },\n    {\n      \"Sid\": \"ServiceLinkedRole\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"iam:CreateServiceLinkedRole\",\n      \"Resource\": \"arn:aws:iam::*:role/aws-service-role/redshift-data.amazonaws.com/AWSServiceRoleForRedshift\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"iam:AWSServiceName\": \"redshift-data.amazonaws.com\"\n        }\n      }\n    }\n  ]\n}",
    "generated": "```json\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"redshift:DescribeClusterParameterGroups\",\n        \"redshift:DescribeClusterParameters\",\n        \"redshift:DescribeClusters\",\n        \"redshift:DescribeEventCategories\",\n        \"redshift:DescribeEvents\",\n        \"redshift:DescribeParameterGroups\",\n        \"redshift:DescribeParameters\",\n        \"redshift:GetClusterParameterGroupStatus\",\n        \"redshift:GetClusterParameterStatus\",\n        \"redshift:ListClusterParameterGroups\",\n        \"redshift:ListClusterParameters\",\n        \"redshift:ListClusterSubnetGroupMembers\",\n        \"redshift:ListClusterSubnetGroups\",\n        \"redshift:ListTagsForResource\",\n        \"redshift:ModifyClusterParameterGroup\",\n        \"redshift:ModifyClusterParameterGroupStatus\",\n        \"redshift:ModifyClusterParameters\",\n        \"redshift:ModifyClusterSubnetGroup\",\n        \"redshift:TagResource\"\n      ],",
    "complexity": "complex"
  },
  {
    "id": "aws_managed_0904",
    "instruction": "Provide an IAM policy for Amazon Sage Maker Service Catalog Products Cloudformation Service Role Policy",
    "expected": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"sagemaker:AddAssociation\",\n        \"sagemaker:AddTags\",\n        \"sagemaker:AssociateTrialComponent\",\n        \"sagemaker:BatchDescribeModelPackage\",\n        \"sagemaker:BatchGetMetrics\",\n        \"sagemaker:BatchGetRecord\",\n        \"sagemaker:BatchPutMetrics\",\n        \"sagemaker:CreateAction\",\n        \"sagemaker:CreateAlgorithm\",\n        \"sagemaker:CreateApp\",\n        \"sagemaker:CreateAppImageConfig\",\n        \"sagemaker:CreateArtifact\",\n        \"sagemaker:CreateAutoMLJob\",\n        \"sagemaker:CreateCodeRepository\",\n        \"sagemaker:CreateCompilationJob\",\n        \"sagemaker:CreateContext\",\n        \"sagemaker:CreateDataQualityJobDefinition\",\n        \"sagemaker:CreateDeviceFleet\",\n        \"sagemaker:CreateDomain\",\n        \"sagemaker:CreateEdgePackagingJob\",\n        \"sagemaker:CreateEndpoint\",\n        \"sagemaker:CreateEndpointConfig\",\n        \"sagemaker:CreateExperiment\",\n        \"sagemaker:CreateFeatureGroup\",\n        \"sagemaker:CreateFlowDefinition\",\n        \"sagemaker:CreateHumanTaskUi\",\n        \"sagemaker:CreateHyperParameterTuningJob\",\n        \"sagemaker:CreateImage\",\n        \"sagemaker:CreateImageVersion\",\n        \"sagemaker:CreateInferenceRecommendationsJob\",\n        \"sagemaker:CreateLabelingJob\",\n        \"sagemaker:CreateLineageGroupPolicy\",\n        \"sagemaker:CreateModel\",\n        \"sagemaker:CreateModelBiasJobDefinition\",\n        \"sagemaker:CreateModelExplainabilityJobDefinition\",\n        \"sagemaker:CreateModelPackage\",\n        \"sagemaker:CreateModelPackageGroup\",\n        \"sagemaker:CreateModelQualityJobDefinition\",\n        \"sagemaker:CreateMonitoringSchedule\",\n        \"sagemaker:CreateNotebookInstance\",\n        \"sagemaker:CreateNotebookInstanceLifecycleConfig\",\n        \"sagemaker:CreatePipeline\",\n        \"sagemaker:CreatePresignedDomainUrl\",\n        \"sagemaker:CreatePresignedNotebookInstanceUrl\",\n        \"sagemaker:CreateProcessingJob\",\n        \"sagemaker:CreateProject\",\n        \"sagemaker:CreateTrainingJob\",\n        \"sagemaker:CreateTransformJob\",\n        \"sagemaker:CreateTrial\",\n        \"sagemaker:CreateTrialComponent\",\n        \"sagemaker:CreateUserProfile\",\n        \"sagemaker:CreateWorkforce\",\n        \"sagemaker:CreateWorkteam\",\n        \"sagemaker:DeleteAction\",\n        \"sagemaker:DeleteAlgorithm\",\n        \"sagemaker:DeleteApp\",\n        \"sagemaker:DeleteAppImageConfig\",\n        \"sagemaker:DeleteArtifact\",\n        \"sagemaker:DeleteAssociation\",\n        \"sagemaker:DeleteCodeRepository\",\n        \"sagemaker:DeleteContext\",\n        \"sagemaker:DeleteDataQualityJobDefinition\",\n        \"sagemaker:DeleteDeviceFleet\",\n        \"sagemaker:DeleteDomain\",\n        \"sagemaker:DeleteEndpoint\",\n        \"sagemaker:DeleteEndpointConfig\",\n        \"sagemaker:DeleteExperiment\",\n        \"sagemaker:DeleteFeatureGroup\",\n        \"sagemaker:DeleteFlowDefinition\",\n        \"sagemaker:DeleteHumanLoop\",\n        \"sagemaker:DeleteHumanTaskUi\",\n        \"sagemaker:DeleteImage\",\n        \"sagemaker:DeleteImageVersion\",\n        \"sagemaker:DeleteLineageGroupPolicy\",\n        \"sagemaker:DeleteModel\",\n        \"sagemaker:DeleteModelBiasJobDefinition\",\n        \"sagemaker:DeleteModelExplainabilityJobDefinition\",\n        \"sagemaker:DeleteModelPackage\",\n        \"sagemaker:DeleteModelPackageGroup\",\n        \"sagemaker:DeleteModelPackageGroupPolicy\",\n        \"sagemaker:DeleteModelQualityJobDefinition\",\n        \"sagemaker:DeleteMonitoringSchedule\",\n        \"sagemaker:DeleteNotebookInstance\",\n        \"sagemaker:DeleteNotebookInstanceLifecycleConfig\",\n        \"sagemaker:DeletePipeline\",\n        \"sagemaker:DeleteProject\",\n        \"sagemaker:DeleteRecord\",\n        \"sagemaker:DeleteTags\",\n        \"sagemaker:DeleteTrial\",\n        \"sagemaker:DeleteTrialComponent\",\n        \"sagemaker:DeleteUserProfile\",\n        \"sagemaker:DeleteWorkforce\",\n        \"sagemaker:DeleteWorkteam\",\n        \"sagemaker:DeregisterDevices\",\n        \"sagemaker:DescribeAction\",\n        \"sagemaker:DescribeAlgorithm\",\n        \"sagemaker:DescribeApp\",\n        \"sagemaker:DescribeAppImageConfig\",\n        \"sagemaker:DescribeArtifact\",\n        \"sagemaker:DescribeAutoMLJob\",\n        \"sagemaker:DescribeCodeRepository\",\n        \"sagemaker:DescribeCompilationJob\",\n        \"sagemaker:DescribeContext\",\n        \"sagemaker:DescribeDataQualityJobDefinition\",\n        \"sagemaker:DescribeDevice\",\n        \"sagemaker:DescribeDeviceFleet\",\n        \"sagemaker:DescribeDomain\",\n        \"sagemaker:DescribeEdgePackagingJob\",\n        \"sagemaker:DescribeEndpoint\",\n        \"sagemaker:DescribeEndpointConfig\",\n        \"sagemaker:DescribeExperiment\",\n        \"sagemaker:DescribeFeatureGroup\",\n        \"sagemaker:DescribeFlowDefinition\",\n        \"sagemaker:DescribeHumanLoop\",\n        \"sagemaker:DescribeHumanTaskUi\",\n        \"sagemaker:DescribeHyperParameterTuningJob\",\n        \"sagemaker:DescribeImage\",\n        \"sagemaker:DescribeImageVersion\",\n        \"sagemaker:DescribeInferenceRecommendationsJob\",\n        \"sagemaker:DescribeLabelingJob\",\n        \"sagemaker:DescribeLineageGroup\",\n        \"sagemaker:DescribeModel\",\n        \"sagemaker:DescribeModelBiasJobDefinition\",\n        \"sagemaker:DescribeModelExplainabilityJobDefinition\",\n        \"sagemaker:DescribeModelPackage\",\n        \"sagemaker:DescribeModelPackageGroup\",\n        \"sagemaker:DescribeModelQualityJobDefinition\",\n        \"sagemaker:DescribeMonitoringSchedule\",\n        \"sagemaker:DescribeNotebookInstance\",\n        \"sagemaker:DescribeNotebookInstanceLifecycleConfig\",\n        \"sagemaker:DescribePipeline\",\n        \"sagemaker:DescribePipelineDefinitionForExecution\",\n        \"sagemaker:DescribePipelineExecution\",\n        \"sagemaker:DescribeProcessingJob\",\n        \"sagemaker:DescribeProject\",\n        \"sagemaker:DescribeSubscribedWorkteam\",\n        \"sagemaker:DescribeTrainingJob\",\n        \"sagemaker:DescribeTransformJob\",\n        \"sagemaker:DescribeTrial\",\n        \"sagemaker:DescribeTrialComponent\",\n        \"sagemaker:DescribeUserProfile\",\n        \"sagemaker:DescribeWorkforce\",\n        \"sagemaker:DescribeWorkteam\",\n        \"sagemaker:DisableSagemakerServicecatalogPortfolio\",\n        \"sagemaker:DisassociateTrialComponent\",\n        \"sagemaker:EnableSagemakerServicecatalogPortfolio\",\n        \"sagemaker:GetDeviceFleetReport\",\n        \"sagemaker:GetDeviceRegistration\",\n        \"sagemaker:GetLineageGroupPolicy\",\n        \"sagemaker:GetModelPackageGroupPolicy\",\n        \"sagemaker:GetRecord\",\n        \"sagemaker:GetSagemakerServicecatalogPortfolioStatus\",\n        \"sagemaker:GetSearchSuggestions\",\n        \"sagemaker:InvokeEndpoint\",\n        \"sagemaker:InvokeEndpointAsync\",\n        \"sagemaker:ListActions\",\n        \"sagemaker:ListAlgorithms\",\n        \"sagemaker:ListAppImageConfigs\",\n        \"sagemaker:ListApps\",\n        \"sagemaker:ListArtifacts\",\n        \"sagemaker:ListAssociations\",\n        \"sagemaker:ListAutoMLJobs\",\n        \"sagemaker:ListCandidatesForAutoMLJob\",\n        \"sagemaker:ListCodeRepositories\",\n        \"sagemaker:ListCompilationJobs\",\n        \"sagemaker:ListContexts\",\n        \"sagemaker:ListDataQualityJobDefinitions\",\n        \"sagemaker:ListDeviceFleets\",\n        \"sagemaker:ListDevices\",\n        \"sagemaker:ListDomains\",\n        \"sagemaker:ListEdgePackagingJobs\",\n        \"sagemaker:ListEndpointConfigs\",\n        \"sagemaker:ListEndpoints\",\n        \"sagemaker:ListExperiments\",\n        \"sagemaker:ListFeatureGroups\",\n        \"sagemaker:ListFlowDefinitions\",\n        \"sagemaker:ListHumanLoops\",\n        \"sagemaker:ListHumanTaskUis\",\n        \"sagemaker:ListHyperParameterTuningJobs\",\n        \"sagemaker:ListImageVersions\",\n        \"sagemaker:ListImages\",\n        \"sagemaker:ListInferenceRecommendationsJobs\",\n        \"sagemaker:ListLabelingJobs\",\n        \"sagemaker:ListLabelingJobsForWorkteam\",\n        \"sagemaker:ListLineageGroups\",\n        \"sagemaker:ListModelBiasJobDefinitions\",\n        \"sagemaker:ListModelExplainabilityJobDefinitions\",\n        \"sagemaker:ListModelMetadata\",\n        \"sagemaker:ListModelPackageGroups\",\n        \"sagemaker:ListModelPackages\",\n        \"sagemaker:ListModelQualityJobDefinitions\",\n        \"sagemaker:ListModels\",\n        \"sagemaker:ListMonitoringExecutions\",\n        \"sagemaker:ListMonitoringSchedules\",\n        \"sagemaker:ListNotebookInstanceLifecycleConfigs\",\n        \"sagemaker:ListNotebookInstances\",\n        \"sagemaker:ListPipelineExecutionSteps\",\n        \"sagemaker:ListPipelineExecutions\",\n        \"sagemaker:ListPipelineParametersForExecution\",\n        \"sagemaker:ListPipelines\",\n        \"sagemaker:ListProcessingJobs\",\n        \"sagemaker:ListProjects\",\n        \"sagemaker:ListSubscribedWorkteams\",\n        \"sagemaker:ListTags\",\n        \"sagemaker:ListTrainingJobs\",\n        \"sagemaker:ListTrainingJobsForHyperParameterTuningJob\",\n        \"sagemaker:ListTransformJobs\",\n        \"sagemaker:ListTrialComponents\",\n        \"sagemaker:ListTrials\",\n        \"sagemaker:ListUserProfiles\",\n        \"sagemaker:ListWorkforces\",\n        \"sagemaker:ListWorkteams\",\n        \"sagemaker:PutLineageGroupPolicy\",\n        \"sagemaker:PutModelPackageGroupPolicy\",\n        \"sagemaker:PutRecord\",\n        \"sagemaker:QueryLineage\",\n        \"sagemaker:RegisterDevices\",\n        \"sagemaker:RenderUiTemplate\",\n        \"sagemaker:Search\",\n        \"sagemaker:SendHeartbeat\",\n        \"sagemaker:SendPipelineExecutionStepFailure\",\n        \"sagemaker:SendPipelineExecutionStepSuccess\",\n        \"sagemaker:StartHumanLoop\",\n        \"sagemaker:StartMonitoringSchedule\",\n        \"sagemaker:StartNotebookInstance\",\n        \"sagemaker:StartPipelineExecution\",\n        \"sagemaker:StopAutoMLJob\",\n        \"sagemaker:StopCompilationJob\",\n        \"sagemaker:StopEdgePackagingJob\",\n        \"sagemaker:StopHumanLoop\",\n        \"sagemaker:StopHyperParameterTuningJob\",\n        \"sagemaker:StopInferenceRecommendationsJob\",\n        \"sagemaker:StopLabelingJob\",\n        \"sagemaker:StopMonitoringSchedule\",\n        \"sagemaker:StopNotebookInstance\",\n        \"sagemaker:StopPipelineExecution\",\n        \"sagemaker:StopProcessingJob\",\n        \"sagemaker:StopTrainingJob\",\n        \"sagemaker:StopTransformJob\",\n        \"sagemaker:UpdateAction\",\n        \"sagemaker:UpdateAppImageConfig\",\n        \"sagemaker:UpdateArtifact\",\n        \"sagemaker:UpdateCodeRepository\",\n        \"sagemaker:UpdateContext\",\n        \"sagemaker:UpdateDeviceFleet\",\n        \"sagemaker:UpdateDevices\",\n        \"sagemaker:UpdateDomain\",\n        \"sagemaker:UpdateEndpoint\",\n        \"sagemaker:UpdateEndpointWeightsAndCapacities\",\n        \"sagemaker:UpdateExperiment\",\n        \"sagemaker:UpdateImage\",\n        \"sagemaker:UpdateModelPackage\",\n        \"sagemaker:UpdateMonitoringSchedule\",\n        \"sagemaker:UpdateNotebookInstance\",\n        \"sagemaker:UpdateNotebookInstanceLifecycleConfig\",\n        \"sagemaker:UpdatePipeline\",\n        \"sagemaker:UpdatePipelineExecution\",\n        \"sagemaker:UpdateProject\",\n        \"sagemaker:UpdateTrainingJob\",\n        \"sagemaker:UpdateTrial\",\n        \"sagemaker:UpdateTrialComponent\",\n        \"sagemaker:UpdateUserProfile\",\n        \"sagemaker:UpdateWorkforce\",\n        \"sagemaker:UpdateWorkteam\"\n      ],\n      \"NotResource\": [\n        \"arn:aws:sagemaker:*:*:domain/*\",\n        \"arn:aws:sagemaker:*:*:user-profile/*\",\n        \"arn:aws:sagemaker:*:*:app/*\",\n        \"arn:aws:sagemaker:*:*:flow-definition/*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:PassRole\"\n      ],\n      \"Resource\": [\n        \"arn:aws:iam::*:role/service-role/AmazonSageMakerServiceCatalogProductsCodeBuildRole\",\n        \"arn:aws:iam::*:role/service-role/AmazonSageMakerServiceCatalogProductsExecutionRole\"\n      ]\n    }\n  ]\n}",
    "generated": "```json\n{\n    \"Version\": \"2012-10-17\",\n    \"Statement\": [\n        {\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"sagemaker:*\"\n            ],\n            \"Resource\": \"*\"\n        }\n    ]\n}\n```\n\n### Explanation:\nThe above policy allows the service role to perform all actions on the SageMaker service. This is necessary because the service role will be used by the CloudFormation stack to create resources in the SageMaker service, such as notebook instances and training jobs. By allowing all actions on the SageMaker service, the service role can create and manage these resources as needed.\n\nIt's important to note that this policy should only be applied to the service role for the specific CloudFormation stack that you are using. Applying this policy to other service roles or stacks could potentially lead to unintended access and security risks.",
    "complexity": "medium"
  }
]