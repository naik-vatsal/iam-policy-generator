{"text": "### Instruction:\nProvide an IAM policy for AWS Fault Injection Simulator EC2Access\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"AllowEc2Actions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:RebootInstances\",\n        \"ec2:SendSpotInstanceInterruptions\",\n        \"ec2:StartInstances\",\n        \"ec2:StopInstances\",\n        \"ec2:TerminateInstances\"\n      ],\n      \"Resource\": \"arn:aws:ec2:*:*:instance/*\"\n    },\n    {\n      \"Sid\": \"AllowEc2InstancesWithEncryptedEbsVolumes\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"kms:CreateGrant\"\n      ],\n      \"Resource\": [\n        \"arn:aws:kms:*:*:key/*\"\n      ],\n      \"Condition\": {\n        \"StringLike\": {\n          \"kms:ViaService\": \"ec2.*.amazonaws.com\"\n        },\n        \"Bool\": {\n          \"kms:GrantIsForAWSResource\": \"true\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"AllowSSMSendOnEc2\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ssm:SendCommand\"\n      ],\n      \"Resource\": [\n        \"arn:aws:ec2:*:*:instance/*\",\n        \"arn:aws:ssm:*:*:document/*\"\n      ]\n    },\n    {\n      \"Sid\": \"AllowSSMStopOnEc2\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ssm:CancelCommand\",\n        \"ssm:ListCommands\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"DescribeInstances\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"ec2:DescribeInstances\",\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"DescribeSubnets\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"ec2:DescribeSubnets\",\n      \"Resource\": \"*\"\n    }\n  ]\n}", "id": "aws_managed_0965", "complexity": "complex", "services": ["ec2", "kms", "ssm"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for Amazon Elastic Transcoder Jobs Submitter\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Action\": [\n        \"elastictranscoder:Read*\",\n        \"elastictranscoder:List*\",\n        \"elastictranscoder:*Job\",\n        \"elastictranscoder:*Preset\",\n        \"s3:ListAllMyBuckets\",\n        \"s3:ListBucket\",\n        \"iam:ListRoles\",\n        \"sns:ListTopics\"\n      ],\n      \"Effect\": \"Allow\",\n      \"Resource\": \"*\"\n    }\n  ]\n}", "id": "aws_managed_0351", "complexity": "complex", "services": ["elastictranscoder", "iam", "s3", "sns"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for Amazon Elastic Container Registry Public Power User\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ecr-public:GetAuthorizationToken\",\n        \"sts:GetServiceBearerToken\",\n        \"ecr-public:BatchCheckLayerAvailability\",\n        \"ecr-public:GetRepositoryPolicy\",\n        \"ecr-public:DescribeRepositories\",\n        \"ecr-public:DescribeRegistries\",\n        \"ecr-public:DescribeImages\",\n        \"ecr-public:DescribeImageTags\",\n        \"ecr-public:GetRepositoryCatalogData\",\n        \"ecr-public:GetRegistryCatalogData\",\n        \"ecr-public:InitiateLayerUpload\",\n        \"ecr-public:UploadLayerPart\",\n        \"ecr-public:CompleteLayerUpload\",\n        \"ecr-public:PutImage\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}", "id": "aws_managed_0715", "complexity": "medium", "services": ["ecr-public", "sts"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for AWS Code Artifact Read Only Access\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Action\": [\n        \"codeartifact:Describe*\",\n        \"codeartifact:Get*\",\n        \"codeartifact:List*\",\n        \"codeartifact:ReadFromRepository\"\n      ],\n      \"Effect\": \"Allow\",\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"sts:GetServiceBearerToken\",\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"sts:AWSServiceName\": \"codeartifact.amazonaws.com\"\n        }\n      }\n    }\n  ]\n}", "id": "aws_managed_0642", "complexity": "medium", "services": ["codeartifact", "sts"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for AWS Purchase Orders Service Role Policy\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"account:GetAccountInformation\",\n        \"account:GetContactInformation\",\n        \"aws-portal:*Billing\",\n        \"consolidatedbilling:GetAccountBillingRole\",\n        \"invoicing:GetInvoicePDF\",\n        \"invoicing:ListInvoiceUnits\",\n        \"payments:GetPaymentInstrument\",\n        \"payments:ListPaymentPreferences\",\n        \"purchase-orders:AddPurchaseOrder\",\n        \"purchase-orders:DeletePurchaseOrder\",\n        \"purchase-orders:GetPurchaseOrder\",\n        \"purchase-orders:ListPurchaseOrderInvoices\",\n        \"purchase-orders:ListPurchaseOrders\",\n        \"purchase-orders:ListTagsForResource\",\n        \"purchase-orders:ModifyPurchaseOrders\",\n        \"purchase-orders:TagResource\",\n        \"purchase-orders:UntagResource\",\n        \"purchase-orders:UpdatePurchaseOrder\",\n        \"purchase-orders:UpdatePurchaseOrderStatus\",\n        \"purchase-orders:ViewPurchaseOrders\",\n        \"tax:ListTaxRegistrations\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}", "id": "aws_managed_0606", "complexity": "complex", "services": ["account", "aws-portal", "consolidatedbilling", "invoicing", "payments", "purchase-orders", "tax"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for EC2Instance Profile For Image Builder\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:DescribeVolumes\",\n        \"ec2:DescribeSnapshots\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:CreateSnapshot\"\n      ],\n      \"Resource\": [\n        \"arn:aws:ec2:*:*:snapshot/*\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:RequestTag/CreatedBy\": \"EC2 Image Builder\"\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:CreateSnapshot\"\n      ],\n      \"Resource\": [\n        \"arn:aws:ec2:*:*:volume/*\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:ResourceTag/CreatedBy\": \"EC2 Image Builder\"\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:CreateTags\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"ec2:CreateAction\": \"CreateSnapshot\",\n          \"aws:RequestTag/CreatedBy\": [\n            \"EC2 Image Builder\"\n          ]\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:GetObject\"\n      ],\n      \"Resource\": [\n        \"arn:aws:s3:::*/*.ISO\",\n        \"arn:aws:s3:::*/*.iso\",\n        \"arn:aws:s3:::*/*.Iso\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"s3:ResourceAccount\": \"${aws:PrincipalAccount}\"\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"imagebuilder:GetComponent\",\n        \"imagebuilder:GetMarketplaceResource\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"kms:Decrypt\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"ForAnyValue:StringEquals\": {\n          \"kms:EncryptionContextKeys\": \"aws:imagebuilder:arn\",\n          \"aws:CalledVia\": [\n            \"imagebuilder.amazonaws.com\"\n          ]\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:GetObject\"\n      ],\n      \"Resource\": \"arn:aws:s3:::ec2imagebuilder*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"logs:CreateLogStream\",\n        \"logs:CreateLogGroup\",\n        \"logs:PutLogEvents\"\n      ],\n      \"Resource\": \"arn:aws:logs:*:*:log-group:/aws/imagebuilder/*\"\n    }\n  ]\n}", "id": "aws_managed_0554", "complexity": "complex", "services": ["ec2", "imagebuilder", "kms", "logs", "s3"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for Cloud Watch Application Insights Full Access\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"applicationinsights:*\",\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:DescribeInstances\",\n        \"ec2:DescribeVolumes\",\n        \"rds:DescribeDBInstances\",\n        \"rds:DescribeDBClusters\",\n        \"sqs:ListQueues\",\n        \"elasticloadbalancing:DescribeLoadBalancers\",\n        \"elasticloadbalancing:DescribeTargetGroups\",\n        \"elasticloadbalancing:DescribeTargetHealth\",\n        \"autoscaling:DescribeAutoScalingGroups\",\n        \"lambda:ListFunctions\",\n        \"dynamodb:ListTables\",\n        \"s3:ListAllMyBuckets\",\n        \"sns:ListTopics\",\n        \"states:ListStateMachines\",\n        \"apigateway:GET\",\n        \"ecs:ListClusters\",\n        \"ecs:DescribeTaskDefinition\",\n        \"ecs:ListServices\",\n        \"ecs:ListTasks\",\n        \"eks:ListClusters\",\n        \"eks:ListNodegroups\",\n        \"fsx:DescribeFileSystems\",\n        \"logs:DescribeLogGroups\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:CreateServiceLinkedRole\"\n      ],\n      \"Resource\": [\n        \"arn:aws:iam::*:role/aws-service-role/application-insights.amazonaws.com/AWSServiceRoleForApplicationInsights\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"iam:AWSServiceName\": \"application-insights.amazonaws.com\"\n        }\n      }\n    }\n  ]\n}", "id": "aws_managed_0705", "complexity": "complex", "services": ["apigateway", "applicationinsights", "autoscaling", "dynamodb", "ec2", "ecs", "eks", "elasticloadbalancing", "fsx", "iam", "lambda", "logs", "rds", "s3", "sns", "sqs", "states"], "source": "aws_managed"}
{"text": "### Instruction:\nGrant permission to list all buckets and get the location of any bucket, but don't allow reading actual objects\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:ListAllMyBuckets\",\n        \"s3:GetBucketLocation\",\n        \"s3:ListBucket\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}", "id": "syn_s3_009", "complexity": "simple", "services": ["s3"], "source": "synthetic"}
{"text": "### Instruction:\nProvide an IAM policy for Amazon Event Bridge Schemas Read Only Access\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"AmazonEventBridgeSchemasReadOnlyAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"schemas:ListDiscoverers\",\n        \"schemas:DescribeDiscoverer\",\n        \"schemas:ListRegistries\",\n        \"schemas:DescribeRegistry\",\n        \"schemas:SearchSchemas\",\n        \"schemas:ListSchemas\",\n        \"schemas:ListSchemaVersions\",\n        \"schemas:DescribeSchema\",\n        \"schemas:GetDiscoveredSchema\",\n        \"schemas:DescribeCodeBinding\",\n        \"schemas:GetCodeBindingSource\",\n        \"schemas:ListTagsForResource\",\n        \"schemas:GetResourcePolicy\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}", "id": "aws_managed_0551", "complexity": "simple", "services": ["schemas"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for Amazon Chime Voice Connector Service Linked Role Policy\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"chime:GetVoiceConnector*\"\n      ],\n      \"Resource\": [\n        \"*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"kinesisvideo:GetDataEndpoint\",\n        \"kinesisvideo:PutMedia\",\n        \"kinesisvideo:UpdateDataRetention\",\n        \"kinesisvideo:DescribeStream\",\n        \"kinesisvideo:CreateStream\"\n      ],\n      \"Resource\": [\n        \"arn:aws:kinesisvideo:*:*:stream/ChimeVoiceConnector-*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"kinesisvideo:ListStreams\"\n      ],\n      \"Resource\": [\n        \"*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"SNS:Publish\"\n      ],\n      \"Resource\": [\n        \"arn:aws:sns:*:*:ChimeVoiceConnector-Streaming*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"sqs:SendMessage\"\n      ],\n      \"Resource\": [\n        \"arn:aws:sqs:*:*:ChimeVoiceConnector-Streaming*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"polly:SynthesizeSpeech\"\n      ],\n      \"Resource\": [\n        \"*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"chime:CreateMediaInsightsPipeline\",\n        \"chime:GetMediaInsightsPipelineConfiguration\"\n      ],\n      \"Resource\": [\n        \"*\"\n      ]\n    }\n  ]\n}", "id": "aws_managed_0515", "complexity": "complex", "services": ["chime", "kinesisvideo", "polly", "sns", "sqs"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for Server Migration Connector\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"iam:GetUser\",\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"sms:SendMessage\",\n        \"sms:GetMessages\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:CreateBucket\",\n        \"s3:DeleteBucket\",\n        \"s3:DeleteObject\",\n        \"s3:GetBucketLocation\",\n        \"s3:GetObject\",\n        \"s3:ListBucket\",\n        \"s3:PutObject\",\n        \"s3:PutObjectAcl\",\n        \"s3:PutLifecycleConfiguration\",\n        \"s3:AbortMultipartUpload\",\n        \"s3:ListBucketMultipartUploads\",\n        \"s3:ListMultipartUploadParts\"\n      ],\n      \"Resource\": [\n        \"arn:aws:s3:::sms-b-*\",\n        \"arn:aws:s3:::import-to-ec2-*\",\n        \"arn:aws:s3:::server-migration-service-upgrade\",\n        \"arn:aws:s3:::server-migration-service-upgrade/*\",\n        \"arn:aws:s3:::connector-platform-upgrade-info/*\",\n        \"arn:aws:s3:::connector-platform-upgrade-info\",\n        \"arn:aws:s3:::connector-platform-upgrade-bundles/*\",\n        \"arn:aws:s3:::connector-platform-upgrade-bundles\",\n        \"arn:aws:s3:::connector-platform-release-notes/*\",\n        \"arn:aws:s3:::connector-platform-release-notes\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"awsconnector:*\",\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"SNS:Publish\"\n      ],\n      \"Resource\": \"arn:aws:sns:*:*:metrics-sns-topic-for-*\"\n    }\n  ]\n}", "id": "aws_managed_0176", "complexity": "complex", "services": ["awsconnector", "iam", "s3", "sms", "sns"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for AWS Thinkbox AWS Portal Worker Policy\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:DescribeTags\"\n      ],\n      \"Resource\": [\n        \"*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:TerminateInstances\"\n      ],\n      \"Resource\": [\n        \"arn:aws:ec2:*:*:instance/*\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"ec2:ResourceTag/DeadlineRole\": \"DeadlineRenderNode\"\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:GetObject\",\n        \"s3:PutObject\",\n        \"s3:ListBucket\"\n      ],\n      \"Resource\": [\n        \"arn:aws:s3:::aws-portal-cache*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:GetObject\"\n      ],\n      \"Resource\": [\n        \"arn:aws:s3:::stack*/gateway_certs/*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"logs:CreateLogStream\",\n        \"logs:PutLogEvents\",\n        \"logs:DescribeLogStreams\",\n        \"logs:DescribeLogGroups\"\n      ],\n      \"Resource\": [\n        \"arn:aws:logs:*:*:log-group:/thinkbox*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"logs:CreateLogGroup\"\n      ],\n      \"Resource\": [\n        \"*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"sqs:SendMessage\",\n        \"sqs:GetQueueUrl\"\n      ],\n      \"Resource\": [\n        \"arn:aws:sqs:*:*:DeadlineAWS*\"\n      ]\n    }\n  ]\n}", "id": "aws_managed_0614", "complexity": "complex", "services": ["ec2", "logs", "s3", "sqs"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for IAM Access Advisor Read Only\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:ListRoles\",\n        \"iam:ListUsers\",\n        \"iam:ListGroups\",\n        \"iam:ListPolicies\",\n        \"iam:ListPoliciesGrantingServiceAccess\",\n        \"iam:GenerateServiceLastAccessedDetails\",\n        \"iam:GenerateOrganizationsAccessReport\",\n        \"iam:GenerateCredentialReport\",\n        \"iam:GetRole\",\n        \"iam:GetPolicy\",\n        \"iam:GetServiceLastAccessedDetails\",\n        \"iam:GetServiceLastAccessedDetailsWithEntities\",\n        \"iam:GetOrganizationsAccessReport\",\n        \"organizations:DescribeAccount\",\n        \"organizations:DescribeOrganization\",\n        \"organizations:DescribeOrganizationalUnit\",\n        \"organizations:DescribePolicy\",\n        \"organizations:ListChildren\",\n        \"organizations:ListParents\",\n        \"organizations:ListPoliciesForTarget\",\n        \"organizations:ListRoots\",\n        \"organizations:ListPolicies\",\n        \"organizations:ListTargetsForPolicy\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}", "id": "aws_managed_0481", "complexity": "medium", "services": ["iam", "organizations"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for AWS Billing Service Role Policy\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"billing:GetBillingViewData\"\n      ],\n      \"Resource\": \"arn:aws:billing::*:billingview/*\"\n    }\n  ]\n}", "id": "aws_managed_1386", "complexity": "simple", "services": ["billing"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for AWS Marketplace Metering Register Usage\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Action\": [\n        \"aws-marketplace:RegisterUsage\"\n      ],\n      \"Effect\": \"Allow\",\n      \"Resource\": \"*\"\n    }\n  ]\n}", "id": "aws_managed_0544", "complexity": "simple", "services": ["aws-marketplace"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for AWS Partner Central Full Access\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"PassAWSPartnerCentralRole\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:PassRole\"\n      ],\n      \"Resource\": \"arn:aws:iam::*:role/PartnerCentralRoleFor*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"iam:PassedToService\": \"partnercentral-account-management.amazonaws.com\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"PartnerUserRoleAssociation\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:ListRoles\",\n        \"Partnercentral-account-management:AssociatePartnerUser\",\n        \"Partnercentral-account-management:DisassociatePartnerUser\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"AWSPartnerCentralAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"partnercentral:*\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"partnercentral:Catalog\": [\n            \"AWS\",\n            \"Sandbox\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"VerificationAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"partnercentral:StartVerification\",\n        \"partnercentral:GetVerification\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"PassAWSPartnerCentralSnapshotJobRole\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:PassRole\"\n      ],\n      \"Resource\": [\n        \"arn:aws:iam::*:role/*\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"iam:PassedToService\": \"resource-snapshot-job.partnercentral-selling.amazonaws.com\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"LegacyPartnerCentralAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"partnercentral-account-management:AccessLegacyPartnerCentral\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"PartnerCentralMarketingAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"partnercentral-account-management:AccessMarketingCentral\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"ChannelBillingTransferRoleAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"sts:AssumeRole\"\n      ],\n      \"Resource\": [\n        \"arn:aws:iam::*:role/PartnerCentralChannelBillingTransferManagement\",\n        \"arn:aws:iam::*:role/PartnerCentralChannelBillingTransferReadOnly\"\n      ]\n    },\n    {\n      \"Sid\": \"PartnerCentralEphemeralWriteS3Access\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:PutObject\"\n      ],\n      \"Resource\": \"arn:aws:s3:::aws-partner-central-marketplace-ephemeral-writeonly-files/${aws:PrincipalAccount}/*\"\n    },\n    {\n      \"Sid\": \"SupportAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"support:CreateCase\",\n        \"support:DescribeCases\",\n        \"support:AddCommunicationToCase\",\n        \"support:ResolveCase\",\n        \"support:AddAttachmentsToSet\",\n        \"support:DescribeCommunications\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"ListEntitiesAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"aws-marketplace:ListEntities\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"DescribeEntityAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"aws-marketplace:DescribeEntity\"\n      ],\n      \"Resource\": [\n        \"arn:aws:aws-marketplace:*:*:AWSMarketplace*/Solution/*\",\n        \"arn:aws:aws-marketplace:*:*:AWSMarketplace*/OfferSet/*\",\n        \"arn:aws:aws-marketplace:*:*:AWSMarketplace*/Offer/*\"\n      ]\n    },\n    {\n      \"Sid\": \"AWSMarketplaceAgreementsReadAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"aws-marketplace:SearchAgreements\",\n        \"aws-marketplace:DescribeAgreement\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"ForAllValues:StringEquals\": {\n          \"aws-marketplace:AgreementType\": [\n            \"PurchaseAgreement\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"AmazonQPartnerAssistantAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"q:StartConversation\",\n        \"q:SendMessage\",\n        \"q:GetConversation\",\n        \"q:ListConversations\",\n        \"q:PassRequest\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}", "id": "aws_managed_1265", "complexity": "complex", "services": ["aws-marketplace", "iam", "partnercentral", "partnercentral-account-management", "q", "s3", "sts", "support"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for AWS Step Functions Read Only Access\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"ReadOnlyAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"states:ListStateMachines\",\n        \"states:ListActivities\",\n        \"states:DescribeStateMachine\",\n        \"states:DescribeStateMachineForExecution\",\n        \"states:ListExecutions\",\n        \"states:DescribeExecution\",\n        \"states:GetExecutionHistory\",\n        \"states:DescribeActivity\",\n        \"states:ListTagsForResource\",\n        \"states:DescribeMapRun\",\n        \"states:ListMapRuns\",\n        \"states:DescribeStateMachineAlias\",\n        \"states:ListStateMachineAliases\",\n        \"states:ListStateMachineVersions\",\n        \"states:ValidateStateMachineDefinition\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}", "id": "aws_managed_0206", "complexity": "simple", "services": ["states"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for Cloud Front Read Only Access\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"cfReadOnly\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"acm:DescribeCertificate\",\n        \"acm:ListCertificates\",\n        \"cloudfront:Describe*\",\n        \"cloudfront:Get*\",\n        \"cloudfront:List*\",\n        \"cloudfront-keyvaluestore:Describe*\",\n        \"cloudfront-keyvaluestore:Get*\",\n        \"cloudfront-keyvaluestore:List*\",\n        \"iam:ListServerCertificates\",\n        \"route53:List*\",\n        \"waf:ListWebACLs\",\n        \"waf:GetWebACL\",\n        \"wafv2:ListWebACLs\",\n        \"wafv2:GetWebACL\",\n        \"ec2:DescribeIpamPools\",\n        \"ec2:GetIpamPoolCidrs\",\n        \"pricingplanmanager:ListSubscriptions\",\n        \"pricingplanmanager:GetSubscription\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}", "id": "aws_managed_0009", "complexity": "complex", "services": ["acm", "cloudfront", "cloudfront-keyvaluestore", "ec2", "iam", "pricingplanmanager", "route53", "waf", "wafv2"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for AWS Systems Manager Account Discovery Service Policy\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"organizations:DescribeAccount\",\n        \"organizations:DescribeOrganization\",\n        \"organizations:DescribeOrganizationalUnit\",\n        \"organizations:ListRoots\",\n        \"organizations:ListAccounts\",\n        \"organizations:ListAWSServiceAccessForOrganization\",\n        \"organizations:ListChildren\",\n        \"organizations:ListParents\",\n        \"organizations:ListDelegatedServicesForAccount\",\n        \"organizations:ListDelegatedAdministrators\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}", "id": "aws_managed_0521", "complexity": "simple", "services": ["organizations"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for AWS Io T Things Registration\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iot:AddThingToThingGroup\",\n        \"iot:AttachPolicy\",\n        \"iot:AttachPrincipalPolicy\",\n        \"iot:AttachThingPrincipal\",\n        \"iot:CreateCertificateFromCsr\",\n        \"iot:CreatePolicy\",\n        \"iot:CreateThing\",\n        \"iot:DescribeCertificate\",\n        \"iot:DescribeThing\",\n        \"iot:DescribeThingGroup\",\n        \"iot:DescribeThingType\",\n        \"iot:DetachPolicy\",\n        \"iot:DetachThingPrincipal\",\n        \"iot:GetPolicy\",\n        \"iot:ListAttachedPolicies\",\n        \"iot:ListPolicyPrincipals\",\n        \"iot:ListPrincipalPolicies\",\n        \"iot:ListPrincipalThings\",\n        \"iot:ListTargetsForPolicy\",\n        \"iot:ListThingGroupsForThing\",\n        \"iot:ListThingPrincipals\",\n        \"iot:RegisterCertificate\",\n        \"iot:RegisterThing\",\n        \"iot:RemoveThingFromThingGroup\",\n        \"iot:UpdateCertificate\",\n        \"iot:UpdateThing\",\n        \"iot:UpdateThingGroupsForThing\",\n        \"iot:AddThingToBillingGroup\",\n        \"iot:DescribeBillingGroup\",\n        \"iot:RemoveThingFromBillingGroup\"\n      ],\n      \"Resource\": [\n        \"*\"\n      ]\n    }\n  ]\n}", "id": "aws_managed_0299", "complexity": "simple", "services": ["iot"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for Amazon SNS Full Access\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"SNSFullAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"sns:*\",\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"SMSAccessViaSNS\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"sms-voice:DescribeVerifiedDestinationNumbers\",\n        \"sms-voice:CreateVerifiedDestinationNumber\",\n        \"sms-voice:SendDestinationNumberVerificationCode\",\n        \"sms-voice:SendTextMessage\",\n        \"sms-voice:DeleteVerifiedDestinationNumber\",\n        \"sms-voice:VerifyDestinationNumber\",\n        \"sms-voice:DescribeAccountAttributes\",\n        \"sms-voice:DescribeSpendLimits\",\n        \"sms-voice:DescribePhoneNumbers\",\n        \"sms-voice:SetTextMessageSpendLimitOverride\",\n        \"sms-voice:DescribeOptedOutNumbers\",\n        \"sms-voice:DeleteOptedOutNumber\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:CalledViaLast\": \"sns.amazonaws.com\"\n        }\n      }\n    }\n  ]\n}", "id": "aws_managed_0062", "complexity": "medium", "services": ["sms-voice", "sns"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for Amazon EKS Block Storage Policy\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:AttachVolume\",\n        \"ec2:DetachVolume\",\n        \"ec2:ModifyVolume\",\n        \"ec2:EnableFastSnapshotRestores\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:ResourceTag/eks:eks-cluster-name\": \"${aws:PrincipalTag/eks:eks-cluster-name}\"\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"ec2:CreateTags\",\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"ec2:CreateAction\": [\n            \"CreateVolume\",\n            \"CreateSnapshot\"\n          ]\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:CreateVolume\"\n      ],\n      \"Resource\": \"arn:aws:ec2:*:*:volume/*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:RequestTag/eks:eks-cluster-name\": \"${aws:PrincipalTag/eks:eks-cluster-name}\"\n        },\n        \"ForAllValues:StringLike\": {\n          \"aws:TagKeys\": [\n            \"eks:eks-cluster-name\",\n            \"CSIVolumeName\",\n            \"ebs.csi.eks.amazonaws.com/cluster\",\n            \"kubernetes.io/cluster/*\",\n            \"kubernetes.io/created-for/*\",\n            \"Name\",\n            \"KubernetesCluster\"\n          ]\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:CreateVolume\"\n      ],\n      \"Resource\": \"arn:aws:ec2:*:*:snapshot/*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:CreateSnapshot\"\n      ],\n      \"Resource\": \"arn:aws:ec2:*:*:volume/*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:CreateSnapshot\"\n      ],\n      \"Resource\": \"arn:aws:ec2:*:*:snapshot/*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:RequestTag/eks:eks-cluster-name\": \"${aws:PrincipalTag/eks:eks-cluster-name}\"\n        },\n        \"ForAllValues:StringLike\": {\n          \"aws:TagKeys\": [\n            \"eks:eks-cluster-name\",\n            \"CSIVolumeSnapshotName\",\n            \"ebs.csi.eks.amazonaws.com/cluster\",\n            \"kubernetes.io/cluster/*\",\n            \"Name\"\n          ]\n        }\n      }\n    }\n  ]\n}", "id": "aws_managed_1234", "complexity": "complex", "services": ["ec2"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for Amazon Zocalo Full Access\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"zocalo:*\",\n        \"ds:*\",\n        \"ec2:AuthorizeSecurityGroupEgress\",\n        \"ec2:AuthorizeSecurityGroupIngress\",\n        \"ec2:CreateNetworkInterface\",\n        \"ec2:CreateSecurityGroup\",\n        \"ec2:CreateSubnet\",\n        \"ec2:CreateTags\",\n        \"ec2:CreateVpc\",\n        \"ec2:DescribeAvailabilityZones\",\n        \"ec2:DescribeNetworkInterfaces\",\n        \"ec2:DescribeSubnets\",\n        \"ec2:DescribeVpcs\",\n        \"ec2:DeleteNetworkInterface\",\n        \"ec2:DeleteSecurityGroup\",\n        \"ec2:RevokeSecurityGroupEgress\",\n        \"ec2:RevokeSecurityGroupIngress\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}", "id": "aws_managed_0071", "complexity": "medium", "services": ["ds", "ec2", "zocalo"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for Amazon Forecast Full Access\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"forecast:*\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:PassRole\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"iam:PassedToService\": \"forecast.amazonaws.com\"\n        }\n      }\n    }\n  ]\n}", "id": "aws_managed_0446", "complexity": "medium", "services": ["forecast", "iam"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for Amazon EMR Containers Service Role Policy\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"eks:DescribeCluster\",\n        \"eks:ListNodeGroups\",\n        \"eks:DescribeNodeGroup\",\n        \"ec2:DescribeRouteTables\",\n        \"ec2:DescribeSubnets\",\n        \"ec2:DescribeSecurityGroups\",\n        \"elasticloadbalancing:DescribeInstanceHealth\",\n        \"elasticloadbalancing:DescribeLoadBalancers\",\n        \"elasticloadbalancing:DescribeTargetGroups\",\n        \"elasticloadbalancing:DescribeTargetHealth\",\n        \"eks:ListPodIdentityAssociations\",\n        \"eks:DescribePodIdentityAssociation\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"acm:ImportCertificate\",\n        \"acm:AddTagsToCertificate\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:RequestTag/emr-container:endpoint:managed-certificate\": \"true\"\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"acm:DeleteCertificate\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:ResourceTag/emr-container:endpoint:managed-certificate\": \"true\"\n        }\n      }\n    }\n  ]\n}", "id": "aws_managed_0731", "complexity": "complex", "services": ["acm", "ec2", "eks", "elasticloadbalancing"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for Amazon Code Guru Profiler Read Only Access\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Action\": [\n        \"codeguru:Get*\",\n        \"codeguru-profiler:BatchGet*\",\n        \"codeguru-profiler:Describe*\",\n        \"codeguru-profiler:Get*\",\n        \"codeguru-profiler:List*\",\n        \"iam:ListRoles\",\n        \"iam:ListUsers\"\n      ],\n      \"Effect\": \"Allow\",\n      \"Resource\": \"*\"\n    }\n  ]\n}", "id": "aws_managed_0563", "complexity": "medium", "services": ["codeguru", "codeguru-profiler", "iam"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for Amazon MCS Read Only Access\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"cassandra:Select\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"application-autoscaling:DescribeScalableTargets\",\n        \"application-autoscaling:DescribeScalingActivities\",\n        \"application-autoscaling:DescribeScalingPolicies\",\n        \"application-autoscaling:DescribeScheduledActions\",\n        \"cloudwatch:DescribeAlarms\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}", "id": "aws_managed_0565", "complexity": "medium", "services": ["application-autoscaling", "cassandra", "cloudwatch"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for AWS Observability Admin Logs Centralization Service Role Policy\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"logs:CreateLogGroup\",\n        \"logs:CreateLogStream\",\n        \"logs:PutLogEvents\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"kms:Encrypt\",\n        \"kms:Decrypt\",\n        \"kms:GenerateDataKey\"\n      ],\n      \"Condition\": {\n        \"ForAnyValue:StringEquals\": {\n          \"aws:CalledVia\": [\n            \"logs.amazonaws.com\"\n          ]\n        },\n        \"StringEquals\": {\n          \"aws:ResourceTag/LogsManaged\": \"true\"\n        },\n        \"ArnLike\": {\n          \"kms:EncryptionContext:aws:logs:arn\": \"arn:aws:logs:*:*:log-group:*\"\n        }\n      },\n      \"Resource\": \"*\"\n    }\n  ]\n}", "id": "aws_managed_1387", "complexity": "medium", "services": ["kms", "logs"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for Cloud Watch Lambda Application Signals Execution Role Policy\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"CloudWatchApplicationSignalsXrayWritePermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"xray:PutTraceSegments\"\n      ],\n      \"Resource\": [\n        \"*\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:ResourceAccount\": \"${aws:PrincipalAccount}\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"CloudWatchApplicationSignalsLogGroupWritePermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"logs:CreateLogGroup\",\n        \"logs:CreateLogStream\",\n        \"logs:PutLogEvents\"\n      ],\n      \"Resource\": \"arn:aws:logs:*:*:log-group:/aws/application-signals/data:*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:ResourceAccount\": \"${aws:PrincipalAccount}\"\n        }\n      }\n    }\n  ]\n}", "id": "aws_managed_1227", "complexity": "medium", "services": ["logs", "xray"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for Health Organizations Service Role Policy\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"HealthAPIOrganizationView0\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"organizations:ListAccounts\",\n        \"organizations:ListAWSServiceAccessForOrganization\",\n        \"organizations:ListDelegatedAdministrators\",\n        \"organizations:DescribeOrganization\",\n        \"organizations:DescribeAccount\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}", "id": "aws_managed_0579", "complexity": "simple", "services": ["organizations"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for AI Ops Console Admin Policy\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"AIOpsAdmin\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"aiops:*\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"OrganizationsAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"organizations:ListAWSServiceAccessForOrganization\",\n        \"organizations:DescribeOrganization\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"SSOApplicationManagement\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"sso:PutApplicationAccessScope\",\n        \"sso:PutApplicationAssignmentConfiguration\",\n        \"sso:PutApplicationGrant\",\n        \"sso:PutApplicationAuthenticationMethod\",\n        \"sso:DeleteApplication\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:CalledViaLast\": \"aiops.amazonaws.com\",\n          \"aws:ResourceTag/ManagedByAmazonAIOperations\": \"true\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"SSOApplicationTagManagement\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"sso:CreateApplication\",\n        \"sso:TagResource\"\n      ],\n      \"Resource\": [\n        \"arn:aws:sso:::instance/*\",\n        \"arn:aws:sso::aws:applicationProvider/aiops\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:CalledViaLast\": \"aiops.amazonaws.com\",\n          \"aws:RequestTag/ManagedByAmazonAIOperations\": \"true\"\n        },\n        \"ForAllValues:StringEquals\": {\n          \"aws:TagKeys\": [\n            \"ManagedByAmazonAIOperations\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"SSOTagManagement\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"sso:TagResource\"\n      ],\n      \"Resource\": \"arn:aws:sso::*:application/*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:CalledViaLast\": \"aiops.amazonaws.com\",\n          \"aws:ResourceTag/ManagedByAmazonAIOperations\": \"true\"\n        },\n        \"ForAllValues:StringEquals\": {\n          \"aws:TagKeys\": [\n            \"ManagedByAmazonAIOperations\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"SSOManagementAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"identitystore:DescribeUser\",\n        \"sso:ListApplications\",\n        \"sso:ListInstances\",\n        \"sso:DescribeRegisteredRegions\",\n        \"sso:GetSharedSsoConfiguration\",\n        \"sso:DescribeInstance\",\n        \"sso:GetSSOStatus\",\n        \"sso-directory:DescribeUsers\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"AllowSTSContextSetting\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"sts:SetContext\"\n      ],\n      \"Resource\": \"arn:aws:sts::*:self\"\n    },\n    {\n      \"Sid\": \"IdentityPropagationAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"signin:ListTrustedIdentityPropagationApplicationsForConsole\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"CloudtrailAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"cloudtrail:ListTrails\",\n        \"cloudtrail:DescribeTrails\",\n        \"cloudtrail:ListEventDataStores\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"KMSAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"kms:ListAliases\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"SSMIntegrationSecretsManagerAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"secretsmanager:CreateSecret\",\n        \"secretsmanager:PutResourcePolicy\",\n        \"secretsmanager:UpdateSecret\",\n        \"secretsmanager:DeleteSecret\"\n      ],\n      \"Resource\": \"arn:aws:secretsmanager:*:*:secret:aws/ssm/3p/*\"\n    },\n    {\n      \"Sid\": \"SSMIntegrationAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ssm:GetServiceSetting\",\n        \"ssm:UpdateServiceSetting\"\n      ],\n      \"Resource\": \"arn:aws:ssm:*:*:servicesetting/integrations/*\"\n    },\n    {\n      \"Sid\": \"SSMIntegrationCreatePolicy\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:CreatePolicy\"\n      ],\n      \"Resource\": \"arn:aws:iam::*:policy/service-role/AWSServiceRoleSSMIntegrationsPolicy*\"\n    },\n    {\n      \"Sid\": \"ChatbotConfigurations\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"chatbot:DescribeChimeWebhookConfigurations\",\n        \"chatbot:DescribeSlackWorkspaces\",\n        \"chatbot:DescribeSlackChannelConfigurations\",\n        \"chatbot:ListMicrosoftTeamsChannelConfigurations\",\n        \"chatbot:ListMicrosoftTeamsConfiguredTeams\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"IAMPassRoleToAIOps\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:PassRole\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"iam:PassedToService\": \"aiops.amazonaws.com\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"IAMListRoles\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:ListRoles\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"TagBoundaryPermission\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"tag:GetTagKeys\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"IAMPassRoleToSSMIntegration\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:PassRole\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"iam:PassedToService\": \"ssm.integrations.amazonaws.com\"\n        },\n        \"ArnEquals\": {\n          \"iam:AssociatedResourceArn\": \"arn:aws:aiops:*:*:investigation-group/*\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"SSMOpsItemAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ssm:CreateOpsItem\",\n        \"ssm:AddTagsToResource\"\n      ],\n      \"Resource\": \"arn:*:ssm:*:*:opsitem/*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:RequestTag/Integration\": \"CloudWatch\",\n          \"aws:ResourceTag/Integration\": \"CloudWatch\"\n        },\n        \"ForAllValues:StringEquals\": {\n          \"aws:TagKeys\": [\n            \"Integration\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"CreateAIOpsCrossAccountAssistantPolicy\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:CreatePolicy\"\n      ],\n      \"Resource\": \"arn:aws:iam::*:policy/AIOpsCrossAccountAssistantPolicy*\"\n    },\n    {\n      \"Sid\": \"AmazonQAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"q:StartConversation\",\n        \"q:SendMessage\",\n        \"q:GetConversation\",\n        \"q:ListConversations\",\n        \"q:UpdateConversation\",\n        \"q:DeleteConversation\",\n        \"q:PassRequest\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}", "id": "aws_managed_1290", "complexity": "complex", "services": ["aiops", "chatbot", "cloudtrail", "iam", "identitystore", "kms", "organizations", "q", "secretsmanager", "signin", "ssm", "sso", "sso-directory", "sts", "tag"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for AWS Elastic Disaster Recovery Failback Installation Policy\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"DRSFailbackInstallationPolicy1\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"drs:SendClientLogsForDrs\",\n        \"drs:SendClientMetricsForDrs\",\n        \"drs:DescribeRecoveryInstances\",\n        \"drs:DescribeSourceServers\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"DRSFailbackInstallationPolicy2\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"drs:TagResource\",\n        \"drs:IssueAgentCertificateForDrs\",\n        \"drs:AssociateFailbackClientToRecoveryInstanceForDrs\",\n        \"drs:GetSuggestedFailbackClientDeviceMappingForDrs\",\n        \"drs:UpdateAgentReplicationInfoForDrs\",\n        \"drs:UpdateFailbackClientDeviceMappingForDrs\"\n      ],\n      \"Resource\": \"arn:aws:drs:*:*:recovery-instance/*\"\n    }\n  ]\n}", "id": "aws_managed_0865", "complexity": "medium", "services": ["drs"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for Amazon Fraud Detector Full Access Policy\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"frauddetector:*\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"sagemaker:ListEndpoints\",\n        \"sagemaker:DescribeEndpoint\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:ListAllMyBuckets\",\n        \"s3:GetBucketLocation\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:ListRoles\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:PassRole\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"iam:PassedToService\": \"frauddetector.amazonaws.com\"\n        }\n      }\n    }\n  ]\n}", "id": "aws_managed_0574", "complexity": "complex", "services": ["frauddetector", "iam", "s3", "sagemaker"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for Simple Workflow Full Access\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Action\": [\n        \"swf:*\"\n      ],\n      \"Effect\": \"Allow\",\n      \"Resource\": \"*\"\n    }\n  ]\n}", "id": "aws_managed_0061", "complexity": "simple", "services": ["swf"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for Amazon Sage Maker Edge Device Fleet Policy\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"DeviceS3Access\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:PutObject\",\n        \"s3:GetBucketLocation\"\n      ],\n      \"Resource\": [\n        \"arn:aws:s3:::*SageMaker*\",\n        \"arn:aws:s3:::*Sagemaker*\",\n        \"arn:aws:s3:::*sagemaker*\"\n      ]\n    },\n    {\n      \"Sid\": \"SageMakerEdgeApis\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"sagemaker:SendHeartbeat\",\n        \"sagemaker:GetDeviceRegistration\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"CreateIoTRoleAlias\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iot:CreateRoleAlias\",\n        \"iot:DescribeRoleAlias\",\n        \"iot:UpdateRoleAlias\",\n        \"iot:ListTagsForResource\",\n        \"iot:TagResource\"\n      ],\n      \"Resource\": [\n        \"arn:aws:iot:*:*:rolealias/SageMakerEdge*\"\n      ]\n    },\n    {\n      \"Sid\": \"CreateIoTRoleAliasIamPermissionsGetRole\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:GetRole\"\n      ],\n      \"Resource\": [\n        \"arn:aws:iam::*:role/*SageMaker*\",\n        \"arn:aws:iam::*:role/*Sagemaker*\",\n        \"arn:aws:iam::*:role/*sagemaker*\"\n      ]\n    },\n    {\n      \"Sid\": \"CreateIoTRoleAliasIamPermissionsPassRole\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:PassRole\"\n      ],\n      \"Resource\": [\n        \"arn:aws:iam::*:role/*SageMaker*\",\n        \"arn:aws:iam::*:role/*Sagemaker*\",\n        \"arn:aws:iam::*:role/*sagemaker*\"\n      ],\n      \"Condition\": {\n        \"StringEqualsIfExists\": {\n          \"iam:PassedToService\": [\n            \"iot.amazonaws.com\",\n            \"credentials.iot.amazonaws.com\"\n          ]\n        }\n      }\n    }\n  ]\n}", "id": "aws_managed_0730", "complexity": "complex", "services": ["iam", "iot", "s3", "sagemaker"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for AWS Service Catalog Admin Read Only Access\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"cloudformation:DescribeStackEvents\",\n        \"cloudformation:DescribeStacks\",\n        \"cloudformation:DescribeChangeSet\",\n        \"cloudformation:ListChangeSets\",\n        \"cloudformation:ListStackResources\",\n        \"cloudformation:DescribeStackSet\",\n        \"cloudformation:DescribeStackInstance\",\n        \"cloudformation:DescribeStackSetOperation\",\n        \"cloudformation:ListStackInstances\",\n        \"cloudformation:ListStackSetOperations\",\n        \"cloudformation:ListStackSetOperationResults\"\n      ],\n      \"Resource\": [\n        \"arn:aws:cloudformation:*:*:stack/SC-*\",\n        \"arn:aws:cloudformation:*:*:stack/StackSet-SC-*\",\n        \"arn:aws:cloudformation:*:*:changeSet/SC-*\",\n        \"arn:aws:cloudformation:*:*:stackset/SC-*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"cloudformation:GetTemplateSummary\",\n        \"iam:GetGroup\",\n        \"iam:GetRole\",\n        \"iam:GetUser\",\n        \"iam:ListGroups\",\n        \"iam:ListRoles\",\n        \"iam:ListUsers\",\n        \"servicecatalog:Get*\",\n        \"servicecatalog:List*\",\n        \"servicecatalog:Describe*\",\n        \"servicecatalog:ScanProvisionedProducts\",\n        \"servicecatalog:Search*\",\n        \"ssm:DescribeDocument\",\n        \"ssm:GetAutomationExecution\",\n        \"ssm:ListDocuments\",\n        \"ssm:ListDocumentVersions\",\n        \"config:DescribeConfigurationRecorders\",\n        \"config:DescribeConfigurationRecorderStatus\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}", "id": "aws_managed_0523", "complexity": "complex", "services": ["cloudformation", "config", "iam", "servicecatalog", "ssm"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for AWS Quick Setup SSM Deployment Role Policy\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"cloudformation:DescribeStacks\",\n        \"cloudformation:DescribeStackDriftDetectionStatus\",\n        \"cloudformation:ListStacks\"\n      ],\n      \"Resource\": [\n        \"*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"cloudformation:CreateStack\",\n        \"cloudformation:UpdateStack\",\n        \"cloudformation:DeleteStack\",\n        \"cloudformation:CreateChangeSet\",\n        \"cloudformation:DeleteChangeSet\",\n        \"cloudformation:ExecuteChangeSet\",\n        \"cloudformation:DescribeChangeSet\",\n        \"cloudformation:DescribeStackResourceDrifts\",\n        \"cloudformation:DetectStackDrift\",\n        \"cloudformation:DetectStackResourceDrift\",\n        \"cloudformation:DescribeStackEvents\"\n      ],\n      \"Resource\": [\n        \"arn:aws:cloudformation:*:*:stack/StackSet-AWS-QuickSetup-SSM-*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"lambda:CreateFunction\",\n        \"lambda:TagResource\"\n      ],\n      \"Condition\": {\n        \"ForAnyValue:StringEquals\": {\n          \"aws:CalledVia\": [\n            \"cloudformation.amazonaws.com\"\n          ]\n        },\n        \"StringEquals\": {\n          \"aws:ResourceAccount\": [\n            \"${aws:PrincipalAccount}\"\n          ],\n          \"aws:ResourceTag/QuickSetupDocument\": [\n            \"AWSQuickSetupType-SSM\"\n          ],\n          \"aws:RequestTag/QuickSetupDocument\": [\n            \"AWSQuickSetupType-SSM\"\n          ]\n        },\n        \"ForAllValues:StringLike\": {\n          \"aws:TagKeys\": [\n            \"QuickSetup*\"\n          ]\n        }\n      },\n      \"Resource\": [\n        \"arn:aws:lambda:*:*:function:aws-quicksetup-lifecycle*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"lambda:InvokeFunction\",\n        \"lambda:DeleteFunction\",\n        \"lambda:UpdateFunction*\"\n      ],\n      \"Condition\": {\n        \"ForAnyValue:StringEquals\": {\n          \"aws:CalledVia\": [\n            \"cloudformation.amazonaws.com\"\n          ]\n        },\n        \"StringEquals\": {\n          \"aws:ResourceAccount\": [\n            \"${aws:PrincipalAccount}\"\n          ],\n          \"aws:ResourceTag/QuickSetupDocument\": [\n            \"AWSQuickSetupType-SSM\"\n          ]\n        }\n      },\n      \"Resource\": [\n        \"arn:aws:lambda:*:*:function:aws-quicksetup-lifecycle*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"lambda:GetFunction\"\n      ],\n      \"Condition\": {\n        \"ForAnyValue:StringEquals\": {\n          \"aws:CalledVia\": \"cloudformation.amazonaws.com\"\n        },\n        \"StringEquals\": {\n          \"aws:ResourceAccount\": \"${aws:PrincipalAccount}\"\n        }\n      },\n      \"Resource\": \"arn:aws:lambda:*:*:function:aws-quicksetup-lifecycle*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ssm:CreateAssociation\",\n        \"ssm:UpdateAssociation\",\n        \"ssm:DeleteAssociation\",\n        \"ssm:DescribeAssociation\",\n        \"ssm:GetDocument\",\n        \"ssm:DescribeDocument\"\n      ],\n      \"Condition\": {\n        \"ForAnyValue:StringEquals\": {\n          \"aws:CalledVia\": [\n            \"cloudformation.amazonaws.com\"\n          ]\n        }\n      },\n      \"Resource\": [\n        \"arn:aws:ssm:*::document/AWSQuickSetupType-EnableAREX\",\n        \"arn:aws:ssm:*::document/AWSQuickSetupType-EnableDHMC\",\n        \"arn:aws:ssm:*::document/AWSQuickSetupType-ManageInstanceProfile\",\n        \"arn:aws:ssm:*::document/AWS-EnableExplorer\",\n        \"arn:aws:ssm:*::document/AWS-GatherSoftwareInventory\",\n        \"arn:aws:ssm:*::document/AWS-UpdateSSMAgent\",\n        \"arn:aws:ec2:*:*:instance/*\",\n        \"arn:aws:ssm:*:*:managed-instance/*\",\n        \"arn:aws:ssm:*:*:association/*\"\n      ]\n    },\n    {\n      \"Sid\": \"SSMSLRCreate\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:CreateServiceLinkedRole\"\n      ],\n      \"Resource\": [\n        \"arn:aws:iam::*:role/aws-service-role/ssm.amazonaws.com/AWSServiceRoleForAmazonSSM\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"iam:AWSServiceName\": \"ssm.amazonaws.com\"\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:CreateRole\",\n        \"iam:TagRole\"\n      ],\n      \"Condition\": {\n        \"ForAnyValue:StringEquals\": {\n          \"aws:CalledVia\": [\n            \"cloudformation.amazonaws.com\"\n          ]\n        },\n        \"ForAllValues:StringLike\": {\n          \"aws:TagKeys\": [\n            \"QuickSetup*\"\n          ]\n        },\n        \"StringEquals\": {\n          \"aws:ResourceTag/QuickSetupDocument\": [\n            \"AWSQuickSetupType-SSM\"\n          ],\n          \"aws:RequestTag/QuickSetupDocument\": [\n            \"AWSQuickSetupType-SSM\"\n          ]\n        }\n      },\n      \"Resource\": [\n        \"arn:aws:iam::*:role/AWS-QuickSetup-SSM-*\",\n        \"arn:aws:iam::*:role/AWS-SSM-Remediation*\",\n        \"arn:aws:iam::*:role/AWS-SSM-Diagnosis*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:GetRole\",\n        \"iam:UpdateRole\",\n        \"iam:DeleteRole\",\n        \"iam:GetRolePolicy\",\n        \"iam:ListAttachedRolePolicies\",\n        \"iam:ListRolePolicies\",\n        \"iam:ListRoleTags\"\n      ],\n      \"Condition\": {\n        \"ForAnyValue:StringEquals\": {\n          \"aws:CalledVia\": [\n            \"cloudformation.amazonaws.com\"\n          ]\n        }\n      },\n      \"Resource\": [\n        \"arn:aws:iam::*:role/AWS-QuickSetup-SSM-*\",\n        \"arn:aws:iam::*:role/AWS-SSM-Remediation*\",\n        \"arn:aws:iam::*:role/AWS-SSM-Diagnosis*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:AttachRolePolicy\",\n        \"iam:DetachRolePolicy\"\n      ],\n      \"Condition\": {\n        \"ArnEquals\": {\n          \"iam:PolicyARN\": [\n            \"arn:aws:iam::aws:policy/AWSQuickSetupSSMLifecycleManagementExecutionPolicy\"\n          ]\n        }\n      },\n      \"Resource\": [\n        \"arn:aws:iam::*:role/AWS-QuickSetup-SSM-LifecycleManagement-*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:AttachRolePolicy\",\n        \"iam:DetachRolePolicy\"\n      ],\n      \"Condition\": {\n        \"ArnEquals\": {\n          \"iam:PolicyARN\": \"arn:aws:iam::aws:policy/AWSQuickSetupSSMManageResourcesExecutionPolicy\"\n        }\n      },\n      \"Resource\": \"arn:aws:iam::*:role/AWS-QuickSetup-SSM-ManageResources-*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:AttachRolePolicy\",\n        \"iam:DetachRolePolicy\"\n      ],\n      \"Condition\": {\n        \"ArnEquals\": {\n          \"iam:PolicyARN\": [\n            \"arn:aws:iam::aws:policy/AWS-SSM-RemediationAutomation-AdministrationRolePolicy\",\n            \"arn:aws:iam::aws:policy/AWS-SSM-RemediationAutomation-ExecutionRolePolicy\",\n            \"arn:aws:iam::aws:policy/AWS-SSM-RemediationAutomation-OperationalAccountAdministrationRolePolicy\",\n            \"arn:aws:iam::aws:policy/AWS-SSM-Automation-DiagnosisBucketPolicy\",\n            \"arn:aws:iam::aws:policy/AWS-SSM-DiagnosisAutomation-AdministrationRolePolicy\",\n            \"arn:aws:iam::aws:policy/AWS-SSM-DiagnosisAutomation-ExecutionRolePolicy\"\n          ]\n        }\n      },\n      \"Resource\": [\n        \"arn:aws:iam::*:role/AWS-SSM-Remediation*\",\n        \"arn:aws:iam::*:role/AWS-SSM-Diagnosis*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:PassRole\"\n      ],\n      \"Resource\": [\n        \"arn:aws:iam::*:role/AWS-QuickSetup*\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"iam:PassedToService\": \"ssm.amazonaws.com\",\n          \"iam:ResourceTag/QuickSetupDocument\": \"AWSQuickSetupType-SSM\"\n        },\n        \"ArnLike\": {\n          \"iam:AssociatedResourceARN\": [\n            \"arn:aws:ssm:*::document/AWSQuickSetupType-EnableAREX\",\n            \"arn:aws:ssm:*::document/AWSQuickSetupType-EnableDHMC\",\n            \"arn:aws:ssm:*::document/AWSQuickSetupType-ManageInstanceProfile\",\n            \"arn:aws:ssm:*::document/AWS-EnableExplorer\",\n            \"arn:aws:ssm:*:*:association/*\"\n          ]\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:PassRole\"\n      ],\n      \"Resource\": [\n        \"arn:aws:iam::*:role/AWS-QuickSetup-SSM-LifecycleManagement*\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"iam:PassedToService\": \"lambda.amazonaws.com\",\n          \"iam:ResourceTag/QuickSetupDocument\": \"AWSQuickSetupType-SSM\"\n        },\n        \"ArnLike\": {\n          \"iam:AssociatedResourceARN\": [\n            \"arn:aws:lambda:*:*:function:aws-quicksetup-lifecycle-*\"\n          ]\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"lambda:TagResource\",\n      \"Resource\": [\n        \"arn:aws:lambda:*:*:function:aws-quicksetup-lifecycle*\"\n      ],\n      \"Condition\": {\n        \"ForAnyValue:StringEquals\": {\n          \"aws:CalledVia\": \"cloudformation.amazonaws.com\"\n        },\n        \"ForAllValues:StringLike\": {\n          \"aws:TagKeys\": \"QuickSetup*\"\n        },\n        \"StringLike\": {\n          \"aws:RequestTag/QuickSetupDocumentVersionName\": \"*\"\n        },\n        \"StringEquals\": {\n          \"aws:ResourceTag/QuickSetupDocument\": \"AWSQuickSetupType-SSM\"\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:TagRole\"\n      ],\n      \"Resource\": [\n        \"arn:aws:iam::*:role/AWS-QuickSetup-SSM-*\",\n        \"arn:aws:iam::*:role/AWS-SSM-Remediation*\",\n        \"arn:aws:iam::*:role/AWS-SSM-Diagnosis*\"\n      ],\n      \"Condition\": {\n        \"ForAnyValue:StringEquals\": {\n          \"aws:CalledVia\": \"cloudformation.amazonaws.com\"\n        },\n        \"ForAllValues:StringLike\": {\n          \"aws:TagKeys\": \"QuickSetup*\"\n        },\n        \"StringLike\": {\n          \"aws:RequestTag/QuickSetupDocumentVersionName\": \"*\"\n        },\n        \"StringEquals\": {\n          \"aws:ResourceTag/QuickSetupDocument\": \"AWSQuickSetupType-SSM\"\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ssm:CreateAssociation\",\n        \"ssm:AddTagsToResource\"\n      ],\n      \"Resource\": [\n        \"arn:aws:ssm:*:*:association/*\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:RequestTag/QuickSetupDocument\": [\n            \"AWSQuickSetupType-SSM\"\n          ]\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ssm:CreateAssociation\",\n        \"ssm:UpdateAssociation\",\n        \"ssm:DeleteAssociation\",\n        \"ssm:DescribeAssociation\"\n      ],\n      \"Resource\": \"arn:aws:ssm:*::document/AWSQuickSetupType-SSM-ManageResources\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ssm:UpdateAssociation\",\n        \"ssm:DeleteAssociation\",\n        \"ssm:DescribeAssociation\"\n      ],\n      \"Resource\": [\n        \"arn:aws:ssm:*:*:association/*\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:ResourceTag/QuickSetupDocument\": [\n            \"AWSQuickSetupType-SSM\"\n          ]\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ssm:AddTagsToResource\",\n        \"ssm:RemoveTagsFromResource\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:ResourceTag/QuickSetupDocument\": [\n            \"AWSQuickSetupType-SSM\"\n          ]\n        }\n      },\n      \"Resource\": [\n        \"arn:aws:ssm:*:*:automation-execution/*\",\n        \"arn:aws:ssm:*:*:association/*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ssm:DescribeAssociationExecutions\",\n        \"ssm:DescribeAssociationExecutionTargets\",\n        \"ssm:GetAutomationExecution\"\n      ],\n      \"Condition\": {\n        \"ForAnyValue:StringEquals\": {\n          \"aws:CalledVia\": [\n            \"cloudformation.amazonaws.com\"\n          ]\n        },\n        \"StringEquals\": {\n          \"aws:ResourceTag/QuickSetupDocument\": [\n            \"AWSQuickSetupType-SSM\"\n          ]\n        }\n      },\n      \"Resource\": [\n        \"arn:aws:ssm:*:*:automation-execution/*\",\n        \"arn:aws:ssm:*:*:association/*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"iam:PassRole\",\n      \"Resource\": \"arn:aws:iam::*:role/AWS-QuickSetup-SSM-ManageResources*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"iam:PassedToService\": [\n            \"ssm.amazonaws.com\"\n          ],\n          \"iam:ResourceTag/QuickSetupDocument\": [\n            \"AWSQuickSetupType-SSM\"\n          ]\n        }\n      }\n    }\n  ]\n}", "id": "aws_managed_1257", "complexity": "complex", "services": ["cloudformation", "iam", "lambda", "ssm"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for Amazon Prometheus Query Access\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Action\": [\n        \"aps:GetLabels\",\n        \"aps:GetMetricMetadata\",\n        \"aps:GetSeries\",\n        \"aps:QueryMetrics\"\n      ],\n      \"Effect\": \"Allow\",\n      \"Resource\": \"*\"\n    }\n  ]\n}", "id": "aws_managed_0746", "complexity": "simple", "services": ["aps"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for AWS Config Remediation Service Role Policy\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Action\": [\n        \"ssm:GetDocument\",\n        \"ssm:DescribeDocument\",\n        \"ssm:StartAutomationExecution\"\n      ],\n      \"Resource\": \"*\",\n      \"Effect\": \"Allow\"\n    },\n    {\n      \"Condition\": {\n        \"StringEquals\": {\n          \"iam:PassedToService\": \"ssm.amazonaws.com\"\n        }\n      },\n      \"Action\": \"iam:PassRole\",\n      \"Resource\": \"*\",\n      \"Effect\": \"Allow\"\n    }\n  ]\n}", "id": "aws_managed_0477", "complexity": "medium", "services": ["iam", "ssm"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for Amazon Cognito Read Only\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"cognito-identity:Describe*\",\n        \"cognito-identity:Get*\",\n        \"cognito-identity:List*\",\n        \"cognito-idp:Describe*\",\n        \"cognito-idp:AdminGet*\",\n        \"cognito-idp:AdminList*\",\n        \"cognito-idp:List*\",\n        \"cognito-idp:Get*\",\n        \"cognito-sync:Describe*\",\n        \"cognito-sync:Get*\",\n        \"cognito-sync:List*\",\n        \"iam:ListOpenIdConnectProviders\",\n        \"iam:ListRoles\",\n        \"sns:ListPlatformApplications\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}", "id": "aws_managed_0090", "complexity": "complex", "services": ["cognito-identity", "cognito-idp", "cognito-sync", "iam", "sns"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for Amazon Augmented AI Human Loop Full Access\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"sagemaker:*HumanLoop\",\n        \"sagemaker:*HumanLoops\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}", "id": "aws_managed_0570", "complexity": "simple", "services": ["sagemaker"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for AWS Service Role For Code Whisperer Policy\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"sid1\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"sso-directory:ListMembersInGroup\"\n      ],\n      \"Resource\": [\n        \"*\"\n      ]\n    },\n    {\n      \"Sid\": \"sid2\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"sso:ListProfileAssociations\",\n        \"sso:ListProfiles\",\n        \"sso:ListDirectoryAssociations\",\n        \"sso:DescribeRegisteredRegions\",\n        \"sso:GetProfile\",\n        \"sso:GetManagedApplicationInstance\",\n        \"sso:ListApplicationAssignments\",\n        \"sso:DescribeInstance\",\n        \"sso:DescribeApplication\"\n      ],\n      \"Resource\": [\n        \"*\"\n      ]\n    },\n    {\n      \"Sid\": \"sid3\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"codeguru-security:CreateUploadUrl\"\n      ],\n      \"Resource\": [\n        \"*\"\n      ]\n    },\n    {\n      \"Sid\": \"sid4\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"codeguru-security:CreateScan\",\n        \"codeguru-security:GetScan\",\n        \"codeguru-security:ListFindings\",\n        \"codeguru-security:GetFindings\"\n      ],\n      \"Resource\": [\n        \"arn:aws:codeguru-security:*:*:scans/CodeWhisperer-*\"\n      ]\n    },\n    {\n      \"Sid\": \"sid5\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"cloudwatch:PutMetricData\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"cloudwatch:namespace\": [\n            \"AWS/CodeWhisperer\"\n          ]\n        }\n      }\n    }\n  ]\n}", "id": "aws_managed_1034", "complexity": "complex", "services": ["cloudwatch", "codeguru-security", "sso", "sso-directory"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for AWS Application Autoscaling Dynamo DB Table Policy\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"dynamodb:DescribeTable\",\n        \"dynamodb:UpdateTable\",\n        \"cloudwatch:PutMetricAlarm\",\n        \"cloudwatch:DescribeAlarms\",\n        \"cloudwatch:DeleteAlarms\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}", "id": "aws_managed_0258", "complexity": "medium", "services": ["cloudwatch", "dynamodb"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for Amazon Machine Learning Read Only Access\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"machinelearning:Describe*\",\n        \"machinelearning:Get*\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}", "id": "aws_managed_0102", "complexity": "simple", "services": ["machinelearning"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for Amazon Chime Full Access\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Action\": [\n        \"chime:*\"\n      ],\n      \"Effect\": \"Allow\",\n      \"Resource\": \"*\"\n    },\n    {\n      \"Action\": [\n        \"s3:ListBucket\",\n        \"s3:ListAllMyBuckets\",\n        \"s3:GetBucketAcl\",\n        \"s3:GetBucketLocation\",\n        \"s3:GetBucketLogging\",\n        \"s3:GetBucketVersioning\",\n        \"s3:GetBucketWebsite\"\n      ],\n      \"Effect\": \"Allow\",\n      \"Resource\": \"*\"\n    },\n    {\n      \"Action\": [\n        \"logs:CreateLogDelivery\",\n        \"logs:DeleteLogDelivery\",\n        \"logs:GetLogDelivery\",\n        \"logs:ListLogDeliveries\",\n        \"logs:DescribeResourcePolicies\",\n        \"logs:PutResourcePolicy\",\n        \"logs:CreateLogGroup\",\n        \"logs:DescribeLogGroups\"\n      ],\n      \"Effect\": \"Allow\",\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"sns:CreateTopic\",\n        \"sns:GetTopicAttributes\"\n      ],\n      \"Resource\": [\n        \"arn:aws:sns:*:*:ChimeVoiceConnector-Streaming*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"sqs:GetQueueAttributes\",\n        \"sqs:CreateQueue\"\n      ],\n      \"Resource\": [\n        \"arn:aws:sqs:*:*:ChimeVoiceConnector-Streaming*\"\n      ]\n    },\n    {\n      \"Action\": [\n        \"kinesis:ListStreams\"\n      ],\n      \"Effect\": \"Allow\",\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"kinesis:DescribeStream\"\n      ],\n      \"Resource\": [\n        \"arn:aws:kinesis:*:*:stream/chime-chat-*\",\n        \"arn:aws:kinesis:*:*:stream/chime-messaging-*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:GetEncryptionConfiguration\",\n        \"s3:ListBucket\"\n      ],\n      \"Resource\": [\n        \"arn:aws:s3:::chime-chat-*\"\n      ]\n    }\n  ]\n}", "id": "aws_managed_0264", "complexity": "complex", "services": ["chime", "kinesis", "logs", "s3", "sns", "sqs"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for AWS Control Tower Identity Center Management Policy\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"AllowIdentityCenterInstancePermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"sso:ListPermissionSets\"\n      ],\n      \"Resource\": \"arn:aws:sso:::instance/*\"\n    },\n    {\n      \"Sid\": \"AllowIdentityCenterManagementPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"sso:DescribeRegisteredRegions\",\n        \"sso:ListDirectoryAssociations\",\n        \"sso:ListProfileAssociations\",\n        \"sso:AssociateProfile\",\n        \"sso:GetProfile\",\n        \"sso:CreateProfile\",\n        \"sso:UpdateProfile\",\n        \"sso:GetTrust\",\n        \"sso:CreateTrust\",\n        \"sso:UpdateTrust\",\n        \"sso:CreateApplicationInstance\",\n        \"sso:GetApplicationInstance\",\n        \"sso:GetSSOStatus\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"AllowIdentityCenterDirectoryPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"sso-directory:SearchGroups\",\n        \"sso-directory:CreateGroup\",\n        \"sso-directory:SearchUsers\",\n        \"sso-directory:CreateUser\",\n        \"sso-directory:DescribeDirectory\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}", "id": "aws_managed_1392", "complexity": "medium", "services": ["sso", "sso-directory"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for AWS Service Role For Image Builder\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"ec2:RegisterImage\",\n      \"Resource\": [\n        \"arn:aws:ec2:*::image/*\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:RequestTag/CreatedBy\": \"EC2 Image Builder\"\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"ec2:RegisterImage\",\n      \"Resource\": [\n        \"arn:aws:ec2:*::snapshot/*\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"ec2:ResourceTag/CreatedBy\": \"EC2 Image Builder\"\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:RunInstances\"\n      ],\n      \"Resource\": [\n        \"arn:aws:ec2:*::image/*\",\n        \"arn:aws:ec2:*::snapshot/*\",\n        \"arn:aws:ec2:*:*:subnet/*\",\n        \"arn:aws:ec2:*:*:network-interface/*\",\n        \"arn:aws:ec2:*:*:security-group/*\",\n        \"arn:aws:ec2:*:*:key-pair/*\",\n        \"arn:aws:ec2:*:*:launch-template/*\",\n        \"arn:aws:license-manager:*:*:license-configuration:*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:RunInstances\"\n      ],\n      \"Resource\": [\n        \"arn:aws:ec2:*:*:volume/*\",\n        \"arn:aws:ec2:*:*:instance/*\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:RequestTag/CreatedBy\": [\n            \"EC2 Image Builder\",\n            \"EC2 Fast Launch\"\n          ]\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"iam:PassRole\",\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"iam:PassedToService\": [\n            \"ec2.amazonaws.com\",\n            \"ec2.amazonaws.com.cn\",\n            \"vmie.amazonaws.com\"\n          ]\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:StopInstances\",\n        \"ec2:StartInstances\",\n        \"ec2:TerminateInstances\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"ec2:ResourceTag/CreatedBy\": \"EC2 Image Builder\"\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:CopyImage\",\n        \"ec2:CreateImage\",\n        \"ec2:CreateLaunchTemplate\",\n        \"ec2:DeregisterImage\",\n        \"ec2:DescribeImages\",\n        \"ec2:DescribeInstanceAttribute\",\n        \"ec2:DescribeInstanceStatus\",\n        \"ec2:DescribeInstances\",\n        \"ec2:DescribeInstanceTypeOfferings\",\n        \"ec2:DescribeInstanceTypes\",\n        \"ec2:DescribeSubnets\",\n        \"ec2:DescribeTags\",\n        \"ec2:ModifyImageAttribute\",\n        \"ec2:DescribeImportImageTasks\",\n        \"ec2:DescribeExportImageTasks\",\n        \"ec2:DescribeSnapshots\",\n        \"ec2:DescribeHosts\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:ModifySnapshotAttribute\"\n      ],\n      \"Resource\": \"arn:aws:ec2:*::snapshot/*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"ec2:ResourceTag/CreatedBy\": \"EC2 Image Builder\"\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:CreateTags\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"ec2:CreateAction\": [\n            \"RunInstances\",\n            \"CreateImage\"\n          ],\n          \"aws:RequestTag/CreatedBy\": [\n            \"EC2 Image Builder\",\n            \"EC2 Fast Launch\"\n          ]\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:CreateTags\"\n      ],\n      \"Resource\": [\n        \"arn:aws:ec2:*::image/*\",\n        \"arn:aws:ec2:*:*:export-image-task/*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:CreateTags\"\n      ],\n      \"Resource\": [\n        \"arn:aws:ec2:*::snapshot/*\",\n        \"arn:aws:ec2:*:*:launch-template/*\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:RequestTag/CreatedBy\": [\n            \"EC2 Image Builder\",\n            \"EC2 Fast Launch\"\n          ]\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"license-manager:UpdateLicenseSpecificationsForResource\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"sns:Publish\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ssm:ListCommands\",\n        \"ssm:ListCommandInvocations\",\n        \"ssm:AddTagsToResource\",\n        \"ssm:DescribeInstanceInformation\",\n        \"ssm:GetAutomationExecution\",\n        \"ssm:StopAutomationExecution\",\n        \"ssm:ListInventoryEntries\",\n        \"ssm:SendAutomationSignal\",\n        \"ssm:DescribeInstanceAssociationsStatus\",\n        \"ssm:DescribeAssociationExecutions\",\n        \"ssm:GetCommandInvocation\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"ssm:SendCommand\",\n      \"Resource\": [\n        \"arn:aws:ssm:*:*:document/AWS-RunPowerShellScript\",\n        \"arn:aws:ssm:*:*:document/AWS-RunShellScript\",\n        \"arn:aws:ssm:*:*:document/AWSEC2-RunSysprep\",\n        \"arn:aws:s3:::*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ssm:SendCommand\"\n      ],\n      \"Resource\": [\n        \"arn:aws:ec2:*:*:instance/*\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"ssm:resourceTag/CreatedBy\": [\n            \"EC2 Image Builder\"\n          ]\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"ssm:StartAutomationExecution\",\n      \"Resource\": \"arn:aws:ssm:*:*:automation-definition/ImageBuilder*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ssm:CreateAssociation\",\n        \"ssm:DeleteAssociation\"\n      ],\n      \"Resource\": [\n        \"arn:aws:ssm:*:*:document/AWS-GatherSoftwareInventory\",\n        \"arn:aws:ssm:*:*:association/*\",\n        \"arn:aws:ec2:*:*:instance/*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"kms:Encrypt\",\n        \"kms:Decrypt\",\n        \"kms:ReEncryptFrom\",\n        \"kms:ReEncryptTo\",\n        \"kms:GenerateDataKeyWithoutPlaintext\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"ForAllValues:StringEquals\": {\n          \"kms:EncryptionContextKeys\": [\n            \"aws:ebs:id\"\n          ]\n        },\n        \"StringLike\": {\n          \"kms:ViaService\": [\n            \"ec2.*.amazonaws.com\"\n          ]\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"kms:DescribeKey\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"kms:ViaService\": [\n            \"ec2.*.amazonaws.com\"\n          ]\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"kms:CreateGrant\",\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"Bool\": {\n          \"kms:GrantIsForAWSResource\": true\n        },\n        \"StringLike\": {\n          \"kms:ViaService\": [\n            \"ec2.*.amazonaws.com\"\n          ]\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"sts:AssumeRole\",\n      \"Resource\": \"arn:aws:iam::*:role/EC2ImageBuilderDistributionCrossAccountRole\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"logs:CreateLogStream\",\n        \"logs:CreateLogGroup\",\n        \"logs:PutLogEvents\"\n      ],\n      \"Resource\": \"arn:aws:logs:*:*:log-group:/aws/imagebuilder/*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:CreateLaunchTemplateVersion\",\n        \"ec2:DescribeLaunchTemplates\",\n        \"ec2:ModifyLaunchTemplate\",\n        \"ec2:DescribeLaunchTemplateVersions\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:ExportImage\"\n      ],\n      \"Resource\": \"arn:aws:ec2:*::image/*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"ec2:ResourceTag/CreatedBy\": \"EC2 Image Builder\"\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:ExportImage\"\n      ],\n      \"Resource\": \"arn:aws:ec2:*:*:export-image-task/*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:CancelExportTask\"\n      ],\n      \"Resource\": \"arn:aws:ec2:*:*:export-image-task/*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"ec2:ResourceTag/CreatedBy\": \"EC2 Image Builder\"\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"iam:CreateServiceLinkedRole\",\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"iam:AWSServiceName\": [\n            \"ssm.amazonaws.com\",\n            \"ec2fastlaunch.amazonaws.com\"\n          ]\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:EnableFastLaunch\"\n      ],\n      \"Resource\": [\n        \"arn:aws:ec2:*::image/*\",\n        \"arn:aws:ec2:*:*:launch-template/*\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"ec2:ResourceTag/CreatedBy\": \"EC2 Image Builder\"\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"inspector2:ListCoverage\",\n        \"inspector2:ListFindings\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ecr:CreateRepository\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:RequestTag/CreatedBy\": \"EC2 Image Builder\"\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ecr:TagResource\"\n      ],\n      \"Resource\": \"arn:aws:ecr:*:*:repository/image-builder-*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:RequestTag/CreatedBy\": \"EC2 Image Builder\"\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ecr:BatchDeleteImage\"\n      ],\n      \"Resource\": \"arn:aws:ecr:*:*:repository/image-builder-*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"ecr:ResourceTag/CreatedBy\": \"EC2 Image Builder\"\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"events:DeleteRule\",\n        \"events:DescribeRule\",\n        \"events:PutRule\",\n        \"events:PutTargets\",\n        \"events:RemoveTargets\"\n      ],\n      \"Resource\": [\n        \"arn:aws:events:*:*:rule/ImageBuilder-*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ssm:GetParameter\",\n        \"ssm:PutParameter\"\n      ],\n      \"Resource\": \"arn:aws:ssm:*:*:parameter/imagebuilder/*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ssm:GetParameter\"\n      ],\n      \"Resource\": \"arn:aws:ssm:*::parameter/aws/service/*\"\n    }\n  ]\n}", "id": "aws_managed_0553", "complexity": "complex", "services": ["ec2", "ecr", "events", "iam", "inspector2", "kms", "license-manager", "logs", "sns", "ssm", "sts"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for AWS Batch Service Role\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"AWSBatchPolicyStatement1\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:DescribeAccountAttributes\",\n        \"ec2:DescribeInstances\",\n        \"ec2:DescribeInstanceStatus\",\n        \"ec2:DescribeInstanceAttribute\",\n        \"ec2:DescribeSubnets\",\n        \"ec2:DescribeSecurityGroups\",\n        \"ec2:DescribeKeyPairs\",\n        \"ec2:DescribeImages\",\n        \"ec2:DescribeImageAttribute\",\n        \"ec2:DescribeSpotInstanceRequests\",\n        \"ec2:DescribeSpotFleetInstances\",\n        \"ec2:DescribeSpotFleetRequests\",\n        \"ec2:DescribeSpotPriceHistory\",\n        \"ec2:DescribeSpotFleetRequestHistory\",\n        \"ec2:DescribeVpcClassicLink\",\n        \"ec2:DescribeLaunchTemplateVersions\",\n        \"ec2:CreateLaunchTemplate\",\n        \"ec2:DeleteLaunchTemplate\",\n        \"ec2:RequestSpotFleet\",\n        \"ec2:CancelSpotFleetRequests\",\n        \"ec2:ModifySpotFleetRequest\",\n        \"ec2:TerminateInstances\",\n        \"ec2:RunInstances\",\n        \"autoscaling:DescribeAccountLimits\",\n        \"autoscaling:DescribeAutoScalingGroups\",\n        \"autoscaling:DescribeLaunchConfigurations\",\n        \"autoscaling:DescribeAutoScalingInstances\",\n        \"autoscaling:DescribeScalingActivities\",\n        \"autoscaling:CreateLaunchConfiguration\",\n        \"autoscaling:CreateAutoScalingGroup\",\n        \"autoscaling:UpdateAutoScalingGroup\",\n        \"autoscaling:SetDesiredCapacity\",\n        \"autoscaling:DeleteLaunchConfiguration\",\n        \"autoscaling:DeleteAutoScalingGroup\",\n        \"autoscaling:CreateOrUpdateTags\",\n        \"autoscaling:SuspendProcesses\",\n        \"autoscaling:PutNotificationConfiguration\",\n        \"autoscaling:TerminateInstanceInAutoScalingGroup\",\n        \"ecs:DescribeClusters\",\n        \"ecs:DescribeContainerInstances\",\n        \"ecs:DescribeTaskDefinition\",\n        \"ecs:DescribeTasks\",\n        \"ecs:ListAccountSettings\",\n        \"ecs:ListClusters\",\n        \"ecs:ListContainerInstances\",\n        \"ecs:ListTaskDefinitionFamilies\",\n        \"ecs:ListTaskDefinitions\",\n        \"ecs:ListTasks\",\n        \"ecs:CreateCluster\",\n        \"ecs:DeleteCluster\",\n        \"ecs:RegisterTaskDefinition\",\n        \"ecs:DeregisterTaskDefinition\",\n        \"ecs:RunTask\",\n        \"ecs:StartTask\",\n        \"ecs:StopTask\",\n        \"ecs:UpdateContainerAgent\",\n        \"ecs:DeregisterContainerInstance\",\n        \"logs:CreateLogGroup\",\n        \"logs:CreateLogStream\",\n        \"logs:PutLogEvents\",\n        \"logs:DescribeLogGroups\",\n        \"iam:GetInstanceProfile\",\n        \"iam:GetRole\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"AWSBatchPolicyStatement2\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"ecs:TagResource\",\n      \"Resource\": [\n        \"arn:aws:ecs:*:*:task/*_Batch_*\"\n      ]\n    },\n    {\n      \"Sid\": \"AWSBatchPolicyStatement3\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"iam:PassRole\",\n      \"Resource\": [\n        \"*\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"iam:PassedToService\": [\n            \"ec2.amazonaws.com\",\n            \"ec2.amazonaws.com.cn\",\n            \"ecs-tasks.amazonaws.com\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"AWSBatchPolicyStatement4\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"iam:CreateServiceLinkedRole\",\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"iam:AWSServiceName\": [\n            \"spot.amazonaws.com\",\n            \"spotfleet.amazonaws.com\",\n            \"autoscaling.amazonaws.com\",\n            \"ecs.amazonaws.com\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"AWSBatchPolicyStatement5\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:CreateTags\"\n      ],\n      \"Resource\": [\n        \"*\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"ec2:CreateAction\": \"RunInstances\"\n        }\n      }\n    }\n  ]\n}", "id": "aws_managed_0203", "complexity": "complex", "services": ["autoscaling", "ec2", "ecs", "iam", "logs"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for AWS Deadline Cloud Fleet Worker\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"RunTasksPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"deadline:AssumeFleetRoleForWorker\",\n        \"deadline:UpdateWorker\",\n        \"deadline:UpdateWorkerSchedule\",\n        \"deadline:BatchGetJobEntity\",\n        \"deadline:AssumeQueueRoleForWorker\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:PrincipalAccount\": \"${aws:ResourceAccount}\"\n        }\n      }\n    }\n  ]\n}", "id": "aws_managed_1171", "complexity": "simple", "services": ["deadline"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for AWS Cloud9Environment Member\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"cloud9:GetUserSettings\",\n        \"cloud9:UpdateUserSettings\",\n        \"cloud9:GetMigrationExperiences\",\n        \"iam:GetUser\",\n        \"iam:ListUsers\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"cloud9:DescribeEnvironmentMemberships\"\n      ],\n      \"Resource\": [\n        \"*\"\n      ],\n      \"Condition\": {\n        \"Null\": {\n          \"cloud9:UserArn\": \"true\",\n          \"cloud9:EnvironmentId\": \"true\"\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ssm:StartSession\",\n        \"ssm:GetConnectionStatus\"\n      ],\n      \"Resource\": \"arn:aws:ec2:*:*:instance/*\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"ssm:resourceTag/aws:cloud9:environment\": \"*\"\n        },\n        \"StringEquals\": {\n          \"aws:CalledViaFirst\": \"cloud9.amazonaws.com\"\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ssm:StartSession\"\n      ],\n      \"Resource\": [\n        \"arn:aws:ssm:*:*:document/*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ssmmessages:OpenDataChannel\"\n      ],\n      \"Resource\": [\n        \"arn:aws:ssm:*:*:session/*\"\n      ]\n    }\n  ]\n}", "id": "aws_managed_0294", "complexity": "complex", "services": ["cloud9", "iam", "ssm", "ssmmessages"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for Sage Maker Studio Full Access\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"AmazonDataZoneStatement\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"datazone:*\"\n      ],\n      \"Resource\": [\n        \"*\"\n      ]\n    },\n    {\n      \"Sid\": \"ReadOnlyStatement\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"kms:DescribeKey\",\n        \"kms:ListAliases\",\n        \"iam:ListRoles\",\n        \"iam:ListPolicies\",\n        \"sso:DescribeRegisteredRegions\",\n        \"s3:ListAllMyBuckets\",\n        \"redshift:DescribeClusters\",\n        \"redshift-serverless:ListWorkgroups\",\n        \"ec2:DescribeSecurityGroups\",\n        \"ec2:DescribeSubnets\",\n        \"ec2:DescribeVpcs\",\n        \"secretsmanager:ListSecrets\",\n        \"iam:ListUsers\",\n        \"glue:GetDatabases\",\n        \"codeconnections:ListConnections\",\n        \"codeconnections:ListTagsForResource\",\n        \"codewhisperer:ListProfiles\",\n        \"bedrock:ListInferenceProfiles\",\n        \"bedrock:ListFoundationModels\",\n        \"bedrock:ListTagsForResource\",\n        \"aoss:ListSecurityPolicies\",\n        \"quicksight:DescribeAccountSubscription\",\n        \"cloudformation:ValidateTemplate\"\n      ],\n      \"Resource\": [\n        \"*\"\n      ]\n    },\n    {\n      \"Sid\": \"BucketReadOnlyStatement\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:ListBucket\",\n        \"s3:GetBucketLocation\",\n        \"s3:ListBucketVersions\"\n      ],\n      \"Resource\": \"arn:aws:s3:::*\"\n    },\n    {\n      \"Sid\": \"ReadManagedBlueprintTemplatesStatement\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"s3:GetObject\",\n      \"Resource\": [\n        \"arn:aws:s3:::default-env-blueprint-*/*\",\n        \"arn:aws:s3:*:*:accesspoint/env-blueprint-accesspoint*\"\n      ],\n      \"Condition\": {\n        \"ArnLike\": {\n          \"s3:DataAccessPointArn\": \"arn:aws:s3:*:*:accesspoint/env-blueprint-accesspoint\"\n        },\n        \"StringNotEquals\": {\n          \"aws:ResourceAccount\": \"${aws:PrincipalAccount}\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"CreateBucketStatement\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:CreateBucket\"\n      ],\n      \"Resource\": [\n        \"arn:aws:s3:::amazon-datazone*\",\n        \"arn:aws:s3:::amazon-sagemaker*\"\n      ]\n    },\n    {\n      \"Sid\": \"ConfigureBucketStatement\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:PutBucketCORS\",\n        \"s3:PutBucketPolicy\",\n        \"s3:PutBucketVersioning\"\n      ],\n      \"Resource\": [\n        \"arn:aws:s3:::amazon-sagemaker*\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:ResourceAccount\": \"${aws:PrincipalAccount}\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"PutObjectStatement\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:PutObject\",\n        \"s3:GetObject\"\n      ],\n      \"Resource\": [\n        \"arn:aws:s3:::amazon-sagemaker*/*\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:ResourceAccount\": \"${aws:PrincipalAccount}\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"RamCreateResourceStatement\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ram:CreateResourceShare\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringEqualsIfExists\": {\n          \"ram:RequestedResourceType\": \"datazone:Domain\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"RamResourceStatement\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ram:DeleteResourceShare\",\n        \"ram:AssociateResourceShare\",\n        \"ram:DisassociateResourceShare\",\n        \"ram:RejectResourceShareInvitation\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"ram:ResourceShareName\": [\n            \"DataZone*\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"RamResourceReadOnlyStatement\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ram:GetResourceShares\",\n        \"ram:GetResourceShareInvitations\",\n        \"ram:GetResourceShareAssociations\",\n        \"ram:ListResourceSharePermissions\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"RamAssociateResourceSharePermissionStatement\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"ram:AssociateResourceSharePermission\",\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"ram:PermissionArn\": [\n            \"arn:aws:ram::aws:permission/AWSRAMDefaultPermissionAmazonDataZoneDomain\",\n            \"arn:aws:ram::aws:permission/AWSRAMPermissionAmazonDataZoneDomainFullAccessWithPortalAccess\",\n            \"arn:aws:ram::aws:permission/AWSRAMPermissionsAmazonDatazoneDomainExtendedServiceAccess\",\n            \"arn:aws:ram::aws:permission/AWSRAMPermissionsAmazonDatazoneDomainExtendedServiceWithPortalAccess\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"IAMPassRoleStatement\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"iam:PassRole\",\n      \"Resource\": [\n        \"arn:aws:iam::*:role/AmazonDataZone*\",\n        \"arn:aws:iam::*:role/service-role/AmazonDataZone*\",\n        \"arn:aws:iam::*:role/service-role/AmazonSageMaker*\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"iam:passedToService\": \"datazone.amazonaws.com\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"IAMGetPolicyStatement\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"iam:GetPolicy\",\n      \"Resource\": [\n        \"arn:aws:iam::*:policy/service-role/AmazonDataZoneRedshiftAccessPolicy*\"\n      ]\n    },\n    {\n      \"Sid\": \"DataZoneTagOnCreateDomainProjectTags\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"secretsmanager:TagResource\"\n      ],\n      \"Resource\": \"arn:aws:secretsmanager:*:*:secret:AmazonDataZone-*\",\n      \"Condition\": {\n        \"ForAllValues:StringEquals\": {\n          \"aws:TagKeys\": [\n            \"AmazonDataZoneDomain\",\n            \"AmazonDataZoneProject\"\n          ]\n        },\n        \"StringLike\": {\n          \"aws:RequestTag/AmazonDataZoneDomain\": \"dzd*\",\n          \"aws:ResourceTag/AmazonDataZoneDomain\": \"dzd*\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"DataZoneTagOnCreate\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"secretsmanager:TagResource\"\n      ],\n      \"Resource\": \"arn:aws:secretsmanager:*:*:secret:AmazonDataZone-*\",\n      \"Condition\": {\n        \"ForAllValues:StringEquals\": {\n          \"aws:TagKeys\": [\n            \"AmazonDataZoneDomain\"\n          ]\n        },\n        \"StringLike\": {\n          \"aws:RequestTag/AmazonDataZoneDomain\": \"dzd*\",\n          \"aws:ResourceTag/AmazonDataZoneDomain\": \"dzd*\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"CreateSecretStatement\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"secretsmanager:CreateSecret\"\n      ],\n      \"Resource\": \"arn:aws:secretsmanager:*:*:secret:AmazonDataZone-*\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"aws:RequestTag/AmazonDataZoneDomain\": \"dzd*\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"ConnectionStatement\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"codeconnections:GetConnection\"\n      ],\n      \"Resource\": [\n        \"arn:aws:codeconnections:*:*:connection/*\"\n      ]\n    },\n    {\n      \"Sid\": \"TagCodeConnectionsStatement\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"codeconnections:TagResource\"\n      ],\n      \"Resource\": [\n        \"arn:aws:codeconnections:*:*:connection/*\",\n        \"arn:aws:codeconnections:*:*:host/*\"\n      ],\n      \"Condition\": {\n        \"ForAllValues:StringEquals\": {\n          \"aws:TagKeys\": [\n            \"for-use-with-all-datazone-projects\"\n          ]\n        },\n        \"StringEquals\": {\n          \"aws:RequestTag/for-use-with-all-datazone-projects\": \"true\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"UntagCodeConnectionsStatement\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"codeconnections:UntagResource\"\n      ],\n      \"Resource\": [\n        \"arn:aws:codeconnections:*:*:connection/*\",\n        \"arn:aws:codeconnections:*:*:host/*\"\n      ],\n      \"Condition\": {\n        \"ForAllValues:StringEquals\": {\n          \"aws:TagKeys\": \"for-use-with-all-datazone-projects\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"SSMParameterStatement\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ssm:GetParameter\",\n        \"ssm:GetParametersByPath\",\n        \"ssm:PutParameter\",\n        \"ssm:DeleteParameter\"\n      ],\n      \"Resource\": [\n        \"arn:aws:ssm:*:*:parameter/amazon/datazone/q*\",\n        \"arn:aws:ssm:*:*:parameter/amazon/datazone/genAI*\",\n        \"arn:aws:ssm:*:*:parameter/amazon/datazone/profiles*\"\n      ]\n    },\n    {\n      \"Sid\": \"UseKMSKeyPermissionsStatement\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"kms:Decrypt\"\n      ],\n      \"Resource\": [\n        \"*\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:ResourceTag/EnableKeyForAmazonDataZone\": \"true\"\n        },\n        \"Null\": {\n          \"aws:ResourceTag/EnableKeyForAmazonDataZone\": \"false\"\n        },\n        \"StringLike\": {\n          \"kms:ViaService\": \"ssm.*.amazonaws.com\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"SecurityPolicyStatement\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"aoss:GetSecurityPolicy\",\n        \"aoss:CreateSecurityPolicy\"\n      ],\n      \"Resource\": [\n        \"*\"\n      ],\n      \"Condition\": {\n        \"StringLike\": {\n          \"aoss:collection\": \"bedrock-ide-*\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"GetFoundationModelStatement\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"bedrock:GetFoundationModel\",\n        \"bedrock:GetFoundationModelAvailability\"\n      ],\n      \"Resource\": [\n        \"arn:aws:bedrock:*::foundation-model/*\"\n      ]\n    },\n    {\n      \"Sid\": \"GetInferenceProfileStatement\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"bedrock:GetInferenceProfile\"\n      ],\n      \"Resource\": [\n        \"arn:aws:bedrock:*:*:inference-profile/*\",\n        \"arn:aws:bedrock:*:*:application-inference-profile/*\"\n      ]\n    },\n    {\n      \"Sid\": \"ApplicationInferenceProfileStatement\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"bedrock:CreateInferenceProfile\"\n      ],\n      \"Resource\": [\n        \"arn:aws:bedrock:*:*:application-inference-profile/*\"\n      ],\n      \"Condition\": {\n        \"Null\": {\n          \"aws:RequestTag/AmazonDataZoneProject\": \"true\",\n          \"aws:RequestTag/AmazonDataZoneDomain\": \"false\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"TagApplicationInferenceProfileStatement\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"bedrock:TagResource\"\n      ],\n      \"Resource\": [\n        \"arn:aws:bedrock:*:*:application-inference-profile/*\"\n      ],\n      \"Condition\": {\n        \"Null\": {\n          \"aws:ResourceTag/AmazonDataZoneProject\": \"true\",\n          \"aws:RequestTag/AmazonDataZoneProject\": \"true\",\n          \"aws:ResourceTag/AmazonDataZoneDomain\": \"false\",\n          \"aws:RequestTag/AmazonDataZoneDomain\": \"false\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"DeleteApplicationInferenceProfileStatement\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"bedrock:DeleteInferenceProfile\"\n      ],\n      \"Resource\": [\n        \"arn:aws:bedrock:*:*:application-inference-profile/*\"\n      ],\n      \"Condition\": {\n        \"Null\": {\n          \"aws:ResourceTag/AmazonDataZoneProject\": \"true\",\n          \"aws:ResourceTag/AmazonDataZoneDomain\": \"false\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"ModelAccessUseCaseStatement\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"bedrock:GetUseCaseForModelAccess\",\n        \"bedrock:PutUseCaseForModelAccess\"\n      ],\n      \"Resource\": [\n        \"*\"\n      ]\n    }\n  ]\n}", "id": "aws_managed_1277", "complexity": "complex", "services": ["aoss", "bedrock", "cloudformation", "codeconnections", "codewhisperer", "datazone", "ec2", "glue", "iam", "kms", "quicksight", "ram", "redshift", "redshift-serverless", "s3", "secretsmanager", "ssm", "sso"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for AWS Audit Manager Administrator Access\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"AuditManagerAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"auditmanager:*\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"OrganizationsAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"organizations:ListAccountsForParent\",\n        \"organizations:ListAccounts\",\n        \"organizations:DescribeOrganization\",\n        \"organizations:DescribeOrganizationalUnit\",\n        \"organizations:DescribeAccount\",\n        \"organizations:ListParents\",\n        \"organizations:ListChildren\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"AllowOnlyAuditManagerIntegration\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"organizations:RegisterDelegatedAdministrator\",\n        \"organizations:DeregisterDelegatedAdministrator\",\n        \"organizations:EnableAWSServiceAccess\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringLikeIfExists\": {\n          \"organizations:ServicePrincipal\": [\n            \"auditmanager.amazonaws.com\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"IAMAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:GetUser\",\n        \"iam:ListUsers\",\n        \"iam:ListRoles\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"IAMAccessCreateSLR\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"iam:CreateServiceLinkedRole\",\n      \"Resource\": \"arn:aws:iam::*:role/aws-service-role/auditmanager.amazonaws.com/AWSServiceRoleForAuditManager*\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"iam:AWSServiceName\": \"auditmanager.amazonaws.com\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"IAMAccessManageSLR\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:DeleteServiceLinkedRole\",\n        \"iam:UpdateRoleDescription\",\n        \"iam:GetServiceLinkedRoleDeletionStatus\"\n      ],\n      \"Resource\": \"arn:aws:iam::*:role/aws-service-role/auditmanager.amazonaws.com/AWSServiceRoleForAuditManager*\"\n    },\n    {\n      \"Sid\": \"S3Access\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:ListAllMyBuckets\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"KmsAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"kms:DescribeKey\",\n        \"kms:ListKeys\",\n        \"kms:ListAliases\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"KmsCreateGrantAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"kms:CreateGrant\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"Bool\": {\n          \"kms:GrantIsForAWSResource\": \"true\"\n        },\n        \"StringLike\": {\n          \"kms:ViaService\": \"auditmanager.*.amazonaws.com\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"SNSAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"sns:ListTopics\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"CreateEventsAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"events:PutRule\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"events:detail-type\": \"Security Hub Findings - Imported\"\n        },\n        \"ForAllValues:StringEquals\": {\n          \"events:source\": [\n            \"aws.securityhub\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"EventsAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"events:DeleteRule\",\n        \"events:DescribeRule\",\n        \"events:EnableRule\",\n        \"events:DisableRule\",\n        \"events:ListTargetsByRule\",\n        \"events:PutTargets\",\n        \"events:RemoveTargets\"\n      ],\n      \"Resource\": \"arn:aws:events:*:*:rule/AuditManagerSecurityHubFindingsReceiver\"\n    },\n    {\n      \"Sid\": \"TagAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"tag:GetResources\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"ControlCatalogAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"controlcatalog:ListCommonControls\",\n        \"controlcatalog:ListDomains\",\n        \"controlcatalog:ListObjectives\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}", "id": "aws_managed_0733", "complexity": "complex", "services": ["auditmanager", "controlcatalog", "events", "iam", "kms", "organizations", "s3", "sns", "tag"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for AWS Code Build Admin Access\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"AWSServicesAccess\",\n      \"Action\": [\n        \"codebuild:*\",\n        \"codecommit:GetBranch\",\n        \"codecommit:GetCommit\",\n        \"codecommit:GetRepository\",\n        \"codecommit:ListBranches\",\n        \"codecommit:ListRepositories\",\n        \"cloudwatch:GetMetricStatistics\",\n        \"ec2:DescribeVpcs\",\n        \"ec2:DescribeSecurityGroups\",\n        \"ec2:DescribeSubnets\",\n        \"ecr:DescribeRepositories\",\n        \"ecr:ListImages\",\n        \"elasticfilesystem:DescribeFileSystems\",\n        \"events:DeleteRule\",\n        \"events:DescribeRule\",\n        \"events:DisableRule\",\n        \"events:EnableRule\",\n        \"events:ListTargetsByRule\",\n        \"events:ListRuleNamesByTarget\",\n        \"events:PutRule\",\n        \"events:PutTargets\",\n        \"events:RemoveTargets\",\n        \"logs:GetLogEvents\",\n        \"s3:GetBucketLocation\",\n        \"s3:ListAllMyBuckets\"\n      ],\n      \"Effect\": \"Allow\",\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"CWLDeleteLogGroupAccess\",\n      \"Action\": [\n        \"logs:DeleteLogGroup\"\n      ],\n      \"Effect\": \"Allow\",\n      \"Resource\": \"arn:aws:logs:*:*:log-group:/aws/codebuild/*:log-stream:*\"\n    },\n    {\n      \"Sid\": \"SSMParameterWriteAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ssm:PutParameter\"\n      ],\n      \"Resource\": \"arn:aws:ssm:*:*:parameter/CodeBuild/*\"\n    },\n    {\n      \"Sid\": \"SSMStartSessionAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ssm:StartSession\"\n      ],\n      \"Resource\": \"arn:aws:ecs:*:*:task/*/*\"\n    },\n    {\n      \"Sid\": \"SSMOpenDataChannelAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ssmmessages:OpenDataChannel\"\n      ],\n      \"Resource\": \"arn:aws:ssm:*:*:session/*\"\n    },\n    {\n      \"Sid\": \"CodeStarConnectionsReadWriteAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"codestar-connections:CreateConnection\",\n        \"codestar-connections:DeleteConnection\",\n        \"codestar-connections:UpdateConnectionInstallation\",\n        \"codestar-connections:TagResource\",\n        \"codestar-connections:UntagResource\",\n        \"codestar-connections:ListConnections\",\n        \"codestar-connections:ListInstallationTargets\",\n        \"codestar-connections:ListTagsForResource\",\n        \"codestar-connections:GetConnection\",\n        \"codestar-connections:GetIndividualAccessToken\",\n        \"codestar-connections:GetInstallationUrl\",\n        \"codestar-connections:PassConnection\",\n        \"codestar-connections:StartOAuthHandshake\",\n        \"codestar-connections:UseConnection\"\n      ],\n      \"Resource\": [\n        \"arn:aws:codestar-connections:*:*:connection/*\",\n        \"arn:aws:codeconnections:*:*:connection/*\"\n      ]\n    },\n    {\n      \"Sid\": \"CodeStarNotificationsReadWriteAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"codestar-notifications:CreateNotificationRule\",\n        \"codestar-notifications:DescribeNotificationRule\",\n        \"codestar-notifications:UpdateNotificationRule\",\n        \"codestar-notifications:DeleteNotificationRule\",\n        \"codestar-notifications:Subscribe\",\n        \"codestar-notifications:Unsubscribe\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"ArnLike\": {\n          \"codestar-notifications:NotificationsForResource\": \"arn:aws:codebuild:*:*:project/*\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"CodeStarNotificationsListAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"codestar-notifications:ListNotificationRules\",\n        \"codestar-notifications:ListEventTypes\",\n        \"codestar-notifications:ListTargets\",\n        \"codestar-notifications:ListTagsforResource\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"CodeStarNotificationsSNSTopicCreateAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"sns:CreateTopic\",\n        \"sns:SetTopicAttributes\"\n      ],\n      \"Resource\": \"arn:aws:sns:*:*:codestar-notifications*\"\n    },\n    {\n      \"Sid\": \"SNSTopicListAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"sns:ListTopics\",\n        \"sns:GetTopicAttributes\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"CodeStarNotificationsChatbotAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"chatbot:DescribeSlackChannelConfigurations\",\n        \"chatbot:ListMicrosoftTeamsChannelConfigurations\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}", "id": "aws_managed_0198", "complexity": "complex", "services": ["chatbot", "cloudwatch", "codebuild", "codecommit", "codestar-connections", "codestar-notifications", "ec2", "ecr", "elasticfilesystem", "events", "logs", "s3", "sns", "ssm", "ssmmessages"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for App Runner Service Role Policy\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Action\": [\n        \"logs:CreateLogGroup\",\n        \"logs:PutRetentionPolicy\"\n      ],\n      \"Effect\": \"Allow\",\n      \"Resource\": \"arn:aws:logs:*:*:log-group:/aws/apprunner/*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"logs:CreateLogStream\",\n        \"logs:PutLogEvents\",\n        \"logs:DescribeLogStreams\"\n      ],\n      \"Resource\": [\n        \"arn:aws:logs:*:*:log-group:/aws/apprunner/*:log-stream:*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"events:PutRule\",\n        \"events:PutTargets\",\n        \"events:DeleteRule\",\n        \"events:RemoveTargets\",\n        \"events:DescribeRule\",\n        \"events:EnableRule\",\n        \"events:DisableRule\"\n      ],\n      \"Resource\": \"arn:aws:events:*:*:rule/AWSAppRunnerManagedRule*\"\n    }\n  ]\n}", "id": "aws_managed_0798", "complexity": "medium", "services": ["events", "logs"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for Amazon Data Zone Redshift Manage Access Role Policy\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"redshiftDataScopeDownPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"redshift-data:BatchExecuteStatement\",\n        \"redshift-data:DescribeTable\",\n        \"redshift-data:ExecuteStatement\",\n        \"redshift-data:ListTables\",\n        \"redshift-data:ListSchemas\",\n        \"redshift-data:ListDatabases\"\n      ],\n      \"Resource\": [\n        \"arn:aws:redshift-serverless:*:*:workgroup/*\",\n        \"arn:aws:redshift:*:*:cluster:*\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:ResourceAccount\": \"${aws:PrincipalAccount}\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"listSecretsPermission\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"secretsmanager:ListSecrets\",\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"getWorkgroupPermission\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"redshift-serverless:GetWorkgroup\",\n      \"Resource\": [\n        \"arn:aws:redshift-serverless:*:*:workgroup/*\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:ResourceAccount\": \"${aws:PrincipalAccount}\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"createAndDeleteWorkgroupPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"redshift-serverless:CreateWorkgroup\",\n        \"redshift-serverless:DeleteWorkgroup\"\n      ],\n      \"Resource\": [\n        \"arn:aws:redshift-serverless:*:*:workgroup/*\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:ResourceAccount\": \"${aws:PrincipalAccount}\"\n        },\n        \"ForAnyValue:StringEquals\": {\n          \"aws:CalledVia\": [\n            \"glue.amazonaws.com\",\n            \"lakeformation.amazonaws.com\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"getNamespacePermission\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"redshift-serverless:GetNamespace\",\n      \"Resource\": [\n        \"arn:aws:redshift-serverless:*:*:namespace/*\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:ResourceAccount\": \"${aws:PrincipalAccount}\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"createAndDeleteNamespacePermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"redshift-serverless:CreateNamespace\",\n        \"redshift-serverless:DeleteNamespace\"\n      ],\n      \"Resource\": [\n        \"arn:aws:redshift-serverless:*:*:namespace/*\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:ResourceAccount\": \"${aws:PrincipalAccount}\"\n        },\n        \"ForAnyValue:StringEquals\": {\n          \"aws:CalledVia\": [\n            \"glue.amazonaws.com\",\n            \"lakeformation.amazonaws.com\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"redshiftDataPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"redshift-data:DescribeStatement\",\n        \"redshift-data:GetStatementResult\",\n        \"redshift:DescribeClusters\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"dataSharesPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"redshift:AuthorizeDataShare\",\n        \"redshift:DescribeDataShares\"\n      ],\n      \"Resource\": [\n        \"arn:aws:redshift:*:*:datashare:*/datazone*\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:ResourceAccount\": \"${aws:PrincipalAccount}\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"associateDataShareConsumerPermission\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"redshift:AssociateDataShareConsumer\",\n      \"Resource\": \"arn:aws:redshift:*:*:datashare:*/datazone*\"\n    }\n  ]\n}", "id": "aws_managed_1105", "complexity": "complex", "services": ["redshift", "redshift-data", "redshift-serverless", "secretsmanager"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for Amazon Memory DB Full Access\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"memorydb:*\",\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"iam:CreateServiceLinkedRole\",\n      \"Resource\": \"arn:aws:iam::*:role/aws-service-role/memorydb.amazonaws.com/AWSServiceRoleForMemoryDB\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"iam:AWSServiceName\": \"memorydb.amazonaws.com\"\n        }\n      }\n    }\n  ]\n}", "id": "aws_managed_0841", "complexity": "medium", "services": ["iam", "memorydb"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for F Sx Delete Service Linked Role Access\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:DeleteServiceLinkedRole\",\n        \"iam:GetServiceLinkedRoleDeletionStatus\",\n        \"iam:GetRole\"\n      ],\n      \"Resource\": \"arn:*:iam::*:role/aws-service-role/s3.data-source.lustre.fsx.amazonaws.com/AWSServiceRoleForFSxS3Access_*\"\n    }\n  ]\n}", "id": "aws_managed_0415", "complexity": "simple", "services": ["iam"], "source": "aws_managed"}
{"text": "### Instruction:\nAllow only t2.micro and t3.micro instance types to be launched. Deny launching any other instance type.\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"ec2:RunInstances\",\n      \"Resource\": \"arn:aws:ec2:*:*:instance/*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"ec2:InstanceType\": [\n            \"t2.micro\",\n            \"t3.micro\"\n          ]\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"ec2:RunInstances\",\n      \"Resource\": [\n        \"arn:aws:ec2:*:*:subnet/*\",\n        \"arn:aws:ec2:*:*:network-interface/*\",\n        \"arn:aws:ec2:*:*:volume/*\",\n        \"arn:aws:ec2:*:*:security-group/*\",\n        \"arn:aws:ec2:*::image/*\"\n      ]\n    }\n  ]\n}", "id": "syn_ec2_006", "complexity": "complex", "services": ["ec2"], "source": "synthetic"}
{"text": "### Instruction:\nProvide an IAM policy for AWS Fin Space Service Role Policy\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"AWSFinSpaceServiceRolePolicy\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"cloudwatch:PutMetricData\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"cloudwatch:namespace\": [\n            \"AWS/FinSpace\",\n            \"AWS/Usage\"\n          ]\n        }\n      },\n      \"Resource\": \"*\"\n    }\n  ]\n}", "id": "aws_managed_1064", "complexity": "simple", "services": ["cloudwatch"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for AWS Elastic Beanstalk Multicontainer Docker\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"ECSAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ecs:Poll\",\n        \"ecs:StartTask\",\n        \"ecs:StopTask\",\n        \"ecs:DiscoverPollEndpoint\",\n        \"ecs:StartTelemetrySession\",\n        \"ecs:RegisterContainerInstance\",\n        \"ecs:DeregisterContainerInstance\",\n        \"ecs:DescribeContainerInstances\",\n        \"ecs:Submit*\",\n        \"ecs:DescribeTasks\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"AllowECSTagResource\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ecs:TagResource\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"ecs:CreateAction\": [\n            \"RegisterContainerInstance\",\n            \"StartTask\"\n          ]\n        }\n      }\n    }\n  ]\n}", "id": "aws_managed_0160", "complexity": "medium", "services": ["ecs"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for AWS Elastic Beanstalk Worker Tier\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"MetricsAccess\",\n      \"Action\": [\n        \"cloudwatch:PutMetricData\"\n      ],\n      \"Effect\": \"Allow\",\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"XRayAccess\",\n      \"Action\": [\n        \"xray:PutTraceSegments\",\n        \"xray:PutTelemetryRecords\",\n        \"xray:GetSamplingRules\",\n        \"xray:GetSamplingTargets\",\n        \"xray:GetSamplingStatisticSummaries\"\n      ],\n      \"Effect\": \"Allow\",\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"QueueAccess\",\n      \"Action\": [\n        \"sqs:ChangeMessageVisibility\",\n        \"sqs:DeleteMessage\",\n        \"sqs:ReceiveMessage\",\n        \"sqs:SendMessage\"\n      ],\n      \"Effect\": \"Allow\",\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"BucketAccess\",\n      \"Action\": [\n        \"s3:Get*\",\n        \"s3:List*\",\n        \"s3:PutObject\"\n      ],\n      \"Effect\": \"Allow\",\n      \"Resource\": [\n        \"arn:aws:s3:::elasticbeanstalk-*\",\n        \"arn:aws:s3:::elasticbeanstalk-*/*\"\n      ]\n    },\n    {\n      \"Sid\": \"DynamoPeriodicTasks\",\n      \"Action\": [\n        \"dynamodb:BatchGetItem\",\n        \"dynamodb:BatchWriteItem\",\n        \"dynamodb:DeleteItem\",\n        \"dynamodb:GetItem\",\n        \"dynamodb:PutItem\",\n        \"dynamodb:Query\",\n        \"dynamodb:Scan\",\n        \"dynamodb:UpdateItem\"\n      ],\n      \"Effect\": \"Allow\",\n      \"Resource\": [\n        \"arn:aws:dynamodb:*:*:table/*-stack-AWSEBWorkerCronLeaderRegistry*\"\n      ]\n    },\n    {\n      \"Sid\": \"CloudWatchLogsAccess\",\n      \"Action\": [\n        \"logs:PutLogEvents\",\n        \"logs:CreateLogStream\"\n      ],\n      \"Effect\": \"Allow\",\n      \"Resource\": [\n        \"arn:aws:logs:*:*:log-group:/aws/elasticbeanstalk*\"\n      ]\n    },\n    {\n      \"Sid\": \"ElasticBeanstalkHealthAccess\",\n      \"Action\": [\n        \"elasticbeanstalk:PutInstanceStatistics\"\n      ],\n      \"Effect\": \"Allow\",\n      \"Resource\": [\n        \"arn:aws:elasticbeanstalk:*:*:application/*\",\n        \"arn:aws:elasticbeanstalk:*:*:environment/*\"\n      ]\n    }\n  ]\n}", "id": "aws_managed_0159", "complexity": "complex", "services": ["cloudwatch", "dynamodb", "elasticbeanstalk", "logs", "s3", "sqs", "xray"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for AWS Transfer Logging Access\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"logs:CreateLogStream\",\n        \"logs:DescribeLogStreams\",\n        \"logs:CreateLogGroup\",\n        \"logs:PutLogEvents\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}", "id": "aws_managed_0443", "complexity": "simple", "services": ["logs"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for Alexa For Business Full Access\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"a4b:*\",\n        \"kms:DescribeKey\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Action\": [\n        \"iam:CreateServiceLinkedRole\"\n      ],\n      \"Effect\": \"Allow\",\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"iam:AWSServiceName\": [\n            \"*a4b.amazonaws.com\"\n          ]\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:DeleteServiceLinkedRole\",\n        \"iam:GetServiceLinkedRoleDeletionStatus\"\n      ],\n      \"Resource\": \"arn:aws:iam::*:role/aws-service-role/*a4b.amazonaws.com/AWSServiceRoleForAlexaForBusiness*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"secretsmanager:GetSecretValue\",\n        \"secretsmanager:DeleteSecret\",\n        \"secretsmanager:UpdateSecret\"\n      ],\n      \"Resource\": \"arn:aws:secretsmanager:*:*:secret:A4B*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"secretsmanager:CreateSecret\",\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"secretsmanager:Name\": \"A4B*\"\n        }\n      }\n    }\n  ]\n}", "id": "aws_managed_0295", "complexity": "complex", "services": ["a4b", "iam", "kms", "secretsmanager"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for Amazon Mechanical Turk Full Access\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"mechanicalturk:*\"\n      ],\n      \"Resource\": [\n        \"*\"\n      ]\n    }\n  ]\n}", "id": "aws_managed_0146", "complexity": "simple", "services": ["mechanicalturk"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for Migration Hub SMS Access Service Role Policy\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"mgh:CreateProgressUpdateStream\",\n      \"Resource\": \"arn:aws:mgh:*:*:progressUpdateStream/SMS\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"mgh:DescribeMigrationTask\",\n        \"mgh:AssociateDiscoveredResource\",\n        \"mgh:ListDiscoveredResources\",\n        \"mgh:ImportMigrationTask\",\n        \"mgh:ListCreatedArtifacts\",\n        \"mgh:DisassociateDiscoveredResource\",\n        \"mgh:AssociateCreatedArtifact\",\n        \"mgh:NotifyMigrationTaskState\",\n        \"mgh:DisassociateCreatedArtifact\",\n        \"mgh:PutResourceAttributes\"\n      ],\n      \"Resource\": \"arn:aws:mgh:*:*:progressUpdateStream/SMS/migrationTask/*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"mgh:ListMigrationTasks\",\n        \"mgh:NotifyApplicationState\",\n        \"mgh:DescribeApplicationState\",\n        \"mgh:GetHomeRegion\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}", "id": "aws_managed_0475", "complexity": "medium", "services": ["mgh"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for Keyspaces CDC Service Role Policy\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"KeyspacesPutMetricDataPermission\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"cloudwatch:PutMetricData\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"cloudwatch:namespace\": \"AWS/Cassandra\"\n        }\n      }\n    }\n  ]\n}", "id": "aws_managed_1354", "complexity": "simple", "services": ["cloudwatch"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for AWS Network Manager Read Only Access\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"networkmanager:Describe*\",\n        \"networkmanager:Get*\",\n        \"networkmanager:List*\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}", "id": "aws_managed_0572", "complexity": "simple", "services": ["networkmanager"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for AWS Code Build Read Only Access\n\n### Response:\n{\n  \"Statement\": [\n    {\n      \"Sid\": \"AWSServicesAccess\",\n      \"Action\": [\n        \"codebuild:BatchGet*\",\n        \"codebuild:GetResourcePolicy\",\n        \"codebuild:List*\",\n        \"codebuild:DescribeTestCases\",\n        \"codebuild:DescribeCodeCoverages\",\n        \"codecommit:GetBranch\",\n        \"codecommit:GetCommit\",\n        \"codecommit:GetRepository\",\n        \"cloudwatch:GetMetricStatistics\",\n        \"events:DescribeRule\",\n        \"events:ListTargetsByRule\",\n        \"events:ListRuleNamesByTarget\",\n        \"logs:GetLogEvents\"\n      ],\n      \"Effect\": \"Allow\",\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"CodeStarConnectionsUserAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"codestar-connections:ListConnections\",\n        \"codestar-connections:GetConnection\"\n      ],\n      \"Resource\": [\n        \"arn:aws:codestar-connections:*:*:connection/*\",\n        \"arn:aws:codeconnections:*:*:connection/*\"\n      ]\n    },\n    {\n      \"Sid\": \"CodeStarNotificationsPowerUserAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"codestar-notifications:DescribeNotificationRule\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"ArnLike\": {\n          \"codestar-notifications:NotificationsForResource\": \"arn:aws:codebuild:*:*:project/*\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"CodeStarNotificationsListAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"codestar-notifications:ListNotificationRules\",\n        \"codestar-notifications:ListEventTypes\",\n        \"codestar-notifications:ListTargets\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ],\n  \"Version\": \"2012-10-17\"\n}", "id": "aws_managed_0197", "complexity": "complex", "services": ["cloudwatch", "codebuild", "codecommit", "codestar-connections", "codestar-notifications", "events", "logs"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for Amazon Kendra Read Only Access\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"kendra:Describe*\",\n        \"kendra:List*\",\n        \"kendra:Query\",\n        \"kendra:GetQuerySuggestions\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}", "id": "aws_managed_0567", "complexity": "simple", "services": ["kendra"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for Amazon ECS Infrastructure Role Policy For Vpc Lattice\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"ManagedVpcLatticeTargetRegistration\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"vpc-lattice:RegisterTargets\",\n        \"vpc-lattice:DeregisterTargets\"\n      ],\n      \"Resource\": [\n        \"arn:aws:vpc-lattice:*:*:targetgroup/*\"\n      ]\n    },\n    {\n      \"Sid\": \"DescribeVpcLatticeTargetGroup\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"vpc-lattice:GetTargetGroup\",\n      \"Resource\": [\n        \"arn:aws:vpc-lattice:*:*:targetgroup/*\"\n      ]\n    },\n    {\n      \"Sid\": \"ListVpcLatticeTargets\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"vpc-lattice:ListTargets\",\n      \"Resource\": [\n        \"arn:aws:vpc-lattice:*:*:targetgroup/*\"\n      ]\n    },\n    {\n      \"Sid\": \"DescribeEc2Resources\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:DescribeSubnets\",\n        \"ec2:DescribeVpcs\",\n        \"ec2:DescribeInstances\"\n      ],\n      \"Resource\": [\n        \"*\"\n      ]\n    }\n  ]\n}", "id": "aws_managed_1250", "complexity": "complex", "services": ["ec2", "vpc-lattice"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for AWS Well Architected Organizations Service Role Policy\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"organizations:ListAWSServiceAccessForOrganization\",\n        \"organizations:DescribeAccount\",\n        \"organizations:DescribeOrganization\",\n        \"organizations:ListAccounts\",\n        \"organizations:ListAccountsForParent\",\n        \"organizations:ListChildren\",\n        \"organizations:ListParents\",\n        \"organizations:ListRoots\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}", "id": "aws_managed_0931", "complexity": "simple", "services": ["organizations"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for Service Quotas Read Only Access\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"autoscaling:DescribeAccountLimits\",\n        \"cloudformation:DescribeAccountLimits\",\n        \"cloudwatch:DescribeAlarmsForMetric\",\n        \"cloudwatch:DescribeAlarms\",\n        \"cloudwatch:GetMetricData\",\n        \"cloudwatch:GetMetricStatistics\",\n        \"dynamodb:DescribeLimits\",\n        \"elasticloadbalancing:DescribeAccountLimits\",\n        \"iam:GetAccountSummary\",\n        \"kinesis:DescribeLimits\",\n        \"organizations:DescribeAccount\",\n        \"organizations:DescribeOrganization\",\n        \"organizations:ListAWSServiceAccessForOrganization\",\n        \"rds:DescribeAccountAttributes\",\n        \"route53:GetAccountLimit\",\n        \"tag:GetTagKeys\",\n        \"tag:GetTagValues\",\n        \"servicequotas:GetAssociationForServiceQuotaTemplate\",\n        \"servicequotas:GetAWSDefaultServiceQuota\",\n        \"servicequotas:GetRequestedServiceQuotaChange\",\n        \"servicequotas:GetServiceQuota\",\n        \"servicequotas:GetServiceQuotaIncreaseRequestFromTemplate\",\n        \"servicequotas:ListAWSDefaultServiceQuotas\",\n        \"servicequotas:ListRequestedServiceQuotaChangeHistory\",\n        \"servicequotas:ListRequestedServiceQuotaChangeHistoryByQuota\",\n        \"servicequotas:ListServices\",\n        \"servicequotas:ListServiceQuotas\",\n        \"servicequotas:ListServiceQuotaIncreaseRequestsInTemplate\",\n        \"servicequotas:ListTagsForResource\",\n        \"servicequotas:GetAutoManagementConfiguration\",\n        \"notifications:ListChannels\",\n        \"notifications:ListEventRules\",\n        \"notifications:ListNotificationConfigurations\",\n        \"notifications:GetNotificationConfiguration\",\n        \"notifications:GetEventRule\",\n        \"notifications:ListNotificationHubs\",\n        \"notifications-contacts:ListEmailContacts\",\n        \"notifications-contacts:GetEmailContact\",\n        \"chatbot:ListMicrosoftTeamsChannelConfigurations\",\n        \"chatbot:DescribeChimeWebhookConfigurations\",\n        \"chatbot:DescribeSlackChannelConfigurations\",\n        \"consoleapp:ListDeviceIdentities\",\n        \"consoleapp:GetDeviceIdentity\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}", "id": "aws_managed_0483", "complexity": "complex", "services": ["autoscaling", "chatbot", "cloudformation", "cloudwatch", "consoleapp", "dynamodb", "elasticloadbalancing", "iam", "kinesis", "notifications", "notifications-contacts", "organizations", "rds", "route53", "servicequotas", "tag"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for Data Scientist\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Action\": [\n        \"autoscaling:*\",\n        \"cloudwatch:*\",\n        \"cloudformation:CreateStack\",\n        \"cloudformation:DescribeStackEvents\",\n        \"datapipeline:Describe*\",\n        \"datapipeline:ListPipelines\",\n        \"datapipeline:GetPipelineDefinition\",\n        \"datapipeline:QueryObjects\",\n        \"dynamodb:*\",\n        \"ec2:CancelSpotInstanceRequests\",\n        \"ec2:CancelSpotFleetRequests\",\n        \"ec2:CreateTags\",\n        \"ec2:DeleteTags\",\n        \"ec2:Describe*\",\n        \"ec2:ModifyImageAttribute\",\n        \"ec2:ModifyInstanceAttribute\",\n        \"ec2:ModifySpotFleetRequest\",\n        \"ec2:RequestSpotInstances\",\n        \"ec2:RequestSpotFleet\",\n        \"elasticfilesystem:*\",\n        \"elasticmapreduce:*\",\n        \"es:*\",\n        \"firehose:*\",\n        \"fsx:DescribeFileSystems\",\n        \"iam:GetInstanceProfile\",\n        \"iam:GetRole\",\n        \"iam:GetPolicy\",\n        \"iam:GetPolicyVersion\",\n        \"iam:ListRoles\",\n        \"kinesis:*\",\n        \"kms:List*\",\n        \"lambda:Create*\",\n        \"lambda:Delete*\",\n        \"lambda:Get*\",\n        \"lambda:InvokeFunction\",\n        \"lambda:PublishVersion\",\n        \"lambda:Update*\",\n        \"lambda:List*\",\n        \"machinelearning:*\",\n        \"sdb:*\",\n        \"rds:*\",\n        \"sns:ListSubscriptions\",\n        \"sns:ListTopics\",\n        \"logs:DescribeLogStreams\",\n        \"logs:GetLogEvents\",\n        \"redshift:*\",\n        \"s3:CreateBucket\",\n        \"sns:CreateTopic\",\n        \"sns:Get*\",\n        \"sns:List*\"\n      ],\n      \"Effect\": \"Allow\",\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:Abort*\",\n        \"s3:DeleteObject\",\n        \"s3:Get*\",\n        \"s3:List*\",\n        \"s3:PutAccelerateConfiguration\",\n        \"s3:PutBucketCors\",\n        \"s3:PutBucketLogging\",\n        \"s3:PutBucketNotification\",\n        \"s3:PutBucketTagging\",\n        \"s3:PutObject\",\n        \"s3:Replicate*\",\n        \"s3:RestoreObject\"\n      ],\n      \"Resource\": [\n        \"*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:RunInstances\",\n        \"ec2:TerminateInstances\"\n      ],\n      \"Resource\": [\n        \"*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:PassRole\"\n      ],\n      \"Resource\": [\n        \"arn:aws:iam::*:role/DataPipelineDefaultRole\",\n        \"arn:aws:iam::*:role/DataPipelineDefaultResourceRole\",\n        \"arn:aws:iam::*:role/EMR_EC2_DefaultRole\",\n        \"arn:aws:iam::*:role/EMR_DefaultRole\",\n        \"arn:aws:iam::*:role/kinesis-*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:PassRole\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"iam:PassedToService\": \"sagemaker.amazonaws.com\"\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"sagemaker:*\"\n      ],\n      \"NotResource\": [\n        \"arn:aws:sagemaker:*:*:domain/*\",\n        \"arn:aws:sagemaker:*:*:user-profile/*\",\n        \"arn:aws:sagemaker:*:*:app/*\",\n        \"arn:aws:sagemaker:*:*:flow-definition/*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"sagemaker:CreatePresignedDomainUrl\",\n        \"sagemaker:DescribeDomain\",\n        \"sagemaker:ListDomains\",\n        \"sagemaker:DescribeUserProfile\",\n        \"sagemaker:ListUserProfiles\",\n        \"sagemaker:*App\",\n        \"sagemaker:ListApps\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"sagemaker:*FlowDefinition\",\n        \"sagemaker:*FlowDefinitions\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringEqualsIfExists\": {\n          \"sagemaker:WorkteamType\": [\n            \"private-crowd\",\n            \"vendor-crowd\"\n          ]\n        }\n      }\n    }\n  ]\n}", "id": "aws_managed_0181", "complexity": "complex", "services": ["autoscaling", "cloudformation", "cloudwatch", "datapipeline", "dynamodb", "ec2", "elasticfilesystem", "elasticmapreduce", "es", "firehose", "fsx", "iam", "kinesis", "kms", "lambda", "logs", "machinelearning", "rds", "redshift", "s3", "sagemaker", "sdb", "sns"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for Amazon Sage Maker Canvas EMR Serverless Execution Role Policy\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"S3Operations\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:GetObject\",\n        \"s3:PutObject\",\n        \"s3:DeleteObject\",\n        \"s3:GetBucketCors\",\n        \"s3:GetBucketLocation\",\n        \"s3:AbortMultipartUpload\"\n      ],\n      \"Resource\": [\n        \"arn:aws:s3:::*SageMaker*\",\n        \"arn:aws:s3:::*sagemaker*\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:ResourceAccount\": \"${aws:PrincipalAccount}\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"S3GetObjectOperation\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"s3:GetObject\",\n      \"Resource\": \"arn:aws:s3:::*\",\n      \"Condition\": {\n        \"StringEqualsIgnoreCase\": {\n          \"s3:ExistingObjectTag/SageMaker\": \"true\"\n        },\n        \"StringEquals\": {\n          \"aws:ResourceAccount\": \"${aws:PrincipalAccount}\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"S3ListOperations\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:ListBucket\",\n        \"s3:ListAllMyBuckets\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:ResourceAccount\": \"${aws:PrincipalAccount}\"\n        }\n      }\n    }\n  ]\n}", "id": "aws_managed_1208", "complexity": "medium", "services": ["s3"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for Git Lab Duo With Amazon Q Permissions Policy\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"GitLabDuoUsagePermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"q:SendEvent\",\n        \"q:CreateAuthGrant\",\n        \"q:UpdateAuthGrant\",\n        \"q:GenerateCodeRecommendations\",\n        \"q:SendMessage\",\n        \"q:ListPlugins\",\n        \"q:VerifyOAuthAppConnection\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"GitLabDuoManagementPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"q:CreateOAuthAppConnection\",\n        \"q:DeleteOAuthAppConnection\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"GitLabDuoPluginPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"q:CreatePlugin\",\n        \"q:DeletePlugin\",\n        \"q:GetPlugin\"\n      ],\n      \"Resource\": \"arn:aws:qdeveloper:*:*:plugin/GitLabDuoWithAmazonQ/*\"\n    }\n  ]\n}", "id": "aws_managed_1325", "complexity": "medium", "services": ["q"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for Amazon ES Read Only Access\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Action\": [\n        \"es:Describe*\",\n        \"es:List*\",\n        \"es:Get*\"\n      ],\n      \"Effect\": \"Allow\",\n      \"Resource\": \"*\"\n    }\n  ]\n}", "id": "aws_managed_0127", "complexity": "simple", "services": ["es"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for AWS Billing Conductor Full Access\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"billingconductor:*\",\n        \"organizations:ListAccounts\",\n        \"pricing:DescribeServices\",\n        \"pricing:GetAttributeValues\",\n        \"pricing:GetProducts\",\n        \"organizations:ListRoots\",\n        \"organizations:ListOrganizationalUnitsForParent\",\n        \"organizations:ListChildren\",\n        \"organizations:DescribeAccount\",\n        \"organizations:DescribeResponsibilityTransfer\",\n        \"organizations:ListInboundResponsibilityTransfers\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}", "id": "aws_managed_0911", "complexity": "medium", "services": ["billingconductor", "organizations", "pricing"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for AWS App Sync Service Role Policy\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"xray:PutTraceSegments\",\n        \"xray:PutTelemetryRecords\",\n        \"xray:GetSamplingTargets\",\n        \"xray:GetSamplingRules\",\n        \"xray:GetSamplingStatisticSummaries\"\n      ],\n      \"Resource\": [\n        \"*\"\n      ]\n    }\n  ]\n}", "id": "aws_managed_0590", "complexity": "simple", "services": ["xray"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for Amazon Code Catalyst Support Access\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"support:DescribeAttachment\",\n        \"support:DescribeCaseAttributes\",\n        \"support:DescribeCases\",\n        \"support:DescribeCommunications\",\n        \"support:DescribeIssueTypes\",\n        \"support:DescribeServices\",\n        \"support:DescribeSeverityLevels\",\n        \"support:DescribeSupportLevel\",\n        \"support:SearchForCases\",\n        \"support:AddAttachmentsToSet\",\n        \"support:AddCommunicationToCase\",\n        \"support:CreateCase\",\n        \"support:InitiateCallForCase\",\n        \"support:InitiateChatForCase\",\n        \"support:PutCaseAttributes\",\n        \"support:RateCaseCommunication\",\n        \"support:ResolveCase\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}", "id": "aws_managed_1046", "complexity": "simple", "services": ["support"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for AWS Security Hub Read Only Access\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"AWSSecurityHubReadOnlyAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"securityhub:Get*\",\n        \"securityhub:List*\",\n        \"securityhub:BatchGet*\",\n        \"securityhub:Describe*\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}", "id": "aws_managed_0413", "complexity": "simple", "services": ["securityhub"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for IAM Access Analyzer Full Access\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"access-analyzer:*\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"iam:CreateServiceLinkedRole\",\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"iam:AWSServiceName\": \"access-analyzer.amazonaws.com\"\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"organizations:DescribeAccount\",\n        \"organizations:DescribeOrganization\",\n        \"organizations:DescribeOrganizationalUnit\",\n        \"organizations:ListAccounts\",\n        \"organizations:ListAccountsForParent\",\n        \"organizations:ListAWSServiceAccessForOrganization\",\n        \"organizations:ListChildren\",\n        \"organizations:ListDelegatedAdministrators\",\n        \"organizations:ListOrganizationalUnitsForParent\",\n        \"organizations:ListParents\",\n        \"organizations:ListRoots\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}", "id": "aws_managed_0555", "complexity": "medium", "services": ["access-analyzer", "iam", "organizations"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for AWS Lambda Basic Execution Role\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"logs:CreateLogGroup\",\n        \"logs:CreateLogStream\",\n        \"logs:PutLogEvents\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}", "id": "aws_managed_0094", "complexity": "simple", "services": ["logs"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for App Runner Networking Service Role Policy\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:DescribeNetworkInterfaces\",\n        \"ec2:DescribeVpcs\",\n        \"ec2:DescribeDhcpOptions\",\n        \"ec2:DescribeSubnets\",\n        \"ec2:DescribeSecurityGroups\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"ec2:CreateNetworkInterface\",\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"ForAllValues:StringEquals\": {\n          \"aws:TagKeys\": [\n            \"AWSAppRunnerManaged\"\n          ]\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"ec2:CreateTags\",\n      \"Resource\": \"arn:aws:ec2:*:*:network-interface/*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"ec2:CreateAction\": \"CreateNetworkInterface\"\n        },\n        \"StringLike\": {\n          \"aws:RequestTag/AWSAppRunnerManaged\": \"*\"\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"ec2:DeleteNetworkInterface\",\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"Null\": {\n          \"ec2:ResourceTag/AWSAppRunnerManaged\": \"false\"\n        }\n      }\n    }\n  ]\n}", "id": "aws_managed_0892", "complexity": "complex", "services": ["ec2"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for AWS Data Pipeline Power User\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Action\": [\n        \"s3:List*\",\n        \"dynamodb:DescribeTable\",\n        \"rds:DescribeDBInstances\",\n        \"rds:DescribeDBSecurityGroups\",\n        \"redshift:DescribeClusters\",\n        \"redshift:DescribeClusterSecurityGroups\",\n        \"sns:ListTopics\",\n        \"iam:ListRoles\",\n        \"iam:GetRolePolicy\",\n        \"iam:GetInstanceProfile\",\n        \"iam:ListInstanceProfiles\",\n        \"datapipeline:*\"\n      ],\n      \"Effect\": \"Allow\",\n      \"Resource\": [\n        \"*\"\n      ]\n    },\n    {\n      \"Action\": \"iam:PassRole\",\n      \"Effect\": \"Allow\",\n      \"Resource\": [\n        \"arn:aws:iam::*:role/DataPipelineDefaultResourceRole\",\n        \"arn:aws:iam::*:role/DataPipelineDefaultRole\"\n      ]\n    }\n  ]\n}", "id": "aws_managed_0214", "complexity": "complex", "services": ["datapipeline", "dynamodb", "iam", "rds", "redshift", "s3", "sns"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for AWS Vendor Insights Vendor Read Only\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"aws-marketplace:DescribeEntity\",\n      \"Resource\": \"arn:aws:aws-marketplace:*:*:*/SaaSProduct/*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"aws-marketplace:ListEntities\",\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"vendor-insights:GetDataSource\",\n        \"vendor-insights:ListDataSources\",\n        \"vendor-insights:ListSecurityProfiles\",\n        \"vendor-insights:GetSecurityProfile\",\n        \"vendor-insights:GetSecurityProfileSnapshot\",\n        \"vendor-insights:ListSecurityProfileSnapshots\",\n        \"vendor-insights:ListTagsForResource\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"artifact:GetReport\",\n        \"artifact:GetReportMetadata\",\n        \"artifact:GetTermForReport\",\n        \"artifact:ListReports\"\n      ],\n      \"Resource\": \"arn:aws:artifact:*::report/*\"\n    }\n  ]\n}", "id": "aws_managed_0936", "complexity": "complex", "services": ["artifact", "aws-marketplace", "vendor-insights"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for AWS Lambda Full Access\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"cloudformation:DescribeStacks\",\n        \"cloudformation:ListStackResources\",\n        \"cloudwatch:ListMetrics\",\n        \"cloudwatch:GetMetricData\",\n        \"ec2:DescribeSecurityGroups\",\n        \"ec2:DescribeSubnets\",\n        \"ec2:DescribeVpcs\",\n        \"kms:DescribeKey\",\n        \"kms:ListAliases\",\n        \"iam:GetPolicy\",\n        \"iam:GetPolicyVersion\",\n        \"iam:GetRole\",\n        \"iam:GetRolePolicy\",\n        \"iam:ListAttachedRolePolicies\",\n        \"iam:ListRolePolicies\",\n        \"iam:ListRoles\",\n        \"lambda:*\",\n        \"logs:DescribeLogGroups\",\n        \"states:DescribeStateMachine\",\n        \"states:ListStateMachines\",\n        \"tag:GetResources\",\n        \"xray:GetTraceSummaries\",\n        \"xray:BatchGetTraces\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"iam:PassRole\",\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"iam:PassedToService\": \"lambda.amazonaws.com\"\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"logs:DescribeLogStreams\",\n        \"logs:GetLogEvents\",\n        \"logs:FilterLogEvents\",\n        \"logs:StartLiveTail\",\n        \"logs:StopLiveTail\"\n      ],\n      \"Resource\": \"arn:aws:logs:*:*:log-group:/aws/lambda/*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"iam:CreateServiceLinkedRole\",\n      \"Resource\": \"arn:aws:iam::*:role/aws-service-role/lambda.amazonaws.com/AWSServiceRoleForLambda\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"iam:AWSServiceName\": \"lambda.amazonaws.com\"\n        }\n      }\n    }\n  ]\n}", "id": "aws_managed_0698", "complexity": "complex", "services": ["cloudformation", "cloudwatch", "ec2", "iam", "kms", "lambda", "logs", "states", "tag", "xray"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for Amazon EKS Service Role Policy\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:CreateNetworkInterface\",\n        \"ec2:DeleteNetworkInterface\",\n        \"ec2:DetachNetworkInterface\",\n        \"ec2:ModifyNetworkInterfaceAttribute\",\n        \"ec2:CreateSecurityGroup\",\n        \"ec2:CreateNetworkInterfacePermission\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:DescribeAccountAttributes\",\n        \"ec2:DescribeAddresses\",\n        \"ec2:DescribeAvailabilityZones\",\n        \"ec2:DescribeCapacityReservations\",\n        \"ec2:DescribeCoipPools\",\n        \"ec2:DescribeInstances\",\n        \"ec2:DescribeInstanceTypeOfferings\",\n        \"ec2:DescribeInstanceTypes\",\n        \"ec2:DescribeInternetGateways\",\n        \"ec2:DescribeLaunchTemplates\",\n        \"ec2:DescribeNetworkInterfaces\",\n        \"ec2:DescribeSecurityGroups\",\n        \"ec2:DescribeSnapshots\",\n        \"ec2:DescribeSpotPriceHistory\",\n        \"ec2:DescribeSubnets\",\n        \"ec2:DescribeTags\",\n        \"ec2:DescribeVolumes\",\n        \"ec2:DescribeVolumesModifications\",\n        \"ec2:DescribeVpcPeeringConnections\",\n        \"ec2:DescribeVpcs\",\n        \"ec2:DescribeRouteTables\",\n        \"ec2:DescribeNetworkAcls\",\n        \"ec2:GetCoipPoolUsage\",\n        \"ec2:GetSecurityGroupsForVpc\",\n        \"eks:DescribeCluster\",\n        \"elasticloadbalancing:DescribeListenerAttributes\",\n        \"elasticloadbalancing:DescribeListenerCertificates\",\n        \"elasticloadbalancing:DescribeListeners\",\n        \"elasticloadbalancing:DescribeLoadBalancerAttributes\",\n        \"elasticloadbalancing:DescribeLoadBalancers\",\n        \"elasticloadbalancing:DescribeRules\",\n        \"elasticloadbalancing:DescribeSSLPolicies\",\n        \"elasticloadbalancing:DescribeTags\",\n        \"elasticloadbalancing:DescribeTargetGroupAttributes\",\n        \"elasticloadbalancing:DescribeTargetGroups\",\n        \"elasticloadbalancing:DescribeTargetHealth\",\n        \"elasticloadbalancing:DescribeTrustStores\",\n        \"iam:ListAttachedRolePolicies\",\n        \"pricing:GetProducts\",\n        \"shield:GetSubscriptionState\",\n        \"tag:GetResources\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:DeleteSecurityGroup\",\n        \"ec2:RevokeSecurityGroupIngress\",\n        \"ec2:AuthorizeSecurityGroupIngress\",\n        \"ec2:RevokeSecurityGroupEgress\",\n        \"ec2:AuthorizeSecurityGroupEgress\"\n      ],\n      \"Resource\": \"arn:aws:ec2:*:*:security-group/*\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"ec2:ResourceTag/Name\": \"eks-cluster-sg*\"\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:CreateTags\",\n        \"ec2:DeleteTags\"\n      ],\n      \"Resource\": [\n        \"arn:aws:ec2:*:*:vpc/*\",\n        \"arn:aws:ec2:*:*:subnet/*\",\n        \"arn:aws:ec2:*:*:network-interface/*\",\n        \"arn:aws:ec2:*:*:security-group/*\"\n      ],\n      \"Condition\": {\n        \"ForAnyValue:StringLike\": {\n          \"aws:TagKeys\": [\n            \"kubernetes.io/cluster/*\"\n          ]\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:CreateTags\",\n        \"ec2:DeleteTags\"\n      ],\n      \"Resource\": [\n        \"arn:aws:ec2:*:*:security-group/*\",\n        \"arn:aws:ec2:*:*:network-interface/*\"\n      ],\n      \"Condition\": {\n        \"StringLike\": {\n          \"aws:RequestTag/Name\": \"eks-cluster-*\"\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"route53:AssociateVPCWithHostedZone\",\n      \"Resource\": \"arn:aws:route53:::hostedzone/*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"logs:CreateLogGroup\",\n      \"Resource\": \"arn:aws:logs:*:*:log-group:/aws/eks/*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"logs:CreateLogStream\",\n        \"logs:DescribeLogStreams\"\n      ],\n      \"Resource\": \"arn:aws:logs:*:*:log-group:/aws/eks/*:*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"logs:PutLogEvents\",\n      \"Resource\": \"arn:aws:logs:*:*:log-group:/aws/eks/*:*:*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"cloudwatch:PutMetricData\",\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"cloudwatch:namespace\": \"AWS/EKS\"\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"eks:CreateAccessEntry\",\n        \"eks:DeleteAccessEntry\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"eks:accessEntryType\": \"STANDARD\"\n        },\n        \"ArnLike\": {\n          \"eks:principalArn\": \"arn:aws:iam::*:role/aws-service-role/eks.amazonaws.com/AWSServiceRoleForAmazonEKS\"\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"eks:ListAssociatedAccessPolicies\"\n      ],\n      \"Resource\": \"arn:aws:eks:*:*:access-entry/*/role/${aws:PrincipalAccount}/AWSServiceRoleForAmazonEKS/*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"eks:AssociateAccessPolicy\",\n        \"eks:DisassociateAccessPolicy\"\n      ],\n      \"Resource\": \"arn:aws:eks:*:*:access-entry/*/role/${aws:PrincipalAccount}/AWSServiceRoleForAmazonEKS/*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"eks:policyArn\": [\n            \"arn:aws:eks::aws:cluster-access-policy/AmazonEKSComputePolicy\",\n            \"arn:aws:eks::aws:cluster-access-policy/AmazonEKSComputeClusterPolicy\",\n            \"arn:aws:eks::aws:cluster-access-policy/AmazonEKSNetworkingPolicy\",\n            \"arn:aws:eks::aws:cluster-access-policy/AmazonEKSNetworkingClusterPolicy\",\n            \"arn:aws:eks::aws:cluster-access-policy/AmazonEKSLoadBalancingPolicy\",\n            \"arn:aws:eks::aws:cluster-access-policy/AmazonEKSLoadBalancingClusterPolicy\",\n            \"arn:aws:eks::aws:cluster-access-policy/AmazonEKSBlockStoragePolicy\",\n            \"arn:aws:eks::aws:cluster-access-policy/AmazonEKSBlockStorageClusterPolicy\",\n            \"arn:aws:eks::aws:cluster-access-policy/AmazonEKSHybridPolicy\",\n            \"arn:aws:eks::aws:cluster-access-policy/AmazonEKSEventPolicy\"\n          ]\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:DeleteNetworkInterface\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"aws:ResourceTag/eks:eks-cluster-name\": \"*\"\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"eks:DescribeAccessEntry\",\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"eks:accessEntryType\": \"EC2\"\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"events:PutRule\",\n      \"Resource\": \"arn:aws:events:*:*:rule/EKS*\",\n      \"Condition\": {\n        \"ForAllValues:StringEquals\": {\n          \"events:source\": [\n            \"aws.ec2\",\n            \"aws.health\"\n          ]\n        },\n        \"StringEquals\": {\n          \"events:ManagedBy\": [\n            \"eks.amazonaws.com\"\n          ]\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"events:PutTargets\",\n      \"Resource\": \"arn:aws:events:*:*:rule/EKS*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:CreateInstanceProfile\",\n        \"iam:DeleteInstanceProfile\",\n        \"iam:RemoveRoleFromInstanceProfile\"\n      ],\n      \"Resource\": \"arn:aws:iam::*:instance-profile/eks*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"iam:GetInstanceProfile\",\n      \"Resource\": \"arn:aws:iam::*:instance-profile/*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:DeleteLaunchTemplate\",\n        \"ec2:TerminateInstances\"\n      ],\n      \"Resource\": [\n        \"arn:aws:ec2:*:*:launch-template/*\",\n        \"arn:aws:ec2:*:*:instance/*\"\n      ],\n      \"Condition\": {\n        \"StringLike\": {\n          \"aws:ResourceTag/eks:eks-cluster-name\": \"*\"\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:DeleteLaunchTemplate\",\n        \"ec2:TerminateInstances\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"ec2:ManagedResourceOperator\": [\n            \"eks.amazonaws.com\"\n          ]\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:DeleteVolume\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"aws:ResourceTag/eks:eks-cluster-name\": \"*\"\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:DeleteSnapshot\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"aws:ResourceTag/eks:eks-cluster-name\": \"*\"\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"elasticloadbalancing:DeleteListener\",\n        \"elasticloadbalancing:DeleteRule\",\n        \"elasticloadbalancing:DeregisterTargets\",\n        \"elasticloadbalancing:DeleteLoadBalancer\",\n        \"elasticloadbalancing:DeleteTargetGroup\",\n        \"ec2:DeleteSecurityGroup\",\n        \"shield:DescribeProtection\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"aws:ResourceTag/eks:eks-cluster-name\": \"*\"\n        }\n      }\n    }\n  ]\n}", "id": "aws_managed_0594", "complexity": "complex", "services": ["cloudwatch", "ec2", "eks", "elasticloadbalancing", "events", "iam", "logs", "pricing", "route53", "shield", "tag"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for Amazon Dev Ops Guru Read Only Access\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"DevOpsGuruReadOnlyAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"devops-guru:DescribeAccountHealth\",\n        \"devops-guru:DescribeAccountOverview\",\n        \"devops-guru:DescribeAnomaly\",\n        \"devops-guru:DescribeEventSourcesConfig\",\n        \"devops-guru:DescribeFeedback\",\n        \"devops-guru:DescribeInsight\",\n        \"devops-guru:DescribeResourceCollectionHealth\",\n        \"devops-guru:DescribeServiceIntegration\",\n        \"devops-guru:GetCostEstimation\",\n        \"devops-guru:GetResourceCollection\",\n        \"devops-guru:ListAnomaliesForInsight\",\n        \"devops-guru:ListEvents\",\n        \"devops-guru:ListInsights\",\n        \"devops-guru:ListAnomalousLogGroups\",\n        \"devops-guru:ListMonitoredResources\",\n        \"devops-guru:ListNotificationChannels\",\n        \"devops-guru:ListRecommendations\",\n        \"devops-guru:SearchInsights\",\n        \"devops-guru:StartCostEstimation\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"CloudFormationListStacksAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"cloudformation:DescribeStacks\",\n        \"cloudformation:ListStacks\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:GetRole\"\n      ],\n      \"Resource\": \"arn:aws:iam::*:role/aws-service-role/devops-guru.amazonaws.com/AWSServiceRoleForDevOpsGuru\"\n    },\n    {\n      \"Sid\": \"CloudWatchGetMetricDataAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"cloudwatch:GetMetricData\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"RDSDescribeDBInstancesAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"rds:DescribeDBInstances\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"CloudWatchLogsFilterLogEventsAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"logs:FilterLogEvents\"\n      ],\n      \"Resource\": \"arn:aws:logs:*:*:log-group:*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:ResourceTag/DevOps-Guru-Analysis\": \"true\"\n        }\n      }\n    }\n  ]\n}", "id": "aws_managed_0717", "complexity": "complex", "services": ["cloudformation", "cloudwatch", "devops-guru", "iam", "logs", "rds"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for AWS Code Star Full Access\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"CodeStarEC2\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"codestar:*\",\n        \"ec2:DescribeKeyPairs\",\n        \"ec2:DescribeVpcs\",\n        \"ec2:DescribeSubnets\",\n        \"cloud9:DescribeEnvironment*\",\n        \"cloud9:ValidateEnvironmentName\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"CodeStarCF\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"cloudformation:DescribeStack*\",\n        \"cloudformation:ListStacks*\",\n        \"cloudformation:GetTemplateSummary\"\n      ],\n      \"Resource\": [\n        \"arn:aws:cloudformation:*:*:stack/awscodestar-*\"\n      ]\n    }\n  ]\n}", "id": "aws_managed_0225", "complexity": "complex", "services": ["cloud9", "cloudformation", "codestar", "ec2"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for Amazon Chime Read Only\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Action\": [\n        \"chime:List*\",\n        \"chime:Get*\",\n        \"chime:Describe*\",\n        \"chime:SearchAvailablePhoneNumbers\"\n      ],\n      \"Effect\": \"Allow\",\n      \"Resource\": \"*\"\n    }\n  ]\n}", "id": "aws_managed_0263", "complexity": "simple", "services": ["chime"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for Sage Maker Studio EMR Instance Role Policy\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"AccessCertificateLocationS3Permission\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"s3:GetObject\",\n      \"Resource\": \"arn:aws:s3:::${aws:PrincipalTag/DomainBucketName}/${aws:PrincipalTag/AmazonDataZoneDomain}/certificate_location/*\",\n      \"Condition\": {\n        \"StringNotEquals\": {\n          \"aws:PrincipalTag/DomainBucketName\": \"\",\n          \"aws:PrincipalTag/AmazonDataZoneDomain\": \"\"\n        },\n        \"Null\": {\n          \"aws:PrincipalTag/AmazonDataZoneProject\": \"false\"\n        },\n        \"StringEquals\": {\n          \"aws:ResourceAccount\": \"${aws:PrincipalAccount}\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"AccessPatchingRPMsS3Permission\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"s3:GetObject\",\n      \"Resource\": [\n        \"arn:aws:s3:::default-env-blueprint-*/*\",\n        \"arn:aws:s3:*:*:accesspoint/env-blueprint-accesspoint*\"\n      ],\n      \"Condition\": {\n        \"ArnLike\": {\n          \"s3:DataAccessPointArn\": \"arn:aws:s3:*:*:accesspoint/env-blueprint-accesspoint\"\n        },\n        \"StringNotEquals\": {\n          \"aws:ResourceAccount\": \"${aws:PrincipalAccount}\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"AccessBootstrapActionScriptS3Permission\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"s3:GetObject\",\n      \"Resource\": \"arn:aws:s3:::${aws:PrincipalTag/DomainBucketName}/${aws:PrincipalTag/AmazonDataZoneDomain}/${aws:PrincipalTag/AmazonDataZoneProject}/${aws:PrincipalTag/AmazonDataZoneScopeName}/sys/emr/bootstrap-script/*\",\n      \"Condition\": {\n        \"StringNotEquals\": {\n          \"aws:PrincipalTag/DomainBucketName\": \"\",\n          \"aws:PrincipalTag/AmazonDataZoneDomain\": \"\",\n          \"aws:PrincipalTag/AmazonDataZoneProject\": \"\",\n          \"aws:PrincipalTag/AmazonDataZoneScopeName\": \"\"\n        },\n        \"Null\": {\n          \"aws:PrincipalTag/AmazonDataZoneProject\": \"false\"\n        },\n        \"StringEquals\": {\n          \"aws:ResourceAccount\": \"${aws:PrincipalAccount}\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"EMRClusterLogUploadS3Permission\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"s3:PutObject\",\n      \"Resource\": \"arn:aws:s3:::${aws:PrincipalTag/DomainBucketName}/${aws:PrincipalTag/AmazonDataZoneDomain}/${aws:PrincipalTag/AmazonDataZoneProject}/${aws:PrincipalTag/AmazonDataZoneScopeName}/sys/emr/*\",\n      \"Condition\": {\n        \"StringNotEquals\": {\n          \"aws:PrincipalTag/DomainBucketName\": \"\",\n          \"aws:PrincipalTag/AmazonDataZoneDomain\": \"\",\n          \"aws:PrincipalTag/AmazonDataZoneProject\": \"\",\n          \"aws:PrincipalTag/AmazonDataZoneScopeName\": \"\"\n        },\n        \"Null\": {\n          \"aws:PrincipalTag/AmazonDataZoneProject\": \"false\"\n        },\n        \"StringEquals\": {\n          \"aws:ResourceAccount\": \"${aws:PrincipalAccount}\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"EMRRuntimeRoleAssumePermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"sts:AssumeRole\",\n        \"sts:TagSession\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"ForAllValues:StringEquals\": {\n          \"aws:TagKeys\": [\n            \"LakeFormationAuthorizedCaller\"\n          ]\n        },\n        \"StringEquals\": {\n          \"iam:ResourceTag/AmazonDataZoneProject\": \"${aws:PrincipalTag/AmazonDataZoneProject}\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"EMRKMSPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"kms:CreateGrant\",\n        \"kms:Decrypt\",\n        \"kms:Encrypt\",\n        \"kms:GenerateDataKeyWithoutPlaintext\"\n      ],\n      \"Resource\": \"arn:aws:kms:*:*:key/${aws:PrincipalTag/KmsKeyId}\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"kms:ViaService\": [\n            \"ec2.*.amazonaws.com\"\n          ]\n        },\n        \"StringEquals\": {\n          \"aws:ResourceAccount\": \"${aws:PrincipalAccount}\"\n        },\n        \"Null\": {\n          \"kms:EncryptionContextKeys\": \"false\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"AllowGenerateDataKeyForEbsEncryption\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"kms:GenerateDataKey\",\n      \"Resource\": \"arn:aws:kms:*:*:key/${aws:PrincipalTag/KmsKeyId}\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:ResourceAccount\": \"${aws:PrincipalAccount}\"\n        }\n      }\n    }\n  ]\n}", "id": "aws_managed_1319", "complexity": "complex", "services": ["kms", "s3", "sts"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for AWS Partner Central Marketing Management\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"PartnerCentralMarketingAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"partnercentral-account-management:AccessMarketingCentral\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"LegacyPartnerCentralAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"partnercentral-account-management:AccessLegacyPartnerCentral\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"ForAnyValue:StringEquals\": {\n          \"partnercentral-account-management:LegacyPartnerCentralRole\": \"MarketingStaff\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"PartnerDiscoveryAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"partnercentral:SearchPartnerProfiles\",\n        \"partnercentral:GetPartnerProfile\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"PartnerProfileAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"partnercentral:StartProfileUpdateTask\",\n        \"partnercentral:GetProfileUpdateTask\",\n        \"partnercentral:CancelProfileUpdateTask\",\n        \"partnercentral:PutProfileVisibility\",\n        \"partnercentral:GetProfileVisibility\"\n      ],\n      \"Resource\": \"arn:aws:partnercentral:*:*:catalog/*/partner/*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"partnercentral:Catalog\": [\n            \"AWS\",\n            \"Sandbox\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"PartnerResourceAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"partnercentral:ListPartners\",\n        \"partnercentral:GetPartner\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"partnercentral:Catalog\": [\n            \"AWS\",\n            \"Sandbox\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"PartnerCentralEphemeralWriteS3Access\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:PutObject\"\n      ],\n      \"Resource\": \"arn:aws:s3:::aws-partner-central-marketplace-ephemeral-writeonly-files/${aws:PrincipalAccount}/*\"\n    },\n    {\n      \"Sid\": \"PartnerDashboardAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"partnercentral:GetPartnerDashboard\"\n      ],\n      \"Resource\": [\n        \"arn:aws:partnercentral::*:catalog/AWS/ReportingData/MarketingCampaign_V1/Dashboard/*\"\n      ]\n    }\n  ]\n}", "id": "aws_managed_1425", "complexity": "complex", "services": ["partnercentral", "partnercentral-account-management", "s3"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for Amazon Sage Maker Service Catalog Products Events Service Role Policy\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"codepipeline:StartPipelineExecution\",\n      \"Resource\": \"arn:aws:codepipeline:*:*:sagemaker-*\"\n    }\n  ]\n}", "id": "aws_managed_0898", "complexity": "simple", "services": ["codepipeline"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for Amazon SES Read Only Access\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"SESReadOnlyAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ses:Get*\",\n        \"ses:List*\",\n        \"ses:BatchGetMetricData\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}", "id": "aws_managed_0060", "complexity": "simple", "services": ["ses"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for AWS SSM Automation Diagnosis Bucket Policy\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"AllowReadWriteToSsmDiagnosisBucketInSameAccount\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:PutObject\",\n        \"s3:GetObject\",\n        \"s3:DeleteObject\"\n      ],\n      \"Resource\": \"arn:aws:s3:::do-not-delete-ssm-diagnosis-*/actions/*/${aws:PrincipalAccount}/*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:ResourceAccount\": \"${aws:PrincipalAccount}\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"AllowReadWriteToSsmDiagnosisBucketWithinOrg\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:PutObject\",\n        \"s3:GetObject\",\n        \"s3:DeleteObject\"\n      ],\n      \"Resource\": \"arn:aws:s3:::do-not-delete-ssm-diagnosis-*/actions/*/${aws:PrincipalAccount}/*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:ResourceOrgId\": \"${aws:PrincipalOrgId}\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"AllowReadOnlyAccessListBucketOnSsmDiagnosisBucketInSameAccount\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:ListBucket\"\n      ],\n      \"Resource\": \"arn:aws:s3:::do-not-delete-ssm-diagnosis-*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:ResourceAccount\": \"${aws:PrincipalAccount}\"\n        },\n        \"StringLike\": {\n          \"s3:prefix\": \"*/${aws:PrincipalAccount}/*\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"AllowReadOnlyAccessListBucketOnSsmDiagnosisBucketWithinOrg\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:ListBucket\"\n      ],\n      \"Resource\": \"arn:aws:s3:::do-not-delete-ssm-diagnosis-*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:ResourceOrgId\": \"${aws:PrincipalOrgId}\"\n        },\n        \"StringLike\": {\n          \"s3:prefix\": \"*/${aws:PrincipalAccount}/*\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"AllowGetEncryptionConfigurationOnSsmDiagnosisBucketInSameAccount\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:GetEncryptionConfiguration\"\n      ],\n      \"Resource\": \"arn:aws:s3:::do-not-delete-ssm-diagnosis-*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:ResourceAccount\": \"${aws:PrincipalAccount}\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"AllowGetEncryptionConfigurationOnSsmDiagnosisBucketWithinOrg\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:GetEncryptionConfiguration\"\n      ],\n      \"Resource\": \"arn:aws:s3:::do-not-delete-ssm-diagnosis-*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:ResourceOrgId\": \"${aws:PrincipalOrgId}\"\n        }\n      }\n    }\n  ]\n}", "id": "aws_managed_1258", "complexity": "complex", "services": ["s3"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for Amazon Sage Maker Canvas Forecast Access\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:GetObject\",\n        \"s3:PutObject\"\n      ],\n      \"Resource\": [\n        \"arn:aws:s3:::sagemaker-*/Canvas*\",\n        \"arn:aws:s3:::sagemaker-*/canvas*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:ListBucket\"\n      ],\n      \"Resource\": [\n        \"arn:aws:s3:::sagemaker-*\"\n      ]\n    }\n  ]\n}", "id": "aws_managed_0946", "complexity": "medium", "services": ["s3"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for Cloud Watch Open Search Dashboards Full Access\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"CloudWatchOpenSearchDashboardsIntegration\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"logs:ListIntegrations\",\n        \"logs:GetIntegration\",\n        \"logs:DeleteIntegration\",\n        \"logs:PutIntegration\",\n        \"logs:DescribeLogGroups\",\n        \"opensearch:ApplicationAccessAll\",\n        \"iam:ListRoles\",\n        \"iam:ListUsers\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"CloudWatchLogsOpensearchReadAPIs\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"aoss:BatchGetCollection\",\n        \"aoss:BatchGetLifecyclePolicy\",\n        \"es:ListApplications\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:CalledViaFirst\": \"logs.amazonaws.com\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"CloudWatchLogsOpensearchCreateServiceLinkedAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:CreateServiceLinkedRole\"\n      ],\n      \"Resource\": \"arn:aws:iam::*:role/aws-service-role/opensearchservice.amazonaws.com/AWSServiceRoleForAmazonOpenSearchService\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"iam:AWSServiceName\": \"opensearchservice.amazonaws.com\",\n          \"aws:CalledViaFirst\": \"logs.amazonaws.com\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"CloudWatchLogsObservabilityCreateServiceLinkedAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:CreateServiceLinkedRole\"\n      ],\n      \"Resource\": \"arn:aws:iam::*:role/aws-service-role/observability.aoss.amazonaws.com/AWSServiceRoleForAmazonOpenSearchServerless\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"iam:AWSServiceName\": \"observability.aoss.amazonaws.com\",\n          \"aws:CalledViaFirst\": \"logs.amazonaws.com\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"CloudWatchLogsCollectionRequestAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"aoss:CreateCollection\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:CalledViaFirst\": \"logs.amazonaws.com\",\n          \"aws:RequestTag/CloudWatchOpenSearchIntegration\": [\n            \"Dashboards\"\n          ]\n        },\n        \"ForAllValues:StringEquals\": {\n          \"aws:TagKeys\": \"CloudWatchOpenSearchIntegration\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"CloudWatchLogsApplicationRequestAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"es:CreateApplication\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:CalledViaFirst\": \"logs.amazonaws.com\",\n          \"aws:RequestTag/OpenSearchIntegration\": [\n            \"Dashboards\"\n          ]\n        },\n        \"ForAllValues:StringEquals\": {\n          \"aws:TagKeys\": \"OpenSearchIntegration\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"CloudWatchLogsCollectionResourceAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"aoss:DeleteCollection\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:CalledViaFirst\": \"logs.amazonaws.com\",\n          \"aws:ResourceTag/CloudWatchOpenSearchIntegration\": [\n            \"Dashboards\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"CloudWatchLogsApplicationResourceAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"es:UpdateApplication\",\n        \"es:GetApplication\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:CalledViaFirst\": \"logs.amazonaws.com\",\n          \"aws:ResourceTag/OpenSearchIntegration\": [\n            \"Dashboards\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"CloudWatchLogsCollectionPolicyAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"aoss:CreateSecurityPolicy\",\n        \"aoss:CreateAccessPolicy\",\n        \"aoss:DeleteAccessPolicy\",\n        \"aoss:DeleteSecurityPolicy\",\n        \"aoss:GetAccessPolicy\",\n        \"aoss:GetSecurityPolicy\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"aoss:collection\": \"cloudwatch-logs-*\",\n          \"aws:CalledViaFirst\": \"logs.amazonaws.com\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"CloudWatchLogsAPIAccessAll\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"aoss:APIAccessAll\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"aoss:collection\": \"cloudwatch-logs-*\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"CloudWatchLogsIndexPolicyAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"aoss:CreateAccessPolicy\",\n        \"aoss:DeleteAccessPolicy\",\n        \"aoss:GetAccessPolicy\",\n        \"aoss:CreateLifecyclePolicy\",\n        \"aoss:DeleteLifecyclePolicy\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"aoss:index\": \"cloudwatch-logs-*\",\n          \"aws:CalledViaFirst\": \"logs.amazonaws.com\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"CloudWatchLogsDQSRequestQueryAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"es:AddDirectQueryDataSource\"\n      ],\n      \"Resource\": \"arn:aws:opensearch:*:*:datasource/cloudwatch_logs_*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:CalledViaFirst\": \"logs.amazonaws.com\",\n          \"aws:RequestTag/CloudWatchOpenSearchIntegration\": [\n            \"Dashboards\"\n          ]\n        },\n        \"ForAllValues:StringEquals\": {\n          \"aws:TagKeys\": \"CloudWatchOpenSearchIntegration\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"CloudWatchLogsStartDirectQueryAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"opensearch:StartDirectQuery\",\n        \"opensearch:GetDirectQuery\"\n      ],\n      \"Resource\": \"arn:aws:opensearch:*:*:datasource/cloudwatch_logs_*\"\n    },\n    {\n      \"Sid\": \"CloudWatchLogsDQSResourceQueryAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"es:GetDirectQueryDataSource\",\n        \"es:DeleteDirectQueryDataSource\"\n      ],\n      \"Resource\": \"arn:aws:opensearch:*:*:datasource/cloudwatch_logs_*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:CalledViaFirst\": \"logs.amazonaws.com\",\n          \"aws:ResourceTag/CloudWatchOpenSearchIntegration\": [\n            \"Dashboards\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"CloudWatchLogsPassRoleAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:PassRole\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"iam:PassedToService\": \"directquery.opensearchservice.amazonaws.com\",\n          \"aws:CalledViaFirst\": \"logs.amazonaws.com\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"CloudWatchLogsAossTagsAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"aoss:TagResource\"\n      ],\n      \"Resource\": \"arn:aws:aoss:*:*:collection/*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:CalledViaFirst\": \"logs.amazonaws.com\",\n          \"aws:ResourceTag/CloudWatchOpenSearchIntegration\": [\n            \"Dashboards\"\n          ]\n        },\n        \"ForAllValues:StringEquals\": {\n          \"aws:TagKeys\": \"CloudWatchOpenSearchIntegration\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"CloudWatchLogsEsApplicationTagsAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"es:AddTags\"\n      ],\n      \"Resource\": \"arn:aws:opensearch:*:*:application/*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:ResourceTag/OpenSearchIntegration\": [\n            \"Dashboards\"\n          ],\n          \"aws:CalledViaFirst\": \"logs.amazonaws.com\"\n        },\n        \"ForAllValues:StringEquals\": {\n          \"aws:TagKeys\": \"OpenSearchIntegration\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"CloudWatchLogsEsDataSourceTagsAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"es:AddTags\"\n      ],\n      \"Resource\": \"arn:aws:opensearch:*:*:datasource/*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:ResourceTag/CloudWatchOpenSearchIntegration\": [\n            \"Dashboards\"\n          ],\n          \"aws:CalledViaFirst\": \"logs.amazonaws.com\"\n        },\n        \"ForAllValues:StringEquals\": {\n          \"aws:TagKeys\": \"CloudWatchOpenSearchIntegration\"\n        }\n      }\n    }\n  ]\n}", "id": "aws_managed_1281", "complexity": "complex", "services": ["aoss", "es", "iam", "logs", "opensearch"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for Amazon SSM Directory Service Access\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ds:CreateComputer\",\n        \"ds:DescribeDirectories\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}", "id": "aws_managed_0456", "complexity": "simple", "services": ["ds"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for App Integrations Service Linked Role Policy\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"cloudwatch:PutMetricData\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"cloudwatch:namespace\": \"AWS/AppIntegrations\"\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"appflow:DescribeConnectorEntity\",\n        \"appflow:ListConnectorEntities\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"appflow:DescribeConnectorProfiles\",\n        \"appflow:UseConnectorProfile\"\n      ],\n      \"Resource\": \"arn:aws:appflow:*:*:connector-profile/*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"appflow:DeleteFlow\",\n        \"appflow:DescribeFlow\",\n        \"appflow:DescribeFlowExecutionRecords\",\n        \"appflow:StartFlow\",\n        \"appflow:StopFlow\",\n        \"appflow:UpdateFlow\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:ResourceTag/AppIntegrationsManaged\": \"true\"\n        }\n      },\n      \"Resource\": \"arn:aws:appflow:*:*:flow/FlowCreatedByAppIntegrations-*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"appflow:TagResource\"\n      ],\n      \"Condition\": {\n        \"ForAllValues:StringEquals\": {\n          \"aws:TagKeys\": [\n            \"AppIntegrationsManaged\"\n          ]\n        }\n      },\n      \"Resource\": \"arn:aws:appflow:*:*:flow/FlowCreatedByAppIntegrations-*\"\n    }\n  ]\n}", "id": "aws_managed_0955", "complexity": "complex", "services": ["appflow", "cloudwatch"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for ROSA Amazon EBSCSI Driver Operator Policy\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:DescribeInstances\",\n        \"ec2:DescribeSnapshots\",\n        \"ec2:DescribeTags\",\n        \"ec2:DescribeVolumes\",\n        \"ec2:DescribeVolumesModifications\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:AttachVolume\",\n        \"ec2:DetachVolume\"\n      ],\n      \"Resource\": [\n        \"arn:aws:ec2:*:*:instance/*\",\n        \"arn:aws:ec2:*:*:volume/*\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:ResourceTag/red-hat-managed\": \"true\"\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:DeleteVolume\",\n        \"ec2:ModifyVolume\"\n      ],\n      \"Resource\": [\n        \"arn:aws:ec2:*:*:volume/*\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:ResourceTag/red-hat-managed\": \"true\"\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:CreateVolume\"\n      ],\n      \"Resource\": [\n        \"arn:aws:ec2:*:*:volume/*\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:RequestTag/red-hat-managed\": \"true\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"CreateVolumeFromSnapshot\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:CreateVolume\"\n      ],\n      \"Resource\": [\n        \"arn:aws:ec2:*:*:snapshot/*\"\n      ]\n    },\n    {\n      \"Sid\": \"CreateSnapshotResourceTag\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:CreateSnapshot\"\n      ],\n      \"Resource\": [\n        \"arn:aws:ec2:*:*:volume/*\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:ResourceTag/red-hat-managed\": \"true\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"CreateSnapshotRequestTag\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:CreateSnapshot\"\n      ],\n      \"Resource\": [\n        \"arn:aws:ec2:*:*:snapshot/*\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:RequestTag/red-hat-managed\": \"true\"\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:DeleteSnapshot\"\n      ],\n      \"Resource\": [\n        \"arn:aws:ec2:*:*:snapshot/*\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:ResourceTag/red-hat-managed\": \"true\"\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:CreateTags\"\n      ],\n      \"Resource\": [\n        \"arn:aws:ec2:*:*:volume/*\",\n        \"arn:aws:ec2:*:*:snapshot/*\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"ec2:CreateAction\": [\n            \"CreateVolume\",\n            \"CreateSnapshot\"\n          ]\n        }\n      }\n    }\n  ]\n}", "id": "aws_managed_1051", "complexity": "complex", "services": ["ec2"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for AWS Wickr Full Access\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"wickr:*\",\n      \"Resource\": \"*\"\n    }\n  ]\n}", "id": "aws_managed_0990", "complexity": "simple", "services": ["wickr"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for AWS Deep Racer Full Access\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:ListAllMyBuckets\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:DeleteObject\",\n        \"s3:DeleteObjectVersion\",\n        \"s3:GetBucketPolicy\",\n        \"s3:PutBucketPolicy\",\n        \"s3:ListBucket\",\n        \"s3:GetBucketAcl\",\n        \"s3:GetObject\",\n        \"s3:GetObjectVersion\",\n        \"s3:GetObjectAcl\",\n        \"s3:GetBucketLocation\"\n      ],\n      \"Resource\": [\n        \"arn:aws:s3:::*DeepRacer*\",\n        \"arn:aws:s3:::*Deepracer*\",\n        \"arn:aws:s3:::*deepracer*\",\n        \"arn:aws:s3:::dr-*\",\n        \"arn:aws:s3:::*DeepRacer*/*\",\n        \"arn:aws:s3:::*Deepracer*/*\",\n        \"arn:aws:s3:::*deepracer*/*\",\n        \"arn:aws:s3:::dr-*/*\"\n      ]\n    }\n  ]\n}", "id": "aws_managed_0683", "complexity": "medium", "services": ["s3"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for Partner Central Account Management User Role Association\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"PassPartnerCentralRole\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:PassRole\"\n      ],\n      \"Resource\": \"arn:aws:iam::*:role/PartnerCentralRoleFor*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"iam:PassedToService\": \"partnercentral-account-management.amazonaws.com\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"PartnerUserRoleAssociation\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:ListRoles\",\n        \"partnercentral-account-management:AssociatePartnerUser\",\n        \"partnercentral-account-management:DisassociatePartnerUser\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}", "id": "aws_managed_1118", "complexity": "medium", "services": ["iam", "partnercentral-account-management"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for Amazon Braket Full Access\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:GetObject\",\n        \"s3:PutObject\",\n        \"s3:ListBucket\",\n        \"s3:CreateBucket\",\n        \"s3:PutBucketPublicAccessBlock\",\n        \"s3:PutBucketPolicy\"\n      ],\n      \"Resource\": \"arn:aws:s3:::amazon-braket-*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:ResourceAccount\": \"${aws:PrincipalAccount}\"\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:ListAllMyBuckets\",\n        \"servicequotas:GetServiceQuota\",\n        \"cloudwatch:GetMetricData\",\n        \"pricing:GetProducts\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ecr:GetDownloadUrlForLayer\",\n        \"ecr:BatchGetImage\",\n        \"ecr:BatchCheckLayerAvailability\"\n      ],\n      \"Resource\": \"arn:aws:ecr:*:*:repository/amazon-braket*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ecr:GetAuthorizationToken\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"logs:Describe*\",\n        \"logs:Get*\",\n        \"logs:List*\",\n        \"logs:StartQuery\",\n        \"logs:StopQuery\",\n        \"logs:TestMetricFilter\",\n        \"logs:FilterLogEvents\"\n      ],\n      \"Resource\": \"arn:aws:logs:*:*:log-group:/aws/braket*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:ListRoles\",\n        \"iam:ListRolePolicies\",\n        \"iam:GetRole\",\n        \"iam:GetRolePolicy\",\n        \"iam:ListAttachedRolePolicies\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"sagemaker:ListNotebookInstances\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"sagemaker:CreatePresignedNotebookInstanceUrl\",\n        \"sagemaker:CreateNotebookInstance\",\n        \"sagemaker:DeleteNotebookInstance\",\n        \"sagemaker:DescribeNotebookInstance\",\n        \"sagemaker:StartNotebookInstance\",\n        \"sagemaker:StopNotebookInstance\",\n        \"sagemaker:UpdateNotebookInstance\",\n        \"sagemaker:ListTags\",\n        \"sagemaker:AddTags\",\n        \"sagemaker:DeleteTags\"\n      ],\n      \"Resource\": \"arn:aws:sagemaker:*:*:notebook-instance/amazon-braket-*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"sagemaker:DescribeNotebookInstanceLifecycleConfig\",\n        \"sagemaker:CreateNotebookInstanceLifecycleConfig\",\n        \"sagemaker:DeleteNotebookInstanceLifecycleConfig\",\n        \"sagemaker:ListNotebookInstanceLifecycleConfigs\",\n        \"sagemaker:UpdateNotebookInstanceLifecycleConfig\"\n      ],\n      \"Resource\": \"arn:aws:sagemaker:*:*:notebook-instance-lifecycle-config/amazon-braket-*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"braket:*\",\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"iam:CreateServiceLinkedRole\",\n      \"Resource\": \"arn:aws:iam::*:role/aws-service-role/braket.amazonaws.com/AWSServiceRoleForAmazonBraket*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"iam:AWSServiceName\": \"braket.amazonaws.com\"\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:PassRole\"\n      ],\n      \"Resource\": \"arn:aws:iam::*:role/service-role/AmazonBraketServiceSageMakerNotebookRole*\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"iam:PassedToService\": [\n            \"sagemaker.amazonaws.com\"\n          ]\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:PassRole\"\n      ],\n      \"Resource\": \"arn:aws:iam::*:role/service-role/AmazonBraketJobsExecutionRole*\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"iam:PassedToService\": [\n            \"braket.amazonaws.com\"\n          ]\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"logs:GetQueryResults\"\n      ],\n      \"Resource\": [\n        \"arn:aws:logs:*:*:log-group:*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"logs:PutLogEvents\",\n        \"logs:CreateLogStream\",\n        \"logs:CreateLogGroup\"\n      ],\n      \"Resource\": \"arn:aws:logs:*:*:log-group:/aws/braket*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"cloudwatch:PutMetricData\",\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"cloudwatch:namespace\": \"/aws/braket\"\n        }\n      }\n    }\n  ]\n}", "id": "aws_managed_0653", "complexity": "complex", "services": ["braket", "cloudwatch", "ecr", "iam", "logs", "pricing", "s3", "sagemaker", "servicequotas"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for AWS Elemental Media Package Full Access\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": {\n    \"Effect\": \"Allow\",\n    \"Action\": \"mediapackage:*\",\n    \"Resource\": \"*\"\n  }\n}", "id": "aws_managed_0305", "complexity": "simple", "services": ["mediapackage"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for Amazon Elastic Container Registry Public Read Only\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ecr-public:GetAuthorizationToken\",\n        \"sts:GetServiceBearerToken\",\n        \"ecr-public:BatchCheckLayerAvailability\",\n        \"ecr-public:GetRepositoryPolicy\",\n        \"ecr-public:DescribeRepositories\",\n        \"ecr-public:DescribeRegistries\",\n        \"ecr-public:DescribeImages\",\n        \"ecr-public:DescribeImageTags\",\n        \"ecr-public:GetRepositoryCatalogData\",\n        \"ecr-public:GetRegistryCatalogData\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}", "id": "aws_managed_0720", "complexity": "medium", "services": ["ecr-public", "sts"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for Sage Maker Studio User IAM Permissive Execution Policy\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"DataAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"cloudwatch:*\",\n        \"glue:*\",\n        \"logs:*\",\n        \"redshift-data:*\",\n        \"redshift-serverless:*\",\n        \"redshift:*\",\n        \"s3:*\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"ComputeAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"athena:*\",\n        \"bedrock:*\",\n        \"codewhisperer:*\",\n        \"sagemaker-unified-studio-mcp:*\",\n        \"q:*\",\n        \"sagemaker:*\",\n        \"sagemaker-mlflow:*\",\n        \"scheduler:*\",\n        \"sqlworkbench:*\",\n        \"emr-serverless:*\",\n        \"airflow-serverless:*\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"GlueSessionIsolation\",\n      \"Effect\": \"Deny\",\n      \"Action\": [\n        \"glue:CancelStatement\",\n        \"glue:CreateSession\",\n        \"glue:DeleteSession\",\n        \"glue:GetSession\",\n        \"glue:GetStatement\",\n        \"glue:RunStatement\",\n        \"glue:StopSession\",\n        \"glue:GetDashboardUrl\"\n      ],\n      \"Resource\": [\n        \"arn:aws:glue:*:*:session/*\"\n      ],\n      \"Condition\": {\n        \"StringNotEquals\": {\n          \"aws:RequestTag/AmazonDataZoneSessionOwner\": \"${aws:SourceIdentity}\",\n          \"aws:ResourceTag/AmazonDataZoneSessionOwner\": \"${aws:SourceIdentity}\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"DenyTaggingUntaggingForeignSessions\",\n      \"Effect\": \"Deny\",\n      \"Action\": [\n        \"glue:TagResource\",\n        \"glue:UntagResource\"\n      ],\n      \"Resource\": \"arn:aws:glue:*:*:session/*\",\n      \"Condition\": {\n        \"StringNotEquals\": {\n          \"aws:ResourceTag/AmazonDataZoneSessionOwner\": \"${aws:SourceIdentity}\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"DataZone\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"datazone:AcceptPredictions\",\n        \"datazone:AcceptSubscriptionRequest\",\n        \"datazone:CancelMetadataGenerationRun\",\n        \"datazone:CancelSubscription\",\n        \"datazone:CreateAsset*\",\n        \"datazone:CreateConnection\",\n        \"datazone:CreateEnvironment\",\n        \"datazone:CreateListingChangeSet\",\n        \"datazone:CreateProject\",\n        \"datazone:CreateSubscriptionGrant\",\n        \"datazone:CreateSubscriptionRequest\",\n        \"datazone:DeleteAsset*\",\n        \"datazone:DeleteConnection\",\n        \"datazone:DeleteEnvironment\",\n        \"datazone:DeleteListing\",\n        \"datazone:DeleteProject\",\n        \"datazone:DeleteSubscriptionGrant\",\n        \"datazone:DeleteSubscriptionRequest\",\n        \"datazone:Get*\",\n        \"datazone:List*\",\n        \"datazone:PostLineageEvent\",\n        \"datazone:RejectPredictions\",\n        \"datazone:RejectSubscriptionRequest\",\n        \"datazone:RevokeSubscription\",\n        \"datazone:Search\",\n        \"datazone:SearchListings\",\n        \"datazone:SearchRules\",\n        \"datazone:SearchTypes\",\n        \"datazone:SearchUserProfiles\",\n        \"datazone:SearchGroupProfiles\",\n        \"datazone:StartMetadataGenerationRun\",\n        \"datazone:UpdateAssetFilter\",\n        \"datazone:UpdateConnection\",\n        \"datazone:UpdateEnvironment\",\n        \"datazone:UpdateProject\",\n        \"datazone:UpdateSubscriptionRequest\",\n        \"datazone:CreateNotebook\",\n        \"datazone:UpdateNotebook\",\n        \"datazone:DeleteNotebook\",\n        \"datazone:CreateCell\",\n        \"datazone:UpdateCell\",\n        \"datazone:DeleteCell\",\n        \"datazone:BatchGetCell\",\n        \"datazone:CreateCellRun\",\n        \"datazone:UpdateCellRun\",\n        \"datazone:DeleteCellRun\",\n        \"datazone:BatchGetCellRun\",\n        \"datazone:PutCellRunResult\",\n        \"datazone:StartNotebookCompute\",\n        \"datazone:StopNotebookCompute\",\n        \"datazone:StartConversation\",\n        \"datazone:GenerateCode\",\n        \"datazone:SendMessage\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"CfnManage\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"cloudformation:*\"\n      ],\n      \"Resource\": [\n        \"arn:aws:cloudformation:*:*:stack/DataZone*\"\n      ]\n    },\n    {\n      \"Sid\": \"ValidateCfn\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"cloudformation:ValidateTemplate\",\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"IamSts\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:GetRole\",\n        \"iam:ListRoles\",\n        \"sts:AssumeRole\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"CreateSLR\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"iam:CreateServiceLinkedRole\",\n      \"Resource\": [\n        \"arn:aws:iam::*:role/aws-service-role/neptune-graph.amazonaws.com/AWSServiceRoleForNeptuneGraph\",\n        \"arn:aws:iam::*:role/aws-service-role/redshift.amazonaws.com/AWSServiceRoleForRedshift\",\n        \"arn:aws:iam::*:role/aws-service-role/sagemaker.amazonaws.com/AWSServiceRoleForAmazonSageMakerNotebooks\",\n        \"arn:aws:iam::*:role/aws-service-role/ops.emr-serverless.amazonaws.com/AWSServiceRoleForAmazonEMRServerless\",\n        \"arn:aws:iam::*:role/aws-service-role/airflow.amazonaws.com/AWSServiceRoleForAmazonMWAA\",\n        \"arn:aws:iam::*:role/aws-service-role/airflow-serverless.amazonaws.com/AWSServiceRoleForAmazonMWAAServerless\",\n        \"arn:aws:iam::*:role/aws-service-role/elasticmapreduce.amazonaws.com/AWSServiceRoleForEMRCleanup\",\n        \"arn:aws:iam::*:role/aws-service-role/sagemaker.application-autoscaling.amazonaws.com/AWSServiceRoleForApplicationAutoScaling_SageMakerEndpoint\",\n        \"arn:aws:iam::*:role/aws-service-role/observability.aoss.amazonaws.com/AWSServiceRoleForAmazonOpenSearchServerless\"\n      ]\n    },\n    {\n      \"Sid\": \"TagSession\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"sts:TagSession\",\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"ForAllValues:StringLike\": {\n          \"aws:TagKeys\": [\n            \"AmazonDataZone*\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"PassRole\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"iam:PassRole\",\n      \"Resource\": [\n        \"arn:aws:iam::*:role/service-role/AmazonSageMaker*\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"iam:PassedToService\": [\n            \"sagemaker.amazonaws.com\",\n            \"lakeformation.amazonaws.com\",\n            \"glue.amazonaws.com\",\n            \"bedrock.amazonaws.com\",\n            \"redshift-serverless.amazonaws.com\",\n            \"redshift.amazonaws.com\",\n            \"scheduler.amazonaws.com\",\n            \"emr-serverless.amazonaws.com\",\n            \"airflow-serverless.amazonaws.com\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"SourceIdentity\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"sts:SetSourceIdentity\",\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"sts:SourceIdentity\": \"${aws:PrincipalTag/datazone:userId}\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"SSM\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ssm:GetParameter*\"\n      ],\n      \"Resource\": [\n        \"arn:aws:ssm:*:*:parameter/amazon/datazone/q*\",\n        \"arn:aws:ssm:*:*:parameter/amazon/datazone/genAI/*\",\n        \"arn:aws:ssm:*::parameter/aws/service/sagemaker-distribution/*\"\n      ]\n    },\n    {\n      \"Sid\": \"LFAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"lakeformation:BatchGrantPermissions\",\n        \"lakeformation:BatchRevokePermissions\",\n        \"lakeformation:DescribeResource\",\n        \"lakeformation:GetDataAccess\",\n        \"lakeformation:GrantPermissions\",\n        \"lakeformation:ListResources\",\n        \"lakeformation:ListPermissions\",\n        \"lakeformation:RevokePermissions\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"FederatedConn\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"dynamodb:List*\",\n        \"dynamodb:Describe*\",\n        \"dynamodb:Scan\",\n        \"dynamodb:PartiQLSelect\",\n        \"dynamodb:Query\",\n        \"secretsmanager:ListSecrets\",\n        \"resource-groups:GetGroupQuery\",\n        \"resource-groups:ListGroupResources\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"PrivateSecret\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"secretsmanager:CreateSecret\",\n        \"secretsmanager:DeleteSecret\",\n        \"secretsmanager:DescribeSecret\",\n        \"secretsmanager:GetSecretValue\",\n        \"secretsmanager:UpdateSecret\",\n        \"secretsmanager:PutResourcePolicy\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:ResourceTag/AmazonDataZoneProject\": \"${datazone:projectId}\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"SharedSecret\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"secretsmanager:CreateSecret\",\n        \"secretsmanager:DescribeSecret\",\n        \"secretsmanager:GetSecretValue\",\n        \"secretsmanager:UpdateSecret\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:ResourceTag/for-use-with-all-datazone-projects\": \"true\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"Ecr\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ecr:BatchCheckLayerAvailability\",\n        \"ecr:BatchGetImage\",\n        \"ecr:DescribeImages\",\n        \"ecr:GetAuthorizationToken\",\n        \"ecr:GetDownloadUrlForLayer\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"CodeConnectionsUser\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"codeconnections:UseConnection\",\n        \"codeconnections:ListConnections\",\n        \"codeconnections:GetConnection\",\n        \"codeconnections:GetHost\",\n        \"codeconnections:ListTagsForResource\",\n        \"codestar-connections:UseConnection\",\n        \"codestar-connections:ListConnections\",\n        \"codestar-connections:GetConnection\",\n        \"codestar-connections:GetHost\",\n        \"codestar-connections:ListTagsForResource\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"KmsListAndDescribe\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"kms:DescribeKey\",\n        \"kms:ListAliases\",\n        \"kms:ListGrants\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"DataZoneKms\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"kms:Decrypt\",\n        \"kms:GenerateDataKey\",\n        \"kms:Encrypt\",\n        \"kms:GenerateDataKeyWithoutPlaintext\",\n        \"kms:ReEncryptTo\",\n        \"kms:ReEncryptFrom\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"kms:ViaService\": \"datazone.*.amazonaws.com\"\n        },\n        \"ForAnyValue:StringEquals\": {\n          \"kms:EncryptionContextKeys\": \"aws:datazone:domainId\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"S3Kms\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"kms:Decrypt\",\n        \"kms:GenerateDataKey\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"kms:ViaService\": \"s3.*.amazonaws.com\"\n        },\n        \"Null\": {\n          \"kms:EncryptionContext:aws:s3:arn\": \"false\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"SchedulerKms\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"kms:Decrypt\",\n        \"kms:GenerateDataKey\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"Null\": {\n          \"kms:EncryptionContext:aws:scheduler:schedule:arn\": \"false\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"SecretsKms\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"kms:Decrypt\",\n        \"kms:Encrypt\",\n        \"kms:GenerateDataKey\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"kms:ViaService\": \"secretsmanager.*.amazonaws.com\"\n        },\n        \"Null\": {\n          \"kms:EncryptionContext:SecretARN\": \"false\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"SageMakerKms\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"kms:Decrypt\",\n        \"kms:Encrypt\",\n        \"kms:GenerateDataKey\",\n        \"kms:GenerateDataKeyWithoutPlaintext\",\n        \"kms:ReEncryptTo\",\n        \"kms:ReEncryptFrom\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"kms:ViaService\": \"sagemaker.*.amazonaws.com\"\n        },\n        \"Null\": {\n          \"kms:EncryptionContextKeys\": \"false\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"SageMakerCreateGrant\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"kms:CreateGrant\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"kms:ViaService\": \"sagemaker.*.amazonaws.com\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"DataZoneCreateGrant\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"kms:CreateGrant\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"kms:ViaService\": \"datazone.*.amazonaws.com\"\n        },\n        \"ForAllValues:StringEquals\": {\n          \"kms:GrantOperations\": [\n            \"Encrypt\",\n            \"Decrypt\",\n            \"ReEncryptFrom\",\n            \"ReEncryptTo\",\n            \"GenerateDataKeyWithoutPlaintext\",\n            \"GenerateDataKey\",\n            \"DescribeKey\",\n            \"RetireGrant\",\n            \"CreateGrant\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"GlueKms\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"kms:Decrypt\",\n        \"kms:Encrypt\",\n        \"kms:GenerateDataKey\",\n        \"kms:GenerateDataKeyWithoutPlaintext\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"kms:ViaService\": \"glue.*.amazonaws.com\"\n        },\n        \"Null\": {\n          \"kms:EncryptionContextKeys\": \"false\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"BedrockKms\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"kms:CreateGrant\",\n        \"kms:Decrypt\",\n        \"kms:GenerateDataKey\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"kms:ViaService\": \"bedrock.*.amazonaws.com\"\n        },\n        \"Null\": {\n          \"kms:EncryptionContextKeys\": \"false\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"WorkflowsCreateGrant\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"kms:CreateGrant\"\n      ],\n      \"Resource\": \"arn:*:kms:*:*:key/*\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"kms:ViaService\": \"airflow-serverless.*.amazonaws.com\"\n        },\n        \"ForAnyValue:StringEquals\": {\n          \"kms:EncryptionContextKeys\": \"aws:airflow-serverless:workflow-arn\"\n        },\n        \"ForAllValues:StringEquals\": {\n          \"kms:GrantOperations\": [\n            \"Decrypt\",\n            \"Encrypt\",\n            \"GenerateDataKey\",\n            \"GenerateDataKeyWithoutPlaintext\",\n            \"RetireGrant\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"WorkflowsKms\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"kms:Decrypt\",\n        \"kms:Encrypt\",\n        \"kms:GenerateDataKey\",\n        \"kms:GenerateDataKeyWithoutPlaintext\"\n      ],\n      \"Resource\": \"arn:*:kms:*:*:key/*\",\n      \"Condition\": {\n        \"ForAnyValue:StringEquals\": {\n          \"kms:EncryptionContextKeys\": \"aws:airflow-serverless:workflow-arn\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"Ec2DescribeOnly\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"ec2:Describe*\",\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"VpcAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:CreateNetworkInterface\",\n        \"ec2:DeleteNetworkInterface\",\n        \"ec2:CreateNetworkInterfacePermission\",\n        \"ec2:DeleteNetworkInterfacePermission\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"EC2TagAccessForVpc\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:CreateTags\",\n        \"ec2:DeleteTags\"\n      ],\n      \"Resource\": [\n        \"arn:aws:ec2:*:*:network-interface/*\"\n      ]\n    },\n    {\n      \"Sid\": \"AthenaSessionIsolation\",\n      \"Effect\": \"Deny\",\n      \"Action\": [\n        \"athena:StartSession\",\n        \"athena:GetSession\",\n        \"athena:TerminateSession\",\n        \"athena:GetSessionStatus\",\n        \"athena:GetSessionEndpoint\",\n        \"athena:GetResourceDashboard\"\n      ],\n      \"Resource\": [\n        \"arn:aws:athena:*:*:workgroup/*/session/*\"\n      ],\n      \"Condition\": {\n        \"StringNotEquals\": {\n          \"aws:RequestTag/AmazonDataZoneSessionOwner\": \"${aws:SourceIdentity}\",\n          \"aws:ResourceTag/AmazonDataZoneSessionOwner\": \"${aws:SourceIdentity}\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"DenyTaggingUntaggingForeignAthenaSessions\",\n      \"Effect\": \"Deny\",\n      \"Action\": [\n        \"athena:TagResource\",\n        \"athena:UntagResource\"\n      ],\n      \"Resource\": \"arn:aws:athena:*:*:workgroup/*/session/*\",\n      \"Condition\": {\n        \"StringNotEquals\": {\n          \"aws:ResourceTag/AmazonDataZoneSessionOwner\": \"${aws:SourceIdentity}\"\n        }\n      }\n    }\n  ]\n}", "id": "aws_managed_1380", "complexity": "complex", "services": ["airflow-serverless", "athena", "bedrock", "cloudformation", "cloudwatch", "codeconnections", "codestar-connections", "codewhisperer", "datazone", "dynamodb", "ec2", "ecr", "emr-serverless", "glue", "iam", "kms", "lakeformation", "logs", "q", "redshift", "redshift-data", "redshift-serverless", "resource-groups", "s3", "sagemaker", "sagemaker-mlflow", "sagemaker-unified-studio-mcp", "scheduler", "secretsmanager", "sqlworkbench", "ssm", "sts"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for Amazon Redshift Federated Authorization\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"AmazonRedshiftFederatedAuthorization\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"glue:GetCatalog\",\n        \"glue:GetCatalogs\",\n        \"glue:GetDatabase\",\n        \"glue:GetDatabases\",\n        \"glue:GetTable\",\n        \"glue:GetTables\",\n        \"glue:GetUserDefinedFunctions\",\n        \"glue:CreateDatabase\",\n        \"glue:CreateTable\",\n        \"glue:DeleteDatabase\",\n        \"glue:DeleteTable\",\n        \"glue:UpdateCatalog\",\n        \"glue:UpdateDatabase\",\n        \"glue:UpdateTable\",\n        \"glue:RenameTable\",\n        \"glue:FederateAuthorization\"\n      ],\n      \"Resource\": [\n        \"arn:aws:glue:*:*:*\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"glue:FederatedAuthorizationSource\": \"Redshift\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"AmazonRedshiftIdentityCenterSetContext\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"sts:SetContext\"\n      ],\n      \"Resource\": \"arn:aws:sts::*:self\"\n    }\n  ]\n}", "id": "aws_managed_1420", "complexity": "medium", "services": ["glue", "sts"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for Server Migration Service Launch Role\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:ModifyInstanceAttribute\",\n        \"ec2:StopInstances\",\n        \"ec2:StartInstances\",\n        \"ec2:TerminateInstances\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"ec2:ResourceTag/aws:cloudformation:stack-id\": \"arn:aws:cloudformation:*:*:stack/sms-app-*/*\"\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"ec2:CreateTags\",\n      \"Resource\": \"arn:aws:ec2:*:*:instance/*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:DisassociateIamInstanceProfile\",\n        \"ec2:AssociateIamInstanceProfile\",\n        \"ec2:ReplaceIamInstanceProfileAssociation\"\n      ],\n      \"Resource\": \"arn:aws:ec2:*:*:instance/*\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"ec2:ResourceTag/aws:cloudformation:stack-id\": \"arn:aws:cloudformation:*:*:stack/sms-app-*/*\"\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"iam:PassRole\",\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"iam:PassedToService\": \"ec2.amazonaws.com\"\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:RunInstances\",\n        \"ec2:Describe*\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"applicationinsights:Describe*\",\n        \"applicationinsights:List*\",\n        \"cloudformation:ListStackResources\",\n        \"cloudformation:DescribeStacks\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"applicationinsights:CreateApplication\",\n        \"applicationinsights:CreateComponent\",\n        \"applicationinsights:UpdateApplication\",\n        \"applicationinsights:DeleteApplication\",\n        \"applicationinsights:UpdateComponentConfiguration\",\n        \"applicationinsights:DeleteComponent\"\n      ],\n      \"Resource\": \"arn:aws:applicationinsights:*:*:application/resource-group/sms-app-*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"resource-groups:CreateGroup\",\n        \"resource-groups:GetGroup\",\n        \"resource-groups:UpdateGroup\",\n        \"resource-groups:DeleteGroup\"\n      ],\n      \"Resource\": \"arn:aws:resource-groups:*:*:group/sms-app-*\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"aws:ResourceTag/aws:cloudformation:stack-id\": \"arn:aws:cloudformation:*:*:stack/sms-app-*/*\"\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:CreateServiceLinkedRole\"\n      ],\n      \"Resource\": [\n        \"arn:aws:iam::*:role/aws-service-role/application-insights.amazonaws.com/AWSServiceRoleForApplicationInsights\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"iam:AWSServiceName\": \"application-insights.amazonaws.com\"\n        }\n      }\n    }\n  ]\n}", "id": "aws_managed_0403", "complexity": "complex", "services": ["applicationinsights", "cloudformation", "ec2", "iam", "resource-groups"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for Auto Scaling Service Role Policy\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"EC2InstanceManagement\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:AttachClassicLinkVpc\",\n        \"ec2:CancelSpotInstanceRequests\",\n        \"ec2:CreateReplaceRootVolumeTask\",\n        \"ec2:CreateFleet\",\n        \"ec2:CreateTags\",\n        \"ec2:DeleteTags\",\n        \"ec2:Describe*\",\n        \"ec2:DetachClassicLinkVpc\",\n        \"ec2:GetInstanceTypesFromInstanceRequirements\",\n        \"ec2:GetSecurityGroupsForVpc\",\n        \"ec2:ModifyInstanceAttribute\",\n        \"ec2:RequestSpotInstances\",\n        \"ec2:RunInstances\",\n        \"ec2:StartInstances\",\n        \"ec2:StopInstances\",\n        \"ec2:TerminateInstances\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"EC2InstanceProfileManagement\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:PassRole\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"iam:PassedToService\": \"ec2.amazonaws.com*\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"EC2SpotManagement\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:CreateServiceLinkedRole\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"iam:AWSServiceName\": \"spot.amazonaws.com\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"ELBManagement\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"elasticloadbalancing:Register*\",\n        \"elasticloadbalancing:Deregister*\",\n        \"elasticloadbalancing:Describe*\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"CWManagement\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"cloudwatch:DeleteAlarms\",\n        \"cloudwatch:DescribeAlarms\",\n        \"cloudwatch:GetMetricData\",\n        \"cloudwatch:PutMetricAlarm\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"SNSManagement\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"sns:Publish\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"EventBridgeRuleManagement\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"events:PutRule\",\n        \"events:PutTargets\",\n        \"events:RemoveTargets\",\n        \"events:DeleteRule\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"events:ManagedBy\": \"autoscaling.amazonaws.com\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"SystemsManagerParameterManagement\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ssm:GetParameters\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"VpcLatticeManagement\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"vpc-lattice:DeregisterTargets\",\n        \"vpc-lattice:GetTargetGroup\",\n        \"vpc-lattice:ListTargets\",\n        \"vpc-lattice:ListTargetGroups\",\n        \"vpc-lattice:RegisterTargets\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"ResourceGroupsManagement\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"resource-groups:ListGroupResources\"\n      ],\n      \"Resource\": \"arn:*:resource-groups:*:*:group/*\"\n    }\n  ]\n}", "id": "aws_managed_0308", "complexity": "complex", "services": ["cloudwatch", "ec2", "elasticloadbalancing", "events", "iam", "resource-groups", "sns", "ssm", "vpc-lattice"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for Dynamo DB Global Table Settings Management Service Role Policy\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"DynamoDBActionsNeededToReplicateSettings\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"application-autoscaling:RegisterScalableTarget\",\n        \"application-autoscaling:DescribeScalableTargets\",\n        \"application-autoscaling:PutScalingPolicy\",\n        \"application-autoscaling:DescribeScalingPolicies\",\n        \"application-autoscaling:DeleteScalingPolicy\",\n        \"application-autoscaling:DeregisterScalableTarget\"\n      ],\n      \"Resource\": [\n        \"arn:aws:application-autoscaling:*:*:scalable-target/*\",\n        \"arn:aws:autoscaling:*:*:scalingPolicy:*:resource/dynamodb/table/*\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"application-autoscaling:service-namespace\": [\n            \"dynamodb\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"DynamoDBReplicationServiceRolePolicy\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:CreateServiceLinkedRole\"\n      ],\n      \"Resource\": \"arn:aws:iam::*:role/aws-service-role/*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"iam:AWSServiceName\": [\n            \"dynamodb.application-autoscaling.amazonaws.com\"\n          ]\n        }\n      }\n    }\n  ]\n}", "id": "aws_managed_1396", "complexity": "medium", "services": ["application-autoscaling", "iam"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for AWS Entity Resolution Console Read Only Access\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"EntityResolutionRead\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"entityresolution:Get*\",\n        \"entityresolution:List*\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}", "id": "aws_managed_1096", "complexity": "simple", "services": ["entityresolution"], "source": "aws_managed"}
{"text": "### Instruction:\nAllow using a specific KMS key to encrypt and decrypt data but not manage the key itself\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"kms:Encrypt\",\n        \"kms:Decrypt\",\n        \"kms:ReEncryptFrom\",\n        \"kms:ReEncryptTo\",\n        \"kms:GenerateDataKey\",\n        \"kms:GenerateDataKeyWithoutPlaintext\",\n        \"kms:DescribeKey\"\n      ],\n      \"Resource\": \"arn:aws:kms:us-east-1:123456789012:key/12345678-1234-1234-1234-123456789012\"\n    }\n  ]\n}", "id": "syn_kms_001", "complexity": "medium", "services": ["kms"], "source": "synthetic"}
{"text": "### Instruction:\nProvide an IAM policy for Amazon Security Lake Permissions Boundary\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"AllowActionsForSecurityLake\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:GetObject\",\n        \"s3:GetObjectVersion\",\n        \"s3:ListBucket\",\n        \"s3:ListBucketVersions\",\n        \"s3:PutObject\",\n        \"s3:GetBucketLocation\",\n        \"kms:Decrypt\",\n        \"kms:GenerateDataKey\",\n        \"sqs:ReceiveMessage\",\n        \"sqs:ChangeMessageVisibility\",\n        \"sqs:DeleteMessage\",\n        \"sqs:GetQueueUrl\",\n        \"sqs:SendMessage\",\n        \"sqs:GetQueueAttributes\",\n        \"sqs:ListQueues\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"DenyActionsForSecurityLake\",\n      \"Effect\": \"Deny\",\n      \"NotAction\": [\n        \"s3:GetObject\",\n        \"s3:GetObjectVersion\",\n        \"s3:ListBucket\",\n        \"s3:ListBucketVersions\",\n        \"s3:PutObject\",\n        \"s3:GetBucketLocation\",\n        \"kms:Decrypt\",\n        \"kms:GenerateDataKey\",\n        \"sqs:ReceiveMessage\",\n        \"sqs:ChangeMessageVisibility\",\n        \"sqs:DeleteMessage\",\n        \"sqs:GetQueueUrl\",\n        \"sqs:SendMessage\",\n        \"sqs:GetQueueAttributes\",\n        \"sqs:ListQueues\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"DenyActionsNotOnSecurityLakeBucket\",\n      \"Effect\": \"Deny\",\n      \"Action\": [\n        \"s3:GetObject\",\n        \"s3:GetObjectVersion\",\n        \"s3:ListBucket\",\n        \"s3:ListBucketVersions\",\n        \"s3:PutObject\",\n        \"s3:GetBucketLocation\"\n      ],\n      \"NotResource\": [\n        \"arn:aws:s3:::aws-security-data-lake*\"\n      ]\n    },\n    {\n      \"Sid\": \"DenyActionsNotOnSecurityLakeSQS\",\n      \"Effect\": \"Deny\",\n      \"Action\": [\n        \"sqs:ReceiveMessage\",\n        \"sqs:ChangeMessageVisibility\",\n        \"sqs:DeleteMessage\",\n        \"sqs:GetQueueUrl\",\n        \"sqs:SendMessage\",\n        \"sqs:GetQueueAttributes\",\n        \"sqs:ListQueues\"\n      ],\n      \"NotResource\": \"arn:aws:sqs:*:*:AmazonSecurityLake*\"\n    },\n    {\n      \"Sid\": \"DenyActionsNotOnSecurityLakeKMSS3SQS\",\n      \"Effect\": \"Deny\",\n      \"Action\": [\n        \"kms:Decrypt\",\n        \"kms:GenerateDataKey\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringNotLike\": {\n          \"kms:ViaService\": [\n            \"s3.*.amazonaws.com\",\n            \"sqs.*.amazonaws.com\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"DenyActionsNotOnSecurityLakeKMSForS3\",\n      \"Effect\": \"Deny\",\n      \"Action\": [\n        \"kms:Decrypt\",\n        \"kms:GenerateDataKey\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"Null\": {\n          \"kms:EncryptionContext:aws:s3:arn\": \"false\"\n        },\n        \"StringNotLikeIfExists\": {\n          \"kms:EncryptionContext:aws:s3:arn\": [\n            \"arn:aws:s3:::aws-security-data-lake*\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"DenyActionsNotOnSecurityLakeKMSForS3SQS\",\n      \"Effect\": \"Deny\",\n      \"Action\": [\n        \"kms:Decrypt\",\n        \"kms:GenerateDataKey\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"Null\": {\n          \"kms:EncryptionContext:aws:sqs:arn\": \"false\"\n        },\n        \"StringNotLikeIfExists\": {\n          \"kms:EncryptionContext:aws:sqs:arn\": [\n            \"arn:aws:sqs:*:*:AmazonSecurityLake*\"\n          ]\n        }\n      }\n    }\n  ]\n}", "id": "aws_managed_0994", "complexity": "complex", "services": ["kms", "s3", "sqs"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for Amazon Sage Maker Quick Sight VPC Policy\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"ManageQuickSightVPCConnection\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"quicksight:CreateVPCConnection\",\n        \"quicksight:DescribeVPCConnection\",\n        \"quicksight:DeleteVPCConnection\",\n        \"quicksight:ListVPCConnections\",\n        \"quicksight:UpdateVPCConnection\"\n      ],\n      \"Resource\": \"arn:aws:quicksight:*:*:vpcconnection/*\",\n      \"Condition\": {\n        \"Null\": {\n          \"aws:ResourceTag/AmazonDataZoneProject\": \"false\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"DescribeQuickSightVPCConnectionEC2Resources\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:DescribeVpcs\",\n        \"ec2:DescribeSubnets\",\n        \"ec2:DescribeSecurityGroups\",\n        \"ec2:DescribeNetworkInterfaces\",\n        \"ec2:DescribeNetworkAcls\",\n        \"ec2:DescribeRouteTables\"\n      ],\n      \"Resource\": [\n        \"*\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:ResourceAccount\": \"${aws:PrincipalAccount}\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"ManageQuickSightEC2NetworkInterface\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:CreateNetworkInterface\",\n        \"ec2:DeleteNetworkInterface\"\n      ],\n      \"Resource\": [\n        \"arn:aws:ec2:*:*:subnet/*\",\n        \"arn:aws:ec2:*:*:security-group/*\",\n        \"arn:aws:ec2:*:*:network-interface/*\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:ResourceAccount\": \"${aws:PrincipalAccount}\"\n        }\n      }\n    }\n  ]\n}", "id": "aws_managed_1342", "complexity": "medium", "services": ["ec2", "quicksight"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for AI Ops Assistant Policy\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"AIOPSServiceAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"access-analyzer:GetAnalyzer\",\n        \"access-analyzer:List*\",\n        \"acm-pca:Describe*\",\n        \"acm-pca:GetCertificate\",\n        \"acm-pca:GetCertificateAuthorityCertificate\",\n        \"acm-pca:GetCertificateAuthorityCsr\",\n        \"acm-pca:List*\",\n        \"acm:DescribeCertificate\",\n        \"acm:GetAccountConfiguration\",\n        \"airflow:List*\",\n        \"amplify:GetApp\",\n        \"amplify:GetBranch\",\n        \"amplify:GetDomainAssociation\",\n        \"amplify:List*\",\n        \"aoss:BatchGetCollection\",\n        \"aoss:BatchGetLifecyclePolicy\",\n        \"aoss:BatchGetVpcEndpoint\",\n        \"aoss:GetAccessPolicy\",\n        \"aoss:GetSecurityConfig\",\n        \"aoss:GetSecurityPolicy\",\n        \"aoss:List*\",\n        \"appconfig:GetApplication\",\n        \"appconfig:GetConfigurationProfile\",\n        \"appconfig:GetEnvironment\",\n        \"appconfig:GetHostedConfigurationVersion\",\n        \"appconfig:List*\",\n        \"appflow:Describe*\",\n        \"appflow:List*\",\n        \"application-autoscaling:Describe*\",\n        \"application-signals:BatchGetServiceLevelObjectiveBudgetReport\",\n        \"application-signals:GetService\",\n        \"application-signals:GetServiceLevelObjective\",\n        \"application-signals:List*\",\n        \"applicationinsights:Describe*\",\n        \"applicationinsights:List*\",\n        \"apprunner:Describe*\",\n        \"apprunner:List*\",\n        \"appstream:Describe*\",\n        \"appstream:List*\",\n        \"appsync:GetApiAssociation\",\n        \"appsync:GetDataSource\",\n        \"appsync:GetDomainName\",\n        \"appsync:GetFunction\",\n        \"appsync:GetGraphqlApi\",\n        \"appsync:GetGraphqlApiEnvironmentVariables\",\n        \"appsync:GetIntrospectionSchema\",\n        \"appsync:GetResolver\",\n        \"appsync:GetSourceApiAssociation\",\n        \"appsync:List*\",\n        \"aps:Describe*\",\n        \"aps:List*\",\n        \"arc-zonal-shift:GetManagedResource\",\n        \"arc-zonal-shift:List*\",\n        \"athena:GetCapacityAssignmentConfiguration\",\n        \"athena:GetCapacityReservation\",\n        \"athena:GetDataCatalog\",\n        \"athena:GetNamedQuery\",\n        \"athena:GetPreparedStatement\",\n        \"athena:GetWorkGroup\",\n        \"athena:List*\",\n        \"auditmanager:GetAssessment\",\n        \"auditmanager:List*\",\n        \"autoscaling:Describe*\",\n        \"backup-gateway:GetHypervisor\",\n        \"backup-gateway:List*\",\n        \"backup:Describe*\",\n        \"backup:GetBackupPlan\",\n        \"backup:GetBackupSelection\",\n        \"backup:GetBackupVaultAccessPolicy\",\n        \"backup:GetBackupVaultNotifications\",\n        \"backup:GetRestoreTestingPlan\",\n        \"backup:GetRestoreTestingSelection\",\n        \"backup:List*\",\n        \"batch:DescribeComputeEnvironments\",\n        \"batch:DescribeJobQueues\",\n        \"batch:DescribeSchedulingPolicies\",\n        \"batch:List*\",\n        \"bedrock:GetAgent\",\n        \"bedrock:GetAgentActionGroup\",\n        \"bedrock:GetAgentAlias\",\n        \"bedrock:GetAgentKnowledgeBase\",\n        \"bedrock:GetDataSource\",\n        \"bedrock:GetGuardrail\",\n        \"bedrock:GetKnowledgeBase\",\n        \"bedrock:List*\",\n        \"budgets:Describe*\",\n        \"budgets:List*\",\n        \"ce:Describe*\",\n        \"ce:GetAnomalyMonitors\",\n        \"ce:GetAnomalySubscriptions\",\n        \"ce:List*\",\n        \"chatbot:Describe*\",\n        \"chatbot:GetMicrosoftTeamsChannelConfiguration\",\n        \"chatbot:List*\",\n        \"cleanrooms-ml:GetTrainingDataset\",\n        \"cleanrooms-ml:List*\",\n        \"cleanrooms:GetAnalysisTemplate\",\n        \"cleanrooms:GetCollaboration\",\n        \"cleanrooms:GetConfiguredTable\",\n        \"cleanrooms:GetConfiguredTableAnalysisRule\",\n        \"cleanrooms:GetConfiguredTableAssociation\",\n        \"cleanrooms:GetMembership\",\n        \"cleanrooms:List*\",\n        \"cloudformation:Describe*\",\n        \"cloudformation:GetResource\",\n        \"cloudformation:GetStackPolicy\",\n        \"cloudformation:GetTemplate\",\n        \"cloudformation:List*\",\n        \"cloudfront:Describe*\",\n        \"cloudfront:GetCachePolicy\",\n        \"cloudfront:GetCloudFrontOriginAccessIdentity\",\n        \"cloudfront:GetContinuousDeploymentPolicy\",\n        \"cloudfront:GetDistribution\",\n        \"cloudfront:GetDistributionConfig\",\n        \"cloudfront:GetFunction\",\n        \"cloudfront:GetKeyGroup\",\n        \"cloudfront:GetMonitoringSubscription\",\n        \"cloudfront:GetOriginAccessControl\",\n        \"cloudfront:GetOriginRequestPolicy\",\n        \"cloudfront:GetPublicKey\",\n        \"cloudfront:GetRealtimeLogConfig\",\n        \"cloudfront:GetResponseHeadersPolicy\",\n        \"cloudfront:List*\",\n        \"cloudtrail:Describe*\",\n        \"cloudtrail:GetChannel\",\n        \"cloudtrail:GetEventConfiguration\",\n        \"cloudtrail:GetEventDataStore\",\n        \"cloudtrail:GetEventSelectors\",\n        \"cloudtrail:GetInsightSelectors\",\n        \"cloudtrail:GetQueryResults\",\n        \"cloudtrail:GetResourcePolicy\",\n        \"cloudtrail:GetTrail\",\n        \"cloudtrail:GetTrailStatus\",\n        \"cloudtrail:List*\",\n        \"cloudtrail:LookupEvents\",\n        \"cloudtrail:StartQuery\",\n        \"cloudwatch:Describe*\",\n        \"cloudwatch:GenerateQuery\",\n        \"cloudwatch:GetDashboard\",\n        \"cloudwatch:GetInsightRuleReport\",\n        \"cloudwatch:GetMetricData\",\n        \"cloudwatch:GetMetricStatistics\",\n        \"cloudwatch:GetMetricStream\",\n        \"cloudwatch:GetService\",\n        \"cloudwatch:GetServiceLevelObjective\",\n        \"cloudwatch:List*\",\n        \"codeartifact:Describe*\",\n        \"codeartifact:GetDomainPermissionsPolicy\",\n        \"codeartifact:GetRepositoryPermissionsPolicy\",\n        \"codeartifact:List*\",\n        \"codebuild:BatchGetFleets\",\n        \"codebuild:List*\",\n        \"codecommit:GetRepository\",\n        \"codecommit:GetRepositoryTriggers\",\n        \"codedeploy:BatchGetDeployments\",\n        \"codedeploy:BatchGetDeploymentTargets\",\n        \"codedeploy:GetApplication\",\n        \"codedeploy:GetDeploymentConfig\",\n        \"codedeploy:List*\",\n        \"codeguru-profiler:Describe*\",\n        \"codeguru-profiler:GetNotificationConfiguration\",\n        \"codeguru-profiler:GetPolicy\",\n        \"codeguru-profiler:List*\",\n        \"codeguru-reviewer:Describe*\",\n        \"codeguru-reviewer:List*\",\n        \"codepipeline:GetPipeline\",\n        \"codepipeline:GetPipelineState\",\n        \"codepipeline:List*\",\n        \"codestar-connections:GetConnection\",\n        \"codestar-connections:GetRepositoryLink\",\n        \"codestar-connections:GetSyncConfiguration\",\n        \"codestar-connections:List*\",\n        \"codestar-notifications:Describe*\",\n        \"codestar-notifications:List*\",\n        \"cognito-identity:DescribeIdentityPool\",\n        \"cognito-identity:GetIdentityPoolRoles\",\n        \"cognito-identity:ListIdentityPools\",\n        \"cognito-identity:ListTagsForResource\",\n        \"cognito-idp:AdminListGroupsForUser\",\n        \"cognito-idp:DescribeIdentityProvider\",\n        \"cognito-idp:DescribeResourceServer\",\n        \"cognito-idp:DescribeRiskConfiguration\",\n        \"cognito-idp:DescribeUserImportJob\",\n        \"cognito-idp:DescribeUserPool\",\n        \"cognito-idp:DescribeUserPoolDomain\",\n        \"cognito-idp:GetGroup\",\n        \"cognito-idp:GetLogDeliveryConfiguration\",\n        \"cognito-idp:GetUICustomization\",\n        \"cognito-idp:GetUserPoolMfaConfig\",\n        \"cognito-idp:GetWebACLForResource\",\n        \"cognito-idp:ListGroups\",\n        \"cognito-idp:ListIdentityProviders\",\n        \"cognito-idp:ListResourceServers\",\n        \"cognito-idp:ListUserPoolClients\",\n        \"cognito-idp:ListUserPools\",\n        \"cognito-idp:ListUsers\",\n        \"cognito-idp:ListTagsForResource\",\n        \"comprehend:Describe*\",\n        \"comprehend:List*\",\n        \"config:Describe*\",\n        \"config:GetStoredQuery\",\n        \"config:List*\",\n        \"connect:Describe*\",\n        \"connect:GetTaskTemplate\",\n        \"connect:List*\",\n        \"databrew:Describe*\",\n        \"databrew:List*\",\n        \"datapipeline:Describe*\",\n        \"datapipeline:GetPipelineDefinition\",\n        \"datapipeline:List*\",\n        \"datasync:Describe*\",\n        \"datasync:List*\",\n        \"deadline:GetFarm\",\n        \"deadline:GetFleet\",\n        \"deadline:GetLicenseEndpoint\",\n        \"deadline:GetMonitor\",\n        \"deadline:GetQueue\",\n        \"deadline:GetQueueEnvironment\",\n        \"deadline:GetQueueFleetAssociation\",\n        \"deadline:GetStorageProfile\",\n        \"deadline:List*\",\n        \"detective:GetMembers\",\n        \"detective:List*\",\n        \"devicefarm:GetDevicePool\",\n        \"devicefarm:GetInstanceProfile\",\n        \"devicefarm:GetNetworkProfile\",\n        \"devicefarm:GetProject\",\n        \"devicefarm:GetTestGridProject\",\n        \"devicefarm:GetVPCEConfiguration\",\n        \"devicefarm:List*\",\n        \"devops-guru:Describe*\",\n        \"devops-guru:GetResourceCollection\",\n        \"devops-guru:List*\",\n        \"dms:Describe*\",\n        \"dms:List*\",\n        \"ds:Describe*\",\n        \"dynamodb:Describe*\",\n        \"dynamodb:GetResourcePolicy\",\n        \"dynamodb:List*\",\n        \"ec2:Describe*\",\n        \"ec2:GetAssociatedEnclaveCertificateIamRoles\",\n        \"ec2:GetIpamPoolAllocations\",\n        \"ec2:GetIpamPoolCidrs\",\n        \"ec2:GetManagedPrefixListEntries\",\n        \"ec2:GetNetworkInsightsAccessScopeContent\",\n        \"ec2:GetSnapshotBlockPublicAccessState\",\n        \"ec2:GetTransitGatewayMulticastDomainAssociations\",\n        \"ec2:GetTransitGatewayRouteTableAssociations\",\n        \"ec2:GetTransitGatewayRouteTablePropagations\",\n        \"ec2:GetVerifiedAccessEndpointPolicy\",\n        \"ec2:GetVerifiedAccessGroupPolicy\",\n        \"ec2:GetVerifiedAccessInstanceWebAcl\",\n        \"ec2:SearchLocalGatewayRoutes\",\n        \"ec2:SearchTransitGatewayRoutes\",\n        \"ecr:Describe*\",\n        \"ecr:GetLifecyclePolicy\",\n        \"ecr:GetRegistryPolicy\",\n        \"ecr:GetRepositoryPolicy\",\n        \"ecr:List*\",\n        \"ecs:Describe*\",\n        \"ecs:List*\",\n        \"eks:Describe*\",\n        \"eks:List*\",\n        \"elasticache:Describe*\",\n        \"elasticache:List*\",\n        \"elasticbeanstalk:Describe*\",\n        \"elasticbeanstalk:List*\",\n        \"elasticfilesystem:Describe*\",\n        \"elasticloadbalancing:GetResourcePolicy\",\n        \"elasticloadbalancing:GetTrustStoreCaCertificatesBundle\",\n        \"elasticloadbalancing:GetTrustStoreRevocationContent\",\n        \"elasticloadbalancing:Describe*\",\n        \"elasticmapreduce:Describe*\",\n        \"elasticmapreduce:List*\",\n        \"emr-containers:Describe*\",\n        \"emr-containers:List*\",\n        \"emr-serverless:GetApplication\",\n        \"emr-serverless:List*\",\n        \"es:Describe*\",\n        \"es:List*\",\n        \"events:Describe*\",\n        \"events:List*\",\n        \"evidently:GetExperiment\",\n        \"evidently:GetFeature\",\n        \"evidently:GetLaunch\",\n        \"evidently:GetProject\",\n        \"evidently:GetSegment\",\n        \"evidently:List*\",\n        \"firehose:Describe*\",\n        \"firehose:List*\",\n        \"fis:GetExperimentTemplate\",\n        \"fis:GetTargetAccountConfiguration\",\n        \"fis:List*\",\n        \"fms:GetNotificationChannel\",\n        \"fms:GetPolicy\",\n        \"fms:List*\",\n        \"forecast:Describe*\",\n        \"forecast:List*\",\n        \"frauddetector:BatchGetVariable\",\n        \"frauddetector:Describe*\",\n        \"frauddetector:GetDetectors\",\n        \"frauddetector:GetDetectorVersion\",\n        \"frauddetector:GetEntityTypes\",\n        \"frauddetector:GetEventTypes\",\n        \"frauddetector:GetExternalModels\",\n        \"frauddetector:GetLabels\",\n        \"frauddetector:GetListElements\",\n        \"frauddetector:GetListsMetadata\",\n        \"frauddetector:GetModelVersion\",\n        \"frauddetector:GetOutcomes\",\n        \"frauddetector:GetRules\",\n        \"frauddetector:GetVariables\",\n        \"frauddetector:List*\",\n        \"fsx:Describe*\",\n        \"gamelift:Describe*\",\n        \"gamelift:List*\",\n        \"globalaccelerator:Describe*\",\n        \"globalaccelerator:List*\",\n        \"glue:GetDatabase\",\n        \"glue:GetDatabases\",\n        \"glue:GetJob\",\n        \"glue:GetRegistry\",\n        \"glue:GetSchema\",\n        \"glue:GetSchemaVersion\",\n        \"glue:GetTable\",\n        \"glue:GetTags\",\n        \"glue:GetTrigger\",\n        \"glue:List*\",\n        \"glue:querySchemaVersionMetadata\",\n        \"grafana:Describe*\",\n        \"grafana:List*\",\n        \"greengrass:Describe*\",\n        \"greengrass:GetDeployment\",\n        \"greengrass:List*\",\n        \"groundstation:GetConfig\",\n        \"groundstation:GetDataflowEndpointGroup\",\n        \"groundstation:GetMissionProfile\",\n        \"groundstation:List*\",\n        \"guardduty:GetDetector\",\n        \"guardduty:GetFilter\",\n        \"guardduty:GetIPSet\",\n        \"guardduty:GetMalwareProtectionPlan\",\n        \"guardduty:GetMasterAccount\",\n        \"guardduty:GetMembers\",\n        \"guardduty:GetThreatIntelSet\",\n        \"guardduty:List*\",\n        \"health:DescribeEvents\",\n        \"health:DescribeEventDetails\",\n        \"healthlake:Describe*\",\n        \"healthlake:List*\",\n        \"iam:GetGroup\",\n        \"iam:GetGroupPolicy\",\n        \"iam:GetInstanceProfile\",\n        \"iam:GetLoginProfile\",\n        \"iam:GetOpenIDConnectProvider\",\n        \"iam:GetPolicy\",\n        \"iam:GetPolicyVersion\",\n        \"iam:GetRole\",\n        \"iam:GetRolePolicy\",\n        \"iam:GetSAMLProvider\",\n        \"iam:GetServerCertificate\",\n        \"iam:GetServiceLinkedRoleDeletionStatus\",\n        \"iam:GetUser\",\n        \"iam:GetUserPolicy\",\n        \"iam:ListAttachedRolePolicies\",\n        \"iam:ListOpenIDConnectProviders\",\n        \"iam:ListRolePolicies\",\n        \"iam:ListRoles\",\n        \"iam:ListServerCertificates\",\n        \"iam:ListVirtualMFADevices\",\n        \"identitystore:DescribeGroup\",\n        \"identitystore:DescribeGroupMembership\",\n        \"identitystore:ListGroupMemberships\",\n        \"identitystore:ListGroups\",\n        \"imagebuilder:GetComponent\",\n        \"imagebuilder:GetContainerRecipe\",\n        \"imagebuilder:GetDistributionConfiguration\",\n        \"imagebuilder:GetImage\",\n        \"imagebuilder:GetImagePipeline\",\n        \"imagebuilder:GetImageRecipe\",\n        \"imagebuilder:GetInfrastructureConfiguration\",\n        \"imagebuilder:GetLifecyclePolicy\",\n        \"imagebuilder:GetWorkflow\",\n        \"imagebuilder:List*\",\n        \"inspector2:List*\",\n        \"inspector:Describe*\",\n        \"inspector:List*\",\n        \"internetmonitor:GetMonitor\",\n        \"internetmonitor:List*\",\n        \"iot:Describe*\",\n        \"iot:GetPackage\",\n        \"iot:GetPackageVersion\",\n        \"iot:GetPolicy\",\n        \"iot:GetThingShadow\",\n        \"iot:GetTopicRule\",\n        \"iot:GetTopicRuleDestination\",\n        \"iot:GetV2LoggingOptions\",\n        \"iot:List*\",\n        \"iotanalytics:Describe*\",\n        \"iotanalytics:List*\",\n        \"iotevents:Describe*\",\n        \"iotevents:List*\",\n        \"iotfleethub:Describe*\",\n        \"iotfleethub:List*\",\n        \"iotsitewise:Describe*\",\n        \"iotsitewise:List*\",\n        \"iotwireless:GetDestination\",\n        \"iotwireless:GetDeviceProfile\",\n        \"iotwireless:GetFuotaTask\",\n        \"iotwireless:GetMulticastGroup\",\n        \"iotwireless:GetNetworkAnalyzerConfiguration\",\n        \"iotwireless:GetServiceProfile\",\n        \"iotwireless:GetWirelessDevice\",\n        \"iotwireless:GetWirelessGateway\",\n        \"iotwireless:GetWirelessGatewayTaskDefinition\",\n        \"iotwireless:List*\",\n        \"ivs:GetChannel\",\n        \"ivs:GetEncoderConfiguration\",\n        \"ivs:GetPlaybackRestrictionPolicy\",\n        \"ivs:GetRecordingConfiguration\",\n        \"ivs:GetStage\",\n        \"ivs:List*\",\n        \"ivschat:GetLoggingConfiguration\",\n        \"ivschat:GetRoom\",\n        \"ivschat:List*\",\n        \"kafka:Describe*\",\n        \"kafka:GetClusterPolicy\",\n        \"kafka:List*\",\n        \"kafkaconnect:Describe*\",\n        \"kafkaconnect:List*\",\n        \"kendra:Describe*\",\n        \"kendra:List*\",\n        \"kinesis:Describe*\",\n        \"kinesis:GetResourcePolicy\",\n        \"kinesis:List*\",\n        \"kinesisanalytics:Describe*\",\n        \"kinesisanalytics:List*\",\n        \"kinesisvideo:Describe*\",\n        \"kms:DescribeKey\",\n        \"kms:ListResourceTags\",\n        \"kms:ListKeys\",\n        \"kms:GetKeyPolicy\",\n        \"kms:GetKeyRotationStatus\",\n        \"kms:ListAliases\",\n        \"kms:ListKeyRotations\",\n        \"lakeformation:Describe*\",\n        \"lakeformation:GetLFTag\",\n        \"lakeformation:GetResourceLFTags\",\n        \"lakeformation:List*\",\n        \"lambda:GetAlias\",\n        \"lambda:GetCodeSigningConfig\",\n        \"lambda:GetEventSourceMapping\",\n        \"lambda:GetFunction\",\n        \"lambda:GetFunctionCodeSigningConfig\",\n        \"lambda:GetFunctionConfiguration\",\n        \"lambda:GetFunctionEventInvokeConfig\",\n        \"lambda:GetFunctionRecursionConfig\",\n        \"lambda:GetFunctionUrlConfig\",\n        \"lambda:GetLayerVersion\",\n        \"lambda:GetLayerVersionPolicy\",\n        \"lambda:GetPolicy\",\n        \"lambda:GetProvisionedConcurrencyConfig\",\n        \"lambda:GetRuntimeManagementConfig\",\n        \"lambda:List*\",\n        \"launchwizard:GetDeployment\",\n        \"launchwizard:List*\",\n        \"lex:Describe*\",\n        \"lex:List*\",\n        \"license-manager:GetLicense\",\n        \"license-manager:List*\",\n        \"lightsail:GetAlarms\",\n        \"lightsail:GetBuckets\",\n        \"lightsail:GetCertificates\",\n        \"lightsail:GetContainerServices\",\n        \"lightsail:GetDisk\",\n        \"lightsail:GetDisks\",\n        \"lightsail:GetInstance\",\n        \"lightsail:GetInstances\",\n        \"lightsail:GetLoadBalancer\",\n        \"lightsail:GetLoadBalancers\",\n        \"lightsail:GetLoadBalancerTlsCertificates\",\n        \"lightsail:GetStaticIp\",\n        \"lightsail:GetStaticIps\",\n        \"logs:Describe*\",\n        \"logs:FilterLogEvents\",\n        \"logs:GetDataProtectionPolicy\",\n        \"logs:GetDelivery\",\n        \"logs:GetDeliveryDestination\",\n        \"logs:GetDeliveryDestinationPolicy\",\n        \"logs:GetDeliverySource\",\n        \"logs:GetLogAnomalyDetector\",\n        \"logs:GetLogDelivery\",\n        \"logs:GetLogGroupFields\",\n        \"logs:GetQueryResults\",\n        \"logs:List*\",\n        \"logs:StartQuery\",\n        \"logs:StopLiveTail\",\n        \"logs:StopQuery\",\n        \"logs:TestMetricFilter\",\n        \"lookoutmetrics:Describe*\",\n        \"lookoutmetrics:List*\",\n        \"lookoutvision:Describe*\",\n        \"lookoutvision:List*\",\n        \"m2:GetApplication\",\n        \"m2:GetEnvironment\",\n        \"m2:List*\",\n        \"macie2:GetAllowList\",\n        \"macie2:GetCustomDataIdentifier\",\n        \"macie2:GetFindingsFilter\",\n        \"macie2:GetMacieSession\",\n        \"macie2:List*\",\n        \"mediaconnect:Describe*\",\n        \"mediaconnect:List*\",\n        \"medialive:Describe*\",\n        \"medialive:GetCloudWatchAlarmTemplate\",\n        \"medialive:GetCloudWatchAlarmTemplateGroup\",\n        \"medialive:GetEventBridgeRuleTemplate\",\n        \"medialive:GetEventBridgeRuleTemplateGroup\",\n        \"medialive:GetSignalMap\",\n        \"medialive:List*\",\n        \"mediapackage-vod:Describe*\",\n        \"mediapackage-vod:List*\",\n        \"mediapackage:Describe*\",\n        \"mediapackage:List*\",\n        \"mediapackagev2:GetChannel\",\n        \"mediapackagev2:GetChannelGroup\",\n        \"mediapackagev2:GetChannelPolicy\",\n        \"mediapackagev2:GetOriginEndpoint\",\n        \"mediapackagev2:GetOriginEndpointPolicy\",\n        \"mediapackagev2:List*\",\n        \"memorydb:Describe*\",\n        \"memorydb:List*\",\n        \"mobiletargeting:GetInAppTemplate\",\n        \"mobiletargeting:List*\",\n        \"mq:Describe*\",\n        \"mq:List*\",\n        \"network-firewall:Describe*\",\n        \"network-firewall:List*\",\n        \"networkmanager:Describe*\",\n        \"networkmanager:GetConnectAttachment\",\n        \"networkmanager:GetConnectPeer\",\n        \"networkmanager:GetCoreNetwork\",\n        \"networkmanager:GetCoreNetworkPolicy\",\n        \"networkmanager:GetCustomerGatewayAssociations\",\n        \"networkmanager:GetDevices\",\n        \"networkmanager:GetLinkAssociations\",\n        \"networkmanager:GetLinks\",\n        \"networkmanager:GetSites\",\n        \"networkmanager:GetSiteToSiteVpnAttachment\",\n        \"networkmanager:GetTransitGatewayPeering\",\n        \"networkmanager:GetTransitGatewayRegistrations\",\n        \"networkmanager:GetTransitGatewayRouteTableAttachment\",\n        \"networkmanager:GetVpcAttachment\",\n        \"networkmanager:List*\",\n        \"nimble:GetLaunchProfile\",\n        \"nimble:GetStreamingImage\",\n        \"nimble:GetStudio\",\n        \"nimble:GetStudioComponent\",\n        \"nimble:List*\",\n        \"oam:GetLink\",\n        \"oam:GetSink\",\n        \"oam:GetSinkPolicy\",\n        \"oam:List*\",\n        \"omics:GetAnnotationStore\",\n        \"omics:GetReferenceStore\",\n        \"omics:GetRunGroup\",\n        \"omics:GetSequenceStore\",\n        \"omics:GetVariantStore\",\n        \"omics:GetWorkflow\",\n        \"omics:List*\",\n        \"opsworks-cm:Describe*\",\n        \"opsworks-cm:List*\",\n        \"organizations:Describe*\",\n        \"organizations:List*\",\n        \"osis:GetPipeline\",\n        \"osis:List*\",\n        \"payment-cryptography:GetAlias\",\n        \"payment-cryptography:GetKey\",\n        \"payment-cryptography:List*\",\n        \"pca-connector-ad:GetConnector\",\n        \"pca-connector-ad:GetDirectoryRegistration\",\n        \"pca-connector-ad:GetServicePrincipalName\",\n        \"pca-connector-ad:GetTemplate\",\n        \"pca-connector-ad:GetTemplateGroupAccessControlEntry\",\n        \"pca-connector-ad:List*\",\n        \"pca-connector-scep:GetChallengeMetadata\",\n        \"pca-connector-scep:GetConnector\",\n        \"pca-connector-scep:List*\",\n        \"personalize:Describe*\",\n        \"personalize:List*\",\n        \"pi:GetResourceMetadata\",\n        \"pi:GetResourceMetrics\",\n        \"pi:ListAvailableResourceDimensions\",\n        \"pi:ListAvailableResourceMetrics\",\n        \"pipes:Describe*\",\n        \"pipes:List*\",\n        \"proton:GetEnvironmentTemplate\",\n        \"proton:GetServiceTemplate\",\n        \"proton:List*\",\n        \"qbusiness:GetApplication\",\n        \"qbusiness:GetDataSource\",\n        \"qbusiness:GetIndex\",\n        \"qbusiness:GetPlugin\",\n        \"qbusiness:GetRetriever\",\n        \"qbusiness:GetWebExperience\",\n        \"qbusiness:List*\",\n        \"qldb:Describe*\",\n        \"qldb:List*\",\n        \"ram:GetPermission\",\n        \"ram:List*\",\n        \"rds:Describe*\",\n        \"rds:List*\",\n        \"redshift-serverless:GetNamespace\",\n        \"redshift-serverless:GetWorkgroup\",\n        \"redshift-serverless:List*\",\n        \"redshift:Describe*\",\n        \"refactor-spaces:GetApplication\",\n        \"refactor-spaces:GetEnvironment\",\n        \"refactor-spaces:GetRoute\",\n        \"refactor-spaces:List*\",\n        \"rekognition:Describe*\",\n        \"rekognition:List*\",\n        \"resiliencehub:Describe*\",\n        \"resiliencehub:List*\",\n        \"resource-explorer-2:GetDefaultView\",\n        \"resource-explorer-2:GetIndex\",\n        \"resource-explorer-2:GetView\",\n        \"resource-explorer-2:List*\",\n        \"resource-groups:GetGroup\",\n        \"resource-groups:GetGroupConfiguration\",\n        \"resource-groups:GetGroupQuery\",\n        \"resource-groups:GetTags\",\n        \"resource-groups:List*\",\n        \"robomaker:Describe*\",\n        \"robomaker:List*\",\n        \"route53-recovery-control-config:Describe*\",\n        \"route53-recovery-control-config:List*\",\n        \"route53-recovery-readiness:GetCell\",\n        \"route53-recovery-readiness:GetReadinessCheck\",\n        \"route53-recovery-readiness:GetRecoveryGroup\",\n        \"route53-recovery-readiness:GetResourceSet\",\n        \"route53-recovery-readiness:List*\",\n        \"route53:GetDNSSEC\",\n        \"route53:GetHealthCheck\",\n        \"route53:GetHostedZone\",\n        \"route53:List*\",\n        \"route53profiles:GetProfile\",\n        \"route53profiles:GetProfileAssociation\",\n        \"route53profiles:GetProfileResourceAssociation\",\n        \"route53profiles:List*\",\n        \"route53resolver:GetFirewallDomainList\",\n        \"route53resolver:GetFirewallRuleGroup\",\n        \"route53resolver:GetFirewallRuleGroupAssociation\",\n        \"route53resolver:GetOutpostResolver\",\n        \"route53resolver:GetResolverConfig\",\n        \"route53resolver:GetResolverQueryLogConfig\",\n        \"route53resolver:GetResolverQueryLogConfigAssociation\",\n        \"route53resolver:GetResolverRule\",\n        \"route53resolver:GetResolverRuleAssociation\",\n        \"route53resolver:List*\",\n        \"rum:GetAppMonitor\",\n        \"rum:List*\",\n        \"s3-outposts:GetAccessPoint\",\n        \"s3-outposts:GetAccessPointPolicy\",\n        \"s3-outposts:GetBucket\",\n        \"s3-outposts:GetBucketPolicy\",\n        \"s3-outposts:GetBucketTagging\",\n        \"s3-outposts:GetLifecycleConfiguration\",\n        \"s3-outposts:List*\",\n        \"s3:GetAccelerateConfiguration\",\n        \"s3:GetAccessGrant\",\n        \"s3:GetAccessGrantsInstance\",\n        \"s3:GetAccessGrantsLocation\",\n        \"s3:GetAccessPoint\",\n        \"s3:GetAccessPointConfigurationForObjectLambda\",\n        \"s3:GetAccessPointForObjectLambda\",\n        \"s3:GetAccessPointPolicy\",\n        \"s3:GetAccessPointPolicyForObjectLambda\",\n        \"s3:GetAccessPointPolicyStatusForObjectLambda\",\n        \"s3:GetAnalyticsConfiguration\",\n        \"s3:GetBucketAbac\",\n        \"s3:GetBucketAcl\",\n        \"s3:GetBucketCORS\",\n        \"s3:GetBucketLocation\",\n        \"s3:GetBucketLogging\",\n        \"s3:GetBucketMetadataTableConfiguration\",\n        \"s3:GetBucketNotification\",\n        \"s3:GetBucketObjectLockConfiguration\",\n        \"s3:GetBucketOwnershipControls\",\n        \"s3:GetBucketPolicy\",\n        \"s3:GetBucketPublicAccessBlock\",\n        \"s3:GetBucketTagging\",\n        \"s3:GetBucketVersioning\",\n        \"S3:GetBucketWebsite\",\n        \"s3:GetEncryptionConfiguration\",\n        \"s3:GetIntelligentTieringConfiguration\",\n        \"s3:GetInventoryConfiguration\",\n        \"s3:GetLifecycleConfiguration\",\n        \"s3:GetMetricsConfiguration\",\n        \"s3:GetMultiRegionAccessPoint\",\n        \"s3:GetMultiRegionAccessPointPolicy\",\n        \"s3:GetMultiRegionAccessPointPolicyStatus\",\n        \"s3:GetReplicationConfiguration\",\n        \"s3:GetStorageLensConfiguration\",\n        \"s3:GetStorageLensConfigurationTagging\",\n        \"s3:GetStorageLensGroup\",\n        \"s3:List*\",\n        \"sagemaker:Describe*\",\n        \"sagemaker:List*\",\n        \"scheduler:GetSchedule\",\n        \"scheduler:GetScheduleGroup\",\n        \"scheduler:List*\",\n        \"schemas:Describe*\",\n        \"schemas:GetResourcePolicy\",\n        \"schemas:List*\",\n        \"secretsmanager:Describe*\",\n        \"secretsmanager:GetResourcePolicy\",\n        \"secretsmanager:List*\",\n        \"securityhub:BatchGetAutomationRules\",\n        \"securityhub:BatchGetSecurityControls\",\n        \"securityhub:Describe*\",\n        \"securityhub:GetConfigurationPolicy\",\n        \"securityhub:GetConfigurationPolicyAssociation\",\n        \"securityhub:GetEnabledStandards\",\n        \"securityhub:GetFindingAggregator\",\n        \"securityhub:GetInsights\",\n        \"securityhub:List*\",\n        \"securitylake:GetSubscriber\",\n        \"securitylake:List*\",\n        \"servicecatalog:Describe*\",\n        \"servicecatalog:GetApplication\",\n        \"servicecatalog:GetAttributeGroup\",\n        \"servicecatalog:List*\",\n        \"servicequotas:GetServiceQuota\",\n        \"ses:Describe*\",\n        \"ses:GetAccount\",\n        \"ses:GetAddonInstance\",\n        \"ses:GetAddonSubscription\",\n        \"ses:GetArchive\",\n        \"ses:GetConfigurationSet\",\n        \"ses:GetConfigurationSetEventDestinations\",\n        \"ses:GetContactList\",\n        \"ses:GetDedicatedIpPool\",\n        \"ses:GetDedicatedIps\",\n        \"ses:GetEmailIdentity\",\n        \"ses:GetEmailTemplate\",\n        \"ses:GetIngressPoint\",\n        \"ses:GetRelay\",\n        \"ses:GetRuleSet\",\n        \"ses:GetTemplate\",\n        \"ses:GetTrafficPolicy\",\n        \"ses:List*\",\n        \"shield:Describe*\",\n        \"shield:List*\",\n        \"signer:GetSigningProfile\",\n        \"signer:List*\",\n        \"sns:GetDataProtectionPolicy\",\n        \"sns:GetSubscriptionAttributes\",\n        \"sns:GetTopicAttributes\",\n        \"sns:List*\",\n        \"sqs:GetQueueAttributes\",\n        \"sqs:GetQueueUrl\",\n        \"sqs:List*\",\n        \"ssm-contacts:GetContact\",\n        \"ssm-contacts:GetContactChannel\",\n        \"ssm-contacts:List*\",\n        \"ssm-incidents:GetReplicationSet\",\n        \"ssm-incidents:GetResponsePlan\",\n        \"ssm-incidents:List*\",\n        \"ssm-sap:GetApplication\",\n        \"ssm-sap:List*\",\n        \"ssm:Describe*\",\n        \"ssm:GetDefaultPatchBaseline\",\n        \"ssm:GetDocument\",\n        \"ssm:GetParameters\",\n        \"ssm:GetPatchBaseline\",\n        \"ssm:GetResourcePolicies\",\n        \"ssm:List*\",\n        \"sso-directory:SearchGroups\",\n        \"sso-directory:SearchUsers\",\n        \"sso:GetInlinePolicyForPermissionSet\",\n        \"sso:GetManagedApplicationInstance\",\n        \"sso:GetPermissionsBoundaryForPermissionSet\",\n        \"sso:GetSharedSsoConfiguration\",\n        \"sso:ListAccountAssignments\",\n        \"sso:ListApplicationAssignments\",\n        \"sso:ListApplications\",\n        \"sso:ListCustomerManagedPolicyReferencesInPermissionSet\",\n        \"sso:ListInstances\",\n        \"sso:ListManagedPoliciesInPermissionSet\",\n        \"sso:ListTagsForResource\",\n        \"states:GetExecutionHistory\",\n        \"states:Describe*\",\n        \"states:List*\",\n        \"synthetics:Describe*\",\n        \"synthetics:GetCanary\",\n        \"synthetics:GetGroup\",\n        \"synthetics:List*\",\n        \"tag:GetResources\",\n        \"timestream:Describe*\",\n        \"timestream:List*\",\n        \"transfer:Describe*\",\n        \"transfer:List*\",\n        \"verifiedpermissions:GetIdentitySource\",\n        \"verifiedpermissions:GetPolicy\",\n        \"verifiedpermissions:GetPolicyStore\",\n        \"verifiedpermissions:GetPolicyTemplate\",\n        \"verifiedpermissions:GetSchema\",\n        \"verifiedpermissions:List*\",\n        \"vpc-lattice:GetAccessLogSubscription\",\n        \"vpc-lattice:GetAuthPolicy\",\n        \"vpc-lattice:GetListener\",\n        \"vpc-lattice:GetResourcePolicy\",\n        \"vpc-lattice:GetRule\",\n        \"vpc-lattice:GetService\",\n        \"vpc-lattice:GetServiceNetwork\",\n        \"vpc-lattice:GetServiceNetworkServiceAssociation\",\n        \"vpc-lattice:GetServiceNetworkVpcAssociation\",\n        \"vpc-lattice:GetTargetGroup\",\n        \"vpc-lattice:List*\",\n        \"wafv2:GetIPSet\",\n        \"wafv2:GetLoggingConfiguration\",\n        \"wafv2:GetRegexPatternSet\",\n        \"wafv2:GetRuleGroup\",\n        \"wafv2:GetWebACL\",\n        \"wafv2:GetWebACLForResource\",\n        \"wafv2:List*\",\n        \"workspaces-web:GetBrowserSettings\",\n        \"workspaces-web:GetIdentityProvider\",\n        \"workspaces-web:GetNetworkSettings\",\n        \"workspaces-web:GetPortal\",\n        \"workspaces-web:GetPortalServiceProviderMetadata\",\n        \"workspaces-web:GetTrustStore\",\n        \"workspaces-web:GetUserAccessLoggingSettings\",\n        \"workspaces-web:GetUserSettings\",\n        \"workspaces-web:List*\",\n        \"workspaces:Describe*\",\n        \"xray:BatchGetTraces\",\n        \"xray:GetGroup\",\n        \"xray:GetGroups\",\n        \"xray:GetSamplingRules\",\n        \"xray:GetServiceGraph\",\n        \"xray:GetTraceSummaries\",\n        \"xray:List*\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"AIOPSS3AccessForAmplify\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:GetObject\",\n        \"s3:GetObjectVersion\",\n        \"s3:GetObjectAcl\"\n      ],\n      \"Resource\": [\n        \"arn:aws:s3:::amplify\",\n        \"arn:aws:s3:::cdk--assets--*\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:ViaAWSService\": [\n            \"amplify.amazonaws.com\"\n          ],\n          \"aws:PrincipalAccount\": [\n            \"${aws:ResourceAccount}\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"AIOPSAPIGatewayAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"apigateway:GET\"\n      ],\n      \"Resource\": [\n        \"arn:aws:apigateway:*::/restapis\",\n        \"arn:aws:apigateway:*::/restapis/*\",\n        \"arn:aws:apigateway:*::/restapis/*/deployments\",\n        \"arn:aws:apigateway:*::/restapis/*/deployments/*\",\n        \"arn:aws:apigateway:*::/restapis/*/resources/*/methods/*/integrations\",\n        \"arn:aws:apigateway:*::/restapis/*/resources/*/methods/*/integrations/*\",\n        \"arn:aws:apigateway:*::/restapis/*/stages\",\n        \"arn:aws:apigateway:*::/restapis/*/stages/*\",\n        \"arn:aws:apigateway:*::/apis\",\n        \"arn:aws:apigateway:*::/apis/*\",\n        \"arn:aws:apigateway:*::/apis/*/deployments\",\n        \"arn:aws:apigateway:*::/apis/*/deployments/*\",\n        \"arn:aws:apigateway:*::/apis/*/integrations\",\n        \"arn:aws:apigateway:*::/apis/*/integrations/*\",\n        \"arn:aws:apigateway:*::/apis/*/stages\",\n        \"arn:aws:apigateway:*::/apis/*/stages/*\",\n        \"arn:aws:apigateway:*::/domainnames/*\"\n      ]\n    }\n  ]\n}", "id": "aws_managed_1289", "complexity": "complex", "services": ["access-analyzer", "acm", "acm-pca", "airflow", "amplify", "aoss", "apigateway", "appconfig", "appflow", "application-autoscaling", "application-signals", "applicationinsights", "apprunner", "appstream", "appsync", "aps", "arc-zonal-shift", "athena", "auditmanager", "autoscaling", "backup", "backup-gateway", "batch", "bedrock", "budgets", "ce", "chatbot", "cleanrooms", "cleanrooms-ml", "cloudformation", "cloudfront", "cloudtrail", "cloudwatch", "codeartifact", "codebuild", "codecommit", "codedeploy", "codeguru-profiler", "codeguru-reviewer", "codepipeline", "codestar-connections", "codestar-notifications", "cognito-identity", "cognito-idp", "comprehend", "config", "connect", "databrew", "datapipeline", "datasync", "deadline", "detective", "devicefarm", "devops-guru", "dms", "ds", "dynamodb", "ec2", "ecr", "ecs", "eks", "elasticache", "elasticbeanstalk", "elasticfilesystem", "elasticloadbalancing", "elasticmapreduce", "emr-containers", "emr-serverless", "es", "events", "evidently", "firehose", "fis", "fms", "forecast", "frauddetector", "fsx", "gamelift", "globalaccelerator", "glue", "grafana", "greengrass", "groundstation", "guardduty", "health", "healthlake", "iam", "identitystore", "imagebuilder", "inspector", "inspector2", "internetmonitor", "iot", "iotanalytics", "iotevents", "iotfleethub", "iotsitewise", "iotwireless", "ivs", "ivschat", "kafka", "kafkaconnect", "kendra", "kinesis", "kinesisanalytics", "kinesisvideo", "kms", "lakeformation", "lambda", "launchwizard", "lex", "license-manager", "lightsail", "logs", "lookoutmetrics", "lookoutvision", "m2", "macie2", "mediaconnect", "medialive", "mediapackage", "mediapackage-vod", "mediapackagev2", "memorydb", "mobiletargeting", "mq", "network-firewall", "networkmanager", "nimble", "oam", "omics", "opsworks-cm", "organizations", "osis", "payment-cryptography", "pca-connector-ad", "pca-connector-scep", "personalize", "pi", "pipes", "proton", "qbusiness", "qldb", "ram", "rds", "redshift", "redshift-serverless", "refactor-spaces", "rekognition", "resiliencehub", "resource-explorer-2", "resource-groups", "robomaker", "route53", "route53-recovery-control-config", "route53-recovery-readiness", "route53profiles", "route53resolver", "rum", "s3", "s3-outposts", "sagemaker", "scheduler", "schemas", "secretsmanager", "securityhub", "securitylake", "servicecatalog", "servicequotas", "ses", "shield", "signer", "sns", "sqs", "ssm", "ssm-contacts", "ssm-incidents", "ssm-sap", "sso", "sso-directory", "states", "synthetics", "tag", "timestream", "transfer", "verifiedpermissions", "vpc-lattice", "wafv2", "workspaces", "workspaces-web", "xray"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for Cloud Watch Full Access V2\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"CloudWatchFullAccessPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"application-autoscaling:DescribeScalingPolicies\",\n        \"application-signals:*\",\n        \"autoscaling:DescribeAutoScalingGroups\",\n        \"autoscaling:DescribePolicies\",\n        \"cloudwatch:*\",\n        \"logs:*\",\n        \"sns:CreateTopic\",\n        \"sns:ListSubscriptions\",\n        \"sns:ListSubscriptionsByTopic\",\n        \"sns:ListTopics\",\n        \"sns:Subscribe\",\n        \"iam:GetPolicy\",\n        \"iam:GetPolicyVersion\",\n        \"iam:GetRole\",\n        \"oam:ListSinks\",\n        \"observabilityadmin:GetCentralizationRuleForOrganization\",\n        \"observabilityadmin:ListCentralizationRulesForOrganization\",\n        \"observabilityadmin:CreateCentralizationRuleForOrganization\",\n        \"observabilityadmin:UpdateCentralizationRuleForOrganization\",\n        \"observabilityadmin:DeleteCentralizationRuleForOrganization\",\n        \"observabilityadmin:StartTelemetryEvaluation\",\n        \"observabilityadmin:GetTelemetryEvaluationStatus\",\n        \"observabilityadmin:ListResourceTelemetry\",\n        \"observabilityadmin:StopTelemetryEvaluation\",\n        \"observabilityadmin:StartTelemetryEvaluationForOrganization\",\n        \"observabilityadmin:GetTelemetryEvaluationStatusForOrganization\",\n        \"observabilityadmin:ListResourceTelemetryForOrganization\",\n        \"observabilityadmin:StopTelemetryEvaluationForOrganization\",\n        \"observabilityadmin:CreateTelemetryRule\",\n        \"observabilityadmin:GetTelemetryRule\",\n        \"observabilityadmin:ListTelemetryRules\",\n        \"observabilityadmin:UpdateTelemetryRule\",\n        \"observabilityadmin:DeleteTelemetryRule\",\n        \"observabilityadmin:CreateTelemetryRuleForOrganization\",\n        \"observabilityadmin:GetTelemetryRuleForOrganization\",\n        \"observabilityadmin:ListTelemetryRulesForOrganization\",\n        \"observabilityadmin:UpdateTelemetryRuleForOrganization\",\n        \"observabilityadmin:DeleteTelemetryRuleForOrganization\",\n        \"observabilityadmin:GetTelemetryEnrichmentStatus\",\n        \"observabilityadmin:StartTelemetryEnrichment\",\n        \"observabilityadmin:StopTelemetryEnrichment\",\n        \"observabilityadmin:TagResource\",\n        \"observabilityadmin:UntagResource\",\n        \"observabilityadmin:ListTagsForResource\",\n        \"observabilityadmin:CreateTelemetryPipeline\",\n        \"observabilityadmin:GetTelemetryPipeline\",\n        \"observabilityadmin:UpdateTelemetryPipeline\",\n        \"observabilityadmin:DeleteTelemetryPipeline\",\n        \"observabilityadmin:ListTelemetryPipelines\",\n        \"observabilityadmin:TestTelemetryPipeline\",\n        \"observabilityadmin:ValidateTelemetryPipelineConfiguration\",\n        \"observabilityadmin:CreateS3TableIntegration\",\n        \"observabilityadmin:GetS3TableIntegration\",\n        \"observabilityadmin:ListS3TableIntegrations\",\n        \"observabilityadmin:DeleteS3TableIntegration\",\n        \"rum:*\",\n        \"synthetics:*\",\n        \"xray:*\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"CloudWatchApplicationSignalsServiceLinkedRolePermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"iam:CreateServiceLinkedRole\",\n      \"Resource\": \"arn:aws:iam::*:role/aws-service-role/application-signals.cloudwatch.amazonaws.com/AWSServiceRoleForCloudWatchApplicationSignals\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"iam:AWSServiceName\": \"application-signals.cloudwatch.amazonaws.com\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"EventsServicePermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"iam:CreateServiceLinkedRole\",\n      \"Resource\": \"arn:aws:iam::*:role/aws-service-role/events.amazonaws.com/AWSServiceRoleForCloudWatchEvents*\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"iam:AWSServiceName\": \"events.amazonaws.com\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"OAMReadPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"oam:ListAttachedLinks\"\n      ],\n      \"Resource\": \"arn:aws:oam:*:*:sink/*\"\n    },\n    {\n      \"Sid\": \"CloudWatchCloudTrailPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"cloudtrail:CreateServiceLinkedChannel\",\n        \"cloudtrail:GetChannel\"\n      ],\n      \"Resource\": \"arn:aws:cloudtrail:*:*:channel/aws-service-channel/application-signals/*\"\n    },\n    {\n      \"Sid\": \"CloudWatchApplicationSignalsCloudTrailListPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"cloudtrail:ListChannels\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"CloudWatchServiceQuotaPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"servicequotas:GetServiceQuota\"\n      ],\n      \"Resource\": [\n        \"arn:aws:servicequotas:*:*:s3/*\",\n        \"arn:aws:servicequotas:*:*:dynamodb/*\",\n        \"arn:aws:servicequotas:*:*:kinesis/*\",\n        \"arn:aws:servicequotas:*:*:sns/*\",\n        \"arn:aws:servicequotas:*:*:bedrock/*\",\n        \"arn:aws:servicequotas:*:*:lambda/*\",\n        \"arn:aws:servicequotas:*:*:fargate/*\",\n        \"arn:aws:servicequotas:*:*:elasticloadbalancing/*\",\n        \"arn:aws:servicequotas:*:*:ec2/*\"\n      ]\n    },\n    {\n      \"Sid\": \"CloudWatchResourceExplorerPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"resource-explorer-2:ListIndexes\",\n        \"resource-explorer-2:Search\"\n      ],\n      \"Resource\": [\n        \"arn:aws:resource-explorer-2:*::view/AWSServiceViewForApplicationSignals/service-view\",\n        \"arn:aws:resource-explorer-2:*::view/AWSServiceViewForApplicationSignalsOrgScopeProd/service-view\"\n      ]\n    },\n    {\n      \"Sid\": \"CloudWatchResourceExplorerSLRPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:CreateServiceLinkedRole\"\n      ],\n      \"Resource\": \"arn:aws:iam::*:role/aws-service-role/resource-explorer-2.amazonaws.com/AWSServiceRoleForResourceExplorer\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"iam:AWSServiceName\": [\n            \"resource-explorer-2.amazonaws.com\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"CloudWatchResourceExplorerCreateIndexPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"resource-explorer-2:CreateIndex\"\n      ],\n      \"Resource\": \"arn:aws:resource-explorer-2:*:*:index/*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"iam:PassRole\",\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"iam:PassedToService\": \"logs.amazonaws.com\"\n        },\n        \"ArnLike\": {\n          \"iam:AssociatedResourceArn\": \"arn:aws:observabilityadmin:*:*:s3tableintegration/*\"\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"iam:PassRole\",\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"iam:PassedToService\": [\n            \"logs.amazonaws.com\",\n            \"telemetry-pipelines.observabilityadmin.amazonaws.com\"\n          ]\n        },\n        \"ArnLike\": {\n          \"iam:AssociatedResourceArn\": \"arn:aws:observabilityadmin:*:*:telemetry-pipeline/*\"\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3tables:CreateTableBucket\",\n        \"s3tables:PutTableBucketEncryption\"\n      ],\n      \"Resource\": \"arn:aws:s3tables:*:*:bucket/aws-cloudwatch\",\n      \"Condition\": {\n        \"ForAnyValue:StringEquals\": {\n          \"aws:CalledVia\": \"observabilityadmin.amazonaws.com\"\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3tables:PutTableBucketPolicy\"\n      ],\n      \"Resource\": \"arn:aws:s3tables:*:*:bucket/aws-cloudwatch\"\n    }\n  ]\n}", "id": "aws_managed_1089", "complexity": "complex", "services": ["application-autoscaling", "application-signals", "autoscaling", "cloudtrail", "cloudwatch", "iam", "logs", "oam", "observabilityadmin", "resource-explorer-2", "rum", "s3tables", "servicequotas", "sns", "synthetics", "xray"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for AWS Elemental Media Package V2Full Access\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": {\n    \"Effect\": \"Allow\",\n    \"Action\": \"mediapackagev2:*\",\n    \"Resource\": \"*\"\n  }\n}", "id": "aws_managed_1085", "complexity": "simple", "services": ["mediapackagev2"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for AWS Code Pipeline Full Access\n\n### Response:\n{\n  \"Statement\": [\n    {\n      \"Action\": [\n        \"codepipeline:*\",\n        \"cloudformation:DescribeStacks\",\n        \"cloudformation:ListStacks\",\n        \"cloudformation:ListChangeSets\",\n        \"cloudtrail:DescribeTrails\",\n        \"codebuild:BatchGetProjects\",\n        \"codebuild:CreateProject\",\n        \"codebuild:ListCuratedEnvironmentImages\",\n        \"codebuild:ListProjects\",\n        \"codecommit:ListBranches\",\n        \"codecommit:GetReferences\",\n        \"codecommit:ListRepositories\",\n        \"codedeploy:BatchGetDeploymentGroups\",\n        \"codedeploy:ListApplications\",\n        \"codedeploy:ListDeploymentGroups\",\n        \"ec2:DescribeSecurityGroups\",\n        \"ec2:DescribeSubnets\",\n        \"ec2:DescribeVpcs\",\n        \"ecr:DescribeRepositories\",\n        \"ecr:ListImages\",\n        \"ecs:ListClusters\",\n        \"ecs:ListServices\",\n        \"elasticbeanstalk:DescribeApplications\",\n        \"elasticbeanstalk:DescribeEnvironments\",\n        \"iam:ListRoles\",\n        \"iam:GetRole\",\n        \"lambda:ListFunctions\",\n        \"events:ListRules\",\n        \"events:ListTargetsByRule\",\n        \"events:DescribeRule\",\n        \"opsworks:DescribeApps\",\n        \"opsworks:DescribeLayers\",\n        \"opsworks:DescribeStacks\",\n        \"s3:ListAllMyBuckets\",\n        \"sns:ListTopics\",\n        \"codestar-notifications:ListNotificationRules\",\n        \"codestar-notifications:ListTargets\",\n        \"codestar-notifications:ListTagsforResource\",\n        \"codestar-notifications:ListEventTypes\",\n        \"states:ListStateMachines\"\n      ],\n      \"Effect\": \"Allow\",\n      \"Resource\": \"*\",\n      \"Sid\": \"CodePipelineAuthoringAccess\"\n    },\n    {\n      \"Action\": [\n        \"s3:GetObject\",\n        \"s3:ListBucket\",\n        \"s3:GetBucketPolicy\",\n        \"s3:GetBucketVersioning\",\n        \"s3:GetObjectVersion\",\n        \"s3:CreateBucket\",\n        \"s3:PutBucketPolicy\"\n      ],\n      \"Effect\": \"Allow\",\n      \"Resource\": \"arn:aws:s3::*:codepipeline-*\",\n      \"Sid\": \"CodePipelineArtifactsReadWriteAccess\"\n    },\n    {\n      \"Action\": [\n        \"cloudtrail:PutEventSelectors\",\n        \"cloudtrail:CreateTrail\",\n        \"cloudtrail:GetEventSelectors\",\n        \"cloudtrail:StartLogging\"\n      ],\n      \"Effect\": \"Allow\",\n      \"Resource\": \"arn:aws:cloudtrail:*:*:trail/codepipeline-source-trail\",\n      \"Sid\": \"CodePipelineSourceTrailReadWriteAccess\"\n    },\n    {\n      \"Action\": [\n        \"iam:PassRole\"\n      ],\n      \"Effect\": \"Allow\",\n      \"Resource\": [\n        \"arn:aws:iam::*:role/service-role/cwe-role-*\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"iam:PassedToService\": [\n            \"events.amazonaws.com\"\n          ]\n        }\n      },\n      \"Sid\": \"EventsIAMPassRole\"\n    },\n    {\n      \"Action\": [\n        \"iam:PassRole\"\n      ],\n      \"Effect\": \"Allow\",\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"iam:PassedToService\": [\n            \"codepipeline.amazonaws.com\"\n          ]\n        }\n      },\n      \"Sid\": \"CodePipelineIAMPassRole\"\n    },\n    {\n      \"Action\": [\n        \"events:PutRule\",\n        \"events:PutTargets\",\n        \"events:DeleteRule\",\n        \"events:DisableRule\",\n        \"events:RemoveTargets\"\n      ],\n      \"Effect\": \"Allow\",\n      \"Resource\": [\n        \"arn:aws:events:*:*:rule/codepipeline-*\"\n      ],\n      \"Sid\": \"CodePipelineEventsReadWriteAccess\"\n    },\n    {\n      \"Sid\": \"CodeStarNotificationsReadWriteAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"codestar-notifications:CreateNotificationRule\",\n        \"codestar-notifications:DescribeNotificationRule\",\n        \"codestar-notifications:UpdateNotificationRule\",\n        \"codestar-notifications:DeleteNotificationRule\",\n        \"codestar-notifications:Subscribe\",\n        \"codestar-notifications:Unsubscribe\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"codestar-notifications:NotificationsForResource\": \"arn:aws:codepipeline:*\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"CodeStarNotificationsSNSTopicCreateAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"sns:CreateTopic\",\n        \"sns:SetTopicAttributes\"\n      ],\n      \"Resource\": \"arn:aws:sns:*:*:codestar-notifications*\"\n    },\n    {\n      \"Sid\": \"CodeStarNotificationsChatbotAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"chatbot:DescribeSlackChannelConfigurations\",\n        \"chatbot:ListMicrosoftTeamsChannelConfigurations\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ],\n  \"Version\": \"2012-10-17\"\n}", "id": "aws_managed_0650", "complexity": "complex", "services": ["chatbot", "cloudformation", "cloudtrail", "codebuild", "codecommit", "codedeploy", "codepipeline", "codestar-notifications", "ec2", "ecr", "ecs", "elasticbeanstalk", "events", "iam", "lambda", "opsworks", "s3", "sns", "states"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for AWS Account Settings Management Role\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"account:GetContactInformation\",\n        \"account:PutContactInformation\",\n        \"account:GetAccountInformation\",\n        \"account:CloseAccount\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"payments:ListTagsForResource\",\n        \"payments:UntagResource\",\n        \"payments:TagResource\",\n        \"payments:ListPaymentPreferences\",\n        \"payments:GetPaymentInstrument\",\n        \"payments:GetPaymentStatus\",\n        \"payments:MakePayment\",\n        \"payments:UpdatePaymentPreferences\",\n        \"payments:CreatePaymentInstrument\",\n        \"payments:UpdatePaymentInstrument\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"invoicing:GetInvoicePDF\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"billing:GetSellerOfRecord\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"freetier:GetAccountPlanState\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ce:GetCostAndUsage\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"pricing:GetProducts\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"tax:GetTaxRegistration\",\n        \"tax:PutTaxRegistration\",\n        \"tax:ListTaxRegistrations\",\n        \"tax:DeleteTaxRegistration\",\n        \"tax:BatchPutTaxRegistration\",\n        \"tax:GetTaxRegistrationDocument\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"customer-verification:GetCustomerVerificationDetails\",\n        \"customer-verification:GetCustomerVerificationEligibility\",\n        \"customer-verification:CreateCustomerVerificationDetails\",\n        \"customer-verification:CreateUploadUrls\",\n        \"customer-verification:UpdateCustomerVerificationDetails\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"sso:ListInstances\",\n        \"sso:ListApplications\",\n        \"sso:DescribeApplication\",\n        \"sso:DescribeInstance\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}", "id": "aws_managed_1437", "complexity": "complex", "services": ["account", "billing", "ce", "customer-verification", "freetier", "invoicing", "payments", "pricing", "sso", "tax"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for Amazon Prometheus Scraper Service Role Policy\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"DeleteSLR\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:DeleteRole\"\n      ],\n      \"Resource\": \"arn:aws:iam::*:role/aws-service-role/scraper.aps.amazonaws.com/AWSServiceRoleForAmazonPrometheusScraper*\"\n    },\n    {\n      \"Sid\": \"NetworkDiscovery\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:DescribeNetworkInterfaces\",\n        \"ec2:DescribeSubnets\",\n        \"ec2:DescribeSecurityGroups\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"ENIManagement\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"ec2:CreateNetworkInterface\",\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"ForAllValues:StringEquals\": {\n          \"aws:TagKeys\": [\n            \"AMPAgentlessScraper\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"TagManagement\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"ec2:CreateTags\",\n      \"Resource\": \"arn:aws:ec2:*:*:network-interface/*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"ec2:CreateAction\": \"CreateNetworkInterface\"\n        },\n        \"Null\": {\n          \"aws:RequestTag/AMPAgentlessScraper\": \"false\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"ENIUpdating\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:DeleteNetworkInterface\",\n        \"ec2:ModifyNetworkInterfaceAttribute\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"Null\": {\n          \"ec2:ResourceTag/AMPAgentlessScraper\": \"false\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"EKSAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"eks:DescribeCluster\",\n      \"Resource\": \"arn:aws:eks:*:*:cluster/*\"\n    },\n    {\n      \"Sid\": \"DeleteEKSAccessEntry\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"eks:DeleteAccessEntry\",\n      \"Resource\": \"arn:aws:eks:*:*:access-entry/*/role/*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:PrincipalAccount\": \"${aws:ResourceAccount}\"\n        },\n        \"ArnLike\": {\n          \"eks:principalArn\": \"arn:aws:iam::*:role/aws-service-role/scraper.aps.amazonaws.com/AWSServiceRoleForAmazonPrometheusScraper*\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"APSWriting\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"aps:RemoteWrite\",\n      \"Resource\": \"arn:aws:aps:*:*:workspace/*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:PrincipalAccount\": \"${aws:ResourceAccount}\"\n        }\n      }\n    }\n  ]\n}", "id": "aws_managed_1129", "complexity": "complex", "services": ["aps", "ec2", "eks", "iam"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for AWS Application Auto Scaling Custom Resource Policy\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"execute-api:Invoke\",\n        \"cloudwatch:PutMetricAlarm\",\n        \"cloudwatch:DescribeAlarms\",\n        \"cloudwatch:DeleteAlarms\"\n      ],\n      \"Resource\": [\n        \"*\"\n      ]\n    }\n  ]\n}", "id": "aws_managed_0348", "complexity": "medium", "services": ["cloudwatch", "execute-api"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for AWS Observability Admin Service Role Policy\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"organizations:ListAccounts\",\n        \"organizations:ListAccountsForParent\",\n        \"organizations:ListChildren\",\n        \"organizations:ListParents\",\n        \"organizations:DescribeOrganization\",\n        \"organizations:DescribeOrganizationalUnit\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"config:PutServiceLinkedConfigurationRecorder\",\n        \"config:DeleteServiceLinkedConfigurationRecorder\"\n      ],\n      \"Resource\": [\n        \"arn:aws:config:*:*:configuration-recorder/AWSConfigurationRecorderForObservabilityAdmin/*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"config:PutConfigurationAggregator\",\n        \"config:DeleteConfigurationAggregator\",\n        \"config:SelectAggregateResourceConfig\"\n      ],\n      \"Resource\": [\n        \"arn:aws:config:*:*:config-aggregator/aws-service-config-aggregator/observabilityadmin.amazonaws.com/*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:CreateServiceLinkedRole\"\n      ],\n      \"Resource\": [\n        \"arn:aws:iam::*:role/aws-service-role/config.amazonaws.com/AWSServiceRoleForConfig\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"iam:AWSServiceName\": [\n            \"config.amazonaws.com\"\n          ]\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:PassRole\"\n      ],\n      \"Resource\": [\n        \"arn:aws:iam::*:role/aws-service-role/config.amazonaws.com/AWSServiceRoleForConfig\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"iam:PassedToService\": [\n            \"config.amazonaws.com\"\n          ]\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"organizations:EnableAWSServiceAccess\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"organizations:ServicePrincipal\": [\n            \"config.amazonaws.com\"\n          ]\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"organizations:ListDelegatedAdministrators\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"organizations:ServicePrincipal\": [\n            \"observabilityadmin.amazonaws.com\",\n            \"config.amazonaws.com\"\n          ]\n        }\n      }\n    }\n  ]\n}", "id": "aws_managed_1276", "complexity": "complex", "services": ["config", "iam", "organizations"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for AWS Backup Restore Access For SAPHANA\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"backup:Get*\",\n        \"backup:List*\",\n        \"backup:Describe*\",\n        \"backup:StartBackupJob\",\n        \"backup:StartRestoreJob\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ssm-sap:GetOperation\",\n        \"ssm-sap:ListDatabases\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ssm-sap:BackupDatabase\",\n        \"ssm-sap:RestoreDatabase\",\n        \"ssm-sap:UpdateHanaBackupSettings\",\n        \"ssm-sap:GetDatabase\",\n        \"ssm-sap:ListTagsForResource\"\n      ],\n      \"Resource\": \"arn:aws:ssm-sap:*:*:*\"\n    }\n  ]\n}", "id": "aws_managed_0974", "complexity": "medium", "services": ["backup", "ssm-sap"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for AWS Io T Wireless Data Access\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iotwireless:SendDataToWirelessDevice\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}", "id": "aws_managed_0741", "complexity": "simple", "services": ["iotwireless"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for Amazon Free RTOSOTA Update\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:GetObjectVersion\",\n        \"s3:PutObject\",\n        \"s3:GetObject\"\n      ],\n      \"Resource\": \"arn:aws:s3:::afr-ota*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"signer:StartSigningJob\",\n        \"signer:DescribeSigningJob\",\n        \"signer:GetSigningProfile\",\n        \"signer:PutSigningProfile\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:ListBucketVersions\",\n        \"s3:ListBucket\",\n        \"s3:ListAllMyBuckets\",\n        \"s3:GetBucketLocation\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iot:DeleteJob\",\n        \"iot:DescribeJob\"\n      ],\n      \"Resource\": \"arn:aws:iot:*:*:job/AFR_OTA*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iot:DeleteStream\"\n      ],\n      \"Resource\": \"arn:aws:iot:*:*:stream/AFR_OTA*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iot:CreateStream\",\n        \"iot:CreateJob\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}", "id": "aws_managed_0371", "complexity": "complex", "services": ["iot", "s3", "signer"], "source": "aws_managed"}
{"text": "### Instruction:\nRead-only access to CloudWatch logs for a specific log group named /app/production\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"logs:GetLogEvents\",\n        \"logs:FilterLogEvents\",\n        \"logs:DescribeLogStreams\"\n      ],\n      \"Resource\": \"arn:aws:logs:*:*:log-group:/app/production:*\"\n    }\n  ]\n}", "id": "syn_cw_003", "complexity": "simple", "services": ["logs"], "source": "synthetic"}
{"text": "### Instruction:\nProvide an IAM policy for AWS Migration Hub Refactor Spaces SSM Automation Policy\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:DescribeInstanceStatus\",\n        \"ec2:DescribeInstances\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:ModifyInstanceAttribute\"\n      ],\n      \"Resource\": \"arn:aws:ec2:*:*:instance/*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:ResourceTag/refactor-spaces:ssm:optin\": \"true\"\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:ModifyInstanceAttribute\"\n      ],\n      \"Resource\": \"arn:aws:ec2:*:*:security-group/*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:CreateTags\",\n        \"ec2:DeleteTags\"\n      ],\n      \"Resource\": \"arn:aws:ec2:*:*:instance/*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:ResourceTag/refactor-spaces:ssm:optin\": \"true\"\n        },\n        \"ForAllValues:StringEquals\": {\n          \"aws:TagKeys\": \"refactor-spaces:ssm:environment-id\"\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"ssm:GetParameters\",\n      \"Resource\": \"arn:aws:ssm:*:*:parameter/ManagedByAWSApplicationMigrationService-*\"\n    }\n  ]\n}", "id": "aws_managed_1093", "complexity": "complex", "services": ["ec2", "ssm"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for AWS Quick Setup Start SSM Associations Execution Policy\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ssm:StartAutomationExecution\"\n      ],\n      \"Resource\": [\n        \"arn:aws:ssm:*:*:document/AWSQuickSetupType-Scheduler-ChangeCalendarState\",\n        \"arn:aws:ssm:*:*:automation-execution/*\",\n        \"arn:aws:ssm:*:*:automation-definition/AWSQuickSetupType-Scheduler-ChangeCalendarState*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"iam:PassRole\",\n      \"Resource\": [\n        \"arn:aws:iam::*:role/AWS-QuickSetup*\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"iam:PassedToService\": [\n            \"ssm.amazonaws.com\"\n          ]\n        },\n        \"ArnLike\": {\n          \"iam:AssociatedResourceARN\": [\n            \"arn:aws:ssm:*:*:document/AWSQuickSetupType-Scheduler-ChangeCalendarState\",\n            \"arn:aws:ssm:*:*:automation-definition/AWSQuickSetupType-Scheduler-ChangeCalendarState*\"\n          ]\n        }\n      }\n    }\n  ]\n}", "id": "aws_managed_1372", "complexity": "medium", "services": ["iam", "ssm"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for Amazon Chime SDK\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"chime:CreateMeeting\",\n        \"chime:CreateMeetingWithAttendees\",\n        \"chime:DeleteMeeting\",\n        \"chime:GetMeeting\",\n        \"chime:ListMeetings\",\n        \"chime:CreateAttendee\",\n        \"chime:BatchCreateAttendee\",\n        \"chime:DeleteAttendee\",\n        \"chime:GetAttendee\",\n        \"chime:ListAttendees\",\n        \"chime:ListAttendeeTags\",\n        \"chime:ListMeetingTags\",\n        \"chime:ListTagsForResource\",\n        \"chime:TagAttendee\",\n        \"chime:TagMeeting\",\n        \"chime:TagResource\",\n        \"chime:UntagAttendee\",\n        \"chime:UntagMeeting\",\n        \"chime:UntagResource\",\n        \"chime:StartMeetingTranscription\",\n        \"chime:StopMeetingTranscription\",\n        \"chime:CreateMediaCapturePipeline\",\n        \"chime:CreateMediaConcatenationPipeline\",\n        \"chime:CreateMediaLiveConnectorPipeline\",\n        \"chime:DeleteMediaCapturePipeline\",\n        \"chime:DeleteMediaPipeline\",\n        \"chime:GetMediaCapturePipeline\",\n        \"chime:GetMediaPipeline\",\n        \"chime:ListMediaCapturePipelines\",\n        \"chime:ListMediaPipelines\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}", "id": "aws_managed_0591", "complexity": "simple", "services": ["chime"], "source": "aws_managed"}
{"text": "### Instruction:\nAllow uploading objects to the logs bucket only if the objects are server-side encrypted with AWS KMS\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"s3:PutObject\",\n      \"Resource\": \"arn:aws:s3:::logs/*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"s3:x-amz-server-side-encryption\": \"aws:kms\"\n        }\n      }\n    }\n  ]\n}", "id": "syn_s3_012", "complexity": "medium", "services": ["s3"], "source": "synthetic"}
{"text": "### Instruction:\nProvide an IAM policy for Ec2Image Builder Cross Account Distribution Access\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"ec2:CreateTags\",\n      \"Resource\": \"arn:aws:ec2:*::image/*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:DescribeImages\",\n        \"ec2:CopyImage\",\n        \"ec2:ModifyImageAttribute\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}", "id": "aws_managed_0675", "complexity": "medium", "services": ["ec2"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for Amazon Detective Organizations Access\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"detective:DisableOrganizationAdminAccount\",\n        \"detective:EnableOrganizationAdminAccount\",\n        \"detective:ListOrganizationAdminAccount\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:CreateServiceLinkedRole\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"iam:AWSServiceName\": \"detective.amazonaws.com\"\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"organizations:EnableAWSServiceAccess\",\n        \"organizations:RegisterDelegatedAdministrator\",\n        \"organizations:DeregisterDelegatedAdministrator\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"organizations:ServicePrincipal\": [\n            \"detective.amazonaws.com\"\n          ]\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"organizations:DescribeAccount\",\n        \"organizations:DescribeOrganization\",\n        \"organizations:ListAccounts\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"organizations:ListDelegatedAdministrators\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"organizations:ServicePrincipal\": [\n            \"detective.amazonaws.com\",\n            \"guardduty.amazonaws.com\",\n            \"macie.amazonaws.com\",\n            \"securityhub.amazonaws.com\"\n          ]\n        }\n      }\n    }\n  ]\n}", "id": "aws_managed_1026", "complexity": "complex", "services": ["detective", "iam", "organizations"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for AWS Resource Groups Read Only Access\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Action\": [\n        \"resource-groups:Get*\",\n        \"resource-groups:List*\",\n        \"resource-groups:Search*\",\n        \"tag:Get*\",\n        \"cloudformation:DescribeStacks\",\n        \"cloudformation:ListStackResources\",\n        \"ec2:DescribeInstances\",\n        \"ec2:DescribeSecurityGroups\",\n        \"ec2:DescribeSnapshots\",\n        \"ec2:DescribeVolumes\",\n        \"ec2:DescribeVpcs\",\n        \"elasticache:DescribeCacheClusters\",\n        \"elasticache:DescribeSnapshots\",\n        \"elasticache:ListTagsForResource\",\n        \"elasticbeanstalk:DescribeEnvironments\",\n        \"elasticmapreduce:DescribeCluster\",\n        \"elasticmapreduce:ListClusters\",\n        \"glacier:ListVaults\",\n        \"glacier:DescribeVault\",\n        \"glacier:ListTagsForVault\",\n        \"kinesis:ListStreams\",\n        \"kinesis:DescribeStream\",\n        \"kinesis:ListTagsForStream\",\n        \"opsworks:DescribeStacks\",\n        \"opsworks:ListTags\",\n        \"rds:DescribeDBInstances\",\n        \"rds:DescribeDBSnapshots\",\n        \"rds:ListTagsForResource\",\n        \"redshift:DescribeClusters\",\n        \"redshift:DescribeTags\",\n        \"route53domains:ListDomains\",\n        \"route53:ListHealthChecks\",\n        \"route53:GetHealthCheck\",\n        \"route53:ListHostedZones\",\n        \"route53:GetHostedZone\",\n        \"route53:ListTagsForResource\",\n        \"storagegateway:ListGateways\",\n        \"storagegateway:DescribeGatewayInformation\",\n        \"storagegateway:ListTagsForResource\",\n        \"s3:ListAllMyBuckets\",\n        \"s3:GetBucketTagging\",\n        \"elasticloadbalancing:DescribeLoadBalancers\",\n        \"elasticloadbalancing:DescribeTags\",\n        \"ssm:ListDocuments\"\n      ],\n      \"Effect\": \"Allow\",\n      \"Resource\": \"*\"\n    }\n  ]\n}", "id": "aws_managed_0321", "complexity": "complex", "services": ["cloudformation", "ec2", "elasticache", "elasticbeanstalk", "elasticloadbalancing", "elasticmapreduce", "glacier", "kinesis", "opsworks", "rds", "redshift", "resource-groups", "route53", "route53domains", "s3", "ssm", "storagegateway", "tag"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for AWS Batch Full Access\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"batch:*\",\n        \"cloudwatch:GetMetricStatistics\",\n        \"ec2:DescribeSubnets\",\n        \"ec2:DescribeSecurityGroups\",\n        \"ec2:DescribeKeyPairs\",\n        \"ec2:DescribeVpcs\",\n        \"ec2:DescribeImages\",\n        \"ec2:DescribeLaunchTemplates\",\n        \"ec2:DescribeLaunchTemplateVersions\",\n        \"ecs:DescribeClusters\",\n        \"ecs:Describe*\",\n        \"ecs:List*\",\n        \"eks:DescribeCluster\",\n        \"eks:ListClusters\",\n        \"logs:Describe*\",\n        \"logs:Get*\",\n        \"logs:TestMetricFilter\",\n        \"logs:FilterLogEvents\",\n        \"iam:ListInstanceProfiles\",\n        \"iam:ListRoles\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:PassRole\"\n      ],\n      \"Resource\": [\n        \"arn:aws:iam::*:role/AWSBatchServiceRole\",\n        \"arn:aws:iam::*:role/service-role/AWSBatchServiceRole\",\n        \"arn:aws:iam::*:role/ecsInstanceRole\",\n        \"arn:aws:iam::*:instance-profile/ecsInstanceRole\",\n        \"arn:aws:iam::*:role/iaws-ec2-spot-fleet-role\",\n        \"arn:aws:iam::*:role/aws-ec2-spot-fleet-role\",\n        \"arn:aws:iam::*:role/AWSBatchJobRole*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:CreateServiceLinkedRole\"\n      ],\n      \"Resource\": \"arn:aws:iam::*:role/*Batch*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"iam:AWSServiceName\": \"batch.amazonaws.com\"\n        }\n      }\n    }\n  ]\n}", "id": "aws_managed_0202", "complexity": "complex", "services": ["batch", "cloudwatch", "ec2", "ecs", "eks", "iam", "logs"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for AWS Organizations Service Trust Policy\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"AllowDeletionOfServiceLinkedRoleForOrganizations\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:DeleteRole\"\n      ],\n      \"Resource\": [\n        \"arn:aws:iam::*:role/aws-service-role/organizations.amazonaws.com/*\"\n      ]\n    },\n    {\n      \"Sid\": \"AllowCreationOfServiceLinkedRoles\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:CreateServiceLinkedRole\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}", "id": "aws_managed_0252", "complexity": "medium", "services": ["iam"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for SSM Quick Setup Role Policy\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"SSMResourceDataSyncPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ssm:ListResourceDataSync\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"SSMResourceDataSyncGetOpsSummaryPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ssm:GetOpsSummary\"\n      ],\n      \"Resource\": \"arn:aws:ssm:*:*:resource-data-sync/AWS-QuickSetup-*\"\n    },\n    {\n      \"Sid\": \"SSMResourceDataSyncManagePermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ssm:DeleteResourceDataSync\"\n      ],\n      \"Resource\": \"arn:aws:ssm:*:*:resource-data-sync/AWS-QuickSetup-*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"ssm:SyncType\": \"SyncFromSource\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"SSMAssociationsReadOnlyPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ssm:ListAssociations\",\n        \"ssm:DescribeAssociationExecutions\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"QuickSetupSSMDocumentsReadOnlyPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ssm:DescribeDocument\",\n        \"ssm:GetDocument\"\n      ],\n      \"Resource\": [\n        \"arn:aws:ssm:*:*:document/AWSQuickSetupType-*\",\n        \"arn:aws:ssm:*:*:document/*-AWSQuickSetupType-*\"\n      ]\n    },\n    {\n      \"Sid\": \"OrganizationReadOnlyPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"organizations:ListAccounts\",\n        \"organizations:ListRoots\",\n        \"organizations:ListAWSServiceAccessForOrganization\",\n        \"organizations:ListDelegatedAdministrators\",\n        \"organizations:ListAccountsForParent\",\n        \"organizations:ListOrganizationalUnitsForParent\",\n        \"organizations:ListDelegatedServicesForAccount\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"QuickSetupStackSetReadOnlyPermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"cloudformation:DescribeStackInstance\",\n        \"cloudformation:DescribeStackSet\",\n        \"cloudformation:DescribeStackSetOperation\",\n        \"cloudformation:ListStackInstances\",\n        \"cloudformation:ListStackSetOperations\",\n        \"cloudformation:ListStackSetOperationResults\",\n        \"cloudformation:GetTemplate\"\n      ],\n      \"Resource\": [\n        \"arn:aws:cloudformation:*:*:stackset/AWS-QuickSetup-*\",\n        \"arn:aws:cloudformation:*:*:stackset/SSMQuickSetup*\",\n        \"arn:aws:cloudformation:*:*:stack/StackSet-AWS-QuickSetup-*\",\n        \"arn:aws:cloudformation:*:*:stack/StackSet-SSMQuickSetup*\"\n      ]\n    },\n    {\n      \"Sid\": \"QuickSetupStackSetDeletePermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"cloudformation:DeleteStackInstances\",\n        \"cloudformation:DeleteStackSet\"\n      ],\n      \"Resource\": [\n        \"arn:aws:cloudformation:*:*:stackset/AWS-QuickSetup-*\",\n        \"arn:aws:cloudformation:*:*:stackset/SSMQuickSetup*\",\n        \"arn:aws:cloudformation:*:*:stack/StackSet-AWS-QuickSetup-*\",\n        \"arn:aws:cloudformation:*:*:stack/StackSet-SSMQuickSetup*\",\n        \"arn:aws:cloudformation:*:*:stackset-target/AWS-QuickSetup-*\",\n        \"arn:aws:cloudformation:*:*:stackset-target/SSMQuickSetup*\",\n        \"arn:aws:cloudformation:*:*:type/resource/*\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:ResourceAccount\": \"${aws:PrincipalAccount}\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"QuickSetupCfnStacksDescribePermissions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"cloudformation:DescribeStacks\",\n        \"cloudformation:ListStacks\"\n      ],\n      \"Resource\": [\n        \"*\"\n      ]\n    }\n  ]\n}", "id": "aws_managed_1192", "complexity": "complex", "services": ["cloudformation", "organizations", "ssm"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for Amazon DRSVPC Management\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:AuthorizeSecurityGroupIngress\",\n        \"ec2:CreateNetworkInterface\",\n        \"ec2:CreateSecurityGroup\",\n        \"ec2:DescribeAvailabilityZones\",\n        \"ec2:DescribeInternetGateways\",\n        \"ec2:DescribeSecurityGroups\",\n        \"ec2:DescribeSubnets\",\n        \"ec2:DescribeVpcAttribute\",\n        \"ec2:DescribeVpcs\",\n        \"ec2:DeleteNetworkInterface\",\n        \"ec2:DeleteSecurityGroup\",\n        \"ec2:ModifyNetworkInterfaceAttribute\",\n        \"ec2:RevokeSecurityGroupIngress\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}", "id": "aws_managed_0123", "complexity": "simple", "services": ["ec2"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for AWS Elemental Media Store Read Only\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Action\": [\n        \"mediastore:Get*\",\n        \"mediastore:List*\",\n        \"mediastore:Describe*\"\n      ],\n      \"Effect\": \"Allow\",\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"Bool\": {\n          \"aws:SecureTransport\": \"true\"\n        }\n      }\n    }\n  ]\n}", "id": "aws_managed_0322", "complexity": "simple", "services": ["mediastore"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for ROSA Worker Instance Policy\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"EC2DescribeInstancesRegions\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:DescribeInstances\",\n        \"ec2:DescribeRegions\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"ECRGetAuthorizationToken\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ecr:GetAuthorizationToken\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"ECRReadOnlyAccessRedHatManaged\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ecr:BatchCheckLayerAvailability\",\n        \"ecr:GetDownloadUrlForLayer\",\n        \"ecr:GetRepositoryPolicy\",\n        \"ecr:DescribeRepositories\",\n        \"ecr:ListImages\",\n        \"ecr:DescribeImages\",\n        \"ecr:BatchGetImage\",\n        \"ecr:ListTagsForResource\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:ResourceTag/red-hat-managed\": \"true\"\n        }\n      }\n    }\n  ]\n}", "id": "aws_managed_1050", "complexity": "medium", "services": ["ec2", "ecr"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for Elastic Load Balancing Full Access\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"elasticloadbalancing:*\",\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:DescribeAccountAttributes\",\n        \"ec2:DescribeAddresses\",\n        \"ec2:DescribeInternetGateways\",\n        \"ec2:DescribeSecurityGroups\",\n        \"ec2:DescribeSubnets\",\n        \"ec2:DescribeVpcs\",\n        \"ec2:DescribeVpcClassicLink\",\n        \"ec2:DescribeInstances\",\n        \"ec2:DescribeNetworkInterfaces\",\n        \"ec2:DescribeClassicLinkInstances\",\n        \"ec2:DescribeRouteTables\",\n        \"ec2:DescribeCoipPools\",\n        \"ec2:GetCoipPoolUsage\",\n        \"ec2:GetSecurityGroupsForVpc\",\n        \"ec2:DescribeVpcPeeringConnections\",\n        \"cognito-idp:DescribeUserPoolClient\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"iam:CreateServiceLinkedRole\",\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringEquals\": {\n          \"iam:AWSServiceName\": \"elasticloadbalancing.amazonaws.com\"\n        }\n      }\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"arc-zonal-shift:*\",\n      \"Resource\": \"arn:aws:elasticloadbalancing:*:*:loadbalancer/*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"arc-zonal-shift:ListManagedResources\",\n        \"arc-zonal-shift:ListZonalShifts\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}", "id": "aws_managed_0375", "complexity": "complex", "services": ["arc-zonal-shift", "cognito-idp", "ec2", "elasticloadbalancing", "iam"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for AWS Image Builder Read Only Access\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"imagebuilder:Get*\",\n        \"imagebuilder:List*\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:GetRole\"\n      ],\n      \"Resource\": \"arn:aws:iam::*:role/aws-service-role/imagebuilder.amazonaws.com/AWSServiceRoleForImageBuilder\"\n    }\n  ]\n}", "id": "aws_managed_0580", "complexity": "medium", "services": ["iam", "imagebuilder"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for Amazon F Sx Service Role Policy\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"CreateFileSystem\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ds:AuthorizeApplication\",\n        \"ds:GetAuthorizedApplicationDetails\",\n        \"ds:UnauthorizeApplication\",\n        \"ec2:CreateNetworkInterface\",\n        \"ec2:CreateNetworkInterfacePermission\",\n        \"ec2:DeleteNetworkInterface\",\n        \"ec2:DescribeAddresses\",\n        \"ec2:DescribeDhcpOptions\",\n        \"ec2:DescribeNetworkInterfaces\",\n        \"ec2:DescribeRouteTables\",\n        \"ec2:DescribeSecurityGroups\",\n        \"ec2:DescribeSubnets\",\n        \"ec2:DescribeVpcs\",\n        \"ec2:DisassociateAddress\",\n        \"ec2:GetSecurityGroupsForVpc\",\n        \"route53:AssociateVPCWithHostedZone\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"PutMetrics\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"cloudwatch:PutMetricData\"\n      ],\n      \"Resource\": [\n        \"*\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"cloudwatch:namespace\": \"AWS/FSx\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"TagResourceNetworkInterface\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:CreateTags\"\n      ],\n      \"Resource\": [\n        \"arn:aws:ec2:*:*:network-interface/*\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"ec2:CreateAction\": \"CreateNetworkInterface\"\n        },\n        \"ForAllValues:StringEquals\": {\n          \"aws:TagKeys\": \"AmazonFSx.FileSystemId\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"ManageNetworkInterface\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:AssignIpv6Addresses\",\n        \"ec2:AssignPrivateIpAddresses\",\n        \"ec2:ModifyNetworkInterfaceAttribute\",\n        \"ec2:UnassignIpv6Addresses\",\n        \"ec2:UnassignPrivateIpAddresses\"\n      ],\n      \"Resource\": [\n        \"arn:aws:ec2:*:*:network-interface/*\"\n      ],\n      \"Condition\": {\n        \"Null\": {\n          \"aws:ResourceTag/AmazonFSx.FileSystemId\": \"false\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"ManageRouteTable\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:CreateRoute\",\n        \"ec2:ReplaceRoute\",\n        \"ec2:DeleteRoute\"\n      ],\n      \"Resource\": [\n        \"arn:aws:ec2:*:*:route-table/*\"\n      ],\n      \"Condition\": {\n        \"StringEquals\": {\n          \"aws:ResourceTag/AmazonFSx\": \"ManagedByAmazonFSx\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"PutCloudWatchLogs\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"logs:DescribeLogGroups\",\n        \"logs:DescribeLogStreams\",\n        \"logs:PutLogEvents\"\n      ],\n      \"Resource\": \"arn:aws:logs:*:*:log-group:/aws/fsx/*\"\n    },\n    {\n      \"Sid\": \"ManageAuditLogs\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"firehose:DescribeDeliveryStream\",\n        \"firehose:PutRecord\",\n        \"firehose:PutRecordBatch\"\n      ],\n      \"Resource\": \"arn:aws:firehose:*:*:deliverystream/aws-fsx-*\"\n    }\n  ]\n}", "id": "aws_managed_0414", "complexity": "complex", "services": ["cloudwatch", "ds", "ec2", "firehose", "logs", "route53"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for Amazon MCS Full Access\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"application-autoscaling:DeleteScalingPolicy\",\n        \"application-autoscaling:DeregisterScalableTarget\",\n        \"application-autoscaling:DescribeScalableTargets\",\n        \"application-autoscaling:DescribeScalingActivities\",\n        \"application-autoscaling:DescribeScalingPolicies\",\n        \"application-autoscaling:PutScalingPolicy\",\n        \"application-autoscaling:RegisterScalableTarget\",\n        \"application-autoscaling:PutScheduledAction\",\n        \"application-autoscaling:DeleteScheduledAction\",\n        \"application-autoscaling:DescribeScheduledActions\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"cassandra:*\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"cloudwatch:DeleteAlarms\",\n        \"cloudwatch:DescribeAlarms\",\n        \"cloudwatch:PutMetricAlarm\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"iam:CreateServiceLinkedRole\",\n      \"Resource\": \"arn:aws:iam::*:role/aws-service-role/cassandra.application-autoscaling.amazonaws.com/AWSServiceRoleForApplicationAutoScaling_CassandraTable\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"iam:AWSServiceName\": \"cassandra.application-autoscaling.amazonaws.com\"\n        }\n      }\n    }\n  ]\n}", "id": "aws_managed_0564", "complexity": "complex", "services": ["application-autoscaling", "cassandra", "cloudwatch", "iam"], "source": "aws_managed"}
{"text": "### Instruction:\nFull access to S3 bucket my-app-bucket including ability to manage bucket policies and ACLs\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"s3:*\",\n      \"Resource\": [\n        \"arn:aws:s3:::my-app-bucket\",\n        \"arn:aws:s3:::my-app-bucket/*\"\n      ]\n    }\n  ]\n}", "id": "syn_s3_004", "complexity": "simple", "services": ["s3"], "source": "synthetic"}
{"text": "### Instruction:\nProvide an IAM policy for AWS Cloud Map Full Access\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"route53:GetHostedZone\",\n        \"route53:ListHostedZonesByName\",\n        \"route53:CreateHostedZone\",\n        \"route53:DeleteHostedZone\",\n        \"route53:ChangeResourceRecordSets\",\n        \"route53:CreateHealthCheck\",\n        \"route53:GetHealthCheck\",\n        \"route53:DeleteHealthCheck\",\n        \"route53:UpdateHealthCheck\",\n        \"ec2:DescribeVpcs\",\n        \"ec2:DescribeRegions\",\n        \"ec2:DescribeInstances\",\n        \"servicediscovery:*\"\n      ],\n      \"Resource\": [\n        \"*\"\n      ]\n    }\n  ]\n}", "id": "aws_managed_0423", "complexity": "medium", "services": ["ec2", "route53", "servicediscovery"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for Cloud Watch Network Flow Monitor Agent Publish Policy\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"networkflowmonitor:Publish\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}", "id": "aws_managed_1284", "complexity": "simple", "services": ["networkflowmonitor"], "source": "aws_managed"}
{"text": "### Instruction:\nProvide an IAM policy for AWSSSO Directory Read Only\n\n### Response:\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"AWSSSODirectoryReadOnly\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"sso-directory:Search*\",\n        \"sso-directory:Describe*\",\n        \"sso-directory:List*\",\n        \"sso-directory:Get*\",\n        \"identitystore:Describe*\",\n        \"identitystore:List*\",\n        \"identitystore-auth:ListSessions\",\n        \"identitystore-auth:BatchGetSession\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"AllowKMSKeyUseViaAWSIdentityStoreService\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"kms:Decrypt\"\n      ],\n      \"Resource\": \"*\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"kms:ViaService\": \"identitystore.*.amazonaws.com\",\n          \"kms:EncryptionContext:aws:identitystore:identitystore-arn\": \"*\"\n        }\n      }\n    }\n  ]\n}", "id": "aws_managed_0386", "complexity": "complex", "services": ["identitystore", "identitystore-auth", "kms", "sso-directory"], "source": "aws_managed"}
